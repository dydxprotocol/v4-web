"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[9766],{33454:(t,e,s)=>{s.d(e,{create:()=>b,exact:()=>m,exclude:()=>y,getListById:()=>g,getListIds:()=>L,getListsMap:()=>I,insert:()=>u,put:()=>h,reducer:()=>T,remove:()=>S,rename:()=>f,replace:()=>d,setup:()=>a});var n=s(97168);function o(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(t[s]!==e[s])return!1;return!0}const r=Symbol();const i={lists:{ids:[],byId:{}},timestamp:null};function l(t,e){t.lists.ids.push(e.id),t.lists.byId[e.id]={id:e.id,name:e.name,symbols:[...e.symbols],shared:e.shared}}const c=(0,n.createSlice)({name:"custom-lists",initialState:i,reducers:{setup:(t,e)=>{const{lists:s,timestamp:n}=e.payload,o={lists:{ids:[],byId:{}},timestamp:null};for(const t of s)l(o,t);return o.timestamp=n,o},insert:(t,e)=>{const{id:s,symbols:n,before:i}=e.payload,{lists:l}=t,c=l.byId[s];if(void 0===c)return;const a=new Set(n);let u;if(void 0!==i&&a.has(i)){u=r;for(let t=c.symbols.indexOf(i);t>=0;--t)if(!a.has(c.symbols[t])){u=c.symbols[t];break}}const d=c.symbols.filter(t=>!a.has(t)),m=function(t,e,s){const n=void 0===s?void 0!==e?t.indexOf(e):void 0:s===r?0:t.indexOf(s)+1;return-1!==n?n:void 0}(d,i,u);void 0===m?d.push(...a):d.splice(m,0,...a),o(d,c.symbols)||(c.symbols=d)},replace:(t,e)=>{const{id:s,current:n,next:o}=e.payload,{lists:r}=t,i=r.byId[s];if(void 0===i)return;if(n===o)return;let l=!1,c=!1;const a=[];for(const t of i.symbols){if(t===o){c=!0;break}t===n?(a.push(o),l=!0):a.push(t)}l&&!c&&(i.symbols=a)},exact:(t,e)=>{const{id:s,symbols:n}=e.payload,{lists:r}=t,i=r.byId[s];if(void 0===i)return;const l=[...new Set(n)];o(l,i.symbols)||(i.symbols=l)},exclude:(t,e)=>{const{id:s,symbols:n}=e.payload,{lists:r}=t,i=r.byId[s];if(void 0===i)return;const l=new Set(n),c=i.symbols.filter(t=>!l.has(t));o(c,i.symbols)||(i.symbols=c)},remove:(t,e)=>{const{id:s}=e.payload,{lists:n}=t;if(void 0===n.byId[s])return;const o=n.ids.filter(t=>t!==s);n.ids=o,delete n.byId[s]},create:(t,e)=>{const{id:s,name:n,symbols:o}=e.payload,{lists:r}=t;void 0===r.byId[s]&&l(t,{id:s,name:n,symbols:o,shared:!1})},put:(t,e)=>{const{id:s,name:n,symbols:o,shared:r}=e.payload,{lists:i}=t;void 0===i.byId[s]?l(t,{id:s,name:n,symbols:o,shared:r}):i.byId[s]={id:s,name:n,shared:r,symbols:[...o]}},rename:(t,e)=>{const{id:s,name:n}=e.payload,{lists:o}=t,r=o.byId[s];void 0!==r&&r.name!==n&&(r.name=n)},share:(t,e)=>{const{id:s,shared:n}=e.payload,{lists:o}=t,r=o.byId[s];void 0!==r&&r.shared!==n&&(r.shared=n)}}}),{setup:a,insert:u,replace:d,exact:m,exclude:y,remove:S,create:b,put:h,rename:f,share:p}=c.actions,{reducer:T}=c;function I(t){return t.lists.byId}function g(t,e){var s;return null!==(s=I(t)[e])&&void 0!==s?s:null}function L(t){return t.lists.ids}},87224:(t,e,s)=>{s.d(e,{SEPARATOR_PREFIX:()=>n});const n="###"},19814:(t,e,s)=>{function n(t){let e=null;return(s,...n)=>(null==e||e.abort(),e=new AbortController,null==s||s.addEventListener("error",()=>null==e?void 0:e.abort(),{once:!0}),t(e.signal,...n))}function o(t){if(!c(t))throw t}function r(t){
if(c(t))throw t}function i(t){return(null==t?void 0:t.aborted)?Promise.reject(l()):new Promise((e,s)=>{null==t||t.addEventListener("abort",()=>s(l()),{once:!0})})}function l(){return new DOMException("Aborted","AbortError")}function c(t){return t instanceof Error&&"AbortError"===t.name}function a(t,e){return Promise.race([i(t),e])}async function u(t,e){let s;try{await a(t,new Promise(t=>{s=setTimeout(t,e)}))}finally{clearTimeout(s)}}s.d(e,{respectLatest:()=>n,skipAbortError:()=>o,rethrowAbortError:()=>r,isAbortError:()=>c,respectAbort:()=>a,delay:()=>u})},30926:(t,e,s)=>{s.r(e),s.d(e,{selectNextAvailableSymbol:()=>o,showContextMenu:()=>r,initWidget:()=>i,updateWidget:()=>l,updateWidgetOptions:()=>c,selectAllSymbols:()=>a,addOrUpdateSymbolList:()=>u,removeSymbolList:()=>d,setSymbolLists:()=>m,selectHotlist:()=>y,updatePosition:()=>S,updateBulkPositions:()=>b,updateActiveList:()=>h});var n=s(49043);const o=(t,e,s,o)=>({type:n.SELECT_NEXT_AVAILABLE_SYMBOL,widgetId:t,currentSymbol:e,keyboardAction:s,cancelSetOnChart:o}),r=(t,e,s,o)=>({type:n.SHOW_CONTEXT_MENU,symbol:e,position:f(s),widgetId:t,size:o}),i=(t,e,s,o)=>({type:n.INIT_WIDGET,options:o,id:t,columns:s,tickerType:e}),l=(t,e)=>({type:n.UPDATE_WIDGET,widgetId:t,widget:e}),c=(t,e)=>({type:n.UPDATE_WIDGET_OPTIONS,widgetId:t,options:e}),a=t=>({type:n.SELECT_ALL_SYMBOLS,widgetId:t}),u=t=>({type:n.ADD_OR_UPDATE_SYMBOL_LIST,symbolList:t}),d=t=>({type:n.REMOVE_SYMBOL_LIST,id:t}),m=t=>({type:n.SET_SYMBOL_LISTS,symbolLists:t}),y=(t,e,s)=>({type:n.SELECT_HOTLIST,widgetId:t,exchange:e,group:s}),S=(t,e)=>({type:n.UPDATE_POSITIONS,symbol:t,position:e}),b=t=>({type:n.UPDATE_BULK_POSITIONS,map:t}),h=t=>({type:n.UPDATE_ACTIVE_LIST,id:t});function f(t){var e;const s=null===(e=t.touches)||void 0===e?void 0:e.map(t=>({clientX:t.clientX,clientY:t.clientY}));return{clientX:t.clientX,clientY:t.clientY,touches:s,attachToXBy:t.attachToXBy,attachToYBy:t.attachToYBy,boxHeight:t.boxHeight}}},49043:(t,e,s)=>{s.d(e,{SELECT_NEXT_AVAILABLE_SYMBOL:()=>o,UPDATE_POSITIONS:()=>r,UPDATE_BULK_POSITIONS:()=>i,INIT_WIDGET:()=>l,SHOW_CONTEXT_MENU:()=>c,UPDATE_WIDGET:()=>a,UPDATE_WIDGET_OPTIONS:()=>u,SELECT_ALL_SYMBOLS:()=>d,ADD_OR_UPDATE_SYMBOL_LIST:()=>m,SET_SYMBOL_LISTS:()=>y,REMOVE_SYMBOL_LIST:()=>S,SELECT_HOTLIST:()=>b,UPDATE_ACTIVE_LIST:()=>h});const n=(0,s(10358).createActionTypeFactory)("WATCHLISTS"),o=n("SELECT_NEXT_AVAILABLE_SYMBOL"),r=n("UPDATE_POSITIONS"),i=n("UPDATE_BULK_POSITIONS"),l=n("INIT_WIDGET"),c=n("SHOW_CONTEXT_MENU"),a=n("UPDATE_WIDGET"),u=n("UPDATE_WIDGET_OPTIONS"),d=n("SELECT_ALL_SYMBOLS"),m=n("ADD_OR_UPDATE_SYMBOL_LIST"),y=n("SET_SYMBOL_LISTS"),S=n("REMOVE_SYMBOL_LIST"),b=n("SELECT_HOTLIST"),h=n("UPDATE_ACTIVE_LIST")},90095:(t,e,s)=>{s.r(e),s.d(e,{addWatchlistSymbolsThunk:()=>v,createWatchlistThunk:()=>I,getActiveWatchlistThunk:()=>W,getCustomWatchlistsThunk:()=>g,putCustomWatchlistsThunk:()=>L,removeWatchlistSymbolsThunk:()=>A,removeWatchlistThunk:()=>O,renameWatchlistThunk:()=>E,replaceWatchlistSymbolsThunk:()=>_,setActiveWatchlistThunk:()=>C,symbolListRepositorySaga:()=>f,
validateWatchListSymbols:()=>p});var n=s(34857),o=s(33454),r=s(74245),i=s(63795),l=s(8763),c=s(30926),a=s(14071),u=s(83969),d=s(19814),m=s(33584),y=s(34318),S=s(83163);function*b(){for(yield(0,n.put)((0,S.asAction)(W(null)));;){yield(0,n.take)([o.remove,o.setup]);const t=yield(0,n.select)();null===(0,m.getCurrentViewableListByWidgetId)(t,y.WATCHLIST_WIDGET_ID)&&(yield(0,n.put)((0,S.asAction)(W(null))))}}const h=(0,a.getLogger)("Platform.Model.SymbolLists");function*f(){yield(0,n.fork)(b)}function p(t){return new Promise(e=>{quoteSessionAdapters.get(WATCHLIST_WIDGET_ID).getUniqueSymbolsFullNames(t).then(t=>{e(t)})})}function T(t,e,s){(0,u.showWarning)({title:e||(0,r.t)("Watchlist error"),text:t},s)}function I(t){const e=(0,i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(s,n)=>{try{const n=await e.createWatchList(t);return null===n?null:(s((0,o.create)({id:n.id,name:n.name,symbols:n.symbols})),n.id)}catch(t){return T(t.message),null}}}const g=(0,d.respectLatest)((function(t){const e=(0,i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(s,n)=>{try{const n=await(0,d.respectAbort)(t,e.getCustomWatchLists());s((0,o.setup)({lists:n.map(t=>({id:t.id,name:t.name,symbols:t.symbols,shared:t.shared})),timestamp:Date.now()}))}catch(t){(0,d.skipAbortError)(t)}}}));function L(t,e){const s=(0,i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(n,r)=>{try{const r=await(0,d.respectAbort)(t,s.putWatchList(e));n((0,o.put)({id:r.id,name:r.name,symbols:r.symbols,shared:r.shared}))}catch(t){(0,d.rethrowAbortError)(t),T(t.message)}}}function E(t,e,s){const n=(0,i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(r,i)=>{r((0,o.rename)({id:e.id,name:s})),await(0,d.respectAbort)(t,n.renameWatchList(e,s))}}function _(t,e,s,n){const r=(0,i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(n,i)=>{"custom"===e.type?(n((0,o.exact)({id:e.id,symbols:s})),await(0,d.respectAbort)(t,r.replaceSymbols(e,s))):h.logWarn("Trying to modify not a custom watchlist")}}function v(t,e,s,n){const r=(0,i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(i,l)=>{if("custom"===e.type){i((0,o.insert)({id:e.id,symbols:s}));try{await(0,d.respectAbort)(t,r.addSymbols(e,s))}catch(t){if((0,d.isAbortError)(t))throw t;const r=e.symbols.filter(t=>!s.includes(t));i((0,o.exact)({id:e.id,symbols:r})),T(t.message,void 0,n)}}else h.logWarn("Trying to modify not a custom watchlist")}}function A(t,e,s){const n=(0,i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(r,i)=>{r((0,o.exclude)({id:e.id,symbols:s})),await(0,d.respectAbort)(t,n.removeSymbols(e,s))}}function O(t,e){const s=(0,i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(n,r)=>{await(0,d.respectAbort)(t,s.removeWatchList(e)),n((0,o.remove)({id:e.id}))}}function C(t,e){const s=(0,i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(n,o)=>{n((0,c.updateActiveList)(e)),await(0,d.respectAbort)(t,s.setActive(e))}}const W=(0,d.respectLatest)((function(t){const e=(0,
i.service)(l.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE);return async(s,n)=>{try{const n=await(0,d.respectAbort)(t,e.getActive());"custom"!==n.type||s((0,o.put)({id:n.id,name:n.name,symbols:n.symbols,shared:n.shared})),s((0,c.updateActiveList)("custom"===n.type?n.id:n.color))}catch(t){(0,d.skipAbortError)(t)}}}))},83163:(t,e,s)=>{function n(t){return t}s.d(e,{asAction:()=>n})},33584:(t,e,s)=>{s.d(e,{columnsSelector:()=>h,getCurrentViewableListByWidgetId:()=>v,getCustomListById:()=>E,getCustomLists:()=>I,getCustomListsMap:()=>L,getGlobalActiveID:()=>u,getGlobalActiveSymbolList:()=>_,getIsReadyCustomLists:()=>g,highlightedSymbolsSelector:()=>b,isLoadingSelector:()=>A,makeGetIsContainedByMultiSelection:()=>C,positionSelector:()=>O,scrollToIdSelector:()=>y,selectedSymbolsSelector:()=>m,shouldDisplayPositionsSelector:()=>T,sortingSelector:()=>S,tickerTypeSelector:()=>f,widgetOptionsSelector:()=>p,widgetSelector:()=>d});var n=s(22222),o=s(16282),r=s(33454);function i(t){return{type:"custom",id:t.id,name:t.name,symbols:t.symbols,shared:t.shared}}function l(t){return t.customLists}const c=t=>t.widgets,a=(t,e)=>e,u=t=>t.activeSymbolList,d=(0,n.createSelector)([c,a],(t,e)=>t[e]||{}),m=(0,n.createSelector)(d,t=>t.selectedSymbols||[]),y=(0,n.createSelector)(d,t=>t.scrollToId),S=(0,n.createSelector)(d,t=>t.sorting||null),b=(0,n.createSelector)(d,t=>t.highlightedSymbols||null),h=(0,n.createSelector)(d,t=>t.columns),f=(0,n.createSelector)(d,t=>t.tickerType),p=(0,n.createSelector)(d,t=>t.options||{}),T=(0,n.createSelector)([p,t=>t.isAuthenticated],(t,e)=>t.shouldDisplayPositions&&!0),I=(0,n.createSelector)(l,t=>(0,r.getListIds)(t).map(e=>i((0,o.ensureNotNull)((0,r.getListById)(t,e))))),g=(0,n.createSelector)([l],t=>null!==t.timestamp),L=(0,n.createSelector)([l],r.getListsMap),E=(0,n.createSelector)([l,(t,e)=>e],(t,e)=>{const s=(0,r.getListById)(t,e);return null===s?null:i(s)}),_=(0,n.createSelector)([l,()=>null,u],(t,e,s)=>{if(null===s)return null;{const e=(0,r.getListById)(t,s);return null===e?null:i(e)}}),v=(0,n.createSelector)([()=>null,l,()=>null,c,a],(t,e,s,n,o)=>{const l=n[o];if(void 0===l)return null;const c=l.listId;if(null===c)return null;const a=(0,r.getListById)(e,c);return null!==a?i(a):null});const A=(0,n.createSelector)([d,v],(t,e)=>null===e||t.isLoading||!1),O=(0,n.createSelector)([t=>t.positions,(t,e)=>e],(t,e)=>t[e]);function C(){const t=(0,n.createSelector)([(t,e)=>e.widgetId,t=>t.widgets],(t,e)=>e[t]),e=(0,n.createSelector)(t,t=>t.selectedSymbols||[]),s=(0,n.createSelector)(e,t=>new Set(t));return(0,n.createSelector)([s,(t,e)=>e.symbol],(t,e)=>t.size>1&&t.has(e))}},59766:(t,e,s)=>{s.r(e),s.d(e,{reorderSymbolsThunk:()=>h,sortSymbolsThunk:()=>f,removeSelectedSymbolsThunk:()=>p,markSymbolsThunk:()=>I,removeSymbolsThunk:()=>g,addSymbolsThunk:()=>L,renameSymbolListThunk:()=>v,clearSymbolListThunk:()=>A,findInWatchlistThunk:()=>O,updateScrollToIdThunk:()=>C,addSymbolsToCustomListThunk:()=>W,moveSymbolsToCustomListThunk:()=>w,insertSymbolBeforeThunk:()=>B,selectSymbolListThunk:()=>D,userCreateWatchlistThunk:()=>k,
saveListAsThunk:()=>N});var n=s(16282),o=s(33454),r=s(74245),i=(s(42254),s(30926)),l=s(33584),c=s(80478),a=s(9288),u=s(69449),d=s(34318),m=s(90095),y=s(19814),S=s(29820),b=s(83969);function h(t,e){return(s,n)=>{const o=n(),{isMovable:r}=(0,l.widgetOptionsSelector)(o,t);if(!r)return;const i=(0,l.getCurrentViewableListByWidgetId)(o,t);if(null!==i&&"hot"!==i.type)if("custom"===i.type){const t={...i,symbols:e};s((0,m.replaceWatchlistSymbolsThunk)(null,t,e))}else 0}}function f(t,e,s){return(r,c)=>{const u=c(),d=(0,l.getCurrentViewableListByWidgetId)(u,t);if(null===d)return;if("hot"===d.type)return;const{symbolsBeforeSorting:y}=(0,l.widgetSelector)(u,t),S=(0,l.sortingSelector)(u,t),b=d.symbols;let h;if(null===e)h=(0,n.ensureNotNull)(y);else{const{column:n,direction:o}=e;h=(0,a.sortSymbols)(t,b,n,o,s)}"custom"===d.type&&(r((0,o.exact)({id:d.id,symbols:h})),r((0,m.replaceWatchlistSymbolsThunk)(null,d,h))),r((0,i.updateWidget)(t,{symbolsBeforeSorting:null===S?[...b]:y,sorting:e}))}}function p(t){return(e,s)=>{const n=s(),o=(0,l.getCurrentViewableListByWidgetId)(n,t);if(null===o)return;if("hot"===o.type)return;const{isDeletable:r}=(0,l.widgetOptionsSelector)(n,t);if(!r)return;const c=(0,l.selectedSymbolsSelector)(n,t);if(0===c.length)return;const u=c[c.length-1],d=o.symbols[o.symbols.length-1],m=o.symbols.some(t=>t===u),y=()=>{e(m&&u!==d?(0,i.selectNextAvailableSymbol)(t,u,"next",!0):(0,i.updateWidget)(t,{selectedSymbols:[]})),"custom"===o.type&&e(T(c,o)),(0,a.trackRemoveEvent)(c.length>1)};if(1===c.length)return void y();const S=document.activeElement;(0,b.showConfirm)({text:(0,a.createConfirmRemoveText)(c.length),onConfirm:({dialogClose:t})=>{y(),t()},onClose:()=>{null==S||S.focus()}})}}function T(t,e){return(s,n)=>{if("custom"!==e.type);else{const n={...e,symbols:e.symbols.filter(e=>!t.includes(e))};s((0,m.removeWatchlistSymbolsThunk)(null,n,t))}}}function I(t,e,s,n){return(t,e)=>{}}function g(t,e,s){return(n,o)=>{const r=o(),i=s?(0,l.getCustomListById)(r,s):(0,l.getCurrentViewableListByWidgetId)(r,t);if(null===i)return;if("hot"===i.type)return;const c=new Set((0,l.selectedSymbolsSelector)(r,t)),u=c.has(e)?Array.from(c):[e],d=()=>{"custom"===i.type&&n((0,m.removeWatchlistSymbolsThunk)(null,i,u)),(0,a.trackRemoveEvent)(u.length>1)};if(1===u.length||Boolean(s))return void d();const y=document.activeElement;(0,b.showConfirm)({text:(0,a.createConfirmRemoveText)(u.length),onConfirm:({dialogClose:t})=>{d(),t()},onClose:()=>{null==y||y.focus()}})}}function L(t,e,s){return(n,o)=>{const r=o(),i=(0,l.getCurrentViewableListByWidgetId)(r,t);if(null===i)return;if("hot"===i.type)return;u.quoteSessionAdapters.get(t).getSymbolsFullNames(e).then(e=>{var o;"custom"===i.type&&n(_(e,i,s));const r=null!==(o=e[e.length-1])&&void 0!==o?o:null;n(E(t,e,r))})}}function E(t,e,s){return(n,o)=>{e=e.slice(0,10),n((0,i.updateWidget)(t,{highlightedSymbols:[...e],scrollToId:s?{id:s}:null})),setTimeout(()=>n((0,i.updateWidget)(t,{highlightedSymbols:null})),500)}}function _(t,e,s,n){return(o,r)=>{const i=new Set(e.symbols),l=t.filter(t=>!i.has(t)&&!i.has((0,
S.safeShortName)(t)));if(l.length){const t=[...e.symbols],r=s?e.symbols.indexOf(s):-1;-1===r?t.push(...l):t.splice(r+1,0,...l);const i={...e,symbols:t};o(-1===r?(0,m.addWatchlistSymbolsThunk)(null,i,l,n):(0,m.replaceWatchlistSymbolsThunk)(null,i,t,n))}}}function v(t,e){return(s,o)=>{const r=o();{const o=(0,n.ensureNotNull)((0,l.getCustomListById)(r,t));s((0,m.renameWatchlistThunk)(null,o,e))}}}function A(t){return(e,s)=>{const o=s();{const s=(0,n.ensureNotNull)((0,l.getCustomListById)(o,t));if(0===s.symbols.length)return;e((0,m.replaceWatchlistSymbolsThunk)(null,{...s,symbols:[]},[]))}}}function O(t,e){return E(t,[e],e)}function C(t,e){return(s,n)=>{const o=n(),r=(0,l.getCurrentViewableListByWidgetId)(o,t);if(!r)return;const{symbols:c}=r;c.includes(e)&&s((0,i.updateWidget)(t,{scrollToId:{id:e}}))}}function W(t,e,s,n){return(o,r)=>{var i;const a=r(),u=(0,l.getCustomListById)(a,e);if(u){const r=s.filter(t=>!(0,c.isSeparatorItem)(t));if(o(_(r,u,void 0,n)),(0,l.getGlobalActiveID)(a)===e){const e=null!==(i=r[r.length-1])&&void 0!==i?i:null;o(E(t,r,e))}}}}function w(t,e,s){return async(n,o)=>{const r=o(),i=(0,l.getCustomListById)(r,e),a=s.filter(t=>!(0,c.isSeparatorItem)(t));i&&n(_(a,i));const u=(0,l.getCustomListById)(r,t);u&&n((0,m.removeWatchlistSymbolsThunk)(null,u,s))}}function B(t,e,s){return(n,o)=>{const r=o(),i=(0,l.getCurrentViewableListByWidgetId)(r,t);if(null===i)return;if("hot"===i.type)return;const{symbols:c}=i;if(!c.includes(s))if("custom"===i.type){const t=c.indexOf(e),o=[...c.slice(0,t),s,...c.slice(t)],r={...i,symbols:o};n((0,m.replaceWatchlistSymbolsThunk)(null,r,o))}else 0}}const D=(0,y.respectLatest)((function(t,e){return async(t,s)=>{try{const o=(0,n.ensureNotNull)((0,l.getCustomListById)(s(),e));t((0,i.updateWidget)(d.WATCHLIST_WIDGET_ID,{isLoading:!1,listId:o.id,sorting:null,symbolsBeforeSorting:null,selectedSymbols:[],scrollToId:null})),t((0,m.setActiveWatchlistThunk)(null,"custom"===o.type?o.id:o.color))}catch(t){(0,y.skipAbortError)(t)}}}));const k=(0,y.respectLatest)((function(t,e,s,o){return async(i,c)=>{try{if(!(0,a.canUseMultipleLists)())return;if(!e||void 0===e.name){const s=await(0,y.respectAbort)(t,(0,a.createSaveRenameDialog)((0,r.t)("Create New List"),void 0,o)());e={name:s,symbols:(null==e?void 0:e.symbols)||[]}}0;const u=(0,m.createWatchlistThunk)(e),d=await(0,y.respectAbort)(t,i(u));if(null===d)return;if(i(D(null,d)),s){const t=(0,l.getCustomListById)(c(),s);if(!t)return;await i(T((0,n.ensureDefined)(e.symbols),(0,n.ensureDefined)(t)))}}catch(t){(0,y.skipAbortError)(t)}}}));function N(t,e,s=!0,o){return async(t,i)=>{if(!(0,a.canUseMultipleLists)())return;const c=await(0,a.createSaveRenameDialog)((0,r.t)("Save List As"),o)();if(!e){const t=(0,n.ensureNotNull)((0,l.getCurrentViewableListByWidgetId)(i(),d.WATCHLIST_WIDGET_ID));e=t.symbols}const u=(0,m.createWatchlistThunk)({name:c,symbols:e}),y=await t(u);null!==y&&s&&t(D(null,y))}}},9288:(t,e,s)=>{s.d(e,{isValidSeparatorItem:()=>S,separatorValToDisplayVal:()=>b,canUseMultipleLists:()=>h,createSaveRenameDialog:()=>f,sortSymbols:()=>T,
createWatchList:()=>L,compareSymbols:()=>E,toPositionRecord:()=>_,isEqualRecords:()=>v,getSymbolFromList:()=>A,findNextAvailableSymbol:()=>O,trackRemoveEvent:()=>C,createConfirmRemoveText:()=>W});var n=s(16282),o=s(74245),r=s(7424),i=s(83969),l=s(99956),c=s(69449),a=s(26861),u=s(80478),d=s(87224),m=s(42254),y=s(29820);function S(t){return(0,u.isSeparatorItem)(t)}function b(t){return t.replace(d.SEPARATOR_PREFIX,"")}function h(){return r.enabled("multiple_watchlists")&&!0}function f(t,e,s){return()=>new Promise(n=>{(0,i.showRename)({title:t,initValue:e,text:(0,o.t)("Symbol list name")+":",maxLength:128,onRename:({newValue:t,dialogClose:e})=>{n(t),e()}},s)})}function p(t){return t.replace("−","-")}function T(t,e,s,o,r){const i=function(t){const e=[],s=[];t.forEach((t,e)=>{(0,u.isSeparatorItem)(t)&&s.push(e)});let n=0;s.forEach(s=>{e.push({values:t.slice(n,s),separator:t[s]}),n=s+1});const o=s[s.length-1],r=t.slice(o+1);return r.length>0&&e.push({values:r,separator:null}),e}(e);return i.forEach(e=>{e.values.sort((e,i)=>{const u=c.quoteSessionAdapters.get(t).getLastSymbolData(e),d=c.quoteSessionAdapters.get(t).getLastSymbolData(i),m=I(u),S=I(d),b=(t,e)=>{if(!t||"flag"===s)return;var n;return"error"===t.status?void 0:r===l.TickerType.Description&&"short_name"===s?(n=t.values,(0,a.getTranslatedSymbolDescription)(n)||(0,y.safeShortName)(e)):t.values[s]},h=b(u,e),f=b(d,i);return function(t,e){const s=-1===e?-1/0:1/0;return(o,r,i,l)=>{if("rchp"!==t){if(void 0===o&&void 0===r)return 0;if(void 0===o)return-e;if(void 0===r)return e}switch(t){case"short_name":return e*(o===r?0:(0,n.ensure)(o)<(0,n.ensure)(r)?-1:1);case"rchp":return i||(o=void 0),l||(r=void 0),g(o,r,e,s);case"last_price":case"change":case"change_percent":return g(o,r,e,s);case"volume":{const t=(0,n.ensure)(o)>=1e100?s:Number(o),i=(0,n.ensure)(r)>=1e100?s:Number(r);return e*(t-i)}default:return(0,n.ensure)(o)>(0,n.ensure)(r)?-1:1}}}(s,o)(h,f,m,S)})}),function(t){const e=[];return t.forEach(({values:t,separator:s})=>{e.push(...t),null!==s&&e.push(s)}),e}(i)}function I(t){if(!t)return!1;const e="pre_market"===t.values.current_session,s="post_market"===t.values.current_session;return e||s}function g(t,e,s,n){let o=parseFloat(p(String(t))),r=parseFloat(p(String(e)));return o=isNaN(o)?n:o,r=isNaN(r)?n:r,s*(o-r)}function L(t,e,s){return{type:"custom",id:t,name:e,symbols:s,shared:!1}}function E(t,e){return t===e||(0,y.safeShortName)(t)===e}function _(t){return{symbol:t.symbol,side:t.side,qty:t.qty,avgPrice:t.avgPrice}}function v(t,e){return t===e||void 0!==t&&void 0!==e&&(t.side===e.side&&t.qty===e.qty&&t.avgPrice===e.avgPrice&&t.symbol===e.symbol)}function A(t,e){if(e.includes(t))return t;{const s=(0,y.safeShortName)(t);if(e.includes(s))return s}}function O(t,e,s){const n="next"===s;for(let s=t;n?s<e.length:s>=0;n?s++:s--)if(!(0,u.isSeparatorItem)(e[s])&&s!==t)return e[s];for(let s=n?0:e.length-1;n?s<t:s>t;n?s++:s--)if(!(0,u.isSeparatorItem)(e[s]))return e[s]}function C(t){t?(0,m.trackEvent)("Watchlist","Multi select","Remove"):(0,m.trackEvent)("Watchlist","Remove")}
function W(t){return(0,o.t)("Do you really want to delete {count} selected symbol?",{plural:"Do you really want to delete {count} selected symbols?",context:"symbols_and_drawings_count",count:t,replace:{count:t.toString()}})}},29820:(t,e,s)=>{s.d(e,{safeShortName:()=>o});var n=s(95418);function o(t){try{return(0,n.shortName)(t)}catch(e){return t}}}}]);