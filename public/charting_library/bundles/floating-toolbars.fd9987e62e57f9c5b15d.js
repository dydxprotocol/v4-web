(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[2306],{266783:t=>{"use strict";var e=Object.prototype.hasOwnProperty;function o(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}t.exports=function(t,i){if(o(t,i))return!0;if("object"!=typeof t||null===t||"object"!=typeof i||null===i)return!1;var n=Object.keys(t),s=Object.keys(i);if(n.length!==s.length)return!1;for(var r=0;r<n.length;r++)if(!e.call(i,n[r])||!o(t[n[r]],i[n[r]]))return!1;return!0}},653351:t=>{t.exports={}},256337:t=>{t.exports={}},428146:t=>{t.exports={button:"button-OvB35Th_",content:"content-OvB35Th_","icon-only":"icon-only-OvB35Th_",link:"link-OvB35Th_","color-brand":"color-brand-OvB35Th_","variant-primary":"variant-primary-OvB35Th_","variant-secondary":"variant-secondary-OvB35Th_","color-gray":"color-gray-OvB35Th_","color-green":"color-green-OvB35Th_","color-red":"color-red-OvB35Th_","size-xsmall":"size-xsmall-OvB35Th_","with-start-icon":"with-start-icon-OvB35Th_","with-end-icon":"with-end-icon-OvB35Th_","start-icon-wrap":"start-icon-wrap-OvB35Th_","end-icon-wrap":"end-icon-wrap-OvB35Th_","size-small":"size-small-OvB35Th_","size-medium":"size-medium-OvB35Th_","size-large":"size-large-OvB35Th_","size-xlarge":"size-xlarge-OvB35Th_",animated:"animated-OvB35Th_",stretch:"stretch-OvB35Th_",grouped:"grouped-OvB35Th_","adjust-position":"adjust-position-OvB35Th_","first-row":"first-row-OvB35Th_","first-col":"first-col-OvB35Th_","no-corner-top-left":"no-corner-top-left-OvB35Th_","no-corner-top-right":"no-corner-top-right-OvB35Th_","no-corner-bottom-right":"no-corner-bottom-right-OvB35Th_","no-corner-bottom-left":"no-corner-bottom-left-OvB35Th_"}},341869:t=>{t.exports={}},604920:t=>{t.exports={}},323021:t=>{t.exports={wrap:"wrap-ean7hSDH",icon:"icon-ean7hSDH",colorBg:"colorBg-ean7hSDH",color:"color-ean7hSDH",multicolor:"multicolor-ean7hSDH",white:"white-ean7hSDH"}},720695:t=>{t.exports={button:"button-_N8p4OlI"}},686405:t=>{t.exports={item:"item-Rhs937dU",withIcon:"withIcon-Rhs937dU",icon:"icon-Rhs937dU",labelRow:"labelRow-Rhs937dU",multiWidth:"multiWidth-Rhs937dU",buttonWrap:"buttonWrap-Rhs937dU",buttonLabel:"buttonLabel-Rhs937dU"}},380072:t=>{t.exports={container:"container-gKn55QI9",sectionTitle:"sectionTitle-gKn55QI9",separator:"separator-gKn55QI9",customButton:"customButton-gKn55QI9"}},266454:t=>{t.exports={container:"container-jgT5uU0F",form:"form-jgT5uU0F",swatch:"swatch-jgT5uU0F",inputWrap:"inputWrap-jgT5uU0F",inputHash:"inputHash-jgT5uU0F",input:"input-jgT5uU0F",buttonWrap:"buttonWrap-jgT5uU0F",hueSaturationWrap:"hueSaturationWrap-jgT5uU0F",saturation:"saturation-jgT5uU0F",hue:"hue-jgT5uU0F"}},592155:t=>{t.exports={hue:"hue-iMmREGnj",pointer:"pointer-iMmREGnj",pointerContainer:"pointerContainer-iMmREGnj"}},401034:t=>{t.exports={opacity:"opacity-uujjxY8O",opacitySlider:"opacitySlider-uujjxY8O",opacitySliderGradient:"opacitySliderGradient-uujjxY8O",pointer:"pointer-uujjxY8O",dragged:"dragged-uujjxY8O",opacityPointerWrap:"opacityPointerWrap-uujjxY8O",opacityInputWrap:"opacityInputWrap-uujjxY8O",
opacityInput:"opacityInput-uujjxY8O",opacityInputPercent:"opacityInputPercent-uujjxY8O"}},153766:t=>{t.exports={saturation:"saturation-S_CtZIbU",pointer:"pointer-S_CtZIbU"}},361561:t=>{t.exports={swatches:"swatches-pNRFZrPx",swatch:"swatch-pNRFZrPx",hover:"hover-pNRFZrPx",empty:"empty-pNRFZrPx",white:"white-pNRFZrPx",selected:"selected-pNRFZrPx",contextItem:"contextItem-pNRFZrPx"}},190948:t=>{t.exports={icon:"icon-XIHzWm6B",dropped:"dropped-XIHzWm6B"}},805184:(t,e,o)=>{"use strict";o.d(e,{Button:()=>c});var i=o(50959),n=o(171529);function s(t="default"){switch(t){case"default":return"primary";case"stroke":return"secondary"}}function r(t="primary"){switch(t){case"primary":return"brand";case"success":return"green";case"default":return"gray";case"danger":return"red"}}function a(t="m"){switch(t){case"s":return"xsmall";case"m":return"small";case"l":return"large"}}function l(t){const{intent:e,size:o,appearance:i,useFullWidth:n,icon:l,...c}=t;return{...c,color:r(e),size:a(o),variant:s(i),stretch:n,startIcon:l}}function c(t){return i.createElement(n.SquareButton,{...l(t)})}},171529:(t,e,o)=>{"use strict";o.d(e,{SquareButton:()=>m});var i=o(50959),n=o(497754),s=o(331774),r=o(72571),a=o(428146),l=o.n(a);function c(t){const{color:e="brand",size:o="medium",variant:i="primary",stretch:r=!1,icon:a,startIcon:c,endIcon:d,iconOnly:h=!1,className:p,isGrouped:u,cellState:m,disablePositionAdjustment:_=!1,isAnchor:g=!1}=t,v=function(t){let e="";return 0!==t&&(1&t&&(e=n(e,l()["no-corner-top-left"])),2&t&&(e=n(e,l()["no-corner-top-right"])),4&t&&(e=n(e,l()["no-corner-bottom-right"])),8&t&&(e=n(e,l()["no-corner-bottom-left"]))),e}((0,s.getGroupCellRemoveRoundBorders)(m));return n(p,l().button,l()[`size-${o}`],l()[`color-${e}`],l()[`variant-${i}`],r&&l().stretch,(a||c)&&l()["with-start-icon"],d&&l()["with-end-icon"],h&&l()["icon-only"],v,u&&l().grouped,u&&!_&&l()["adjust-position"],u&&m.isTop&&l()["first-row"],u&&m.isLeft&&l()["first-col"],g&&l().link)}function d(t){const{startIcon:e,icon:o,iconOnly:n,children:s,endIcon:a}=t,c=null!=e?e:o;return i.createElement(i.Fragment,null,c&&i.createElement(r.Icon,{icon:c,className:l()["start-icon-wrap"]}),s&&i.createElement("span",{className:l().content},s),a&&!n&&i.createElement(r.Icon,{icon:a,className:l()["end-icon-wrap"]}))}var h=o(380327),p=o(800417);function u(t){const{className:e,color:o,variant:i,size:n,stretch:s,animated:r,icon:a,iconOnly:l,startIcon:c,endIcon:d,...h}=t;return{...h,...(0,p.filterDataProps)(t),...(0,p.filterAriaProps)(t)}}function m(t){const{reference:e,...o}=t,{isGrouped:n,cellState:s,disablePositionAdjustment:r}=(0,i.useContext)(h.ControlGroupContext),a=c({...o,isGrouped:n,cellState:s,disablePositionAdjustment:r});return i.createElement("button",{...u(o),className:a,ref:e},i.createElement(d,{...o}))}},380327:(t,e,o)=>{"use strict";o.d(e,{ControlGroupContext:()=>i});const i=o(50959).createContext({isGrouped:!1,cellState:{isTop:!0,isRight:!0,isBottom:!0,isLeft:!0}})},331774:(t,e,o)=>{"use strict";function i(t){let e=0;return t.isTop&&t.isLeft||(e+=1),t.isTop&&t.isRight||(e+=2),
t.isBottom&&t.isLeft||(e+=8),t.isBottom&&t.isRight||(e+=4),e}o.d(e,{getGroupCellRemoveRoundBorders:()=>i})},496818:(t,e,o)=>{"use strict";o.d(e,{Draggable:()=>a,PointerBackend:()=>l});var i=o(650151),n=o(202369),s=o(601227),r=o(972535);class a{constructor(t){var e,o;this._helper=null,this._handleDragStart=t=>{var e;if(null!==this._helper)return;const o=this._source;o.classList.add("ui-draggable-dragging");const[i,s]=[(0,n.outerWidth)(o),(0,n.outerHeight)(o)];this._helper={startTop:parseFloat(o.style.top)||0,startLeft:parseFloat(o.style.left)||0,nextTop:null,nextLeft:null,raf:null,size:[i,s],containment:this._containment instanceof HTMLElement?[parseInt(getComputedStyle(this._containment).borderLeftWidth)+parseInt(getComputedStyle(this._containment).paddingLeft),parseInt(getComputedStyle(this._containment).borderTopWidth)+parseInt(getComputedStyle(this._containment).paddingTop),this._containment.offsetWidth-parseInt(getComputedStyle(this._containment).borderRightWidth)-parseInt(getComputedStyle(this._containment).paddingRight)-parseInt(getComputedStyle(o).marginLeft)-parseInt(getComputedStyle(o).marginRight)-i,this._containment.offsetHeight-parseInt(getComputedStyle(this._containment).borderBottomWidth)-parseInt(getComputedStyle(this._containment).paddingBottom)-parseInt(getComputedStyle(o).marginTop)-parseInt(getComputedStyle(o).marginBottom)-s]:"window"===this._containment?[window.scrollX,window.scrollY,window.scrollX+document.documentElement.offsetWidth-i,window.scrollY+document.documentElement.offsetHeight-s]:null},null===(e=this._start)||void 0===e||e.call(this)},this._handleDragMove=t=>{var e;if(null===this._helper)return;const{current:o,initial:i}=t.detail,n=this._source,s=this._helper.nextTop,r=this._helper.nextLeft,a="y"===this._axis||!1===this._axis||0!==o.movementY;if(a){const t=this._helper.startTop;isFinite(t)&&(this._helper.nextTop=o.clientY-i.clientY+t)}const l="x"===this._axis||!1===this._axis||0!==o.movementY;if(l){const t=this._helper.startLeft;isFinite(t)&&(this._helper.nextLeft=o.clientX-i.clientX+t)}if(null!==this._helper.containment){const[t,e,o,i]=this._helper.containment;a&&this._helper.nextTop&&(this._helper.nextTop=Math.min(this._helper.nextTop,i),this._helper.nextTop=Math.max(this._helper.nextTop,e)),l&&this._helper.nextLeft&&(this._helper.nextLeft=Math.min(this._helper.nextLeft,o),this._helper.nextLeft=Math.max(this._helper.nextLeft,t))}null!==this._helper.raf||s===this._helper.nextTop&&r===this._helper.nextLeft||(this._helper.raf=requestAnimationFrame((()=>{null!==this._helper&&(null!==this._helper.nextTop&&(n.style.top=this._helper.nextTop+"px",this._helper.nextTop=null),null!==this._helper.nextLeft&&(n.style.left=this._helper.nextLeft+"px",this._helper.nextLeft=null),this._helper.raf=null)}))),null===(e=this._drag)||void 0===e||e.call(this)},this._handleDragStop=t=>{var e;if(null===this._helper)return;this._source.classList.remove("ui-draggable-dragging"),this._helper=null,null===(e=this._stop)||void 0===e||e.call(this)};const i=this._source=t.source;i.classList.add("ui-draggable")
;const s=this._handle=null!==(e=t.handle?i.querySelector(t.handle):null)&&void 0!==e?e:i;s.classList.add("ui-draggable-handle"),this._start=t.start,this._stop=t.stop,this._drag=t.drag,this._backend=new l({handle:s,onDragStart:this._handleDragStart,onDragMove:this._handleDragMove,onDragStop:this._handleDragStop}),this._axis=null!==(o=t.axis)&&void 0!==o&&o,this._containment=t.containment}destroy(){const t=this._source;t.classList.remove("ui-draggable"),t.classList.remove("ui-draggable-dragging");this._handle.classList.remove("ui-draggable-handle"),this._backend.destroy(),null!==this._helper&&(this._helper.raf&&cancelAnimationFrame(this._helper.raf),this._helper=null)}}class l{constructor(t){this._initial=null,this._handlePointerDown=t=>{if(null!==this._initial)return;if(!(t.target instanceof Element&&this._handle.contains(t.target)))return;if(this._initial=t,!this._dispatchEvent(this._createEvent("pointer-drag-start",t)))return void(this._initial=null);t.preventDefault();const e=this._getEventTarget();e.addEventListener("pointermove",this._handlePointerMove),e.addEventListener("pointerup",this._handlePointerUp),e.addEventListener("pointercancel",this._handlePointerUp),e.addEventListener("lostpointercapture",this._handlePointerUp),e.setPointerCapture(t.pointerId)},this._handlePointerMove=t=>{null!==this._initial&&this._initial.pointerId===t.pointerId&&(t.preventDefault(),this._dispatchEvent(this._createEvent("pointer-drag-move",t)))},this._handlePointerUp=t=>{if(null===this._initial||this._initial.pointerId!==t.pointerId)return;t.preventDefault();const e=this._getEventTarget();e.removeEventListener("pointermove",this._handlePointerMove),e.removeEventListener("pointerup",this._handlePointerUp),e.removeEventListener("pointercancel",this._handlePointerUp),e.removeEventListener("lostpointercapture",this._handlePointerUp),e.releasePointerCapture(this._initial.pointerId),this._dispatchEvent(this._createEvent("pointer-drag-stop",t)),this._initial=null};const e=this._handle=t.handle;this._onDragStart=t.onDragStart,this._onDragMove=t.onDragMove,this._onDragStop=t.onDragStop,e.style.touchAction="none";this._getEventTarget().addEventListener("pointerdown",this._handlePointerDown)}destroy(){this._handle.style.touchAction="";const t=this._getEventTarget();t.removeEventListener("pointerdown",this._handlePointerDown),t.removeEventListener("pointermove",this._handlePointerMove),t.removeEventListener("pointerup",this._handlePointerUp),t.removeEventListener("pointercancel",this._handlePointerUp),t.removeEventListener("lostpointercapture",this._handlePointerUp),null!==this._initial&&(t.releasePointerCapture(this._initial.pointerId),this._initial=null)}_getEventTarget(){return s.CheckMobile.iOS()||(0,s.isMac)()&&r.touch?window.document.documentElement:this._handle}_dispatchEvent(t){switch(t.type){case"pointer-drag-start":this._onDragStart(t);break;case"pointer-drag-move":this._onDragMove(t);break;case"pointer-drag-stop":this._onDragStop(t)}return!t.defaultPrevented}_createEvent(t,e){return(0,i.assert)(null!==this._initial),
new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:{backend:this,initial:this._initial,current:e}})}}},202369:(t,e,o)=>{"use strict";o.d(e,{contentHeight:()=>n,html:()=>a,outerHeight:()=>s,outerWidth:()=>r,position:()=>c});var i=o(650151);function n(t){const{paddingTop:e,paddingBottom:o}=window.getComputedStyle(t);return[e,o].reduce(((t,e)=>t-Number((e||"").replace("px",""))),t.clientHeight)}function s(t,e=!1){const o=getComputedStyle(t),i=[o.height];return"border-box"!==o.boxSizing&&i.push(o.paddingTop,o.paddingBottom,o.borderTopWidth,o.borderBottomWidth),e&&i.push(o.marginTop,o.marginBottom),i.reduce(((t,e)=>t+(parseFloat(e)||0)),0)}function r(t,e=!1){const o=getComputedStyle(t),i=[o.width];return"border-box"!==o.boxSizing&&i.push(o.paddingLeft,o.paddingRight,o.borderLeftWidth,o.borderRightWidth),e&&i.push(o.marginLeft,o.marginRight),i.reduce(((t,e)=>t+(parseFloat(e)||0)),0)}function a(t,e){return void 0===e||(null===e&&(t.innerHTML=""),"string"!=typeof e&&"number"!=typeof e||(t.innerHTML=String(e))),t}function l(t){if(!t.getClientRects().length)return{top:0,left:0};const e=t.getBoundingClientRect(),o=(0,i.ensureNotNull)(t.ownerDocument.defaultView);return{top:e.top+o.pageYOffset,left:e.left+o.pageXOffset}}function c(t){const e=getComputedStyle(t);let o,i={top:0,left:0};if("fixed"===e.position)o=t.getBoundingClientRect();else{o=l(t);const e=t.ownerDocument;let n=t.offsetParent||e.documentElement;for(;n&&(n===e.body||n===e.documentElement)&&"static"===getComputedStyle(n).position;)n=n.parentElement;n&&n!==t&&1===n.nodeType&&(i=l(n),i.top+=parseFloat(getComputedStyle(n).borderTopWidth),i.left+=parseFloat(getComputedStyle(n).borderLeftWidth))}return{top:o.top-i.top-parseFloat(e.marginTop),left:o.left-i.left-parseFloat(e.marginLeft)}}},523847:(t,e,o)=>{"use strict";o.d(e,{ColorPickerButton:()=>g});var i=o(50959),n=o(497754),s=o.n(n),r=o(650151),a=o(72571),l=o(724377),c=o(602564),d=o(206397),h=o(557630),p=o(860184),u=o(155185),m=o(834297),_=o(323021);function g(t){const{property:e,icon:o,propertyApplier:n,title:g,undoText:v,className:w}=t,f=(0,m.useProperty)(e),y=(0,i.useRef)(null),b=f?(0,l.parseRgba)(f)[3]:void 0,T=""===f,C=String(P()).toLowerCase()===p.white,[E,S,x]=(0,d.useCustomColors)();return i.createElement(u.ToolWidgetMenu,{className:w,content:i.createElement("div",{className:_.wrap},i.createElement(a.Icon,{className:_.icon,icon:o}),i.createElement("div",{className:_.colorBg},i.createElement("div",{className:s()(_.color,T&&_.multicolor,C&&_.white),style:T?void 0:{backgroundColor:f}}))),arrow:!1,title:g,ref:y,"data-name":t["data-name"],menuDataName:`${t["data-name"]}-menu`},i.createElement(h.ColorPicker,{color:P(),opacity:b,onColorChange:function(t,e){const o=f?(0,c.alphaToTransparency)((0,l.parseRgba)(f)[3]):0;W((0,c.generateColor)(String(t),o,true)),e||(0,r.ensureNotNull)(y.current).close()},onOpacityChange:function(t){W((0,c.generateColor)(f,(0,c.alphaToTransparency)(t),!0))},selectOpacity:void 0!==b,selectCustom:!0,customColors:E,onAddColor:function(t){S(t),(0,r.ensureNotNull)(y.current).close()},
onRemoveCustomColor:x}));function P(){return f?(0,l.rgbToHexString)((0,l.parseRgb)(f)):null}function W(t){n.setProperty(e,t,v)}}},822598:(t,e,o)=>{"use strict";o.d(e,{LineWidthButton:()=>f});var i=o(50959),n=o(497754),s=o(650151),r=o(72571),a=o(155185),l=o(834297),c=o(192063),d=o(493173),h=o(222978),p=o(114631),u=o(206096),m=o(206483),_=o(266611),g=o(686405);const v=(0,d.mergeThemes)(c.DEFAULT_POPUP_MENU_ITEM_THEME,g),w=[{value:1,icon:h},{value:2,icon:p},{value:3,icon:u},{value:4,icon:m}];function f(t){const{multipleProperty:e,title:o,undoText:d,propertyApplier:h,className:p,isSmallScreen:u}=t,m=(0,l.useProperty)((0,s.ensureDefined)(e)),f="mixed"===m||!m,y=function(t){const e=w.find((e=>e.value===t));if(!e)return _;return e.icon}(m);return i.createElement(a.ToolWidgetMenu,{className:p,arrow:!1,title:o,"data-name":t["data-name"],menuDataName:`${t["data-name"]}-menu`,content:i.createElement("div",null,f?i.createElement("div",{className:g.multiWidth},i.createElement(r.Icon,{icon:_})):i.createElement("div",{className:g.buttonWrap},!u&&i.createElement(r.Icon,{icon:y}),i.createElement("div",{className:n(!u&&g.buttonLabel)},`${m}px`)))},w.map((({value:t,icon:e})=>i.createElement(c.PopupMenuItem,{key:t,theme:v,label:`${t}px`,icon:e,isActive:t===m,onClick:b,onClickArg:t}))));function b(t){t&&e&&(h.beginUndoMacro(d),e.setValue(t,void 0,{applyValue:(t,e)=>{h.setProperty(t,e,d)}}),h.endUndoMacro())}}},834297:(t,e,o)=>{"use strict";o.d(e,{useProperty:()=>n});var i=o(50959);const n=t=>{const[e,o]=(0,i.useState)(t.value());return(0,i.useEffect)((()=>{const e=t=>{o(t.value())};e(t);const i={};return t.subscribe(i,e),()=>t.unsubscribe(i,e)}),[t]),e}},190266:(t,e,o)=>{"use strict";o.d(e,{runOrSignIn:()=>i});function i(t,e){t()}},557630:(t,e,o)=>{"use strict";o.d(e,{ColorPicker:()=>M});var i=o(50959),n=o(497754),s=o.n(n),r=o(509806),a=o(724377),l=o(650151),c=o(601227),d=o(544377),h=o(192063);const p=i.createContext(void 0);var u=o(860184),m=o(535149),_=o(361561);function g(t){const{index:e,color:s,selected:a,onSelect:g}=t,[v,w]=(0,i.useState)(!1),f=(0,i.useContext)(p),y=(0,i.useRef)(null),b=Boolean(f)&&!c.CheckMobile.any();return i.createElement(i.Fragment,null,i.createElement("div",{ref:y,style:s?{color:s}:void 0,className:n(_.swatch,v&&_.hover,a&&_.selected,!s&&_.empty,String(s).toLowerCase()===u.white&&_.white),onClick:function(){g(s)},onContextMenu:b?T:void 0}),b&&i.createElement(d.PopupMenu,{isOpened:v,onClose:T,position:function(){const t=(0,l.ensureNotNull)(y.current).getBoundingClientRect();return{x:t.left,y:t.top+t.height+4}},onClickOutside:T},i.createElement(h.PopupMenuItem,{className:_.contextItem,label:r.t(null,void 0,o(854336)),icon:m,onClick:function(){T(),(0,l.ensureDefined)(f)(e)},dontClosePopup:!0})));function T(){w(!v)}}class v extends i.PureComponent{constructor(){super(...arguments),this._onSelect=t=>{const{onSelect:e}=this.props;e&&e(t)}}render(){const{colors:t,color:e,children:o}=this.props;if(!t)return null;const n=e?(0,a.parseRgb)(String(e)):void 0;return i.createElement("div",{className:_.swatches
},t.map(((t,e)=>i.createElement(g,{key:String(t)+e,index:e,color:t,selected:n&&(0,a.areEqualRgb)(n,(0,a.parseRgb)(String(t))),onSelect:this._onSelect}))),o)}}var w=o(939075),f=o(805184);function y(t){const e=`Invalid RGB color: ${t}`;if(null===t)throw new Error(e);const o=t.match(/^#?([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i);if(null===o)throw new Error(e);const[,i,n,s]=o;if(!i||!n||!s)throw new Error(e);const r=parseInt(i,16)/255,a=parseInt(n,16)/255,l=parseInt(s,16)/255,c=Math.max(r,a,l),d=Math.min(r,a,l);let h;const p=c,u=c-d,m=0===c?0:u/c;if(c===d)h=0;else{switch(c){case r:h=(a-l)/u+(a<l?6:0);break;case a:h=(l-r)/u+2;break;case l:h=(r-a)/u+4;break;default:h=0}h/=6}return{h,s:m,v:p}}var b=o(343370),T=o(153766);class C extends i.PureComponent{constructor(){super(...arguments),this._container=null,this._refContainer=t=>{this._container=t},this._handlePosition=t=>{const{hsv:{h:e},onChange:o}=this.props;if(!o)return;const i=(0,l.ensureNotNull)(this._container).getBoundingClientRect(),n=t.clientX-i.left,s=t.clientY-i.top;let r=n/i.width;r<0?r=0:r>1&&(r=1);let a=1-s/i.height;a<0?a=0:a>1&&(a=1),o({h:e,s:r,v:a})},this._mouseDown=t=>{window.addEventListener("mouseup",this._mouseUp),window.addEventListener("mousemove",this._mouseMove)},this._mouseUp=t=>{window.removeEventListener("mousemove",this._mouseMove),window.removeEventListener("mouseup",this._mouseUp),this._handlePosition(t)},this._mouseMove=(0,b.default)(this._handlePosition,100),this._handleTouch=t=>{this._handlePosition(t.nativeEvent.touches[0])}}render(){const{className:t,hsv:{h:e,s:o,v:n}}=this.props,r=`hsl(${360*e}, 100%, 50%)`;return i.createElement("div",{className:s()(T.saturation,t),style:{backgroundColor:r},ref:this._refContainer,onMouseDown:this._mouseDown,onTouchStart:this._handleTouch,onTouchMove:this._handleTouch},i.createElement("div",{className:T.pointer,style:{left:100*o+"%",top:100*(1-n)+"%"}}))}}var E=o(592155);class S extends i.PureComponent{constructor(){super(...arguments),this._container=null,this._refContainer=t=>{this._container=t},this._handlePosition=t=>{const{hsv:{s:e,v:o},onChange:i}=this.props;if(!i)return;const n=(0,l.ensureNotNull)(this._container).getBoundingClientRect();let s=(t.clientY-n.top)/n.height;s<0?s=0:s>1&&(s=1),i({h:s,s:e,v:o})},this._mouseDown=t=>{window.addEventListener("mouseup",this._mouseUp),window.addEventListener("mousemove",this._mouseMove)},this._mouseUp=t=>{window.removeEventListener("mousemove",this._mouseMove),window.removeEventListener("mouseup",this._mouseUp),this._handlePosition(t)},this._mouseMove=(0,b.default)(this._handlePosition,100),this._handleTouch=t=>{this._handlePosition(t.nativeEvent.touches[0])}}render(){const{className:t,hsv:{h:e}}=this.props;return i.createElement("div",{className:s()(E.hue,t)},i.createElement("div",{className:E.pointerContainer,ref:this._refContainer,onMouseDown:this._mouseDown,onTouchStart:this._handleTouch,onTouchMove:this._handleTouch},i.createElement("div",{className:E.pointer,style:{top:100*e+"%"}})))}}var x=o(266454);const P="#000000",W=r.t(null,{context:"Color Picker"
},o(340276));class L extends i.PureComponent{constructor(t){super(t),this._handleHSV=t=>{const e=function(t){const{h:e,s:o,v:i}=t;let n,s,r;const a=Math.floor(6*e),l=6*e-a,c=i*(1-o),d=i*(1-l*o),h=i*(1-(1-l)*o);switch(a%6){case 0:n=i,s=h,r=c;break;case 1:n=d,s=i,r=c;break;case 2:n=c,s=i,r=h;break;case 3:n=c,s=d,r=i;break;case 4:n=h,s=c,r=i;break;case 5:n=i,s=c,r=d;break;default:n=0,s=0,r=0}return"#"+[255*n,255*s,255*r].map((t=>("0"+Math.round(t).toString(16)).replace(/.+?([a-f0-9]{2})$/i,"$1"))).join("")}(t)||P;this.setState({color:e,inputColor:e.replace(/^#/,""),hsv:t}),this.props.onSelect(e)},this._handleInput=t=>{const e=t.currentTarget.value;try{const t=y(e),o=`#${e}`;this.setState({color:o,inputColor:e,hsv:t}),this.props.onSelect(o)}catch(t){this.setState({inputColor:e})}},this._handleAddColor=()=>this.props.onAdd(this.state.color);const e=t.color||P;this.state={color:e,inputColor:e.replace(/^#/,""),hsv:y(e)}}render(){const{color:t,hsv:e,inputColor:o}=this.state;return i.createElement("div",{className:x.container},i.createElement("div",{className:x.form},i.createElement("div",{className:x.swatch,style:{backgroundColor:t}}),i.createElement("div",{className:x.inputWrap},i.createElement("span",{className:x.inputHash},"#"),i.createElement("input",{type:"text",className:x.input,value:o,onChange:this._handleInput})),i.createElement("div",{className:x.buttonWrap},i.createElement(f.Button,{size:"s",onClick:this._handleAddColor},W))),i.createElement("div",{className:x.hueSaturationWrap},i.createElement(C,{className:x.saturation,hsv:e,onChange:this._handleHSV}),i.createElement(S,{className:x.hue,hsv:e,onChange:this._handleHSV})))}}var B=o(380072);const N=r.t(null,{context:"Color Picker"},o(453585)),k=r.t(null,{context:"Color Picker"},o(681865));class M extends i.PureComponent{constructor(t){super(t),this._handleAddColor=t=>{this.setState({isCustom:!1}),this._onToggleCustom(!1);const{onAddColor:e}=this.props;e&&e(t)},this._handleSelectColor=t=>{const{onColorChange:e}=this.props,{isCustom:o}=this.state;e&&e(t,o)},this._handleCustomClick=()=>{this.setState({isCustom:!0}),this._onToggleCustom(!0)},this._handleOpacity=t=>{const{onOpacityChange:e}=this.props;e&&e(t)},this.state={isCustom:!1}}componentDidUpdate(t,e){t.selectOpacity!==this.props.selectOpacity&&this.props.menu&&this.props.menu.update()}render(){const{color:t,opacity:e,selectCustom:o,selectOpacity:n,customColors:r,onRemoveCustomColor:a}=this.props,{isCustom:l}=this.state,c="number"==typeof e?e:1;return l?i.createElement(L,{color:t,onSelect:this._handleSelectColor,onAdd:this._handleAddColor}):i.createElement("div",{className:B.container},i.createElement(v,{colors:u.basic,color:t,onSelect:this._handleSelectColor}),i.createElement(v,{colors:u.extended,color:t,onSelect:this._handleSelectColor}),i.createElement("div",{className:B.separator}),i.createElement(p.Provider,{value:a},i.createElement(v,{colors:r,color:t,onSelect:this._handleSelectColor},o&&i.createElement("div",{className:s()(B.customButton,"apply-common-tooltip"),onClick:this._handleCustomClick,title:N
}))),n&&i.createElement(i.Fragment,null,i.createElement("div",{className:B.sectionTitle},k),i.createElement(w.Opacity,{color:t,opacity:c,onChange:this._handleOpacity})))}_onToggleCustom(t){const{onToggleCustom:e}=this.props;e&&e(t)}}},939075:(t,e,o)=>{"use strict";o.d(e,{Opacity:()=>l});var i=o(50959),n=o(497754),s=o(650151),r=o(218954),a=o(401034);class l extends i.PureComponent{constructor(t){super(t),this._container=null,this._pointer=null,this._raf=null,this._refContainer=t=>{this._container=t},this._refPointer=t=>{this._pointer=t},this._handlePosition=t=>{null===this._raf&&(this._raf=requestAnimationFrame((()=>{const e=(0,s.ensureNotNull)(this._container),o=(0,s.ensureNotNull)(this._pointer),i=e.getBoundingClientRect(),n=o.offsetWidth,a=t.clientX-n/2-i.left,l=(0,r.clamp)(a/(i.width-n),0,1);this.setState({inputOpacity:Math.round(100*l).toString()}),this.props.onChange(l),this._raf=null})))},this._onSliderClick=t=>{this._handlePosition(t.nativeEvent),this._dragSubscribe()},this._mouseUp=t=>{this.setState({isPointerDragged:!1}),this._dragUnsubscribe(),this._handlePosition(t)},this._mouseMove=t=>{this.setState({isPointerDragged:!0}),this._handlePosition(t)},this._onTouchStart=t=>{this._handlePosition(t.nativeEvent.touches[0])},this._handleTouch=t=>{this.setState({isPointerDragged:!0}),this._handlePosition(t.nativeEvent.touches[0])},this._handleTouchEnd=()=>{this.setState({isPointerDragged:!1})},this._handleInput=t=>{const e=t.currentTarget.value,o=Number(e)/100;this.setState({inputOpacity:e}),Number.isNaN(o)||o>1||this.props.onChange(o)},this.state={inputOpacity:Math.round(100*t.opacity).toString(),isPointerDragged:!1}}componentWillUnmount(){null!==this._raf&&(cancelAnimationFrame(this._raf),this._raf=null),this._dragUnsubscribe()}render(){const{color:t,opacity:e,hideInput:o}=this.props,{inputOpacity:s,isPointerDragged:r}=this.state,l={color:t||void 0};return i.createElement("div",{className:a.opacity},i.createElement("div",{className:a.opacitySlider,style:l,ref:this._refContainer,onMouseDown:this._onSliderClick,onTouchStart:this._onTouchStart,onTouchMove:this._handleTouch,onTouchEnd:this._handleTouchEnd},i.createElement("div",{className:a.opacitySliderGradient,style:{backgroundImage:`linear-gradient(90deg, transparent, ${t})`}}),i.createElement("div",{className:a.opacityPointerWrap},i.createElement("div",{className:n(a.pointer,r&&a.dragged),style:{left:100*e+"%"},ref:this._refPointer}))),!o&&i.createElement("div",{className:a.opacityInputWrap},i.createElement("input",{type:"text",className:a.opacityInput,value:s,onChange:this._handleInput}),i.createElement("span",{className:a.opacityInputPercent},"%")))}_dragSubscribe(){const t=(0,s.ensureNotNull)(this._container).ownerDocument;t&&(t.addEventListener("mouseup",this._mouseUp),t.addEventListener("mousemove",this._mouseMove))}_dragUnsubscribe(){const t=(0,s.ensureNotNull)(this._container).ownerDocument;t&&(t.removeEventListener("mousemove",this._mouseMove),t.removeEventListener("mouseup",this._mouseUp))}}},860184:(t,e,o)=>{"use strict";o.d(e,{white:()=>n,basic:()=>a,
extended:()=>c});var i=o(676507);const n=i.colorsPalette["color-white"],s=["ripe-red","tan-orange","banana-yellow","iguana-green","minty-green","sky-blue","tv-blue","deep-blue","grapes-purple","berry-pink"],r=[200,300,400,500,600,700,800,900].map((t=>`color-cold-gray-${t}`));r.unshift("color-white"),r.push("color-black"),s.forEach((t=>{r.push(`color-${t}-500`)}));const a=r.map((t=>i.colorsPalette[t])),l=[];[100,200,300,400,700,900].forEach((t=>{s.forEach((e=>{l.push(`color-${e}-${t}`)}))}));const c=l.map((t=>i.colorsPalette[t]))},206397:(t,e,o)=>{"use strict";o.d(e,{useCustomColors:()=>l});var i=o(50959),n=o(870122),s=o(559410);function r(t,e){(0,i.useEffect)((()=>(s.subscribe(t,e,null),()=>{s.unsubscribe(t,e,null)})),[t,e])}var a=o(724377);function l(){const[t,e]=(0,i.useState)((0,n.getJSON)("pickerCustomColors",[]));r("add_new_custom_color",(o=>e(c(o,t)))),r("remove_custom_color",(o=>e(d(o,t))));const o=(0,i.useCallback)((e=>{const o=e?(0,a.parseRgb)(e):null;t.some((t=>null!==t&&null!==o&&(0,a.areEqualRgb)((0,a.parseRgb)(t),o)))||(s.emit("add_new_custom_color",e),(0,n.setJSON)("pickerCustomColors",c(e,t)))}),[t]),l=(0,i.useCallback)((e=>{(e>=0||e<t.length)&&(s.emit("remove_custom_color",e),(0,n.setJSON)("pickerCustomColors",d(e,t)))}),[t]);return[t,o,l]}function c(t,e){const o=e.slice();return o.push(t),o.length>29&&o.shift(),o}function d(t,e){return e.filter(((e,o)=>t!==o))}},313739:(t,e,o)=>{"use strict";o.d(e,{MatchMediaMap:()=>r});var i=o(50959),n=o(266783),s=o.n(n);class r extends i.Component{constructor(t){super(t),this._handleMediaChange=()=>{const t=l(this.state.queries,((t,e)=>e.matches));let e=!1;for(const o in t)if(t.hasOwnProperty(o)&&this.state.matches[o]!==t[o]){e=!0;break}e&&this.setState({matches:t})};const{rules:e}=this.props;this.state=a(e)}shouldComponentUpdate(t,e){return!s()(t,this.props)||(!s()(e.rules,this.state.rules)||!s()(e.matches,this.state.matches))}componentDidMount(){this._migrate(null,this.state.queries)}componentDidUpdate(t,e){s()(t.rules,this.props.rules)||this._migrate(e.queries,this.state.queries)}componentWillUnmount(){this._migrate(this.state.queries,null)}render(){return this.props.children(this.state.matches)}static getDerivedStateFromProps(t,e){if(s()(t.rules,e.rules))return null;const{rules:o}=t;return a(o)}_migrate(t,e){null!==t&&l(t,((t,e)=>{e.removeListener(this._handleMediaChange)})),null!==e&&l(e,((t,e)=>{e.addListener(this._handleMediaChange)}))}}function a(t){const e=l(t,((t,e)=>window.matchMedia(e)));return{queries:e,matches:l(e,((t,e)=>e.matches)),rules:{...t}}}function l(t,e){const o={};for(const i in t)t.hasOwnProperty(i)&&(o[i]=e(i,t[i]));return o}},515783:(t,e,o)=>{"use strict";o.d(e,{ToolWidgetCaret:()=>l});var i=o(50959),n=o(497754),s=o(72571),r=o(190948),a=o(100578);function l(t){const{dropped:e,className:o}=t;return i.createElement(s.Icon,{className:n(o,r.icon,{[r.dropped]:e}),icon:a})}},635194:t=>{t.exports={button:"button-uO7HM85b",hover:"hover-uO7HM85b",isInteractive:"isInteractive-uO7HM85b",isGrouped:"isGrouped-uO7HM85b",isActive:"isActive-uO7HM85b",
isOpened:"isOpened-uO7HM85b",isDisabled:"isDisabled-uO7HM85b",text:"text-uO7HM85b",icon:"icon-uO7HM85b"}},574749:t=>{t.exports={button:"button-rqVQ8gUB"}},17049:t=>{t.exports={button:"button-reABrhVR",hover:"hover-reABrhVR",arrow:"arrow-reABrhVR",arrowWrap:"arrowWrap-reABrhVR",isOpened:"isOpened-reABrhVR"}},152867:(t,e,o)=>{"use strict";o.d(e,{DEFAULT_TOOL_WIDGET_BUTTON_THEME:()=>a,ToolWidgetButton:()=>l});var i=o(50959),n=o(497754),s=o(72571),r=o(635194);const a=r,l=i.forwardRef(((t,e)=>{const{icon:o,isActive:a,isOpened:l,isDisabled:c,isGrouped:d,isHovered:h,onClick:p,text:u,textBeforeIcon:m,title:_,theme:g=r,className:v,forceInteractive:w,"data-name":f,...y}=t,b=n(v,g.button,_&&"apply-common-tooltip",{[g.isActive]:a,[g.isOpened]:l,[g.isInteractive]:(w||Boolean(p))&&!c,[g.isDisabled]:c,[g.isGrouped]:d,[g.hover]:h}),T=o&&("string"==typeof o?i.createElement(s.Icon,{className:g.icon,icon:o}):i.cloneElement(o,{className:n(g.icon,o.props.className)}));return i.createElement("div",{...y,ref:e,"data-role":"button",className:b,onClick:c?void 0:p,title:_,"data-name":f},m&&u&&i.createElement("div",{className:n("js-button-text",g.text)},u),T,!m&&u&&i.createElement("div",{className:n("js-button-text",g.text)},u))}))},392745:(t,e,o)=>{"use strict";o.d(e,{ToolWidgetIconButton:()=>a});var i=o(50959),n=o(497754),s=o(152867),r=o(574749);const a=i.forwardRef(((t,e)=>{const{className:o,id:a,...l}=t;return i.createElement(s.ToolWidgetButton,{"data-name":a,...l,ref:e,className:n(o,r.button)})}))},155185:(t,e,o)=>{"use strict";o.d(e,{DEFAULT_TOOL_WIDGET_MENU_THEME:()=>u,ToolWidgetMenu:()=>m});var i=o(50959),n=o(497754),s=o(544377),r=o(515783),a=o(800417),l=o(163694),c=o(759339),d=o(838683),h=o(930052),p=o(17049);const u=p;class m extends i.PureComponent{constructor(t){super(t),this._wrapperRef=null,this._controller=i.createRef(),this._handleWrapperRef=t=>{this._wrapperRef=t,this.props.reference&&this.props.reference(t)},this._handleClick=t=>{t.target instanceof Node&&t.currentTarget.contains(t.target)&&(this._handleToggleDropdown(),this.props.onClick&&this.props.onClick(t,!this.state.isOpened))},this._handleToggleDropdown=t=>{const{onClose:e,onOpen:o}=this.props,{isOpened:i}=this.state,n="boolean"==typeof t?t:!i;this.setState({isOpened:n}),n&&o&&o(),!n&&e&&e()},this._handleClose=()=>{this.close()},this.state={isOpened:!1}}render(){const{id:t,arrow:e,content:o,isDisabled:s,isDrawer:l,isShowTooltip:c,title:d,className:p,hotKey:u,theme:m,drawerBreakpoint:_}=this.props,{isOpened:g}=this.state,v=n(p,m.button,{"apply-common-tooltip":c||!s,[m.isDisabled]:s,[m.isOpened]:g});return i.createElement("div",{id:t,className:v,onClick:s?void 0:this._handleClick,title:d,"data-tooltip-hotkey":u,ref:this._handleWrapperRef,"data-role":"button",...(0,a.filterDataProps)(this.props)},o,e&&i.createElement("div",{className:m.arrow},i.createElement("div",{className:m.arrowWrap},i.createElement(r.ToolWidgetCaret,{dropped:g}))),this.state.isOpened&&(_?i.createElement(h.MatchMedia,{rule:_},(t=>this._renderContent(t))):this._renderContent(l)))}close(){
this._handleToggleDropdown(!1)}update(){null!==this._controller.current&&this._controller.current.update()}_renderContent(t){const{menuDataName:e,minWidth:o,menuClassName:n,maxHeight:r,drawerPosition:a="Bottom",children:h}=this.props,{isOpened:p}=this.state,u={horizontalMargin:this.props.horizontalMargin||0,verticalMargin:this.props.verticalMargin||2,verticalAttachEdge:this.props.verticalAttachEdge,horizontalAttachEdge:this.props.horizontalAttachEdge,verticalDropDirection:this.props.verticalDropDirection,horizontalDropDirection:this.props.horizontalDropDirection,matchButtonAndListboxWidths:this.props.matchButtonAndListboxWidths},m=Boolean(p&&t&&a),_=function(t){return"function"==typeof t}(h)?h({isDrawer:m}):h;return m?i.createElement(l.DrawerManager,null,i.createElement(c.Drawer,{onClose:this._handleClose,position:a,"data-name":e},_)):i.createElement(s.PopupMenu,{controller:this._controller,closeOnClickOutside:this.props.closeOnClickOutside,doNotCloseOn:this,isOpened:p,minWidth:o,onClose:this._handleClose,position:(0,d.getPopupPositioner)(this._wrapperRef,u),className:n,maxHeight:r,"data-name":e},_)}}m.defaultProps={arrow:!0,closeOnClickOutside:!0,theme:p}},122392:(t,e,o)=>{"use strict";o.r(e),o.d(e,{FavoriteDrawingToolbar:()=>g});var i=o(509806),n=o(909168),s=o(67508),r=(o(650151),o(972535)),a=o(488563),l=o(710567),c=o(282926),d=o(358076),h=o(842003),p=o(870122),u=o(131595),m=o(210596),_=o.n(m);o(341869);class g extends n.FloatingToolbar{constructor(t){super({allowSortable:!r.mobiletouch,dragOnlyInsideToolbar:!0,defaultPosition:t,positionSettingsKey:"chart.favoriteDrawingsPosition",positionStorageType:"device"}),this._linetoolsWidgets={},this._canBeShownValue=new(_())(!1),this._attachHandlers(),this._loadVisibilityState(),this._hideAction=this._createHideToolbarAction()}show(){this._canBeShownValue.value()&&(this.isVisible()||this._renderAllLinetools(),super.show())}showAndSaveSettingsValue(){this._canBeShownValue.value()&&(u.TVLocalStorage.setItem("ChartFavoriteDrawingToolbarWidget.visible","true"),this.show())}hideAndSaveSettingsValue(){u.TVLocalStorage.setItem("ChartFavoriteDrawingToolbarWidget.visible","false"),this.hide()}canBeShown(){return this._canBeShownValue.readonly()}_onFavoriteAdded(t){this.addWidget(this._createLinetoolWidget(t)),s.LinetoolsFavoritesStore.favorites().filter(v).length>0&&(this._canBeShownValue.setValue(!0),this.show())}_onFavoriteRemoved(t){this.removeWidget(this._linetoolsWidgets[t]),delete this._linetoolsWidgets[t],0===s.LinetoolsFavoritesStore.favorites().filter(v).length&&(this._canBeShownValue.setValue(!1),this.hide())}_onFavoriteMoved(){this._renderAllLinetools()}_onSelectedLinetoolChanged(t){Object.keys(this._linetoolsWidgets).forEach((e=>{this._linetoolsWidgets[e].classList.toggle("i-active",t===e)}))}_createLinetoolWidget(t){const e=`<span class="tv-favorited-drawings-toolbar__widget apply-common-tooltip ${t===d.tool.value()?"i-active":""}" title="${h.lineToolsInfo[t].localizedName}" data-name="FavoriteToolbar${t}">${h.lineToolsInfo[t].icon}</span>`,o=(0,a.parseHtmlElement)(e)
;return o.addEventListener("click",(e=>{e.preventDefault(),d.tool.value()!==t&&d.tool.setValue(t)})),this._linetoolsWidgets[t]=o,o}_renderAllLinetools(){this._linetoolsWidgets={},this.removeWidgets(),s.LinetoolsFavoritesStore.favorites().filter((t=>h.lineToolsInfo[t]&&!0)).forEach((t=>{this.addWidget(this._createLinetoolWidget(t))}))}_attachHandlers(){s.LinetoolsFavoritesStore.favoriteAdded.subscribe(this,this._onFavoriteAdded),s.LinetoolsFavoritesStore.favoriteRemoved.subscribe(this,this._onFavoriteRemoved),s.LinetoolsFavoritesStore.favoriteMoved.subscribe(this,this._onFavoriteMoved),s.LinetoolsFavoritesStore.favoritesSynced.subscribe(null,(()=>{this._loadVisibilityState(),this._renderAllLinetools()})),this.onWidgetsReordered().subscribe(this,((t,e)=>{if(s.LinetoolsFavoritesStore.favoriteMoved.unsubscribe(this,this._onFavoriteMoved),!s.LinetoolsFavoritesStore.moveFavorite(s.LinetoolsFavoritesStore.favorite(t),e))throw new Error("Something went wrong");s.LinetoolsFavoritesStore.favoriteMoved.subscribe(this,this._onFavoriteMoved)})),this.onContextMenu((t=>{t.preventDefault(),c.ContextMenuManager.showMenu([this._hideAction],t)})),d.tool.subscribe(this._onSelectedLinetoolChanged.bind(this))}_createHideToolbarAction(){return new l.Action({actionId:"Chart.FavoriteDrawingToolsToolbar.Hide",label:i.t(null,void 0,o(574813)),onExecute:()=>{this.hideAndSaveSettingsValue()}})}_loadVisibilityState(){const t=s.LinetoolsFavoritesStore.favorites().filter(v).length>0;this._canBeShownValue.setValue(t);const e=s.LinetoolsFavoritesStore.favoritesCount()>0;let o;const i=p.getValue("ChartFavoriteDrawingToolbarWidget.visible");void 0!==i?(p.remove("ChartFavoriteDrawingToolbarWidget.visible",{forceFlush:!0}),o="false"!==i,u.TVLocalStorage.setItem("ChartFavoriteDrawingToolbarWidget.visible",i)):o="false"!==u.TVLocalStorage.getItem("ChartFavoriteDrawingToolbarWidget.visible"),o&&e?this.show():this.hide()}}function v(t){return!0}},909168:(t,e,o)=>{"use strict";o.d(e,{FLOATING_TOOLBAR_REACT_WIDGETS_CLASS:()=>w,FloatingToolbar:()=>y});var i=o(370981),n=o(972535),s=o(635991),r=o(870122),a=o(922157),l=o.n(a),c=o(210596),d=o.n(c),h=o(181370);class p extends h.ChunkLoader{_startLoading(){return Promise.all([o.e(1553),o.e(2377)]).then(o.bind(o,177525)).then((t=>t.HammerJS))}}var u=o(131595),m=o(496818),_=o(488563),g=o(32133),v=o(25388);o(604920);const w="floating-toolbar-react-widgets",f=`<div class="tv-floating-toolbar i-closed i-hidden"><div class="tv-floating-toolbar__widget-wrapper"><div class="tv-floating-toolbar__drag js-drag">${v}</div><div class="tv-floating-toolbar__content js-content"></div><div class="${w}"></div></div></div>`;class y{constructor(t){this._widget=document.createElement("div"),this._isVertical=!1,this._hiddingTimeoutId=null,this._visibility=new(d())(!1),this._windowResizeListener=this._onWindowResize.bind(this),this._reorderedDelegate=new(l()),this._responsiveResizeFunction=null,this._showTimeStamp=null,this._draggable=null,this._preventClickUntilAnimation=t=>{
null!==this._showTimeStamp&&performance.now()-this._showTimeStamp<this.hideDuration()&&t.stopPropagation()},y._toolbars.push(this),this._options=t,this._widget=(0,_.parseHtmlElement)(f),this._content=this._widget.getElementsByClassName("js-content").item(0),this._reactWidgetsContainer=this._widget.getElementsByClassName(w).item(0),this._setZIndex(y._startZIndex+y._toolbars.length-1),this._options.addClass&&(this._widget.className+=` ${this._options.addClass}`),this._options["data-name"]&&(this._widget.dataset.name=this._options["data-name"]),this._options.layout&&"auto"!==this._options.layout&&(this._isVertical="vertical"===this._options.layout,this._updateLayoutType(),this._updateAxisOption()),this._widget.addEventListener("click",this._preventClickUntilAnimation,!0)}destroy(){this.hide(!0),y._toolbars.splice(y._toolbars.indexOf(this),1),this._widget.removeEventListener("click",this._preventClickUntilAnimation,!0),document.body.contains(this._widget)&&document.body.removeChild(this._widget),null!==this._draggable&&this._draggable.destroy(),this._widget.innerHTML="",this._responsiveResizeFunction=null}setResponsiveResizeFunc(t){this._responsiveResizeFunction=t}isVisible(){return this._visibility.value()}visibility(){return this._visibility.readonly()}isVertical(){return this._isVertical}show(){this.isVisible()||(document.body.contains(this._widget)||(this._init(),document.body.appendChild(this._widget)),this._setHiddingTimeout(null),window.addEventListener("resize",this._windowResizeListener),this.raise(),this._visibility.setValue(!0),this._showTimeStamp=performance.now(),this._widget.classList.contains("i-hidden")?(this._widget.classList.remove("i-hidden"),setTimeout((()=>{this.isVisible()&&this._widget.classList.remove("i-closed")}))):this._widget.classList.remove("i-closed"),this._onWindowResize())}hide(t=!1){if(!this.isVisible())return;const e=this._widget.classList.contains("i-closed");if(this._widget.classList.add("i-closed"),this._visibility.setValue(!1),t||e)this._setHiddingTimeout(null),this._widget.classList.add("i-hidden");else{const t=setTimeout((()=>{this._setHiddingTimeout(null),this._widget.classList.add("i-hidden")}),this.hideDuration());this._setHiddingTimeout(t)}window.removeEventListener("resize",this._windowResizeListener)}raise(){y._toolbars.length+y._startZIndex!==this._zIndex()&&(y._toolbars.splice(y._toolbars.indexOf(this),1),y._toolbars.push(this),y._updateAllZIndexes())}hideDuration(){return.75*s.dur}addWidget(t,e={}){const o=this.widgetsCount();if(void 0===e.index&&(e.index=o),e.index<0||e.index>o)throw new Error(`Index must be in [0, ${o}]`);const i=document.createElement("div");i.className="tv-floating-toolbar__widget js-widget",i.appendChild(t);const n=e.index===o?null:this._content.childNodes.item(e.index);this._content.insertBefore(i,n),this._onWindowResize()}getReactWidgetContainer(){return this._reactWidgetsContainer}removeWidget(t){const e=this._findWrapperForWidget(t);e&&(this._content.removeChild(e),this._onWindowResize())}widgetsCount(){return this._content.childNodes.length}
showWidget(t){const e=this._findWrapperForWidget(t);e&&e.classList.remove("i-hidden")}hideWidget(t){const e=this._findWrapperForWidget(t);e&&e.classList.add("i-hidden")}removeWidgets(){for(;this._content.firstChild;)this._content.removeChild(this._content.firstChild);this._onWindowResize()}onWidgetsReordered(){return this._reorderedDelegate}onContextMenu(t){if(n.mobiletouch){(new p).load().then((e=>{const o=new e(this._widget);o.get("press").set({time:500}),o.on("press",(e=>{this._preventWidgetTouchEndEvent(),t(e.srcEvent)}))}))}else this._widget.addEventListener("contextmenu",t)}checkPosition(){const t=this._getCorrectedWidgetRect(),e={left:t.left,top:t.top};this._correctPosition(e),t.left===e.left&&t.top===e.top||(this._widget.style.left=e.left+"px",this._widget.style.top=e.top+"px")}_determineCurrentLayoutVertical(t){const e=this._isVertical?t.height:t.width;return window.innerWidth<e&&window.innerWidth<window.innerHeight}_getWidget(){return this._widget}_findWrapperForWidget(t){const e=this._content.getElementsByClassName("js-widget");for(let o=0;o<e.length;++o){const i=e.item(o);if(i.contains(t))return i}return null}_onVerticalChanged(t,e){}_correctPosition(t){const e=this._getCorrectedWidgetRect(),o=this._getSavedPosition(),i=window.innerWidth-e.right,n=window.innerHeight-e.bottom;i<0?t.left=Math.max(0,window.innerWidth-e.width):o&&o.left>t.left&&(t.left=Math.min(t.left+i,o.left)),n<0?t.top=Math.max(0,window.innerHeight-e.height):o&&o.top>t.top&&(t.top=Math.min(t.top+n,o.top))}_getCorrectedWidgetRect(){const t=this._widget.getBoundingClientRect();if(this._widget.classList.contains("i-closed")){const e=1/.925-1,o=t.width*e,i=t.height*e;return{bottom:t.bottom+i/2,height:t.height+i,left:t.left-o/2,right:t.right+o/2,top:t.top-i/2,width:t.width+o}}return t}_getSavedPosition(){var t;let e;if("device"===this._options.positionStorageType){const t=u.TVLocalStorage.getItem(this._options.positionSettingsKey);e=null!==t?JSON.parse(t):null}else e=null!==(t=(0,r.getJSON)(this._options.positionSettingsKey))&&void 0!==t?t:null;return null!==e&&"top"in e&&"left"in e?e:null}_setHiddingTimeout(t){null!==this._hiddingTimeoutId&&clearTimeout(this._hiddingTimeoutId),this._hiddingTimeoutId=t}_preventWidgetTouchEndEvent(){const t=e=>{e.preventDefault(),this._widget.removeEventListener("touchend",t)};this._widget.addEventListener("touchend",t)}_updateLayoutType(){this._widget.classList.toggle("i-vertical",this._isVertical)}_updateAxisOption(){0}_onWindowResize(){if("auto"===(this._options.layout||"auto")){const t=this._isVertical,e=this._getCorrectedWidgetRect();this._isVertical=this._determineCurrentLayoutVertical(e),this._updateLayoutType(),t!==this._isVertical&&(this._onVerticalChanged(this._isVertical,t),this._updateAxisOption())}this.checkPosition(),this._resizeResponsive()}_resizeResponsive(){if(null===this._responsiveResizeFunction)return;let t=this._options.layout||"auto";"auto"===t&&(t=this._isVertical?"vertical":"horizontal")
;const e="vertical"===t?this._widget.clientHeight:this._widget.clientWidth,o=("vertical"===t?window.innerHeight:window.innerWidth)-e;this._responsiveResizeFunction(e,o,t)}_setZIndex(t){this._widget.style.zIndex=String(t)}_zIndex(){return Number(this._widget.style.zIndex)}_loadPosition(){var t;const e=null!==(t=this._getSavedPosition())&&void 0!==t?t:this._options.defaultPosition;this._widget.style.left=Math.round(e.left)+"px",this._widget.style.top=Math.round(e.top)+"px",this._onWindowResize()}_savePosition(){const t=this._widget.getBoundingClientRect();if("device"===this._options.positionStorageType)try{u.TVLocalStorage.setItem(this._options.positionSettingsKey,JSON.stringify({left:t.left,top:t.top}))}catch(t){}else(0,r.setJSON)(this._options.positionSettingsKey,{left:t.left,top:t.top})}_init(){this._loadPosition(),this._draggable=new m.Draggable({source:this._widget,containment:"window",handle:".js-drag",start:i.globalCloseMenu,stop:this._savePosition.bind(this)}),this._widget.addEventListener("pointerdown",this.raise.bind(this))}_initSortable(){let t=-1;lazyJqueryUI(this._content).sortable({start:(e,o)=>{t=o.item.index()},stop:(e,o)=>{const i=o.item.index();t!==i&&((0,g.trackEvent)("Floating Toolbar","User Sort"),this._reorderedDelegate.fire(t,i))},tolerance:"pointer",distance:5,containment:!!this._options.dragOnlyInsideToolbar&&"parent",scroll:!1,placeholder:"sortable-placeholder",forcePlaceholderSize:!0}),this._updateAxisOption()}static _updateAllZIndexes(){y._toolbars.forEach(((t,e)=>{t._setZIndex(y._startZIndex+e)}))}}y._startZIndex=20,y._toolbars=[]},123623:(t,e,o)=>{"use strict";o.d(e,{LineToolPropertiesWidgetBase:()=>Wt});var i=o(50959),n=o(500962),s=o(509806),r=o(440097),a=o(484727),l=o(210596),c=o.n(l),d=o(486028),h=o(232468),p=o(358076),u=o(519355),m=o(650151),_=o(976704),g=o.n(_);class v extends(g()){constructor(t,e,o){super(),this._listenersMappers=[],this._isProcess=!1,this._baseProperty=t,this._propertyApplier=e,this._undoText=o}destroy(){this._baseProperty.destroy()}value(){return this._baseProperty.value()}setValue(t){this._isProcess=!0,this._baseProperty.setValue(t,void 0,{applyValue:(t,e)=>this._propertyApplier.setProperty(t,e,this._undoText)}),this._isProcess=!1,this._listenersMappers.forEach((t=>{t.method.call(t.obj,this)}))}subscribe(t,e){const o=o=>{this._isProcess||e.call(t,this)},i={obj:t,method:e,callback:o};this._listenersMappers.push(i),this._baseProperty.subscribe(t,o)}unsubscribe(t,e){var o;const i=(0,m.ensureDefined)(null===(o=this._listenersMappers.find((o=>o.obj===t&&o.method===e)))||void 0===o?void 0:o.callback);this._baseProperty.unsubscribe(t,i)}unsubscribeAll(t){this._baseProperty.unsubscribeAll(t)}}var w=o(357291),f=o(313739),y=o(909168),b=o(996038);const T=y.FLOATING_TOOLBAR_REACT_WIDGETS_CLASS+"__button";function C(t){const{templateButton:e,propertyButtons:o,commonButtons:n,isDrawingFinished:s,activeChartWidget:r}=t,a=r.hasModel()&&r.model().selection().dataSources();return a&&a.length?i.createElement(f.MatchMediaMap,{rules:{isSmallWidth:b.DialogBreakpoints.TabletSmall,
isSmallHeight:"screen and (max-height: 430px)"}},(({isSmallWidth:t,isSmallHeight:e})=>i.createElement(i.Fragment,null,l(),s&&i.createElement(i.Fragment,null,Boolean(o.length)&&o.map(((o,n)=>i.createElement(o.component,{...o.props,key:`${o.props.title}_${n}`,className:T,isSmallScreen:t||e}))),Boolean(n.length)&&n.map(((o,n)=>{const s=t||e;return s?o.showForSmallScreen?i.createElement(o.component,{...o.props,isSmallScreen:s,key:`${o.props.title}_${n}`,className:T}):null:i.createElement(o.component,{...o.props,key:`${o.props.title}_${n}`,className:T})})))))):l();function l(){return null===e?null:i.createElement(e.component,{...e.props,isDrawingFinished:s,className:T})}}var E=o(32133),S=o(392745),x=o(561964);function P(t){const{title:e,activeChartWidget:o,className:n}=t;return i.createElement(S.ToolWidgetIconButton,{className:n,icon:x,title:e,onClick:async function(){(0,E.trackEvent)("GUI","Context action on drawings","Settings");const t=o.model().selection().lineDataSources(),e=t.length;1===e?await o.showChartPropertiesForSource(t[0],void 0,{onWidget:o.onWidget()}):e>1&&await o.showChartPropertiesForSources({sources:t})},"data-name":"settings"})}var W=o(834297),L=o(497754),B=o(54588),N=o(720695);function k(t){const{className:e,...o}=t;return i.createElement(B.ToolButton,{className:L(e,N.button),tooltipPosition:"horizontal",...o})}var M=o(665186),A=o(691244);function D(t){const{activeChartWidget:e,className:n}=t,r=e.model().selection().lineDataSources();if(0===r.length)return null;const a=r[0].properties().frozen,l=(0,W.useProperty)(a),c=l?{title:s.t(null,void 0,o(715101)),icon:M}:{title:s.t(null,void 0,o(642284)),icon:A};return i.createElement(k,{className:n,isActive:Boolean(l),onClick:function(){(0,E.trackEvent)("GUI","Context action on drawings","Lock"),e.toggleLockSelectedObject()},"data-name":Boolean(l)?"unlock":"lock",...c})}var I=o(535149);function O(t){const{title:e,activeChartWidget:o,className:n}=t;return i.createElement(S.ToolWidgetIconButton,{className:n,icon:I,title:e,"data-name":"remove",onClick:function(){(0,E.trackEvent)("GUI","Context action on drawings","Remove"),o.removeSelectedSources()}})}var R=o(72571),F=o(972535),V=o(180185),z=o(411589),U=o(155185),H=o(789645),j=o(710567),G=o(249161),$=o(282926),Y=o(412905),Z=o(844996),q=o(484959);function K(t){const{title:e,activeChartWidget:n,isSmallScreen:r,className:a}=t,l=n.model(),c=l.selection().lineDataSources(),[d,h]=(0,i.useState)([]),p=(0,i.useRef)(null),u=(0,i.useMemo)((()=>new Y.ActionsProvider(n)),[n]);return i.createElement(i.Fragment,null,i.createElement(G.KeyboardDocumentListener,{keyCode:27,eventType:"keyup",handler:function(){(0,m.ensureNotNull)(p.current).close()}}),i.createElement(U.ToolWidgetMenu,{className:a,ref:p,arrow:!1,onOpen:r?void 0:function(){const t=[(0,Y.createVisualOrderAction)(n,c)];t.push((0,Y.createChangeIntervalsVisibilitiesAction)(n,c));const e=function(){const t=[],e=V.isMacKeyboard?" +":"",i=c.filter((t=>t.cloneable()));i.length>0&&t.push(new j.Action({actionId:"Chart.LineTool.Clone",name:"clone",icon:o(636296),
shortcutHint:V.humanReadableModifiers(z.Modifiers.Mod)+e+" Drag",label:s.t(null,void 0,o(552977)),onExecute:()=>{l.cloneLineTools(i,!1),(0,E.trackEvent)("GUI","Context action on drawings","Clone")}}));const r=c.filter((t=>t.copiable()));if(r.length>0){const i={actionId:"Chart.Clipboard.CopyLineTools",name:"copy",label:s.t(null,void 0,o(35216)),shortcutHint:V.humanReadableModifiers(z.Modifiers.Mod)+e+" C",onExecute:()=>{n.chartWidgetCollection().clipboard.uiRequestCopy(r)}};t.push(new j.Action(i,"Copy"))}if(!function(){if(!(null==n?void 0:n.isMultipleLayout()))return!1;return c.some((t=>t.isSynchronizable()))}())return t;return t.push(...(0,Y.createSyncDrawingActions)(n,c)),t}();e.length&&t.push(new j.Separator,...e);t.push(new j.Separator,new j.Action({actionId:"Chart.SelectedObject.Hide",label:s.t(null,void 0,o(831971)),icon:q,onExecute:()=>{n.hideSelectedObject()},name:"hide"})),h(J(t))},onClick:r?function(t){u.contextMenuActionsForSources(c).then((e=>{window.matchMedia(b.DialogBreakpoints.TabletSmall).matches?$.ContextMenuManager.showMenu(J(e),t,{mode:"drawer","data-name":"more-menu"}):h(J(e))}))}:void 0,title:e,content:i.createElement(R.Icon,{icon:Z}),"data-name":"more",menuDataName:"more-menu"},i.createElement(H.ActionsTable,{parentIsOpened:!0,items:d})))}function J(t){if(F.touch&&!window.matchMedia("(pointer:fine)").matches){const e=t.filter((t=>"Copy"!==t.id));if(e.length===t.length)return e;const o=[];return e.forEach((t=>{("separator"!==t.type||o.length>0&&"separator"!==o[o.length-1].type)&&o.push(t)})),o}return t}var X=o(795161),Q=o(200501),tt=o(123851),et=o(357740);function ot(t){const{property:e,propertyApplier:n,title:r,undoText:a,className:l}=t,c=(0,W.useProperty)(e),d=(0,i.useMemo)((()=>[new j.Action({actionId:"Chart.LineTool.Toolbar.ChangeLineStyleToSolid",icon:Q,label:s.t(null,void 0,o(301277)),active:X.LineStyle.Solid===c,onExecute:()=>n.setProperty(e,X.LineStyle.Solid,a)}),new j.Action({actionId:"Chart.LineTool.Toolbar.ChangeLineStyleToDashed",icon:tt,label:s.t(null,void 0,o(459317)),active:X.LineStyle.Dashed===c,onExecute:()=>n.setProperty(e,X.LineStyle.Dashed,a)}),new j.Action({actionId:"Chart.LineTool.Toolbar.ChangeLineStyleToDotted",icon:et,label:s.t(null,void 0,o(842973)),active:X.LineStyle.Dotted===c,onExecute:()=>n.setProperty(e,X.LineStyle.Dotted,a)})]),[n,e,c]);return i.createElement(U.ToolWidgetMenu,{className:l,arrow:!1,content:i.createElement(R.Icon,{icon:it(c)}),title:r,"data-name":t["data-name"],menuDataName:`${t["data-name"]}-menu`},i.createElement(H.ActionsTable,{items:d}))}function it(t){switch(t){case X.LineStyle.Solid:return Q;case X.LineStyle.Dashed:return tt;case X.LineStyle.Dotted:return et;default:return""}}const nt=[10,11,12,14,16,20,24,28,32,40];function st(t){const{property:e,propertyApplier:o,title:n,undoText:s,className:r}=t,a=(0,W.useProperty)(e),l=nt.map((t=>new j.Action({actionId:"Chart.LineTool.Toolbar.ChangeFontSizeProperty",label:t.toString(),onExecute:()=>o.setProperty(e,t,s),active:t===a})));return i.createElement(U.ToolWidgetMenu,{arrow:!1,content:a,className:r,
title:n,"data-name":t["data-name"],menuDataName:`${t["data-name"]}-menu`},i.createElement(H.ActionsTable,{items:l}))}var rt=o(922157),at=o.n(rt);o(256337),o(653351);class lt extends y.FloatingToolbar{constructor(t){super(lt._prepareOptions(t)),this._onWidgetStateChangedDelegate=new(at()),this._statedWidgets=[],this._currentPopup=null,this._onWindowClickedListener=this._onWindowClicked.bind(this)}show(){super.show(),document.addEventListener("mousedown",this._onWindowClickedListener)}hide(t){super.hide(t),document.removeEventListener("mousedown",this._onWindowClickedListener)}destroy(){this._closePopup(),super.destroy()}addGroupedWidget(t,e={}){(0,m.assert)(t.states.length>0&&-1!==lt._getStateIndexById(t,t.currentStateId),`Argument is invalid (count: ${t.states.length}, state: ${t.currentStateId})`);const o=document.createElement("div");o.className="tv-grouped-floating-toolbar__widget-wrapper apply-common-tooltip",t.widgetAddClass&&o.classList.add(t.widgetAddClass),o.setAttribute("title",t.tooltip);const i={isEnabled:!0,statedWidget:t,toolbarWidget:o},n=this._onWidgetClicked.bind(this,i);i.clickListener=n,o.addEventListener("click",n),this._updateWidgetPreview(i),this.addWidget(o,e),this._statedWidgets.push(i)}findGroupedWidget(t){const e=this._statedWidgets.length;for(let o=0;o<e;++o){if(this._statedWidgets[o].statedWidget.id===t)return o}return-1}removeGroupedWidget(t){const e=this._statedWidgets.length;for(let o=0;o<e;++o){const e=this._statedWidgets[o];if(e.statedWidget.id===t)return this._isPopupCreatedForWidget(t)&&this._closePopup(),void 0!==e.clickListener&&e.toolbarWidget.removeEventListener("click",e.clickListener),this.removeWidget(e.toolbarWidget),this._statedWidgets.splice(o,1),void this._updatePopupPosition()}(0,m.assert)(!1,`Unknown groupId(${t})`)}updateGroupedWidget(t,e){this._closePopup();const o=this._ensuredGetWidgetDataForId(t);o.statedWidget.currentStateId=e.currentStateId,o.statedWidget.states=e.states,this._updateWidgetPreview(o)}setGroupedWidgetEnabled(t,e){const o=this._ensuredGetWidgetDataForId(t);o.isEnabled=e,o.toolbarWidget.classList.toggle("i-disabled",!e)}setGroupedWidgetState(t,e){const o=this._ensuredGetWidgetDataForId(t);(0,m.assert)(-1!==lt._getStateIndexById(o.statedWidget,e),`Unknown stateId (${e})`),o.statedWidget.currentStateId=e,this._updateSubWidgetsState(o.statedWidget),this._updateWidgetPreview(o)}onWidgetStateChanged(){return this._onWidgetStateChangedDelegate}_onVerticalChanged(t,e){this._updatePopupPosition()}_ensuredGetWidgetDataForId(t){for(const e of this._statedWidgets)if(e.statedWidget.id===t)return e;throw new Error(`Unknown groupId(${t})`)}_onWidgetClicked(t,e){const o=this._currentPopup&&this._isPopupCreatedForWidget(t.statedWidget.id);this._closePopup(),!o&&t.isEnabled&&this._createPopup(t)}_createPopup(t){const e={createdFor:t.toolbarWidget,element:document.createElement("div"),stateWidgetId:t.statedWidget.id,widgets:[]};e.element.className+="tv-grouped-floating-toolbar__popup js-popup";const o=t.statedWidget.states.length;t.statedWidget.states.forEach(((i,n)=>{
const s=this._createSubWidget(t,i),r=this._onSubWidgetClicked.bind(this,t,i.id);s.addEventListener("click",r),e.widgets.push({clickListener:r,stateWidget:i,widget:s}),s.classList.add(`tv-grouped-floating-toolbar__sub-widget--slide-right-${n}`),s.classList.add("tv-grouped-floating-toolbar__sub-widget--slide-left-"+(o-n+1)),i.readonly||e.element.appendChild(s)})),this._currentPopup=e,this._updateSubWidgetsState(t.statedWidget),t.toolbarWidget.classList.add("i-dropped"),this._getWidget().appendChild(this._currentPopup.element),Promise.resolve().then((()=>{this._currentPopup&&this._currentPopup.element.classList.add("i-opened")})),this._updatePopupPosition()}_closePopup(){if(this._statedWidgets.forEach((t=>{t.toolbarWidget.classList.remove("i-dropped")})),!this._currentPopup)return;const t=this._currentPopup.widgets,e=this._currentPopup.element;this._currentPopup=null,t.forEach((t=>{t.widget.removeEventListener("click",t.clickListener)})),e.classList.remove("i-opened"),e.addEventListener("transitionend",(t=>{t.target===e&&this._getWidget().removeChild(e)}))}_updateWidgetPreview(t){const e=lt._getStateIndexById(t.statedWidget,t.statedWidget.currentStateId);(0,m.assert)(-1!==e,`Unknown state id: ${t.statedWidget.currentStateId}`);const o=t.statedWidget.states[e].widget.cloneNode(!0);t.toolbarWidget.firstChild?t.toolbarWidget.replaceChild(o,t.toolbarWidget.firstChild):(t.toolbarWidget.appendChild(o),t.toolbarWidget.appendChild(lt._createCaret()))}_updateSubWidgetsState(t){this._currentPopup&&this._isPopupCreatedForWidget(t.id)&&this._currentPopup.widgets.forEach((e=>{e.widget.classList.toggle(lt._activeSubWidgetClass,e.stateWidget.id===t.currentStateId)}))}_updatePopupPosition(){if(!this._currentPopup)return;const t=this._currentPopup.createdFor,e=this._getWidget().getBoundingClientRect(),o=this._findWrapperForWidget(t);if(!o||!this._currentPopup)throw new Error("Toolbar has no wrapper for preview's widget or there is no popup");const i=o.getBoundingClientRect(),n=this._currentPopup.element.getBoundingClientRect(),s=this._currentPopup.element;if(this.isVertical())s.classList.remove("tv-grouped-floating-toolbar__popup--at-top"),s.style.top=i.top-e.top+1+"px",s.style.left="",e.left>window.innerWidth-e.right?s.classList.add("tv-grouped-floating-toolbar__popup--at-left"):s.classList.remove("tv-grouped-floating-toolbar__popup--at-left");else{s.classList.remove("tv-grouped-floating-toolbar__popup--at-left");let t=0;i.left+n.width>window.innerWidth?e.left+n.width>window.innerWidth&&(t=e.width-n.width):t=i.left-e.left+1,s.style.left=`${t}px`,e.bottom+n.height>window.innerHeight?s.classList.add("tv-grouped-floating-toolbar__popup--at-top"):(s.classList.remove("tv-grouped-floating-toolbar__popup--at-top"),s.style.top="")}}_isPopupCreatedForWidget(t){return Boolean(this._currentPopup&&this._currentPopup.stateWidgetId===t)}_createSubWidget(t,e){const o=document.createElement("div");return o.className+="tv-grouped-floating-toolbar__sub-widget",t.statedWidget.stateWidgetAddClass&&o.classList.add(t.statedWidget.stateWidgetAddClass),
o.appendChild(e.widget),o}_onSubWidgetClicked(t,e){this._closePopup(),t.statedWidget.currentStateId!==e&&(this.setGroupedWidgetState(t.statedWidget.id,e),this._onWidgetStateChangedDelegate.fire(t.statedWidget.id,e))}_onWindowClicked(t){if(this.isVisible()&&this._currentPopup&&!lt._isEventInElement(t,this._currentPopup.element)){for(let e=0;e<this._statedWidgets.length;++e)if(lt._isEventInElement(t,this._statedWidgets[e].toolbarWidget))return;this._closePopup()}}static _getStateIndexById(t,e){for(let o=0;o<t.states.length;++o)if(t.states[o].id===e)return o;return-1}static _createCaret(){const t=document.createElement("div");return t.className="tv-caret tv-caret--small tv-caret--colored tv-grouped-floating-toolbar__caret",t}static _prepareOptions(t){const e=" tv-grouped-floating-toolbar";return t.addClass?t.addClass+=e:t.addClass=e,t}static _isEventInElement(t,e){return t.target===e||e.contains(t.target)}}lt._activeSubWidgetClass="tv-grouped-floating-toolbar__sub-widget--current";var ct=o(887905),dt=o(622200),ht=o(40813),pt=o(16143),ut=o(21218),mt=o(76821),_t=o(608280);function gt(t){const{model:e,onRestore:n,onSave:r,isDrawingFinished:a,className:l,...c}=t,[d,h]=(0,i.useState)(!1),[p,u]=(0,i.useState)(null),m=(0,i.useRef)(null);(0,i.useEffect)((()=>{var t;null===(t=m.current)||void 0===t||t.update()}),[d]);const _=(0,i.useMemo)((()=>{if(r)return()=>{e.showSaveDialog((t=>{e.saveTemplate(t,JSON.stringify(r()))}))}}),[e,r]),g=(0,i.useMemo)((()=>{const t=[];return a&&_&&t.push(new j.Action({actionId:"Chart.LineTool.Templates.SaveAs",label:(0,ut.appendEllipsis)(s.t(null,void 0,o(933751))),onExecute:_})),t.push(new j.Action({actionId:"Chart.LineTool.Templates.ApplyDefaults",label:s.t(null,void 0,o(486528)),onExecute:n})),d?t.push(new j.Loader("Chart.LineTool.Templates.Apply")):!d&&(null==p?void 0:p.length)&&(t.push(new j.Separator),t.push(...p.map((t=>new j.Action({actionId:"Chart.LineTool.Templates.Apply",label:t,onExecute:()=>function(t){void 0!==t&&e.loadTemplate(t)}(t),showToolboxOnHover:!0,toolbox:{type:mt.ToolboxType.Delete,action:()=>e.deleteAction(t)}}))))),t}),[_,n,p,e,a,d]);return i.createElement(U.ToolWidgetMenu,{title:s.t(null,void 0,o(891900)),content:i.createElement(R.Icon,{icon:_t}),onOpen:function(){h(!0),e.templatesLoaded().then((()=>{const t=e.getData();void 0!==t&&(u(t),h(!1))})),(0,E.trackEvent)("GUI","Context action on drawings","Templates")},arrow:!1,className:l,"data-name":"templates",menuDataName:"templates-menu",ref:m,...c},i.createElement(H.ActionsTable,{items:g}))}var vt=o(508547),wt=o(708123);const ft=(!a.enabled("widget")||window.is_authenticated)&&a.enabled("linetoolpropertieswidget_template_button"),yt=new r.TranslatedString("change line tool(s) font size",s.t(null,void 0,o(436819))),bt=new r.TranslatedString("change line tool(s) line style",s.t(null,void 0,o(654769))),Tt=new r.TranslatedString("apply drawing template",s.t(null,void 0,o(349037))),Ct=s.t(null,void 0,o(389517)),Et=s.t(null,void 0,o(734596)),St=s.t(null,void 0,o(141610)),xt=s.t(null,void 0,o(832733)),Pt=s.t(null,void 0,o(417006))
;class Wt{constructor(t){this._isDrawingFinished=new(c())(!0),this._currentTool=null,this._updateVisibilityTimeout=null,this._lineWidthsProperty=null,this._lineColorsProperty=null,this._currentProperties=null,this._container=null,this._toolbarRendered=!1,this._toolbarVisible=!1,this._propertiesVisible=!1,this._templatesButton=null,this._propertyButtons=[],this._commonButtons=[],this._handleSourceEdit=t=>{p.isDirectionalMovementActive.value()||(t?this._floatingToolbar.hide(!0):this._toolbarRendered&&this._floatingToolbar.show())},this._chartWidgetCollection=t,this._floatingToolbar=new lt({defaultPosition:{top:ct.HEADER_TOOLBAR_HEIGHT_EXPANDED+15,left:window.innerWidth/2},positionSettingsKey:"properties_toolbar.position",positionStorageType:"device",layout:"horizontal","data-name":"drawing-toolbar"}),this._container=this._floatingToolbar.getReactWidgetContainer(),this._isToolMovingNowSpawn=p.isToolMovingNow.spawn(),this._isToolEditingNowSpawn=p.isToolEditingNow.spawn(),this._toolSpawn=p.tool.spawn(),this._iconToolSpawn=p.iconTool.spawn(),this._emojiToolSpawn=p.emojiTool.spawn(),this._selectedSourcesSpawn=this._chartWidgetCollection.selectedSources.spawn(),this._isToolMovingNowSpawn.subscribe(this._handleSourceEdit),this._isToolEditingNowSpawn.subscribe(this._handleSourceEdit),this._toolSpawn.subscribe(this._onToolChanged.bind(this),{callWithLast:!0}),this._iconToolSpawn.subscribe((()=>this._onToolChanged(p.tool.value()))),this._emojiToolSpawn.subscribe((()=>this._onToolChanged(p.tool.value()))),this._selectedSourcesSpawn.subscribe((()=>this.onSourceChanged(this.selectedSources()))),this._chartWidgetCollection.onAboutToBeDestroyed.subscribe(this,this.destroy,!0)}destroy(){this._isToolMovingNowSpawn.destroy(),this._isToolEditingNowSpawn.destroy(),this._toolSpawn.destroy(),this._iconToolSpawn.destroy(),this._emojiToolSpawn.destroy(),this._selectedSourcesSpawn.destroy()}refresh(){this.onSourceChanged(this.selectedSources())}onSourceChanged(t){if(!(null==t?void 0:t.length))return this._propertiesVisible=!1,this._toolbarVisible=!1,void this.hide();if(this._createCommonButtons(),t.every((e=>e.toolname===t[0].toolname))?this._showTemplatesOf({sources:t}):this._templatesButton&&this._clearTemplatesButton(),1===t.length){const e=t[0];e.isAvailableInFloatingWidget()&&this.activeChartWidget().model().model().dataSourceForId(e.id())?(!e.userEditEnabled()||!(0,h.isLineDrawnWithPressedButton)(e.toolname)&&this.activeChartWidget().model().lineBeingCreated()||this._isDrawingFinished.setValue(!0),this.showPropertiesOf(e.toolname,e.properties(),!0),this._toolbarVisible=!0):this.hide()}else this._clearProperties(),this._createWidthsButton(void 0,!0),this._createColorsButton(void 0,!0),this._createBackgroundsButton(void 0,!0),this._createTextColorsButton(void 0,!0),this._propertiesVisible=!0;this._updateVisibility()}activeChartWidget(){return this._chartWidgetCollection.activeChartWidget.value()}selectedSources(){return this._chartWidgetCollection.selectedSources.value().filter(h.isLineTool)}hide(){var t
;this._updateVisibilityTimeout&&clearTimeout(this._updateVisibilityTimeout),this._updateVisibilityTimeout=setTimeout((()=>{(0,h.unsetNewToolProperties)(),this._floatingToolbar.hide(!0),this._isToolbarRendered()&&this._unmountToolbar(),this._clearProperties(),this._clearCommonButtons()}),0),null===(t=this._lineToolsDoNotAffectChartInvalidation)||void 0===t||t.destroy(),delete this._lineToolsDoNotAffectChartInvalidation,delete this._propertyApplier}templatesList(){return this._templatesList}_onToolChanged(t,e){this._currentTool=t;const o=this.selectedSources();if(this._isDrawingToolExcludingCustomUrlEventTool(t)){if(this._isDrawingFinished.setValue(!1),ft){const o=e instanceof vt.DefaultProperty?e:(0,h.setNewToolProperties)(t,"LineToolIcon"===t?p.iconTool.value():"LineToolEmoji"===t?p.emojiTool.value():void 0,this._chartWidgetCollection.activeChartWidget.value().model().model());this.showPropertiesOf(t,o,e instanceof vt.DefaultProperty),this._showTemplatesOf({tool:t,properties:o}),this._toolbarVisible=!0}this._updateVisibility()}else o&&o.length?(o.length>1&&this._isDrawingFinished.setValue(!0),this.onSourceChanged(this.selectedSources())):this.hide()}_propertyApplierImpl(){return this._propertyApplier||(this._lineToolsDoNotAffectChartInvalidation||(this._lineToolsDoNotAffectChartInvalidation=new wt.FeatureToggleWatchedValue("do_not_invalidate_chart_on_changing_line_tools",!1)),this._propertyApplier=new ht.PropertyApplierWithoutSavingChart((()=>this.activeChartWidget().model()),this._lineToolsDoNotAffectChartInvalidation)),this._propertyApplier}_clearProperties(){this._clearPropertyButtons(),this._lineWidthsProperty&&(this._lineWidthsProperty.destroy(),this._lineWidthsProperty=null),this._lineColorsProperty&&(this._lineColorsProperty.destroy(),this._lineColorsProperty=null),this._currentProperties&&(this._currentProperties=null)}_show(){this._updateVisibilityTimeout&&clearTimeout(this._updateVisibilityTimeout),this._updateVisibilityTimeout=setTimeout((()=>{this._renderToolbar(),this._floatingToolbar.show(),this._floatingToolbar.checkPosition()}),0)}_addPropertyButton(t){this._propertyButtons.push(t),this._renderToolbar()}_addCommonButton(t){this._commonButtons.push(t),this._renderToolbar()}_addTemplatesButton(t){this._templatesButton=t}_renderToolbar(){null!==this._container&&this.activeChartWidget()&&this.activeChartWidget().hasModel()&&(n.render(i.createElement(C,{templateButton:this._templatesButton,propertyButtons:this._propertyButtons,commonButtons:this._commonButtons,isDrawingFinished:this._isDrawingFinished.value(),activeChartWidget:this.activeChartWidget()}),this._container),this._toolbarRendered=!0)}_unmountToolbar(){null!==this._container&&(n.unmountComponentAtNode(this._container),this._toolbarRendered=!1)}_clearTemplatesButton(){this._templatesButton=null}_clearPropertyButtons(){this._propertyButtons=[]}_clearCommonButtons(){this._commonButtons=[]}_isToolbarRendered(){return this._toolbarRendered}_createSettingsButton(){const t={component:P,props:{title:Ct,activeChartWidget:this.activeChartWidget()}}
;this._addCommonButton(t)}_createLockButton(){const t={component:D,props:{title:"Lock",activeChartWidget:this.activeChartWidget()}};this._addCommonButton(t)}_createRemoveButton(){const t={component:O,props:{title:Et,activeChartWidget:this.activeChartWidget()},showForSmallScreen:!0};this._addCommonButton(t)}_createDotsButton(){this._addCommonButton({component:K,props:{title:St,activeChartWidget:this.activeChartWidget()},showForSmallScreen:!0})}_createAlertButton(){}_createSourceActions(){this._createLockButton()}_createLineStyleButton(t){const e=this.selectedSources();if(0===e.length)return!1;const o=e[0];if(!(0,dt.isDataSource)(o))return!1;const i={component:ot,props:{property:o.properties().linestyle||t,title:xt,propertyApplier:this._propertyApplierImpl(),"data-name":"style",undoText:bt}};return this._addPropertyButton(i),!0}_createFontSizeButton(t){const e=this.selectedSources();if(0===e.length)return!1;const o=e[0];if(!(0,dt.isDataSource)(o))return!1;const i={component:st,props:{property:o.properties().fontsize||t,title:Pt,propertyApplier:this._propertyApplierImpl(),"data-name":"font-size",undoText:yt}};return this._addPropertyButton(i),!0}_createCommonButtons(){this._commonButtons.length&&this._clearCommonButtons(),a.enabled("property_pages")&&this._createSettingsButton(),this._createSourceActions(),this._createRemoveButton(),this._createDotsButton()}_prepareProperties(t){const e=this.selectedSources().filter((e=>e.properties()[t]));if(!(e.filter((e=>e.properties()[t].visible())).length<1))return e.map((e=>e.properties()[t])).filter(d.notNull)}_createProperty(t,e,o,i){if(e){const t=this._prepareProperties(o);if(!t)return;return this._isWidthProperty(t[0])?new v(new u.MultipleLineWidthsProperty(t),this._propertyApplierImpl(),i):new w.CollectibleColorPropertyUndoWrapper(new u.MultipleLineColorsProperty(t),this._propertyApplierImpl(),i)}if(t&&t.visible())return this._isWidthProperty(t)?new u.MultipleLineWidthsProperty([t]):new w.CollectibleColorPropertyDirectWrapper(new u.MultipleLineColorsProperty([t]))}_shouldShowBackgroundProperty(t,e){return!e||!e.fillBackground||!!e.fillBackground.value()}_isDrawingToolExcludingCustomUrlEventTool(t){return Boolean(null==t?void 0:t.toLowerCase().includes("linetool"))&&"LineToolTweet"!==t&&"LineToolIdea"!==t&&"LineToolImage"!==t}_updateVisibility(){(ft||this._isDrawingFinished.value())&&(this._toolbarVisible||this._propertiesVisible)?this._show():this.hide()}_showTemplatesOf(t){if(!a.enabled("drawing_templates"))return;if(this._templatesButton&&this._clearTemplatesButton(),!ft)return;let e,o,i,n;if("sources"in t){if(e=t.sources,o=e[0].toolname,i=e[0].properties(),1===e.length){const t=e[0];n=()=>t.template()}}else o=t.tool,i=t.properties;this._templatesList=new pt.LinetoolTemplatesList(o,(t=>{if(e){const o=this.activeChartWidget().model();o.beginUndoMacro(Tt),e.forEach((e=>o.applyLineToolTemplate(e,t,Tt))),o.endUndoMacro(),this.onSourceChanged(e)}else i.mergeAndFire(t),i.saveDefaults(),this._onToolChanged(o,i)})),this._addTemplatesButton({component:gt,props:{key:"Templates",
model:this._templatesList,onSave:n,onRestore:()=>{void 0!==e?this.activeChartWidget().model().restoreLineToolsFactoryDefaults(e):i.restoreFactoryDefaults(),this.refresh()}}})}_isWidthProperty(t){return t instanceof u.LineToolWidthsProperty}}},16143:(t,e,o)=>{"use strict";o.r(e),o.d(e,{LinetoolTemplatesList:()=>d});var i=o(509806),n=o(68969),s=o(368562),r=o(592834),a=o(190266),l=o(153055),c=o(727157);class d{constructor(t,e){this._toolName=t,this._applyTemplate=e,this._templatesDeferred=this._loadData()}getData(){return n.store.getState().templates[this._toolName]}templatesLoaded(){return this._templatesDeferred}loadTemplate(t,e){n.store.dispatch((0,s.loadTemplate)(this._toolName,t,(t=>{this._applyTemplate(t),null==e||e()})))}removeTemplate(t){n.store.dispatch((0,s.startRemoveTemplate)(this._toolName,t))}saveTemplate(t,e){const o=(0,r.clean)(t);n.store.dispatch((0,s.saveTemplate)(this._toolName,o,e))}deleteAction(t){(0,a.runOrSignIn)((()=>{const e=i.t(null,{replace:{name:t}},o(774935));(0,l.showConfirm)({text:e,onConfirm:e=>{this.removeTemplate(t),e.dialogClose()}})}),{source:"Delete line tool template"})}showSaveDialog(t){(0,a.runOrSignIn)((()=>{(0,l.showRename)({title:i.t(null,void 0,o(933751)),text:i.t(null,void 0,o(350912))+":",maxLength:64,source:this.getData()||[],autocompleteFilter:c.autocompleteFilter,onRename:e=>{if(-1!==(this.getData()||[]).indexOf(e.newValue)){const n=i.t(null,{replace:{name:e.newValue}},o(571527));(0,l.showConfirm)({text:n,onConfirm:o=>{t(e.newValue),o.dialogClose(),e.dialogClose()},onClose:e.focusInput},e.innerManager)}else t(e.newValue),e.dialogClose()}})}),{source:"Save line tool template",sourceMeta:"Chart"})}async _loadData(){return new Promise((t=>{this.getData()?t():n.store.dispatch((0,s.getTemplates)(this._toolName,t))}))}}},611389:(t,e,o)=>{"use strict";var i=o(440097).TranslatedString,n=o(123623).LineToolPropertiesWidgetBase;const s=o(523847).ColorPickerButton,r=o(822598).LineWidthButton;var a=o(394071),l=o(621065),c=o(448984),d=new i("change line tool(s) color",o(509806).t(null,void 0,o(368519))),h=new i("change line tool(s) background color",o(509806).t(null,void 0,o(674350))),p=new i("change line tool(s) text color",o(509806).t(null,void 0,o(16631))),u=new i("change line tool(s) line width",o(509806).t(null,void 0,o(141648))),m=o(509806).t(null,void 0,o(940054)),_=o(509806).t(null,void 0,o(712928)),g=o(509806).t(null,void 0,o(319221)),v=o(509806).t(null,void 0,o(121327)),w=o(509806).t(null,void 0,o(938455)),f=o(509806).t(null,void 0,o(671845)),y=o(509806).t(null,void 0,o(832733)),b=o(509806).t(null,void 0,o(23886)),T=o(509806).t(null,void 0,o(286327)),C=o(509806).t(null,void 0,o(447059)),E=o(509806).t(null,void 0,o(36785)),S=o(509806).t(null,void 0,o(749593)),x=o(509806).t(null,void 0,o(867455)),P=o(509806).t(null,void 0,o(179964)),W=o(509806).t(null,void 0,o(745320));class L extends n{constructor(t){super(t),this._templatesButton=null}_createWidthsButton(t,e){if(this._lineWidthsProperty&&(this._lineWidthsProperty.destroy(),this._lineWidthsProperty=null),
this._lineWidthsProperty=this._createProperty(t,e,"linesWidths",u),!this._lineWidthsProperty)return!0;var o=T;e&&(1!==this.selectedSources().filter((t=>t.properties().linesWidths)).length&&(o=C));return this._addPropertyButton({component:r,props:{title:o,multipleProperty:this._lineWidthsProperty,propertyApplier:this._propertyApplierImpl(),"data-name":"line-tool-width",undoText:u}}),!0}_createColorsButton(t,e){return this._lineColorsProperty&&(this._lineColorsProperty.destroy(),this._lineColorsProperty=null),this._lineColorsProperty=this._createProperty(t,e,"linesColors",d),!this._lineColorsProperty||(this._addPropertyButton({component:s,props:{icon:a,title:_,property:this._lineColorsProperty,propertyApplier:this._propertyApplierImpl(),"data-name":"line-tool-color",undoText:d}}),!0)}_createBackgroundsButton(t,e){return this._backgroundsProperty&&(this._backgroundsProperty.destroy(),this._backgroundsProperty=null),this._backgroundsProperty=this._createProperty(t,e,"backgroundsColors",h),!this._backgroundsProperty||(this._addPropertyButton({component:s,props:{icon:l,title:f,property:this._backgroundsProperty,propertyApplier:this._propertyApplierImpl(),"data-name":"background-color",undoText:h}}),!0)}_createTextColorsButton(t,e){return this._textColorsProperty&&(this._textColorsProperty.destroy(),this._textColorsProperty=null),this._textColorsProperty=this._createProperty(t,e,"textsColors",p),!this._textColorsProperty||(this._addPropertyButton({component:s,props:{icon:c,title:v,property:this._textColorsProperty,propertyApplier:this._propertyApplierImpl(),"data-name":"text-color",undoText:p}}),!0)}_getPossibleProperty(t){for(var e=[],o=this._defaultToolProperties(),i=0;i<o.length;i++){var n=o[i];n.name in t&&e.push(n)}return e}showPropertiesOf(t,e,o){this._toolExceptionCases||(this._toolExceptionCases=this._createToolExceptionCases());var i=this._toolExceptionCases[t]||this._getPossibleProperty(e);if(this._clearProperties(),this._propertiesVisible=!1,i.length){for(var n={},r=0;r<i.length;r++){for(var a=i[r],l=e,c=a.name.split("."),d=0;d<c.length;++d)l=l&&l[c[d]];var h=a.showIf;if("function"!=typeof h||h(l,e)){var p=a.factory;if(p&&p.call(this,l,o))continue;if(!l)continue;if(this._propertiesVisible=!0,"combobox"!==a.inputType){const t={component:s,props:{icon:a.iconSvgCode,title:a.title,"data-name":a.dataName,property:l,propertyApplier:this._propertyApplierImpl(),undoText:a.undoText}};this._addPropertyButton(t);continue}n[a.name]=l}}this._currentProperties=n}}_defaultToolProperties(){return[{name:"linesColors",inputType:"colorPicker",iconSvgCode:a,title:m,factory:L.prototype._createColorsButton,dataName:"line-tool-color"},{name:"backgroundsColors",inputType:"colorPicker",iconSvgCode:l,title:w,factory:L.prototype._createBackgroundsButton,dataName:"background-color",showIf:this._shouldShowBackgroundProperty},{name:"textsColors",title:g,inputType:"colorPicker",iconSvgCode:c,factory:L.prototype._createTextColorsButton,dataName:"text-color"},{name:"linesWidths",inputType:"combobox",factory:L.prototype._createWidthsButton},{
name:"linestyle",title:y,inputType:"combobox",factory:L.prototype._createLineStyleButton}]}_regressionToolExceptionCases(){return[{name:"linesWidths",inputType:"combobox",factory:L.prototype._createWidthsButton}]}_pathExceptionCases(){return[{name:"linesColors",inputType:"colorPicker",iconSvgCode:a,title:m,factory:L.prototype._createColorsButton,dataName:"line-tool-color"},{name:"linesWidths",inputType:"combobox",factory:L.prototype._createWidthsButton},{name:"lineStyle",title:y,inputType:"combobox",factory:L.prototype._createLineStyleButton}]}_riskPropertiesExceptionCases(){return[{name:"textcolor",title:g,inputType:"colorPicker",iconSvgCode:c,dataName:"text-color",undoText:p},{name:"profitBackground",title:E,inputType:"colorPicker",iconSvgCode:l,dataName:"background-color",undoText:h},{name:"stopBackground",title:S,inputType:"colorPicker",iconSvgCode:l,dataName:"background-color",undoText:h}]}_rangeExceptionCases(){return[{name:"linecolor",inputType:"colorPicker",iconSvgCode:a,title:m,dataName:"line-tool-color",undoText:d},{name:"backgroundColor",inputType:"colorPicker",iconSvgCode:l,title:w,dataName:"background-color",showIf:this._shouldShowBackgroundProperty,undoText:h},{name:"linesWidths",inputType:"combobox",factory:L.prototype._createWidthsButton}]}_brushPropertiesExceptionCase(){return[{name:"linesColors",inputType:"colorPicker",iconSvgCode:a,title:m,factory:L.prototype._createColorsButton,dataName:"line-tool-color"},{name:"backgroundsColors",inputType:"colorPicker",iconSvgCode:l,title:w,dataName:"background-color",factory:L.prototype._createBackgroundsButton},{name:"linesWidths",inputType:"combobox",factory:L.prototype._createWidthsButton}]}_bezierPropertiesExceptionCases(){return[{name:"linesColors",inputType:"colorPicker",iconSvgCode:a,title:m,factory:L.prototype._createColorsButton,dataName:"line-tool-color"},{name:"backgroundsColors",inputType:"colorPicker",iconSvgCode:l,dataName:"background-color",title:w,factory:L.prototype._createBackgroundsButton,showIf:this._shouldShowBackgroundProperty},{name:"linesWidths",inputType:"combobox",factory:L.prototype._createWidthsButton},{name:"linestyle",title:y,inputType:"combobox",factory:L.prototype._createLineStyleButton}]}_textPropertiesExceptionCases(){return[{name:"color",title:g,inputType:"colorPicker",iconSvgCode:c,dataName:"text-color",undoText:p},{name:"backgroundColor",title:w,inputType:"colorPicker",iconSvgCode:l,dataName:"background-color",showIf:this._shouldShowBackgroundProperty,undoText:h},{name:"fontsize",title:b,inputType:"combobox",factory:L.prototype._createFontSizeButton}]}_notePropertiesExceptionCases(){return[{name:"markerColor",title:x,inputType:"colorPicker",iconSvgCode:a,dataName:"line-tool-color",undoText:d},{name:"textColor",title:g,inputType:"colorPicker",iconSvgCode:c,dataName:"text-color",undoText:p},{name:"fontSize",title:b,inputType:"combobox",factory:L.prototype._createFontSizeButton}]}_createToolExceptionCases(){return{LineToolBrush:L.prototype._brushPropertiesExceptionCase(),
LineToolBezierQuadro:L.prototype._bezierPropertiesExceptionCases(),LineToolBezierCubic:L.prototype._bezierPropertiesExceptionCases(),LineToolText:L.prototype._textPropertiesExceptionCases(),LineToolTextAbsolute:L.prototype._textPropertiesExceptionCases(),LineToolBalloon:L.prototype._textPropertiesExceptionCases(),LineToolComment:L.prototype._textPropertiesExceptionCases(),LineToolCallout:L.prototype._textPropertiesExceptionCases(),LineToolPriceLabel:L.prototype._textPropertiesExceptionCases(),LineToolDateRange:L.prototype._rangeExceptionCases(),LineToolPriceRange:L.prototype._rangeExceptionCases(),LineToolDateAndPriceRange:L.prototype._rangeExceptionCases(),LineToolNote:L.prototype._notePropertiesExceptionCases(),LineToolNoteAbsolute:L.prototype._notePropertiesExceptionCases(),LineToolRiskRewardLong:L.prototype._riskPropertiesExceptionCases(),LineToolRiskRewardShort:L.prototype._riskPropertiesExceptionCases(),LineToolPath:L.prototype._pathExceptionCases(),LineToolRegressionTrend:L.prototype._regressionToolExceptionCases(),LineToolBarsPattern:[{name:"color",title:m,inputType:"colorPicker",iconSvgCode:l,dataName:"background-color",undoText:d}],LineToolProjection:[{name:"color1",title:P,inputType:"colorPicker",iconSvgCode:l,dataName:"background-color",undoText:h},{name:"color2",title:W,inputType:"colorPicker",iconSvgCode:l,dataName:"background-color",undoText:h},{name:"linesWidths",inputType:"combobox",factory:L.prototype._createWidthsButton}],LineToolSignpost:[{name:"linesColors",inputType:"colorPicker",iconSvgCode:l,dataName:"background-color",title:m,factory:L.prototype._createBackgroundsButton,showIf:function(t,e){return e&&e.showImage.value()}},{name:"fontSize",title:b,inputType:"combobox",factory:L.prototype._createFontSizeButton}]}}}t.exports=L},368562:(t,e,o)=>{"use strict";o.d(e,{getTemplates:()=>n,setTemplates:()=>s,addTemplate:()=>r,startRemoveTemplate:()=>a,removeTemplate:()=>l,saveTemplate:()=>c,loadTemplate:()=>d});var i=o(859251);function n(t,e){return{type:i.GET_TEMPLATES,toolName:t,callback:e}}function s(t,e){return{type:i.SET_TEMPLATES,templates:e,toolName:t}}function r(t,e){return{type:i.ADD_TEMPLATE,templateName:e,toolName:t}}function a(t,e){return{type:i.START_REMOVE_TEMPLATE,templateName:e,toolName:t}}function l(t,e){return{type:i.REMOVE_TEMPLATE,templateName:e,toolName:t}}function c(t,e,o){return{type:i.SAVE_TEMPLATE,templateName:e,toolName:t,content:o}}function d(t,e,o){return{type:i.LOAD_TEMPLATE,toolName:t,templateName:e,callback:o}}},859251:(t,e,o)=>{"use strict";function i(t){return"LINE_TOOL_TEMPLATE__"+t}o.d(e,{GET_TEMPLATES:()=>n,SET_TEMPLATES:()=>s,START_REMOVE_TEMPLATE:()=>r,REMOVE_TEMPLATE:()=>a,SAVE_TEMPLATE:()=>l,ADD_TEMPLATE:()=>c,LOAD_TEMPLATE:()=>d});const n=i("GET_TEMPLATES"),s=i("SET_TEMPLATES"),r=i("START_REMOVE_TEMPLATE"),a=i("REMOVE_TEMPLATE"),l=i("SAVE_TEMPLATE"),c=i("ADD_TEMPLATE"),d=i("LOAD_TEMPLATE")},68969:(t,e,o)=>{"use strict";o.d(e,{store:()=>T});var i=o(691622),n=o(254773),s=o(336349),r=o(650151),a=o(859251),l=o(817808),c=o(368562);function d(t,e){return e}
var h=o(646846);const p=(0,l.getLogger)("Chart.LineToolTemplatesList");function u(t,e){return e}function*m(){for(;;){const{toolName:t,templateName:e,content:o}=u(a.SAVE_TEMPLATE,yield(0,s.take)(a.SAVE_TEMPLATE));try{yield(0,s.call)(h.backend.saveDrawingTemplate,t,e,o),yield(0,s.put)((0,c.addTemplate)(t,e))}catch(t){p.logWarn(t)}}}function*_(){for(;;){const{toolName:t,templateName:e}=u(a.START_REMOVE_TEMPLATE,yield(0,s.take)(a.START_REMOVE_TEMPLATE));try{yield(0,s.call)(h.backend.removeDrawingTemplate,t,e),yield(0,s.put)((0,c.removeTemplate)(t,e))}catch(t){p.logWarn(t)}}}function*g(){const t=new Map;for(;;){const{toolName:o,callback:i}=u(a.GET_TEMPLATES,yield(0,s.take)(a.GET_TEMPLATES));t.has(o)?(0,r.ensureDefined)(t.get(o)).push(i):(t.set(o,[i]),yield(0,s.fork)(e,o))}function*e(e){try{const t=d(h.backend.getDrawingTemplates,yield(0,s.call)(h.backend.getDrawingTemplates,e));yield(0,s.put)((0,c.setTemplates)(e,t))}catch(t){p.logWarn(t)}(0,r.ensureDefined)(t.get(e)).forEach((t=>null==t?void 0:t())),t.delete(e)}}function*v(){for(;;){const{toolName:t,templateName:e,callback:o}=u(a.LOAD_TEMPLATE,yield(0,s.take)(a.LOAD_TEMPLATE));try{const i=d(h.backend.loadDrawingTemplate,yield(0,s.call)(h.backend.loadDrawingTemplate,t,e));o&&o(i)}catch(t){p.logWarn(t)}}}function*w(){yield(0,s.all)([(0,s.call)(g),(0,s.call)(m),(0,s.call)(_),(0,s.call)(v)])}const f={templates:{}};function y(t,e){return t.localeCompare(e,void 0,{numeric:!0})}function b(t=f,e){switch(e.type){case a.ADD_TEMPLATE:{const{toolName:o,templateName:i}=e;if(!t.templates[o].includes(i)){const e=[...t.templates[o],i].sort(y);return{...t,templates:{...t.templates,[o]:e}}}return t}case a.SET_TEMPLATES:{const{toolName:o,templates:i}=e;return{...t,templates:{...t.templates,[o]:[...i].sort(y)}}}case a.REMOVE_TEMPLATE:{const{toolName:o,templateName:i}=e;return{...t,templates:{...t.templates,[o]:t.templates[o].filter((t=>t!==i))}}}default:return t}}const T=function(){const t=(0,n.default)(),e=(0,i.createStore)(b,(0,i.applyMiddleware)(t));return t.run(w),e}()},357291:(t,e,o)=>{"use strict";o.d(e,{CollectibleColorPropertyUndoWrapper:()=>a,CollectibleColorPropertyDirectWrapper:()=>l});var i=o(650151),n=o(976704),s=o.n(n);class r extends(s()){constructor(t){super(),this._listenersMappers=[],this._isProcess=!1,this._baseProperty=t}destroy(){this._baseProperty.destroy()}value(){const t=this._baseProperty.value();return"mixed"===t?"":t}visible(){return this._baseProperty.visible()}setValue(t){this._isProcess=!0,this._baseProperty.setValue(""===t?"mixed":t,void 0,{applyValue:this._applyValue.bind(this)}),this._isProcess=!1,this._listenersMappers.forEach((t=>{t.method.call(t.obj,this)}))}subscribe(t,e){const o=o=>{this._isProcess||e.call(t,this)},i={obj:t,method:e,callback:o};this._listenersMappers.push(i),this._baseProperty.subscribe(t,o)}unsubscribe(t,e){var o;const n=(0,i.ensureDefined)(null===(o=this._listenersMappers.find((o=>o.obj===t&&o.method===e)))||void 0===o?void 0:o.callback);this._baseProperty.unsubscribe(t,n)}unsubscribeAll(t){this._baseProperty.unsubscribeAll(t)}}
class a extends r{constructor(t,e,o){super(t),this._propertyApplier=e,this._undoText=o}_applyValue(t,e){this._propertyApplier.setProperty(t,e,this._undoText)}}class l extends r{_applyValue(t,e){t.setValue(e)}}},40813:(t,e,o)=>{"use strict";o.d(e,{PropertyApplierWithoutSavingChart:()=>i});class i{constructor(t,e){this._undoModelSupplier=t,this._featureToggle=e}setProperty(t,e,o){this._undoModelSupplier().setProperty(t,e,o,this._featureToggle.value())}beginUndoMacro(t){return this._undoModelSupplier().beginUndoMacro(t,this._shouldWeKeepChartValidated())}endUndoMacro(){this._undoModelSupplier().endUndoMacro()}setWatchedValue(t,e,o){this._undoModelSupplier().undoHistory().setWatchedValue(t,e,o,!0)}_shouldWeKeepChartValidated(){const t=this._undoModelSupplier().model().isAutoSaveEnabled().value();return this._featureToggle.value()&&t}}},727157:(t,e,o)=>{"use strict";function i(t,e){return Boolean(""===t||t&&-1!==e.toLowerCase().indexOf(t.toLowerCase()))}o.d(e,{autocompleteFilter:()=>i})},100578:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 8" width="16" height="8"><path fill="currentColor" d="M0 1.475l7.396 6.04.596.485.593-.49L16 1.39 14.807 0 7.393 6.122 8.58 6.12 1.186.08z"/></svg>'},844996:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none"><path fill="currentColor" fillRule="evenodd" clipRule="evenodd" d="M7.5 13a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM5 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM12 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM19 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0z"/></svg>'},123851:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentColor" d="M4 13h5v1H4v-1zM12 13h5v1h-5v-1zM20 13h5v1h-5v-1z"/></svg>'},357740:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor"><circle cx="9" cy="14" r="1"/><circle cx="4" cy="14" r="1"/><circle cx="14" cy="14" r="1"/><circle cx="19" cy="14" r="1"/><circle cx="24" cy="14" r="1"/></svg>'},200501:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path stroke="currentColor" d="M4 13.5h20"/></svg>'},636296:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none"><path stroke="currentColor" d="M8 9.5H6.5a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1V20m-8-1.5h11a1 1 0 0 0 1-1v-11a1 1 0 0 0-1-1h-11a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1z"/></svg>'},621065:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" fill="none"><path stroke="currentColor" d="M13.5 6.5l-3-3-7 7 7.59 7.59a2 2 0 0 0 2.82 0l4.18-4.18a2 2 0 0 0 0-2.82L13.5 6.5zm0 0v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v6"/><path fill="currentColor" d="M0 16.5C0 15 2.5 12 2.5 12S5 15 5 16.5 4 19 2.5 19 0 18 0 16.5z"/><circle fill="currentColor" cx="9.5" cy="9.5" r="1.5"/></svg>'},25388:t=>{
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 12" width="8" height="12" fill="currentColor"><rect width="2" height="2" rx="1"/><rect width="2" height="2" rx="1" y="5"/><rect width="2" height="2" rx="1" y="10"/><rect width="2" height="2" rx="1" x="6"/><rect width="2" height="2" rx="1" x="6" y="5"/><rect width="2" height="2" rx="1" x="6" y="10"/></svg>'},222978:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 1" width="18" height="1"><rect width="18" height="1" fill="currentColor" rx=".5"/></svg>'},114631:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 2" width="18" height="2"><rect width="18" height="2" fill="currentColor" rx="1"/></svg>'},206096:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 3" width="18" height="3"><rect width="18" height="3" fill="currentColor" rx="1.5"/></svg>'},206483:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 4" width="18" height="4"><rect width="18" height="4" fill="currentColor" rx="2"/></svg>'},266611:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor"><rect width="18" height="2" rx="1" x="5" y="14"/><rect width="18" height="1" rx=".5" x="5" y="20"/><rect width="18" height="3" rx="1.5" x="5" y="7"/></svg>'},394071:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17" fill="none"><path stroke="currentColor" d="M1.5 11.5l-.7.7a1 1 0 0 0-.3.71v3.59h3.59a1 1 0 0 0 .7-.3l.71-.7m-4-4l9-9m-9 9l2 2m2 2l9-9m-9 9l-2-2m11-7l1.3-1.3a1 1 0 0 0 0-1.4l-2.6-2.6a1 1 0 0 0-1.4 0l-1.3 1.3m4 4l-4-4m-7 11l9-9"/></svg>'},608280:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none" stroke="currentColor"><path stroke-linecap="round" d="M15.5 18.5h6m-3 3v-6"/><rect width="6" height="6" rx="1.5" x="6.5" y="6.5"/><rect width="6" height="6" rx="1.5" x="15.5" y="6.5"/><rect width="6" height="6" rx="1.5" x="6.5" y="15.5"/></svg>'},448984:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 13 15" width="13" height="15" fill="none"><path stroke="currentColor" d="M4 14.5h2.5m2.5 0H6.5m0 0V.5m0 0h-5a1 1 0 0 0-1 1V4m6-3.5h5a1 1 0 0 1 1 1V4"/></svg>'},561964:t=>{
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentcolor" fill-rule="evenodd" clip-rule="evenodd" d="M13 5.5c0-.28.22-.5.5-.5h1c.28 0 .5.22.5.5V7.05l.4.09c.9.18 1.73.53 2.46 1.02l.34.23.29-.3.81-.8c.2-.2.52-.2.71 0l.7.7.36-.35-.35.35c.2.2.2.51 0 .7l-.82.82-.29.29.23.34c.49.73.84 1.57 1.02 2.46l.08.4H22.5c.28 0 .5.22.5.5v1a.5.5 0 0 1-.5.5H20.95l-.09.4c-.18.9-.53 1.73-1.02 2.46l-.23.34.3.29.8.81c.2.2.2.52 0 .71l-.7.7a.5.5 0 0 1-.7 0l-.82-.8-.29-.3-.34.23c-.73.49-1.57.84-2.46 1.02l-.4.08V22.5a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5V20.95l-.4-.09a6.96 6.96 0 0 1-2.46-1.02l-.34-.23-.29.3-.81.8.35.36-.35-.35a.5.5 0 0 1-.71 0l-.7-.71a.5.5 0 0 1 0-.7l-.36-.36.35.35.82-.81.29-.29-.23-.34a6.96 6.96 0 0 1-1.02-2.46l-.08-.4H5.5a.5.5 0 0 1-.5-.5v-1c0-.28.22-.5.5-.5H7.05l.09-.4c.18-.9.53-1.73 1.02-2.46l.23-.34-.3-.29-.8-.81a.5.5 0 0 1 0-.71l.7-.7c.2-.2.51-.2.7 0l.82.8.29.3.34-.23a6.96 6.96 0 0 1 2.46-1.02l.4-.08V5.5zm.5-1.5c-.83 0-1.5.67-1.5 1.5v.75c-.73.2-1.43.48-2.06.86l-.54-.53a1.5 1.5 0 0 0-2.12 0l-.7.7a1.5 1.5 0 0 0 0 2.12l.53.54A7.95 7.95 0 0 0 6.25 12H5.5c-.83 0-1.5.67-1.5 1.5v1c0 .83.67 1.5 1.5 1.5h.75c.2.73.48 1.43.86 2.06l-.53.54a1.5 1.5 0 0 0 0 2.12l.7.7a1.5 1.5 0 0 0 2.12 0l.54-.53c.63.38 1.33.67 2.06.86v.75c0 .83.67 1.5 1.5 1.5h1c.83 0 1.5-.67 1.5-1.5v-.75a7.95 7.95 0 0 0 2.06-.86l.54.53a1.5 1.5 0 0 0 2.12 0l.7-.7a1.5 1.5 0 0 0 0-2.12l-.53-.54c.38-.63.67-1.33.86-2.06h.75c.83 0 1.5-.67 1.5-1.5v-1c0-.83-.67-1.5-1.5-1.5h-.75a7.95 7.95 0 0 0-.86-2.06l.53-.54a1.5 1.5 0 0 0 0-2.12l-.7-.7a1.5 1.5 0 0 0-2.12 0l-.54.53A7.95 7.95 0 0 0 16 6.25V5.5c0-.83-.67-1.5-1.5-1.5h-1zM12 14a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm2-3a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"/></svg>'}}]);