(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[7636],{259142:function(e,t){var i,s,o;s=[t],i=function(e){"use strict";function t(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}Object.defineProperty(e,"__esModule",{value:!0});var i=!1;if("undefined"!=typeof window){var s={get passive(){i=!0}};window.addEventListener("testPassive",null,s),window.removeEventListener("testPassive",null,s)}var o="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),n=[],r=!1,a=-1,l=void 0,d=void 0,c=function(e){return n.some((function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))}))},u=function(e){var t=e||window.event;return!!c(t.target)||1<t.touches.length||(t.preventDefault&&t.preventDefault(),!1)},h=function(){setTimeout((function(){void 0!==d&&(document.body.style.paddingRight=d,d=void 0),void 0!==l&&(document.body.style.overflow=l,l=void 0)}))};e.disableBodyScroll=function(e,s){if(o){if(!e)return void console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");if(e&&!n.some((function(t){return t.targetElement===e}))){var h={targetElement:e,options:s||{}};n=[].concat(t(n),[h]),e.ontouchstart=function(e){1===e.targetTouches.length&&(a=e.targetTouches[0].clientY)},e.ontouchmove=function(t){var i,s,o,n;1===t.targetTouches.length&&(s=e,n=(i=t).targetTouches[0].clientY-a,!c(i.target)&&(s&&0===s.scrollTop&&0<n||(o=s)&&o.scrollHeight-o.scrollTop<=o.clientHeight&&n<0?u(i):i.stopPropagation()))},r||(document.addEventListener("touchmove",u,i?{passive:!1}:void 0),r=!0)}}else{_=s,setTimeout((function(){if(void 0===d){var e=!!_&&!0===_.reserveScrollBarGap,t=window.innerWidth-document.documentElement.clientWidth;e&&0<t&&(d=document.body.style.paddingRight,document.body.style.paddingRight=t+"px")}void 0===l&&(l=document.body.style.overflow,document.body.style.overflow="hidden")}));var m={targetElement:e,options:s||{}};n=[].concat(t(n),[m])}var _},e.clearAllBodyScrollLocks=function(){o?(n.forEach((function(e){e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null})),r&&(document.removeEventListener("touchmove",u,i?{passive:!1}:void 0),r=!1),n=[],a=-1):(h(),n=[])},e.enableBodyScroll=function(e){if(o){if(!e)return void console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");e.ontouchstart=null,e.ontouchmove=null,n=n.filter((function(t){return t.targetElement!==e})),r&&0===n.length&&(document.removeEventListener("touchmove",u,i?{passive:!1}:void 0),r=!1)}else 1===n.length&&n[0].targetElement===e?(h(),n=[]):n=n.filter((function(t){return t.targetElement!==e}))}},void 0===(o="function"==typeof i?i.apply(t,s):i)||(e.exports=o)},150408:e=>{e.exports={}},946587:e=>{e.exports={wrapper:"wrapper-bUw_gKIQ",input:"input-bUw_gKIQ",box:"box-bUw_gKIQ",icon:"icon-bUw_gKIQ",noOutline:"noOutline-bUw_gKIQ","intent-danger":"intent-danger-bUw_gKIQ",
check:"check-bUw_gKIQ",dot:"dot-bUw_gKIQ"}},794090:e=>{e.exports={checkbox:"checkbox-pJWVW1z6",reverse:"reverse-pJWVW1z6",label:"label-pJWVW1z6",baseline:"baseline-pJWVW1z6"}},16896:e=>{e.exports={container:"container-eWp989Bq"}},309807:e=>{e.exports={wrapper:"wrapper-WhfOeAKH",button:"button-WhfOeAKH",position:"position-WhfOeAKH",buy:"buy-WhfOeAKH",sell:"sell-WhfOeAKH",pl:"pl-WhfOeAKH",profit:"profit-WhfOeAKH",loss:"loss-WhfOeAKH"}},234952:e=>{e.exports={headerWrapper:"headerWrapper-VLOLIP0X",header:"header-VLOLIP0X",customField:"customField-VLOLIP0X",duration:"duration-VLOLIP0X",arrow:"arrow-VLOLIP0X",upperCase:"upperCase-VLOLIP0X",textBlock:"textBlock-VLOLIP0X",summaryLine:"summaryLine-VLOLIP0X"}},171827:e=>{e.exports={wrapper:"wrapper-OuTXqV9S",title:"title-OuTXqV9S"}},597800:e=>{e.exports={upperBlock:"upperBlock-i_ck_NUH",bottomBlock:"bottomBlock-i_ck_NUH"}},204396:e=>{e.exports={widgetcolumnwidthbuysell:"62px",widgetcolumnwidthmiddle:"70px",widgetcolumnwidthorders:"56px",widgetordertypeheight:"10px",widgetborderwidth:"1px",widgetrowheight:"20px","tv-dome-widget-main":"tv-dome-widget-main-uv4cFTXG","tv-dome-widget-main__anchor":"tv-dome-widget-main__anchor-uv4cFTXG","tv-dome-widget-main__row":"tv-dome-widget-main__row-uv4cFTXG","tv-dome-widget-main__value":"tv-dome-widget-main__value-uv4cFTXG","tv-dome-widget-main__value--price":"tv-dome-widget-main__value--price-uv4cFTXG","tv-dome-widget-main__value--highlighted":"tv-dome-widget-main__value--highlighted-uv4cFTXG","tv-dome-widget-main__value--long-position":"tv-dome-widget-main__value--long-position-uv4cFTXG","tv-dome-widget-main__value--short-position":"tv-dome-widget-main__value--short-position-uv4cFTXG","tv-dome-widget-main__value--buy":"tv-dome-widget-main__value--buy-uv4cFTXG","tv-dome-widget-main__value--sell":"tv-dome-widget-main__value--sell-uv4cFTXG","tv-dome-widget-main__value--orders-buy":"tv-dome-widget-main__value--orders-buy-uv4cFTXG","tv-dome-widget-main__value--orders-sell":"tv-dome-widget-main__value--orders-sell-uv4cFTXG","tv-dome-widget-main__value--color-bid":"tv-dome-widget-main__value--color-bid-uv4cFTXG","tv-dome-widget-main__value--color-ask":"tv-dome-widget-main__value--color-ask-uv4cFTXG","tv-dome-widget-main__label":"tv-dome-widget-main__label-uv4cFTXG","tv-dome-widget-main__label--active":"tv-dome-widget-main__label--active-uv4cFTXG","tv-dome-widget-main__meter":"tv-dome-widget-main__meter-uv4cFTXG","tv-dome-widget-main__meter--buy":"tv-dome-widget-main__meter--buy-uv4cFTXG","tv-dome-widget-main__meter--buy-active":"tv-dome-widget-main__meter--buy-active-uv4cFTXG","tv-dome-widget-main__meter--sell":"tv-dome-widget-main__meter--sell-uv4cFTXG","tv-dome-widget-main__meter--sell-active":"tv-dome-widget-main__meter--sell-active-uv4cFTXG","tv-dome-widget-main__value-readout":"tv-dome-widget-main__value-readout-uv4cFTXG","tv-dome-widget-main__offscreen-arrow":"tv-dome-widget-main__offscreen-arrow-uv4cFTXG","tv-dome-widget-main__offscreen-arrow--higher":"tv-dome-widget-main__offscreen-arrow--higher-uv4cFTXG",
"tv-dome-widget-main__offscreen-arrow--lower":"tv-dome-widget-main__offscreen-arrow--lower-uv4cFTXG","tv-dome-widget-main__order":"tv-dome-widget-main__order-uv4cFTXG","tv-dome-widget-main__order--collapsed":"tv-dome-widget-main__order--collapsed-uv4cFTXG","tv-dome-widget-main__drag-shield":"tv-dome-widget-main__drag-shield-uv4cFTXG","tv-dome-widget-main__drag-shield--order":"tv-dome-widget-main__drag-shield--order-uv4cFTXG","tv-dome-widget-main__hidden":"tv-dome-widget-main__hidden-uv4cFTXG"}},368156:e=>{e.exports={widgetcolumnwidthbuysell:"62px",widgetcolumnwidthmiddle:"70px",widgetborderwidth:"1px",widgetyellow:"#ffc84a","tv-dome-widget-nav":"tv-dome-widget-nav-EkWKwrVZ","tv-dome-widget-nav__button-block":"tv-dome-widget-nav__button-block-EkWKwrVZ","tv-dome-widget-nav__button-block--price":"tv-dome-widget-nav__button-block--price-EkWKwrVZ","tv-dome-widget-nav__button-block--orders":"tv-dome-widget-nav__button-block--orders-EkWKwrVZ","tv-dome-widget-nav__button":"tv-dome-widget-nav__button-EkWKwrVZ","tv-dome-widget-nav__button--clear-ask":"tv-dome-widget-nav__button--clear-ask-EkWKwrVZ","tv-dome-widget-nav__button--clear-bid":"tv-dome-widget-nav__button--clear-bid-EkWKwrVZ","tv-dome-widget-nav__button--disabled":"tv-dome-widget-nav__button--disabled-EkWKwrVZ","tv-dome-widget-nav__button--center":"tv-dome-widget-nav__button--center-EkWKwrVZ","tv-dome-widget-nav_center":"tv-dome-widget-nav_center-EkWKwrVZ","tv-dome-widget-nav_overall-volume":"tv-dome-widget-nav_overall-volume-EkWKwrVZ","tv-dome-widget-nav_overall-volume--ask":"tv-dome-widget-nav_overall-volume--ask-EkWKwrVZ","tv-dome-widget-nav_overall-volume--bid":"tv-dome-widget-nav_overall-volume--bid-EkWKwrVZ","tv-dome-widget-nav_count-volume":"tv-dome-widget-nav_count-volume-EkWKwrVZ","tv-dome-widget-nav__timer":"tv-dome-widget-nav__timer-EkWKwrVZ"}},892180:e=>{e.exports={widgetordertypeheight:"10px",widgetrowheight:"20px",widgetborderwidth:"1px",widgetyellow:"#ffc84a","tv-dome-widget-order":"tv-dome-widget-order-JH6m1O_M","tv-dome-widget-order--ghost":"tv-dome-widget-order--ghost-JH6m1O_M","tv-dome-widget-order--inactive":"tv-dome-widget-order--inactive-JH6m1O_M","tv-dome-widget-order--type-stop":"tv-dome-widget-order--type-stop-JH6m1O_M","tv-dome-widget-order__close":"tv-dome-widget-order__close-JH6m1O_M","tv-dome-widget-order--type-stoplimit":"tv-dome-widget-order--type-stoplimit-JH6m1O_M","tv-dome-widget-order--highlighted":"tv-dome-widget-order--highlighted-JH6m1O_M","tv-dome-widget-order--buy":"tv-dome-widget-order--buy-JH6m1O_M","tv-dome-widget-order--notcanceled":"tv-dome-widget-order--notcanceled-JH6m1O_M","tv-dome-widget-order__qty":"tv-dome-widget-order__qty-JH6m1O_M","tv-dome-widget-order--immovable":"tv-dome-widget-order--immovable-JH6m1O_M","tv-dome-widget-order--unmodified":"tv-dome-widget-order--unmodified-JH6m1O_M","tv-dome-widget-order__type":"tv-dome-widget-order__type-JH6m1O_M"}},28830:e=>{e.exports={widgetcolumnwidthbuysell:"62px",widgetcolumnwidthmiddle:"70px",widgetcolumnwidthorders:"56px",widgetborderwidth:"1px",
"tv-dome-panel":"tv-dome-panel-mzbDkMCN","tv-dome-panel__header":"tv-dome-panel__header-mzbDkMCN","tv-dome-panel__header-title":"tv-dome-panel__header-title-mzbDkMCN","tv-dome-panel__header-symbol":"tv-dome-panel__header-symbol-mzbDkMCN","tv-dome-panel__header-exchange":"tv-dome-panel__header-exchange-mzbDkMCN","tv-dome-panel__header-close":"tv-dome-panel__header-close-mzbDkMCN","tv-dome-panel__header-warning":"tv-dome-panel__header-warning-mzbDkMCN","tv-dome-panel__header-warning--active":"tv-dome-panel__header-warning--active-mzbDkMCN","tv-dome-panel__content":"tv-dome-panel__content-mzbDkMCN","tv-dome-panel__warning":"tv-dome-panel__warning-mzbDkMCN","tv-dome-panel__no-data-notice":"tv-dome-panel__no-data-notice-mzbDkMCN","tv-dome-panel__disabled":"tv-dome-panel__disabled-mzbDkMCN","tv-dome-panel__disabled-warning":"tv-dome-panel__disabled-warning-mzbDkMCN",mainblock:"mainblock-mzbDkMCN"}},396437:e=>{e.exports={wrapper:"wrapper-_gd_SWmf",marketBlock:"marketBlock-_gd_SWmf",tradingActionBlock:"tradingActionBlock-_gd_SWmf",container:"container-_gd_SWmf",row:"row-_gd_SWmf",button:"button-_gd_SWmf",buttonOrdinary:"buttonOrdinary-_gd_SWmf button-_gd_SWmf",buttonBuy:"buttonBuy-_gd_SWmf button-_gd_SWmf",buttonSell:"buttonSell-_gd_SWmf button-_gd_SWmf"}},253378:e=>{e.exports={wrapper:"wrapper-IFe0dt5g",help:"help-IFe0dt5g"}},684202:e=>{e.exports={"tablet-small-breakpoint":"screen and (max-width: 430px)",menuButton:"menuButton-U8VXuVpD",select:"select-U8VXuVpD",selectMenu:"selectMenu-U8VXuVpD",title:"title-U8VXuVpD",titleWithError:"titleWithError-U8VXuVpD"}},383241:e=>{e.exports={wrapper:"wrapper-Fe4_Wrqf",select:"select-Fe4_Wrqf",selectMenu:"selectMenu-Fe4_Wrqf",dateTimePickerWrapper:"dateTimePickerWrapper-Fe4_Wrqf",dateTimePickerInput:"dateTimePickerInput-Fe4_Wrqf",focused:"focused-Fe4_Wrqf",icon:"icon-Fe4_Wrqf",title:"title-Fe4_Wrqf"}},421937:e=>{e.exports={wrapper:"wrapper-o_DoQ7J4",title:"title-o_DoQ7J4",dateTimeWrapper:"dateTimeWrapper-o_DoQ7J4",mobileDateTimeWrapper:"mobileDateTimeWrapper-o_DoQ7J4",mobilePickerControl:"mobilePickerControl-o_DoQ7J4",mobileDateInputContainer:"mobileDateInputContainer-o_DoQ7J4",mobileDateInput:"mobileDateInput-o_DoQ7J4",mobileDateInputIcon:"mobileDateInputIcon-o_DoQ7J4",timeInput:"timeInput-o_DoQ7J4",buttonWrapper:"buttonWrapper-o_DoQ7J4",button:"button-o_DoQ7J4"}},404096:e=>{e.exports={icon:"icon-WK28_Sxa",button:"button-WK28_Sxa",wrapper:"wrapper-WK28_Sxa",infoContainer:"infoContainer-WK28_Sxa",title:"title-WK28_Sxa",link:"link-WK28_Sxa",text:"text-WK28_Sxa"}},220423:e=>{e.exports={delayedDataTitleColor:"#F57C00",batsQuotesTitleColor:"#C2185B",header:"header-nn4qdFML",wrapper:"wrapper-nn4qdFML",text:"text-nn4qdFML",button:"button-nn4qdFML",settingsButton:"settingsButton-nn4qdFML button-nn4qdFML",settingsPopupMenu:"settingsPopupMenu-nn4qdFML",delayedDataIcon:"delayedDataIcon-nn4qdFML",batsQuotesIcon:"batsQuotesIcon-nn4qdFML"}},945966:e=>{e.exports={"default-drawer-min-top-distance":"100px",wrap:"wrap-yBUNQyVA",positionBottom:"positionBottom-yBUNQyVA",backdrop:"backdrop-yBUNQyVA",
drawer:"drawer-yBUNQyVA",positionLeft:"positionLeft-yBUNQyVA"}},952955:e=>{e.exports={"info-icon":"info-icon-YlhRm8KA","size-s":"size-s-YlhRm8KA","size-m":"size-m-YlhRm8KA","info-icon-wrap":"info-icon-wrap-YlhRm8KA"}},181621:e=>{e.exports={checkbox:"checkbox-h77ElFIj"}},190948:e=>{e.exports={icon:"icon-XIHzWm6B",dropped:"dropped-XIHzWm6B"}},408323:(e,t,i)=>{"use strict";i.d(t,{CheckboxInput:()=>d});var s=i(50959),o=i(497754),n=i(72571),r=i(465890),a=i(946587),l=i.n(a);function d(e){const t=o(l().box,l()[`intent-${e.intent}`],{[l().check]:!Boolean(e.indeterminate),[l().dot]:Boolean(e.indeterminate),[l().noOutline]:-1===e.tabIndex}),i=o(l().wrapper,e.className);return s.createElement("span",{className:i,title:e.title,style:e.style},s.createElement("input",{id:e.id,tabIndex:e.tabIndex,className:l().input,type:"checkbox",name:e.name,checked:e.checked,disabled:e.disabled,value:e.value,autoFocus:e.autoFocus,role:e.role,onChange:function(){e.onChange&&e.onChange(e.value)},ref:e.reference,"aria-required":e["aria-required"]}),s.createElement("span",{className:t},s.createElement(n.Icon,{icon:r,className:l().icon})))}},302946:(e,t,i)=>{"use strict";i.d(t,{Checkbox:()=>d});var s=i(50959),o=i(497754),n=i(732834),r=i(408323),a=i(794090),l=i.n(a);class d extends s.PureComponent{render(){const{inputClassName:e,labelClassName:t,...i}=this.props,n=o(this.props.className,l().checkbox,{[l().reverse]:Boolean(this.props.labelPositionReverse),[l().baseline]:Boolean(this.props.labelAlignBaseline)}),a=o(l().label,t,{[l().disabled]:this.props.disabled});let d=null;return this.props.label&&(d=s.createElement("span",{className:a,title:this.props.title},this.props.label)),s.createElement("label",{className:n},s.createElement(r.CheckboxInput,{...i,className:e}),d)}}d.defaultProps={value:"on"};(0,n.makeSwitchGroupItem)(d)},732834:(e,t,i)=>{"use strict";i.d(t,{SwitchGroup:()=>n,makeSwitchGroupItem:()=>r});var s=i(50959),o=i(719036);class n extends s.PureComponent{constructor(){super(...arguments),this._subscriptions=new Set,this._getName=()=>this.props.name,this._getValues=()=>this.props.values,this._getOnChange=()=>this.props.onChange,this._subscribe=e=>{this._subscriptions.add(e)},this._unsubscribe=e=>{this._subscriptions.delete(e)}}getChildContext(){return{switchGroupContext:{getName:this._getName,getValues:this._getValues,getOnChange:this._getOnChange,subscribe:this._subscribe,unsubscribe:this._unsubscribe}}}render(){return this.props.children}componentDidUpdate(e){this._notify(this._getUpdates(this.props.values,e.values))}_notify(e){this._subscriptions.forEach((t=>t(e)))}_getUpdates(e,t){return[...t,...e].filter((i=>t.includes(i)?!e.includes(i):e.includes(i)))}}function r(e){var t;return t=class extends s.PureComponent{constructor(){super(...arguments),this._onChange=e=>{this.context.switchGroupContext.getOnChange()(e)},this._onUpdate=e=>{e.includes(this.props.value)&&this.forceUpdate()}}componentDidMount(){this.context.switchGroupContext.subscribe(this._onUpdate)}render(){return s.createElement(e,{...this.props,name:this._getName(),
onChange:this._onChange,checked:this._isChecked()})}componentWillUnmount(){this.context.switchGroupContext.unsubscribe(this._onUpdate)}_getName(){return this.context.switchGroupContext.getName()}_isChecked(){return this.context.switchGroupContext.getValues().includes(this.props.value)}},t.contextTypes={switchGroupContext:o.any.isRequired},t}n.childContextTypes={switchGroupContext:o.any.isRequired}},616090:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DomePanel:()=>Xe});var s,o=i(500962),n=i(50959),r=i(509806),a=i(210596),l=i.n(a),d=i(947488),c=i(650151),u=i(688401),h=i(870122),m=i(181436),_=i(218954),p=i(960521),g=i.n(p),v=i(159255),b=i(128943),w=i(821737),f=i(609781),y=i(212775),k=i(710567),x=i(282926),I=i(488563),C=i(79581),S=i(842974);!function(e){e[e.Inside=0]="Inside",e[e.Lower=1]="Lower",e[e.Higher=2]="Higher"}(s||(s={}));var T=i(737538),P=i(66568),D=i(180185),N=i(892180),O=i(204396);const E={limitOrder:r.t(null,void 0,i(398157)),stopOrder:r.t(null,void 0,i(905023))};class M{constructor(e){this._pool=[],this._handlers=e||{},this._ordersPool=new V(this._handlers),this._useCssTransform="transform"in document.createElement("span").style}allocate(){return this._pool.pop()||new B(this._ordersPool,this._handlers,this._useCssTransform)}free(e){e.destroy(),this._pool.push(e)}}class B{constructor(e,t,i){this._price=0,this._useCssTransform=i,this._ordersPool=e,this._handlers=t,this._allocatedOrderViews=[];const s=document.createElement("div");s.setAttribute("class",O["tv-dome-widget-main__row"]);const o=document.createElement("span");o.setAttribute("class",`${O["tv-dome-widget-main__value"]} ${O["tv-dome-widget-main__value--price"]}`);const n=document.createElement("span");n.setAttribute("class",`${O["tv-dome-widget-main__value"]} ${O["tv-dome-widget-main__value--sell"]}`);const r=document.createElement("span");r.setAttribute("class",`${O["tv-dome-widget-main__value"]} ${O["tv-dome-widget-main__value--buy"]}`);const a=document.createElement("span");a.setAttribute("class",`${O["tv-dome-widget-main__meter"]} ${O["tv-dome-widget-main__meter--sell"]}`);const l=document.createElement("span");l.setAttribute("class",`${O["tv-dome-widget-main__meter"]} ${O["tv-dome-widget-main__meter--buy"]}`);const d=document.createElement("span");d.setAttribute("class",O["tv-dome-widget-main__value-readout"]);const c=document.createElement("span");c.setAttribute("class",O["tv-dome-widget-main__value-readout"]);const u=document.createTextNode(""),h=document.createTextNode(""),m=document.createTextNode("");this._useCssTransform&&(a.style.width=l.style.width="100%",a.style.transform=l.style.transform="scale(0, 1)");const _=document.createElement("span");_.setAttribute("class",`${O["tv-dome-widget-main__value"]} ${O["tv-dome-widget-main__value--orders-buy"]}`);const p=document.createElement("span");p.textContent=E.limitOrder,p.setAttribute("class",O["tv-dome-widget-main__label"]),_.appendChild(p);const g=document.createElement("span");g.setAttribute("class",`${O["tv-dome-widget-main__value"]} ${O["tv-dome-widget-main__value--orders-sell"]}`)
;const v=document.createElement("span");v.textContent=E.limitOrder,v.setAttribute("class",O["tv-dome-widget-main__label"]),g.appendChild(v),s.appendChild(n),s.appendChild(r),s.appendChild(o),s.appendChild(_),s.appendChild(g),o.appendChild(m),n.appendChild(a),r.appendChild(l),n.appendChild(d),r.appendChild(c),d.appendChild(u),c.appendChild(h),this._priceCell=o,this._priceText=m,this._askText=u,this._bidText=h,this._askMeter=a,this._bidMeter=l,this._ordersBuy=_,this._ordersSell=g,this._orderBuyLabel=p,this._orderSellLabel=v,this._isHigherThanBestBid=!1,this._isLowerThanBestAsk=!1,this._orderType=1,t&&t.bidAskClick&&(n.addEventListener("click",(e=>this._handlerCellClick(-1,e)),!1),r.addEventListener("click",(e=>this._handlerCellClick(1,e)),!1)),t&&t.bidAskContextMenu&&(n.addEventListener("contextmenu",(e=>{t.bidAskContextMenu.call(null,e,{price:this._price,side:-1})}),!1),r.addEventListener("contextmenu",(e=>{t.bidAskContextMenu.call(null,e,{price:this._price,side:1})}),!1)),n.addEventListener("mouseover",(e=>{v.textContent=(0,D.modifiersFromEvent)(e)===D.Modifiers.Mod?E.stopOrder:E.limitOrder,v.style.visibility="visible"}),!1),n.addEventListener("mouseout",(()=>{v.style.visibility="hidden"}),!1),r.addEventListener("mouseover",(e=>{p.textContent=(0,D.modifiersFromEvent)(e)===D.Modifiers.Mod?E.stopOrder:E.limitOrder,p.style.visibility="visible"}),!1),r.addEventListener("mouseout",(()=>{p.style.visibility="hidden"}),!1),this.element=s}updatePriceText(e){this._priceText.nodeValue=e}updateBidVolume(e){this._bidText.nodeValue!==e&&(this._bidText.nodeValue=e)}updateAskVolume(e){this._askText.nodeValue!==e&&(this._askText.nodeValue=e)}updateBidMeter(e){const t=Math.min(Math.max(e,0),1)||0;this._useCssTransform?this._bidMeter.style.transform=`scale(${t}, 1)`:this._bidMeter.style.width=100*t+"%"}updateAskMeter(e){const t=Math.min(Math.max(e,0),1)||0;this._useCssTransform?this._askMeter.style.transform=`scale(${t}, 1)`:this._askMeter.style.width=100*t+"%"}updatePriceHighlight(e,t){const i=this._priceCell.classList;if(i)i.toggle(O["tv-dome-widget-main__value--highlighted"],e),i.toggle(O["tv-dome-widget-main__value--long-position"],t>0),i.toggle(O["tv-dome-widget-main__value--short-position"],t<0);else{let i=`${O["tv-dome-widget-main__value"]} ${O["tv-dome-widget-main__value--price"]}`;e&&(i+=` ${O["tv-dome-widget-main__value--highlighted"]}`),t>0?i+=` ${O["tv-dome-widget-main__value--long-position"]}`:t<0&&(i+=` ${O["tv-dome-widget-main__value--short-position"]}`),this._priceCell.setAttribute("class",i)}}setHigherThanBid(e){this._isHigherThanBestBid=e,this._updateLabelColor(this._orderBuyLabel,this._isActive(e))}updateAskLabels(e){this._isLowerThanBestAsk=e,this._updateLabelColor(this._orderSellLabel,this._isActive(e))}handlerKey(e){const t=(0,D.modifiersFromEvent)(e)===D.Modifiers.Mod;this._orderType=t?3:1,this._orderSellLabel.textContent=t?E.stopOrder:E.limitOrder,this._orderBuyLabel.textContent=t?E.stopOrder:E.limitOrder,this._updateLabelColor(this._orderBuyLabel,this._isActive(this._isHigherThanBestBid)),
this._updateLabelColor(this._orderSellLabel,this._isActive(this._isLowerThanBestAsk))}updatePrice(e){this._price=e}updateOrders(e){for(var t;this._allocatedOrderViews.length>e.length;){const e=this._allocatedOrderViews.pop();e&&this._ordersPool.free(e)}for(;this._allocatedOrderViews.length<e.length;)this._allocatedOrderViews.push(this._ordersPool.allocate());const i={};for(let s=0;s<e.length;s++){const o=e[s],n=this._allocatedOrderViews[s],r=Boolean(o.buy),a=r?1:-1;null===(t=i[a])||void 0===t||t.collapse(),i[a]=o.noCollapse?void 0:n,o.order!==n.order()&&(n.updateOrderData(o.order,o.pricePropertyName),n.updateQty(o.qty),n.updateTypeText(o.typeText),r?this._ordersBuy.prepend(n.element):this._ordersSell.append(n.element)),n.updateClassName({isBuy:r,type:o.type,inactive:o.inactive,ghost:o.ghost,highlighted:o.highlighted,isModifiable:o.isModifiable,isMovable:o.isMovable,isCancellable:o.isCancellable})}}destroy(){const e=this._allocatedOrderViews.length;if(e>0){for(let t=0;t<e;t++)this._ordersPool.free(this._allocatedOrderViews[t]);this._allocatedOrderViews.length=0}}paintPrice(e){const t=this.element.classList;t.toggle(O["tv-dome-widget-main__value--color-ask"],"ask"===e),t.toggle(O["tv-dome-widget-main__value--color-bid"],"bid"===e)}_handlerCellClick(e,t){const i=(0,D.modifiersFromEvent)(t);if(![D.Modifiers.None,D.Modifiers.Mod].includes(i))return;const s=1===e?this._bidMeter:this._askMeter,o=1===e?"buy":"sell";clearTimeout(this._activeStateTimerId),s.classList.add(`${O[`tv-dome-widget-main__meter--${o}-active`]}`),this._activeStateTimerId=setTimeout((()=>{s.classList.remove(`${O[`tv-dome-widget-main__meter--${o}-active`]}`)}),500),this._handlers.bidAskClick.call(null,t,{price:this._price,side:e,type:i===D.Modifiers.Mod?3:1})}_updateLabelColor(e,t){const i=e.classList;if(i)i.toggle(O["tv-dome-widget-main__label--active"],t);else{let i=O["tv-dome-widget-main__label"];t&&(i+=` ${O["tv-dome-widget-main__label--active"]}`),e.setAttribute("class",i)}}_isActive(e){const t=3===this._orderType;return t&&!e||!t&&e}}class V{constructor(e){this._pool=[],this._handlers=e}allocate(){return this._pool.pop()||new L(this._handlers)}free(e){e.destroy(),this._pool.push(e)}}class L{constructor(e){this._order=null,this._pricePropertyName=null;const t=document.createElement("div");t.setAttribute("class",`${O["tv-dome-widget-main__order"]} ${N["tv-dome-widget-order"]}`);const s=document.createElement("div");s.innerHTML=i(548927),s.setAttribute("class",N["tv-dome-widget-order__close"]);const o=document.createElement("span");o.setAttribute("class",N["tv-dome-widget-order__qty"]);const n=document.createTextNode(""),r=document.createElement("span");r.setAttribute("class",N["tv-dome-widget-order__type"]);const a=document.createTextNode("");t.appendChild(s),t.appendChild(o),o.appendChild(n),t.appendChild(r),r.appendChild(a),e&&e.closeButtonClick&&s.addEventListener("click",(t=>{e.closeButtonClick.call(null,t,this._order)}),!1),e&&e.qtyClick&&o.addEventListener("click",(t=>{e.qtyClick.call(null,t,this._order)}),!1),
e&&e.orderMousedown&&o.addEventListener("mousedown",(t=>{null!==this._order&&null!==this._pricePropertyName&&e.orderMousedown.call(null,t,{order:this._order,pricePropertyName:this._pricePropertyName})}),!1),this.element=t,this._qtyText=n,this._typeText=a}order(){return this._order}updateQty(e){this._qtyText.nodeValue=e||""}updateTypeText(e){this._typeText.nodeValue=e||""}updateClassName(e){const{isBuy:t,type:i,inactive:s,ghost:o,highlighted:n,isModifiable:r,isMovable:a,isCancellable:l}=e,d=this.element;d.className=`${O["tv-dome-widget-main__order"]} ${N["tv-dome-widget-order"]}`,d.classList.toggle(N["tv-dome-widget-order--buy"],!!t),d.classList.toggle(N[`tv-dome-widget-order--type-${i}`],!!i),d.classList.toggle(N["tv-dome-widget-order--inactive"],!!s),d.classList.toggle(N["tv-dome-widget-order--ghost"],!!o),d.classList.toggle(N["tv-dome-widget-order--highlighted"],!!n),d.classList.toggle(N["tv-dome-widget-order--unmodified"],!1===r),d.classList.toggle(N["tv-dome-widget-order--immovable"],!1===a),d.classList.toggle(N["tv-dome-widget-order--notcanceled"],!1===l)}collapse(){this.element.classList.add(O["tv-dome-widget-main__order--collapsed"])}updateOrderData(e,t){this._order=e,this._pricePropertyName=t}destroy(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this._order=null}}function F(e,t){const i=[];if(0===e.length||0===t.length)return[...e,...t];let s=0,o=0;for(;s<=e.length&&o<=t.length;){const n=e[s],r=t[o];n>=r?(s++,i.push(n)):(o++,i.push(r))}return s===e.length&&i.push(...t.slice(o+1)),o===t.length&&i.push(...e.slice(s+1)),i}function A(e,t){let i=0;for(const s of e){const e=s.filter(isFinite);if(0===e.length)continue;const o=e[0]-(t-i);if(o<0)return t-i;if(o<e.length)return e[o];const n=e.length-1;i+=e[0]-e[n]-n}return t-i}function W(e,t){return t-e}function H(e,t,i,s){return t===s[i-1]||e.push(Number(t)),e}class R{constructor(e,t,i){this._container=null,this._listContainer=null,this._dragShield=null,this._viewsList=[],this._bids={},this._asks={},this._indexes=[],this._repaintScheduled=!1,this._currentVolumeMax=0,this._orders={},this._positionIndex=NaN,this._positionQty=0,this._orderGhost=null,this._totalVolumeBid=0,this._totalVolumeAsk=0,this._buyOrdersValue=0,this._sellOrdersValue=0,this._buyOrdersValueInactive=0,this._sellOrdersValueInactive=0,this._buyOrdersQuantity=0,this._sellOrdersQuantity=0,this._offscreenIndexLocation$=new T.Subject,this._cellIndexesInAskZone=[],this._cellIndexesInBidZone=[],this._bestAskIndex=Number.POSITIVE_INFINITY,this._bestBidIndex=Number.NEGATIVE_INFINITY,this._worstBidIndex=Number.POSITIVE_INFINITY,this._worstAskIndex=Number.NEGATIVE_INFINITY,this._handlers=e||{},this._realtimeProvider=i,this._showPricesWith=t,this.autoCenterRequired=new(l())(!1),this.height=0,this.topIndex=NaN,this._symbolData=null,this.indexToPrice=()=>NaN,this.priceToIndex=()=>NaN,this._lastPriceIndex=NaN,this._viewAllocated=new Map,this._viewPool=null,this._invalidatedAsk={},this._invalidatedBid={},this._invalidatedPriceHighlight={},this._invalidatedOrders={},
this._dynamicModeState=!1,this._numericFormatter=new P.NumericFormatter,this._showPricesWith.zeroVolume.subscribe(this.centerOnLast.bind(this)),this._showPricesWith.spread.subscribe(this.centerOnLast.bind(this)),this.reset()}reset(){this.topIndex=NaN,this._symbolData=null,this.indexToPrice=()=>NaN,this.priceToIndex=()=>NaN,this._lastPriceIndex=NaN,this.resetData(),this.resetView(),this.resetOrders(),this.resetOrderGhost(),this.resetPosition(),this.autoCenterRequired.setValue(!1)}resetData(){if(this._bids={},this._asks={},this._totalVolumeBid=0,this._totalVolumeAsk=0,this._recalcMaxVolume(),this._recalcBestWorstBid(),this._recalcBestWorstAsk(),this._viewAllocated)for(const[e]of this._viewAllocated)this._invalidatedAsk[e]=!0,this._invalidatedBid[e]=!0;this._offscreenIndexLocation$.next(s.Inside),this.scheduleRepaint()}resetOrders(){if(this._orders)for(const e in this._orders)this._orders.hasOwnProperty(e)&&(this._invalidatedOrders[e]=!0);this._orders={},this._buyOrdersValue=0,this._sellOrdersValue=0,this._buyOrdersValueInactive=0,this._sellOrdersValueInactive=0,this._buyOrdersQuantity=0,this._sellOrdersQuantity=0,this.scheduleRepaint()}resetPosition(){this._invalidatedPriceHighlight[this._positionIndex]=!0,this._positionIndex=NaN,this._positionQty=0,this.scheduleRepaint()}resetView(){if(this._viewAllocated&&this._viewPool)for(const[e]of this._viewAllocated){const t=this._viewAllocated.get(e);t&&(t.element.remove(),this._viewPool.free(t),this._viewAllocated.delete(e))}this._listContainer&&(this._viewsList.length=0,this._listContainer.innerHTML=""),this.setDragShield(!1,!1),this.scheduleRepaint()}setSymbolInfo(e){this._symbolData={...e},this.indexToPrice=(0,C.makePriceIndexToPriceConverter)(e.minTick,e.variableMinTickData),this.priceToIndex=(0,C.makePriceToPriceIndexConverter)(e.minTick,e.variableMinTickData)}setContainer(e){if(this._container===e)return;this._container&&(this.resetView(),this._container.innerHTML=""),this._container=e,this._viewPool=new M(this._handlers),this._viewAllocated=new Map;const t=this._listContainer=document.createElement("div");t.className=O["tv-dome-widget-main__anchor"],e.append(t);const i=this._dragShield=document.createElement("div");i.className=`${O["tv-dome-widget-main__drag-shield"]} js-hidden`,e.append(i),this._repaintScheduled=!1,this.scheduleRepaint()}setHeight(e){e!==this.height&&(this.height=e,this.checkAutoCenter(),this.scheduleRepaint())}shiftTopIndexRelativeToIndex(e,t){this._setTopIndex(e+t)}handlerKey(e){let t=this.topIndex;this._canIndexBeDisplayed(t)||(t=this.correctIndex(t,-1));const i=this.correctIndex(t,1-this.height);if(!isFinite(i))return;const s=this._viewAllocated;for(const[,t]of s)t&&t.handlerKey(e)}correctIndex(e,t=0){const i=e+t;if(!this._hasQuotes())return i;const s=this._showPricesWith.zeroVolume.value(),o=this._showPricesWith.spread.value();return s&&o?i:s&&!o?A([[this._bestAskIndex,this._bestBidIndex]],i):!s&&o?A([this._cellIndexesInAskZone,this._cellIndexesInBidZone],i):s||o?i:A([(new Array).concat(this._cellIndexesInAskZone,this._cellIndexesInBidZone)],i)}
centerOnLast(){this.autoCenterRequired.setValue(!1);const e=this._autoCenterTargetTopIndex();isFinite(e)&&this._setTopIndex(e)}guessOrderType(e,t){const i=this.priceToIndex(e);if(!isFinite(e))return null;if(1!==t&&-1!==t)return null;let s=this._bestAskIndex,o=this._bestBidIndex;return isFinite(s)||(s=o+1),isFinite(o)||(o=s-1),isFinite(s)||isFinite(o)||(s=o=this._lastPriceIndex),1===t?i&&i<s?1:3:i&&i>o?1:3}updateData(e){this._indexes.forEach((e=>{isFinite(this._asks[e])||delete this._asks[e],isFinite(this._bids[e])||delete this._bids[e]}));let t=!1;if(e.snapshot){const e=0===Object.keys(this._asks).length&&0===Object.keys(this._bids).length;t=!this._showPricesWith.zeroVolume.value()&&!this._showPricesWith.spread.value()&&e,this.resetData()}let i=!1;if(e.bids)for(let t=0;t<e.bids.length;t++){const s=(0,c.ensureDefined)(e.bids[t]),o=this.priceToIndex(s.price),n=s.volume,r=this._bids[o]||null;r!==n&&(i=!0,n>0?(this._totalVolumeBid+=n-Number(r),this._bids[o]=n):(this._totalVolumeBid-=Number(r),delete this._bids[o]),this._invalidatedBid[o]=!0)}if(e.asks)for(let t=0;t<e.asks.length;t++){const s=(0,c.ensureDefined)(e.asks[t]),o=this.priceToIndex(s.price),n=s.volume,r=this._asks[o]||null;r!==n&&(i=!0,n>0?(this._totalVolumeAsk+=n-Number(r),this._asks[o]=n):(this._totalVolumeAsk-=Number(r),delete this._asks[o]),this._invalidatedAsk[o]=!0)}if(this._collectIndexes(),!this._hasDataInDom()){if(i=!0,0!==e.bids.length){const t=this.priceToIndex(e.bids[0].price);this._bids[t]=Number.POSITIVE_INFINITY}if(0!==e.asks.length){const t=this.priceToIndex(e.asks[0].price);this._asks[t]=Number.POSITIVE_INFINITY}this._collectIndexes()}i&&this._recalcDepthInfo(),this._recalcMaxVolume(),t?this.centerOnLast():this.checkAutoCenter(),this._dynamicModeState&&this.centerOnLast(),this.scheduleRepaint()}totalVolumeBid(){return this._totalVolumeBid}totalVolumeAsk(){return this._totalVolumeAsk}buyOrdersValue(){return this._buyOrdersValue}sellOrdersValue(){return this._sellOrdersValue}buyInactiveOrdersValue(){return this._buyOrdersValueInactive}sellInactiveOrdersValue(){return this._sellOrdersValueInactive}buyOrdersQuantity(){return this._numericFormatter.format(this._buyOrdersQuantity)}sellOrdersQuantity(){return this._numericFormatter.format(this._sellOrdersQuantity)}updateOrders(e){this.resetOrders();for(let t=0;t<e.length;t++){const i=e[t],s=6===i.status;if(1===i.side?(this._buyOrdersValue+=Number(s),this._buyOrdersValueInactive+=Number(!s),this._buyOrdersQuantity+=s?i.qty:0):(this._sellOrdersValue+=Number(s),this._sellOrdersValueInactive+=Number(!s),this._sellOrdersQuantity+=s?i.qty:0),i.stopPrice){const e=this.priceToIndex(i.stopPrice);this._orders[e]||(this._orders[e]=[]),this._orders[e].push({order:i,pricePropertyName:"stopPrice"}),this._invalidatedOrders[e]=!0}if(void 0!==i.limitPrice){const e=this.priceToIndex(i.limitPrice);this._orders[e]||(this._orders[e]=[]),this._orders[e].push({order:i,pricePropertyName:"limitPrice"}),this._invalidatedOrders[e]=!0}}this._recalcDepthInfo(),this.scheduleRepaint()}updateLast(e){const t=this.priceToIndex(e)
;t!==this._lastPriceIndex&&(this._invalidatedPriceHighlight[this._lastPriceIndex]=!0,this._invalidatedPriceHighlight[t]=!0,this._lastPriceIndex=t,this.checkAutoCenter(),this.scheduleRepaint())}updatePosition(e){if(void 0===e||0===e.qty)return void this.resetPosition();const t=this.priceToIndex(e.avgPrice),i=Math.abs(e.qty)*(1===e.side?1:-1);this._positionIndex===t&&this._positionQty===i||(this._invalidatedPriceHighlight[this._positionIndex]=!0,this._invalidatedPriceHighlight[t]=!0,this._positionIndex=t,this._positionQty=i,this.scheduleRepaint())}resetOrderGhost(){this._orderGhost&&(this._invalidatedOrders[this._orderGhost.index]=!0,this._invalidatedOrders[this._orderGhost.originIndex]=!0,this._orderGhost=null,this.scheduleRepaint())}setOrderGhost(e){const{order:t,pricePropertyName:i,price:s}=e;this.resetOrderGhost();const o=this.priceToIndex(s);isFinite(o)&&(this._orderGhost={ghost:!0,order:t,pricePropertyName:i,price:s,index:o,originIndex:this.priceToIndex(t[i])},this._invalidatedOrders[o]=!0,this.scheduleRepaint())}setDragShield(e,t){this._dragShield&&(this._dragShield.classList.toggle("js-hidden",!e),this._dragShield.classList.toggle(O["tv-dome-widget-main__drag-shield--order"],t))}scheduleRepaint(){this._repaintScheduled||this._symbolData&&(requestAnimationFrame((()=>this.repaint())),this._repaintScheduled=!0)}formatVolume(e){return null===this._symbolData?String(e):this._symbolData.volumeFormatter.format(e)}repaint(){if(this._repaintScheduled=!1,!this._listContainer)return;if(null===this._viewPool)return;const e=this.topIndex,t=this.correctIndex(e,1-this.height);if(isFinite(t)){for(;this._viewsList.length<this.height;){const e=this._viewPool.allocate();this._listContainer.append(e.element),this._viewsList.push(e)}for(;this._viewsList.length>this.height;){const e=(0,c.ensureDefined)(this._viewsList.pop());e.element.remove(),this._viewPool.free(e)}this._oldViewAllocated=this._viewAllocated,this._viewAllocated=new Map;for(let t=0;t<this._viewsList.length;t++){const i=this.correctIndex(e,-t),s=this._viewsList[t];this._viewAllocated.set(i,s),this._updateRow(i)}this._updateOffscreenIndexLocation(this._lastPriceIndex,e,t);for(const e in this._invalidatedBid)this._invalidatedBid.hasOwnProperty(e)&&delete this._invalidatedBid[e];for(const e in this._invalidatedAsk)this._invalidatedAsk.hasOwnProperty(e)&&delete this._invalidatedAsk[e];for(const e in this._invalidatedPriceHighlight)this._invalidatedPriceHighlight.hasOwnProperty(e)&&delete this._invalidatedPriceHighlight[e];for(const e in this._invalidatedOrders)this._invalidatedOrders.hasOwnProperty(e)&&delete this._invalidatedOrders[e]}}typePrice(e){return e>=this._bestAskIndex?"ask":e<=this._bestBidIndex?"bid":void 0}toggleDynamicModeState(){return this._dynamicModeState=!this._dynamicModeState,this._dynamicModeState}getDynamicModeState(){return this._dynamicModeState}checkAutoCenter(){isFinite(this.topIndex)||this.centerOnLast();const e=this.topIndex,t=this.correctIndex(this.topIndex,1-this.height);let i
;i=isFinite(this._bestBidIndex)?this._bestBidIndex:isFinite(this._bestAskIndex)?this._bestAskIndex:isFinite(this._lastPriceIndex)?this._lastPriceIndex:NaN;let s=NaN;isFinite(this._bestAskIndex)?s=this._bestAskIndex:isFinite(this._bestBidIndex)?s=this._bestBidIndex:isFinite(this._lastPriceIndex)&&(i=this._lastPriceIndex);let o=!1;(s+3>e||i-3<t)&&this.topIndex!==this._autoCenterTargetTopIndex()&&(o=!0),this.autoCenterRequired.setValue(o)}isSpread(e){return this._bestAskIndex>e&&e>this._bestBidIndex}getOffscreenIndexLocationObservable(){return this._offscreenIndexLocation$.asObservable()}_hasDataInDom(){return 0!==this._indexes.length}_updateOffscreenIndexLocation(e,t,i){isFinite(this._lastPriceIndex)&&(e>t?this._offscreenIndexLocation$.next(s.Higher):e<i?this._offscreenIndexLocation$.next(s.Lower):this._offscreenIndexLocation$.next(s.Inside))}_hasQuotes(){return this._indexes.length>1}_collectIndexes(){this._indexes=Object.keys(Object.assign({},this._asks,this._bids))}_recalcDepthInfo(){const e=Object.keys(this._asks).reduce(H,[]).sort(W),t=Object.keys(this._bids).reduce(H,[]).sort(W),i=Object.keys(this._orders).reduce(H,[]).sort(W);this._worstAskIndex=e[0],this._bestAskIndex=e[e.length-1],this._bestBidIndex=t[0],this._worstBidIndex=t[t.length-1];const s=[],o=[];for(const e of i)e<=this._worstAskIndex&&e>=this._bestAskIndex&&void 0===this._asks[e]&&s.push(e),e<=this._bestBidIndex&&e>=this._worstBidIndex&&void 0===this._bids[e]&&o.push(e);this._cellIndexesInAskZone=F(e,s),this._cellIndexesInBidZone=F(t,o)}_updateRow(e){var t;if(!this._symbolData)return;const s=this._oldViewAllocated,o=this._viewAllocated;let n=o.get(e);this._viewPool&&!n&&(n=this._viewPool.allocate(),o.set(e,n));const a=this._orderGhost;if(s&&s.get(e)!==o.get(e)){const t=this.indexToPrice(e);n.updatePrice(t),n.updatePriceText(this._symbolData.priceFormatter.format(t))}n.paintPrice(this.typePrice(e)),this._asks[e]&&this._asks[e]!==Number.POSITIVE_INFINITY?n.updateAskVolume(this.formatVolume(this._asks[e])):n.updateAskVolume(""),n.updateAskLabels(e<this._bestAskIndex),this._bids[e]&&this._bids[e]!==Number.POSITIVE_INFINITY?n.updateBidVolume(this.formatVolume(this._bids[e])):n.updateBidVolume(""),n.setHigherThanBid(e>this._bestBidIndex),n.updateAskMeter(this._asks[e]===Number.POSITIVE_INFINITY?100:this._asks[e]/this._currentVolumeMax||0),n.updateBidMeter(this._bids[e]===Number.POSITIVE_INFINITY?100:this._bids[e]/this._currentVolumeMax||0);const l=e===this._lastPriceIndex,d=e===this._positionIndex?this._positionQty:0;n.updatePriceHighlight(l,d);let c,u,h=this._orders[e]||[];null!==a&&(a.index===e&&(a.originIndex!==e?h=h.concat(a):u=a.order.id),a.index!==e&&a.originIndex!==e||(c=a.order.side));const m=null===(t=this._realtimeProvider.activeBroker())||void 0===t?void 0:t.metainfo().configFlags;for(let e=0;e<h.length;e++){const t=h[e],s=t.order,o=s.filledQty||0;switch(t.inactive=6!==s.status||4===s.type&&"limitPrice"===t.pricePropertyName,t.isModifiable=void 0!==m&&(0,S.isModifyOrderSupported)(s,m),t.isMovable=void 0!==m&&(0,S.isMoveOrderSupported)(s,m),
t.isCancellable=!0,s.type){case 2:t.typeText=r.t(null,void 0,i(359758)),t.type="market";break;case 1:t.typeText=s.parentId?r.t(null,void 0,i(885242)):r.t(null,void 0,i(398157)),t.type="limit";break;case 3:t.typeText=s.parentId?r.t(null,void 0,i(154852)):r.t(null,{context:"order"},i(7122)),t.type="stop";break;case 4:t.typeText=r.t(null,void 0,i(900853)),t.type="stoplimit";break;default:t.typeText=""}t.qty=this._symbolData.quantityFormatter.format(s.qty-o),t.buy=1===s.side,t.noCollapse=s.side===c,t.highlighted=null!==a&&void 0!==u&&s.id===u&&a.pricePropertyName===t.pricePropertyName}n.updateOrders(h)}_setTopIndex(e){e!==this.topIndex&&(this.topIndex=e,this.checkAutoCenter()),this.scheduleRepaint()}_canIndexBeDisplayed(e){const t=this._showPricesWith.zeroVolume.value(),i=this._showPricesWith.spread.value();if(t&&!this.isSpread(e))return!0;if(i&&this.isSpread(e))return!0;const s=e===this._lastPriceIndex,o=e===this._positionIndex,n=this._bids.hasOwnProperty(e)||this._asks.hasOwnProperty(e),r=e<=this._worstBidIndex||this._worstAskIndex<=e,a=this._orders[e]||[],l=this._orderGhost&&this._orderGhost.index===e;return o||s||l||r||n||0!==a.length}_getGapMiddleIndex(){let e=this._bestAskIndex,t=this._bestBidIndex;return isFinite(e)||(e=t),isFinite(t)||(t=e),Math.floor((t+e)/2)}_autoCenterTargetTopIndex(){const e=Math.floor(this.height/2);return this._showPricesWith.zeroVolume.value()&&this._showPricesWith.spread.value()?this._getCenterIndex()+e:this._getCorrectCenterIndex()+e}_getCorrectCenterIndex(){var e,t;const i=this._getCenterIndex(),s=null!==(e=this._bestAskIndex)&&void 0!==e?e:i,o=null!==(t=this._worstAskIndex)&&void 0!==t?t:i;let n=i;if(!this._showPricesWith.zeroVolume.value()){n=i+o-s-1-(this._cellIndexesInAskZone.length-1>=0?this._cellIndexesInAskZone.length-1:0)+1}return this._showPricesWith.spread.value()||(n+=s-i),n}_getCenterIndex(){const e=this._getGapMiddleIndex();return isFinite(e)?e:isFinite(this._bestBidIndex)?this._bestBidIndex:isFinite(this._bestAskIndex)?this._bestAskIndex:isFinite(this._lastPriceIndex)?this._lastPriceIndex:NaN}_recalcMaxVolume(){let e=0;for(const t in this._asks)this._asks.hasOwnProperty(t)&&(e=Math.max(this._asks[t],e));for(const t in this._bids)this._bids.hasOwnProperty(t)&&(e=Math.max(this._bids[t],e));e!==this._currentVolumeMax&&(this._currentVolumeMax=e)}_recalcBestWorstBid(){let e=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY;for(const i in this._bids)this._bids.hasOwnProperty(i)&&(+i>e&&(e=+i),+i<t&&(t=+i));this._bestBidIndex=e,this._worstBidIndex=t}_recalcBestWorstAsk(){let e=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY;for(const i in this._asks)this._asks.hasOwnProperty(i)&&(+i<e&&(e=+i),+i>t&&(t=+i));this._bestAskIndex=e,this._worstAskIndex=t}}class q{constructor(e){this._symbolData=null,this._calculatePLUsingLast=!1,this._hasLotSize=new(l())(!1),this._plState=new T.Subject,this._positionState=new T.Subject,this.changePLViewType=()=>{switch(this._displayProfitState){case 2:this._displayProfitState=1;break;case 0:this._displayProfitState=2;break;case 1:
this._displayProfitState=0}h.setValue(b.settingsKeys.PROFIT_VIEW_TYPE,this._displayProfitState),this.updatePL()},this.compareQty=()=>{var e;const t=Math.abs(Number(null===(e=this._position)||void 0===e?void 0:e.qty));t>0&&isFinite(t)&&this.qty.setValue(t)},this.plState$=this._plState.asObservable(),this.positionState$=this._positionState.asObservable(),this._handlers=e||{},this._numericFormatter=new P.NumericFormatter,this._displayProfitState=h.getJSON(b.settingsKeys.PROFIT_VIEW_TYPE,2),this.reset(),this._integerFormatter=new P.NumericFormatter(0),this._oneDecimalFormatter=new P.NumericFormatter(1),this.qty=new(l())(1),this.qty.subscribe((e=>this._handlers.qtyChange.call(null,e))),this._qtyProperties=new(l())({min:1,step:1,max:1,format:null})}reset(){this._position=void 0,this._pl=void 0,this._lastPrice=void 0,this._bid=void 0,this._ask=void 0,this._symbolData=null,this._updatePositionState(null,null),this._updatePLState(null,null)}setBrokerConfigFlags(e){this._calculatePLUsingLast=e.calculatePLUsingLast}setSymbolInfo(e){const{qtyProperties:t}=e;this._symbolData=e,this._qtyProperties.setValue({min:t.min,step:t.step,uiStep:t.uiStep,max:t.max,format:this._numericFormatter})}getQtyProperties(){return this._qtyProperties}updatePosition(e){if(this._position=e,void 0===this._position||0===this._position.qty||null===this._symbolData)return void this._updatePositionState(null,null);const{qty:t,avgPrice:i,side:s}=this._position,o=this._symbolData.priceFormatter.format(i),n=Math.abs(t),r=this._symbolData.volumeFormatter.format(n);this._updatePositionState(`${r} @ ${o}`,s)}updatePL(e){if(void 0!==e&&(this._pl=e),void 0===this._position)return void this._updatePLState(null,null);const{side:t,avgPrice:i}=this._position,s=-1===t,o=this._calculatePLUsingLast?this._lastPrice:s?this._ask:this._bid;if(void 0===o){if(void 0===this._pl||2!==this._displayProfitState)this._updatePLState(null,null);else{const e=this._pl>=0?1:2;this._updatePLState(this._makePlText(),e)}return}const n=(o-i)*(s?-1:1),r=n>0?1:2;switch(this._displayProfitState){case 0:const e=this._calculatePLPercentage(i,n);this._updatePLState(e,r);break;case 1:const t=this._makePipsText(n);this._updatePLState(t,r);break;case 2:this._updatePLState(this._makePlText(),r)}}updateLast(e,t,i){this._lastPrice=e,this._bid=t,this._ask=i,this.updatePL()}bid(){return this._bid}ask(){return this._ask}setHasLotSize(e){this._hasLotSize.setValue(e)}hasLotSize(){return this._hasLotSize.readonly()}_calculatePLPercentage(e,t){const i=t/e;return isFinite(i)?(100*i).toFixed(2)+"%":null}_makePipsText(e){if(null===this._symbolData)return null;const{pipSize:t,minTick:s}=this._symbolData,o=isFinite(t)&&t!==s?this._oneDecimalFormatter:this._integerFormatter,n=parseFloat(o.format(e/(t||s)));return isFinite(n)?r.t(null,{replace:{pips:String(n)}},i(207218)):null}_makePlText(){var e;if(void 0===this._pl)return null;const t=this._pl.toFixed(2);return void 0!==(null===(e=this._symbolData)||void 0===e?void 0:e.positionCurrency)?`${t} ${this._symbolData.positionCurrency}`:t}_updatePositionState(e,t){
this._positionState.next({positionText:e,side:t})}_updatePLState(e,t){this._plState.next({plText:e,tradeDirection:t})}}class U{constructor(e,t,i){this._expiresAt=0,this._delay=e,this._doneCb=t,this._progressCb=i}run(){if(this._timeoutId)return;const e=Date.now?Date.now():+new Date;this._expiresAt=e+this._delay,this._timeoutId=window.setTimeout((()=>{this.abort(),this._doneCb()}),this._delay),this._trackProgressScheduled||this._trackProgress()}revert(){this._timeoutId&&(window.clearTimeout(this._timeoutId),this._timeoutId=void 0,this.run())}abort(){this._timeoutId&&(window.clearTimeout(this._timeoutId),this._timeoutId=void 0,this._expiresAt=0,this._progressCb&&this._progressCb(0))}setWindow(e){this._wnd=e}_trackProgress(){if(this._trackProgressScheduled=!1,!this._progressCb||!this._timeoutId)return;const e=Date.now?Date.now():+new Date;let t=1-(this._expiresAt-e)/this._delay;t=Math.max(Math.min(t,1),0),this._progressCb(t),this._wnd&&this._wnd.requestAnimationFrame?this._wnd.requestAnimationFrame((()=>{this._trackProgress()})):window.setTimeout((()=>{this._trackProgress()}),40),this._trackProgressScheduled=!0}}var z=i(922157),$=i.n(z);class G{constructor(){this._customFieldsCount=new(l())(0),this._currentValuesSummaryLine=new(l())(""),this._onCustomFieldsUpdate=new($()),this._selectedComboBoxValues=new Map,this._checkboxFieldsStates=new Map,this._comboBoxItems=new(l())([]),this._checkboxFields=new(l())([]),this._rewriteDisplayedSelectedItems=()=>{const e=[...this._getSelectedComboBoxItemsNames(),...this._getCheckedCheckboxFieldsTitles()],t=this._getCurrentDurationName();void 0!==t&&e.push(t);const i=e.join(", ");this._currentValuesSummaryLine.setValue(i)},this._getSelectedComboBoxItemsNames=()=>{const e=[];for(const t of this._comboBoxItems.value()){const i=(0,c.ensureDefined)(this._selectedComboBoxValues.get(t.id)).value(),s=t.items.find((e=>e.value===i));e.push((0,c.ensureDefined)(s).text)}return e},this._recountCustomFields=()=>{var e;let t=void 0!==this._currentDuration?1:0;void 0!==(null===(e=this._currentDuration)||void 0===e?void 0:e.datetime)&&t++,this._customFieldsCount.setValue(this._comboBoxItems.value().length+this._checkboxFields.value().length+t)},this._recountCustomFields()}setCustomFields(e){const t=[],i=[],s=new Map,o=new Map;e.forEach((e=>{if("ComboBox"===e.inputType){const i=this._selectedComboBoxValues.get(e.id);if(void 0!==i)this._selectedComboBoxValues.delete(e.id),s.set(e.id,i),i.setValue(e.items[0].value);else{const t=new(l())(e.items[0].value);s.set(e.id,t),t.subscribe(this._rewriteDisplayedSelectedItems)}t.push(e)}if("Checkbox"===e.inputType){const t=this._checkboxFieldsStates.get(e.id);if(void 0!==t)this._checkboxFieldsStates.delete(e.id),o.set(e.id,t),t.setValue(e.value);else{const t=new(l())(e.value);o.set(e.id,t),t.subscribe(this._rewriteDisplayedSelectedItems)}i.push(e)}})),this._selectedComboBoxValues.forEach((e=>e.unsubscribe(this._rewriteDisplayedSelectedItems))),this._selectedComboBoxValues=s,this._checkboxFieldsStates.forEach((e=>e.unsubscribe(this._rewriteDisplayedSelectedItems))),
this._checkboxFieldsStates=o,this._comboBoxItems.setValue(t),this._checkboxFields.setValue(i),this._rewriteDisplayedSelectedItems(),this._recountCustomFields(),this._onCustomFieldsUpdate.fire()}comboBoxItems(){return this._comboBoxItems.readonly()}getSelectedComboBoxValues(){return this._selectedComboBoxValues}checkboxFields(){return this._checkboxFields.readonly()}getCheckboxFieldsStates(){return this._checkboxFieldsStates}getCustomFieldsCount(){return this._customFieldsCount.value()}currentValuesSummaryLine(){return this._currentValuesSummaryLine.readonly()}setDurationsInfo(e,t){void 0!==t&&(this._durationsMetaInfo=t),this._currentDuration=e,this._rewriteDisplayedSelectedItems(),this._recountCustomFields()}_getCheckedCheckboxFieldsTitles(){const e=[];for(const t of this._checkboxFields.value()){(0,c.ensureDefined)(this._checkboxFieldsStates.get(t.id)).value()&&e.push(t.title)}return e}_getCurrentDurationName(){var e,t;const i=null===(e=this._currentDuration)||void 0===e?void 0:e.type,s=null===(t=this._durationsMetaInfo)||void 0===t?void 0:t.find((e=>e.value===i));return null==s?void 0:s.name}}var Q=i(661851),K=i(72571),j=i(497754),X=i(901317),J=i(297265),Y=i(587374),Z=i(613977),ee=i(42107);function te(e){const{currentDuration:t,durationMetaInfoList:i,onDurationChanged:s}=e;return n.createElement(ee.DurationControl,{currentDuration:t,durationMetaInfoList:i,onDurationChanged:s})}var ie=i(234952),se=i(488263),oe=i(611902);function ne(e){const t=e.domDetails,[s,o]=(0,X.useWatchedValue)(e.openState),a=(0,J.useWatchedValueReadonly)({watchedValue:e.currentDuration}),l=(0,J.useWatchedValueReadonly)({watchedValue:e.durationMetaInfoList}),d=(0,J.useWatchedValueReadonly)({watchedValue:t.currentValuesSummaryLine()}),u=(0,J.useWatchedValueReadonly)({watchedValue:t.comboBoxItems()}),h=(0,J.useWatchedValueReadonly)({watchedValue:t.checkboxFields()}),m=e.onDurationChanged,_=t.getSelectedComboBoxValues(),p=t.getCheckboxFieldsStates();return n.createElement(n.Fragment,null,n.createElement("div",{className:ie.headerWrapper},n.createElement("div",{className:ie.header,onClick:()=>o(!s)},n.createElement("div",{className:j(ie.textBlock,ie.summaryLine)},n.createElement("span",{className:ie.upperCase},r.t(null,void 0,i(557027))+": "),d),n.createElement("div",{className:ie.arrow},n.createElement(K.Icon,{icon:s?se:oe})))),s&&n.createElement(n.Fragment,null,n.createElement("div",null,u.length>0&&_.size>0&&n.createElement(n.Fragment,null,u.map((e=>{const t=(0,c.ensureDefined)(_.get(e.id));return n.createElement("div",{key:e.id,className:ie.customField},n.createElement(Y.CustomComboboxContainer,{title:e.title,items:e.items,selectedItem:t,forceUserToSelectValue:!1,alwaysShowAttachedErrors:!1}))}))),h.length>0&&p.size>0&&n.createElement(n.Fragment,null,h.map((e=>n.createElement("div",{key:e.id,className:ie.customField},n.createElement(Z.CheckboxCustomField,{title:e.title,help:e.help,checked:(0,c.ensureDefined)(p.get(e.id))}))))),n.createElement("div",{className:ie.duration},void 0!==a&&void 0!==l&&n.createElement(te,{currentDuration:a,
durationMetaInfoList:l,onDurationChanged:m})))))}var re=i(587125),ae=i(886630),le=i(171827);function de(e){const{calcData:t}=e,[s,o]=(0,n.useState)(!1),[a,l]=(0,n.useState)(),[d,c]=(0,n.useState)(t.qty.value()),[u,h]=(0,X.useWatchedValue)(t.qty),m=(0,J.useWatchedValueReadonly)({watchedValue:t.getQtyProperties()}),_=(0,J.useWatchedValueReadonly)({watchedValue:t.hasLotSize()})?r.t(null,void 0,i(357653)):r.t(null,void 0,i(125933));return(0,n.useEffect)((()=>{if(u===d)return;const{res:e,msg:t}=(0,ae.checkQtyError)(m,u,!0);e||c(u),o(e),l(t)}),[u,m,d]),n.createElement("div",{className:le.wrapper},n.createElement("span",{className:le.title},_),n.createElement(re.NumberInput,{alwaysUpdateValueFromProps:!0,mode:"float",value:u,onValueChange:e=>h(e),errorHandler:e=>o(e),errorMessage:a,error:s,onBlur:function(){if(d===u)return;h(d)},min:m.min,max:m.max,step:m.step,uiStep:m.uiStep}))}var ce=i(725784),ue=i(396437);const he=(0,ce.hotKeySerialize)({keys:["Shift","B"],text:"{0} + {1}"}),me=(0,ce.hotKeySerialize)({keys:["Shift","S"],text:"{0} + {1}"}),_e=r.t(null,void 0,i(102846)),pe=r.t(null,void 0,i(545322));function ge(e){const{uiPlaceOrder:t}=e;return n.createElement("div",{className:j(ue.row,ue.wrapper,ue.marketBlock)},n.createElement("button",{className:j(ue.buttonBuy,"apply-common-tooltip"),"data-tooltip-hotkey":he,onClick:e=>{e.preventDefault(),t({type:2,side:1})}},_e),n.createElement("button",{className:j(ue.buttonSell,"apply-common-tooltip"),"data-tooltip-hotkey":me,onClick:e=>{e.preventDefault(),t({type:2,side:-1})}},pe))}function ve(e,t){return t?{title:e}:{"data-tooltip":e}}var be=i(309807);const we={plText:null,tradeDirection:1},fe={positionText:null,side:1},ye=r.t(null,void 0,i(381617)),ke=r.t(null,void 0,i(110649));function xe(e){const{plText:t,tradeDirection:i}=(0,Q.useObservable)(e.plState,we),{positionText:s,side:o}=(0,Q.useObservable)(e.positionState,fe),r=null!==s,a=j(be.button,be.pl,r&&(1===i?be.profit:be.loss),"apply-common-tooltip"),l=j(be.button,be.position,r&&(1===o?be.buy:be.sell),"apply-common-tooltip");return n.createElement("div",{className:be.wrapper},n.createElement("button",{className:l,disabled:!r,onClick:e.compareQty,...ve(ye,!r)},null!=s?s:""),n.createElement("button",{className:a,disabled:!r,onClick:e.changePLViewType,...ve(ke,!r)},null!=t?t:""))}const Ie=r.t(null,void 0,i(323288)),Ce=r.t(null,void 0,i(963867)),Se=r.t(null,void 0,i(224186)),Te=r.t(null,void 0,i(975336)),Pe=r.t(null,void 0,i(987411)),De=r.t(null,void 0,i(843065));function Ne(e){const t=e.isPositionBlocked||!e.isTradable||!e.hasPosition||!e.hasFlatten,i=!e.isTradable||!(e.hasBuyOrders||e.hasSellOrders),s=e.isPositionBlocked||!e.isTradable||!e.hasPosition||!e.hasReverse;return n.createElement("div",{className:j(ue.row,ue.wrapper,ue.tradingActionBlock)},n.createElement("button",{className:j(ue.buttonOrdinary,"apply-common-tooltip"),disabled:t,onClick:t=>{t.preventDefault(),e.uiClosePosition()},...ve(Pe,t)},Ce),n.createElement("button",{className:j(ue.buttonOrdinary,"apply-common-tooltip"),title:Te,disabled:i,onClick:t=>{
t.preventDefault(),e.uiCancelAllOrders()},...ve(Te,i)},Ie),n.createElement("button",{className:j(ue.buttonOrdinary,"apply-common-tooltip"),title:De,disabled:s,onClick:t=>{t.preventDefault(),e.uiReversePosition()},...ve(De,s)},Se))}var Oe=i(16896);function Ee(e){const t=(0,Q.useObservable)(e.uiState$,{isTradable:!1,isPositionBlocked:!1,hasPosition:!1,hasBuyOrders:!1,hasSellOrders:!1,qty:1,gtcOrder:!1,hasFlatten:!1,hasReverse:!1}),i=e.domDetailsDropdownProps.domDetails.getCustomFieldsCount();return n.createElement("div",{className:Oe.container},n.createElement(xe,{...e.domCalcBlockProps}),n.createElement(Ne,{...e.tradingActionBlockControllers,...t}),n.createElement(de,{...e.domNumberContainerProps}),n.createElement(ge,{...e.domMarketActionBlockProps}),t.isTradable&&0!==i&&n.createElement(ne,{...e.domDetailsDropdownProps}))}var Me=i(28830),Be=i(368156),Ve=(i(150408),i(597800)),Le=i(11728),Fe=i(781957),Ae=i(943145);function We(e,t){return`${b.settingsKeys.DOM_DURATION}${e}.${t}`}const He={1:"LIMIT",2:"MARKET",3:"STOP",4:"STOPLIMIT"};function Re(e){var t,i;return e instanceof MouseEvent?e.pageY:null!==(i=null===(t=e.touches[0])||void 0===t?void 0:t.pageY)&&void 0!==i?i:0}class qe{constructor(e,t,s,o){this.delayedData=new(l())(!1),this.isBats=new(l())(!1),this._container=null,this._warning=null,this._mainBlock=null,this._svgTimerPath=null,this._noDataNoticeBlock=null,this._totalVolumeBidTextNode=null,this._totalVolumeAskTextNode=null,this._countVolumeBuyTextNode=null,this._countVolumeSellTextNode=null,this._countVolumeBid=null,this._countVolumeAsk=null,this._subscription=null,this._noDataTimeout=null,this._actionMarketButtons=null,this._actionPositionButtons=null,this._navButtons=null,this._currentDuration=new(l()),this._durationMetaInfoList=new(l()),this._viewTotalVolumeScheduled=!1,this._detailsOpenState=new(l())(!1),this._csxAllTitle=r.t(null,void 0,i(975336)),this._flattenTitle=r.t(null,void 0,i(987411)),this._reverseTitle=r.t(null,void 0,i(843065)),this._onDurationChanged=e=>{this._currentDuration.setValue(e),this._domDetails.setDurationsInfo(e);const t=this._realtimeProvider.activeBroker();if(null===t)return;const i=We(t.metainfo().id,u.linking.proSymbol.value());h.setValue(i,e.type)},this._onSuggestedQtyChange=e=>{this._calcData.qty.setValue(e),this._mergeUiState({qty:e})},this._visible=t,this._symbolData=null,this._supportedOrderTypes=[2],this._domDetails=new G,this._trading=s,this._qtySuggester=o,this._realtimeProvider=this._trading.realtimeProvider();const n=this._handlers(),a={zeroVolume:this._trading.showPricesWith().zeroVolume.readonly(),spread:this._trading.showPricesWith().spread.readonly()};this._data=new R(n,a,this._realtimeProvider),this._calcData=new q(n),this._uiState={isTradable:!1,isPositionBlocked:!1,hasPosition:!1,hasBuyOrders:!1,hasSellOrders:!1,qty:1,gtcOrder:!1,hasFlatten:!1,hasReverse:!1},this._upperBlockResizeObserver=new v.default((e=>{for(const t of e){const e=Math.ceil(t.target.clientHeight/20);this._data.setHeight(e)}})),this._uiState$=new d.BehaviorSubject(this._uiState),
this._timerLockState={},this._timer=new U(2e3,(()=>{this._data.centerOnLast()}),(e=>{this._updateTimerUi(e)})),this._data.autoCenterRequired.subscribe((e=>{this._mergeTimerLockState({autoCenterRequired:e})})),e.subscribe((e=>this._recreateLayout(e)),{callWithLast:!0}),u.linking.proSymbol.subscribe((()=>{this._onStateChange(),this._updateDetails()})),this._realtimeProvider.onStatusChanged.subscribe(null,(()=>{this._onStateChange(),this._updateDetails()})),t.subscribe((()=>{this._onStateChange()})),this._onStateChange(),this._updateDetails()}uiScroll(e){this._data.getDynamicModeState()||(this._data.shiftTopIndexRelativeToIndex(this._data.topIndex,0|e),this._timer.revert())}uiCenter(){this._data.centerOnLast(),this._trackEvent("Center")}uiCancelOrder(e){this._uiState.isTradable&&null!==e&&((0,c.ensureNotNull)(this._trading.brokerCommandsUI()||null).cancelOrder(e),this._trackEvent("Cancel Order"))}uiModifyOrder(e,t=null){if(!e||!this._uiState.isTradable||void 0===this._configFlags||!(0,S.isModifyOrderSupported)(e,this._configFlags))return Promise.resolve();let i=!0;null===t&&(t={},i=!1);const s=(0,c.ensureNotNull)(this._trading.brokerCommandsUI()||null).modifyOrder({...e,...t},i,void 0,!0);return this._lockTimerUntilSettled(s),this._trackEvent("Modify Order"),Promise.resolve()}uiPlaceOrder({side:e,type:t,price:i=NaN,altPrice:s=NaN}){var o;if(!this._realtimeProvider.activeBroker())return void this._trading.toggleTradingWidget().then((()=>{this._trading.onNeedSelectBroker.fire()}));if(!(null===(o=this._subscription)||void 0===o?void 0:o.broker))return void this._trading.toggleTradingWidget();if(2!==t&&!isFinite(i))return;null===t&&(t=this._data.guessOrderType(i,e));let n=!0;if(null===t&&(n=!1,t=1),!this._isOrderTypeSupported(t))return;const r={};for(const[e,t]of this._domDetails.getSelectedComboBoxValues())r[e]=t.value();for(const[e,t]of this._domDetails.getCheckboxFieldsStates())r[e]=t.value();const a=this._calcData.ask(),l=this._calcData.bid(),d=1===e?a:l,h={symbol:u.linking.proSymbol.value(),qty:this._calcData.qty.value(),side:e,type:t,seenPrice:null!=d?d:null,duration:this._currentDuration.value(),customFields:r};void 0!==a&&void 0!==l&&(h.currentQuotes={ask:a,bid:l}),3===h.type&&(h.stopPrice=i),1===h.type&&(h.limitPrice=i),4===h.type&&(h.stopPrice=i,isFinite(s)?h.limitPrice=s:n=!1),this._lockTimerUntilSettled((0,c.ensureNotNull)(this._trading.brokerCommandsUI()||null).placeOrder(h,n,!0)),this._trackEvent("Place Order",He[t])}uiCancelAllOrders(e){const t=this._uiState;if(!t.isTradable||!t.hasBuyOrders&&!t.hasSellOrders||1===e&&!t.hasBuyOrders||-1===e&&!t.hasSellOrders)return Promise.resolve();const i=(0,c.ensureNotNull)(this._trading.brokerCommandsUI()||null).cancelOrders(u.linking.proSymbol.value(),e);return this._lockTimerUntilSettled(i),e?this._trackEvent("Cancel All "+(1===e?"Buy":"Sell")+" Orders"):this._trackEvent("Cancel All Orders"),Promise.resolve()}async uiClosePosition(){if(this._uiState.isPositionBlocked||!this._uiState.isTradable||!this._uiState.hasPosition||!this._uiState.hasFlatten)return
;const e=this._realtimeProvider.activeBroker();if(!e)return;this._mergeUiState({isPositionBlocked:!0});const t=e.positions(u.linking.proSymbol.value()).then((e=>{for(const t of e)if(0!==t.qty)return(0,c.ensureNotNull)(this._trading.brokerCommandsUI()).closePosition(t.id);return Promise.resolve(!1)})).finally((()=>this._mergeUiState({isPositionBlocked:!1})));this._lockTimerUntilSettled(t),this._trackEvent("Close Position")}async uiReversePosition(){if(this._uiState.isPositionBlocked||!this._uiState.isTradable||!this._uiState.hasPosition||!this._uiState.hasReverse)return;const e=this._realtimeProvider.activeBroker();if(!e)return;this._mergeUiState({isPositionBlocked:!0});const t=e.positions(u.linking.proSymbol.value()).then((e=>{for(const t of e)if(0!==t.qty)return(0,c.ensureNotNull)(this._trading.brokerCommandsUI()).reversePosition(t.id);return Promise.resolve(!1)})).finally((()=>this._mergeUiState({isPositionBlocked:!1})));this._lockTimerUntilSettled(t),this._trackEvent("Reverse")}uiOrderMousedown(e,t,i){if(1!==e.buttons||null===t||null===this._mainBlock||null===this._subscription)return;this.uiStopOrderDrag();const s=t[i],o=this._subscription;let n=NaN;o.orderMouseRoot=document.documentElement,o.orderMousemoveHandler=e=>{if(e.preventDefault(),1!==(e.buttons||e.which)||void 0===this._configFlags||!(0,S.isMoveOrderSupported)(t,this._configFlags))return void this.uiStopOrderDrag();const s=(0,c.ensureNotNull)(this._mainBlock).getBoundingClientRect().y,o=Re(e)-s,r=-Math.floor(o/20),a=this._data.correctIndex(this._data.topIndex,r);n=this._data.indexToPrice(a),this._data.setDragShield(!0,!0),this._mergeTimerLockState({drag:!0}),this._data.setOrderGhost({order:t,pricePropertyName:i,price:n})},o.orderMouseupHandler=()=>{this.uiStopOrderDrag();this._realtimeProvider.activeBroker()&&isFinite(n)&&n!==s&&(this._data.setOrderGhost({order:t,pricePropertyName:i,price:n}),this._data.setDragShield(!0,!0),this._trackEvent("Move Order"),this.uiModifyOrder(t,{[i]:n}).then((()=>this.uiStopOrderDrag())).catch((()=>this.uiStopOrderDrag())))},o.orderMousedownHandler=()=>{this.uiStopOrderDrag()},o.orderMouseRoot.addEventListener("mousemove",o.orderMousemoveHandler),o.orderMouseRoot.addEventListener("mouseup",o.orderMouseupHandler),setTimeout((()=>{const{orderMouseRoot:e,orderMousedownHandler:t}=o;e&&t&&e.addEventListener("mousedown",t)}),0)}uiStopOrderDrag(){if(this._data.setDragShield(!1,!1),this._data.resetOrderGhost(),this._mergeTimerLockState({drag:!1}),!this._subscription)return;const{orderMousemoveHandler:e,orderMouseupHandler:t,orderMousedownHandler:i,orderMouseRoot:s}=this._subscription;delete this._subscription.orderMousemoveHandler,delete this._subscription.orderMouseupHandler,delete this._subscription.orderMousedownHandler,delete this._subscription.orderMouseRoot,s&&e&&s.removeEventListener("mousemove",e),s&&t&&s.removeEventListener("mouseup",t),s&&i&&s.removeEventListener("mousedown",i)}uiContextMenu(e,t,s){if(!this._uiState.isTradable)return;if(1!==t&&-1!==t)return
;const o=this._uiState.qty||NaN,n=u.linking.seriesShortSymbol.value()||u.linking.proSymbol.value(),a=(0,y.abbreviatedNumber)(o),l=[],d=this._symbolData&&this._symbolData.priceFormatter||new w.PriceFormatter;if(this._trackEvent("Context Menu"),isFinite(s)){const e=d.format(s);if(this._isOrderTypeSupported(3)){const o={stopPrice:e,qty:a,symbol:n};let d="";d=1===t?r.t(null,{replace:o},i(812458)):r.t(null,{replace:o},i(793711));const c=new k.Action({actionId:"Trading.DomePlaceStopOrder",label:d,onExecute:()=>{this.uiPlaceOrder({side:t,price:s,type:3})}});l.push(c)}if(this._isOrderTypeSupported(1)){const o={limitPrice:e,qty:a,symbol:n};let d="";d=1===t?r.t(null,{replace:o},i(222821)):r.t(null,{replace:o},i(596283));const c=new k.Action({actionId:"Trading.DomePlaceLimitOrder",label:d,onExecute:()=>{this.uiPlaceOrder({side:t,price:s,type:1})}});l.push(c)}if(this._symbolData&&this._hasStopLimit){const o=(0,C.getMinTick)({minTick:this._symbolData.minTick,price:s,variableMinTickData:this._symbolData.variableMinTickData}),c=new(g())(o).mul(1===t?1:-1).plus(s).toNumber(),u={stopPrice:e,limitPrice:d.format(c),qty:a,symbol:n};let h="";h=1===t?r.t(null,{replace:u},i(832023)):r.t(null,{replace:u},i(81078));const m=new k.Action({actionId:"Trading.DomePlaceStopLimitOrder",label:h,onExecute:()=>{this.uiPlaceOrder({side:t,price:s,altPrice:c,type:4})}});l.push(m)}}if(this._isOrderTypeSupported(2)){const e={qty:a,symbol:n};let s="";s=1===t?r.t(null,{replace:e},i(503491)):r.t(null,{replace:e},i(331840));const o=new k.Action({actionId:"Trading.DomePlaceMarketOrder",label:s,onExecute:()=>{this.uiPlaceOrder({side:t,type:2})}});l.push(o)}l.length&&x.ContextMenuManager.showMenu(l,e,void 0,{menuName:"DomeWidgetContextMenu"})}_recreateLayout(e){null!==this._container&&(this._container.innerHTML="");const t=document.createElement("div"),o=document.createElement("div");this._upperBlockResizeObserver.disconnect(),this._upperBlockResizeObserver.observe(t),t.classList.add(Ve.upperBlock),o.classList.add(Ve.bottomBlock),this._container=e;const n=function(e){const t=document.createElement("span"),o=document.createElement("span");return t.className=`${O["tv-dome-widget-main__offscreen-arrow"]} ${O["tv-dome-widget-main__offscreen-arrow--higher"]} js-hidden`,o.className=`${O["tv-dome-widget-main__offscreen-arrow"]} ${O["tv-dome-widget-main__offscreen-arrow--lower"]} js-hidden`,t.innerHTML=i(826724),o.innerHTML=i(237699),e.append(t),e.append(o),e=>{t.classList.toggle("js-hidden",e!==s.Higher),o.classList.toggle("js-hidden",e!==s.Lower)}}(t);this._data.getOffscreenIndexLocationObservable().subscribe(n),this._createMainBlock(t),this._createNavBlock(o),this._createDomBottomWidget(o),this._container.append(t),this._container.append(o),this._calcData.reset()}_createMainBlock(e){const t=document.createElement("div");t.className=O["tv-dome-widget-main"],e.append(t);const s=this._warning=document.createElement("div");s.className=`${Me["tv-dome-panel__warning"]} i-hidden`,s.textContent=r.t(null,void 0,i(180526)),t.append(s),this._data.setContainer(t);let o=0
;t.addEventListener("wheel",(e=>{if(e.preventDefault(),!this._data.getDynamicModeState()&&(e.deltaMode!==e.DOM_DELTA_PAGE?o-=(0,m.getPixelsFromEvent)(e).y/100:o-=(0,_.clamp)(e.deltaY,-1,1),Math.abs(o)>=1)){const e=o%1;this.uiScroll(o-e),o=e}}));let n=!1;const a=e=>{if(n)return;const t="touches"in e;if(!t&&1!==(e.buttons||e.which))return;const i=this._data.topIndex;if(!isFinite(i))return;if(t&&1!==e.touches.length)return;if(!(e.target instanceof Element))return;if(!e.target.closest(`.${O["tv-dome-widget-main__value--price"]}`))return;n=!0;const s=Re(e),o=document.documentElement,r=()=>{["mouseup","mousedown","touchend","touchstart","touchcancel"].forEach((e=>o.removeEventListener(e,r))),o.removeEventListener("mousemove",a),o.removeEventListener("touchmove",a),n=!1,this._data.setDragShield(!1,!1),this._mergeTimerLockState({scroll:!1})},a=e=>{if(e.preventDefault(),!this._data.getDynamicModeState()){if(!t&&1!==(e.buttons||e.which))return void r();const o=Re(e)-s,n=Math.round(o/20);n&&(this._data.setDragShield(!0,!1),this._mergeTimerLockState({scroll:!0})),this._data.shiftTopIndexRelativeToIndex(i,n)}};o.addEventListener(t?"touchmove":"mousemove",a),o.addEventListener(t?"touchend":"mouseup",r),t&&o.addEventListener("touchcancel",r),setTimeout((()=>{n&&o.addEventListener(t?"touchstart":"mousedown",r)}),0)};t.addEventListener("mousedown",a),t.addEventListener("touchstart",a),t.addEventListener("dblclick",(e=>{if(!(e.target instanceof Element))return;e.target.closest(`.${O["tv-dome-widget-main__value--price"]}`)&&this.uiCenter()})),this._mainBlock=t,document.addEventListener("keydown",(e=>this._data.handlerKey(e)),!1),document.addEventListener("keyup",(e=>this._data.handlerKey(e)),!1)}_createDomBottomWidget(e){const t=document.createElement("div");e.append(t);const i={domDetails:this._domDetails,currentDuration:this._currentDuration,durationMetaInfoList:this._durationMetaInfoList,onDurationChanged:this._onDurationChanged,openState:this._detailsOpenState},s={calcData:this._calcData},r={uiPlaceOrder:e=>this.uiPlaceOrder(e)},a={uiClosePosition:()=>this.uiClosePosition(),uiCancelAllOrders:()=>this.uiCancelAllOrders(),uiReversePosition:()=>this.uiReversePosition()},l={plState:this._calcData.plState$,positionState:this._calcData.positionState$,changePLViewType:this._calcData.changePLViewType,compareQty:this._calcData.compareQty};!function(e,t){o.render(n.createElement(Ee,{...t}),e)}(t,{uiState$:this._uiState$.asObservable(),tradingActionBlockControllers:a,domDetailsDropdownProps:i,domNumberContainerProps:s,domMarketActionBlockProps:r,domCalcBlockProps:l})}_createNavBlock(e){const t={on:Fe,off:Ae},s=(0,c.ensureNotNull)((0,
I.parseHtmlElement)(`\n\t\t\t<div class="tv-dome-widget-nav-wrapper">\n\t\t\t\t<div class="${Be["tv-dome-widget-nav"]}">\n\t\t\t\t\t<div class="${Be["tv-dome-widget-nav__button-block"]} ${Be["tv-dome-widget-nav__button-block--orders"]}">\n\t\t\t\t\t\t<span class="apply-common-tooltip ${Be["tv-dome-widget-nav__button"]} ${Be["tv-dome-widget-nav__button--clear-ask"]} js-clear-ask">\n\t\t\t\t\t\t\t${Le}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class="${Be["tv-dome-widget-nav_count-volume"]} js-count-volume-buy"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="${Be["tv-dome-widget-nav__button-block"]} ${Be["tv-dome-widget-nav__button-block--price"]}">\n\t\t\t\t\t\t<div class="${Be["tv-dome-widget-nav_overall-volume"]} ${Be["tv-dome-widget-nav_overall-volume--bid"]}">\n\t\t\t\t\t\t\t<span class="apply-common-tooltip js-total-volume-bid"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="${Be["tv-dome-widget-nav_center"]} apply-common-tooltip js-center">\n\t\t\t\t\t\t\t<svg class="${Be["tv-dome-widget-nav__timer"]}" viewBox="-1 -1 2 2" width="2" height="2">\n\t\t\t\t\t\t\t\t<path d="M 0,0" class="js-timer-path"></path>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<span class="${Be["tv-dome-widget-nav__button"]} ${Be["tv-dome-widget-nav__button--center"]} js-center-target">\n\t\t\t\t\t\t\t\t${t.off}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="${Be["tv-dome-widget-nav_overall-volume"]} ${Be["tv-dome-widget-nav_overall-volume--ask"]}">\n\t\t\t\t\t\t\t<span class="apply-common-tooltip js-total-volume-ask"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="${Be["tv-dome-widget-nav__button-block"]} ${Be["tv-dome-widget-nav__button-block--orders"]}">\n\t\t\t\t\t\t<span class="${Be["tv-dome-widget-nav_count-volume"]} js-count-volume-sell"></span>\n\t\t\t\t\t\t<span class="apply-common-tooltip ${Be["tv-dome-widget-nav__button"]} ${Be["tv-dome-widget-nav__button--clear-bid"]} js-clear-bid">\n\t\t\t\t\t\t\t${Le}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`)),o=(0,c.ensureNotNull)(s.querySelector(".js-clear-ask")),n=(0,c.ensureNotNull)(s.querySelector(".js-clear-bid")),a=(0,c.ensureNotNull)(s.querySelector(".js-center")),l=(0,c.ensureNotNull)(s.querySelector(".js-center-target"));this._totalVolumeBidTextNode=document.createTextNode("-"),this._totalVolumeAskTextNode=document.createTextNode("-"),this._countVolumeBuyTextNode=document.createTextNode(""),this._countVolumeSellTextNode=document.createTextNode("");const d=(0,c.ensureNotNull)(s.querySelector(".js-total-volume-bid")),u=(0,c.ensureNotNull)(s.querySelector(".js-total-volume-ask")),h=(0,c.ensureNotNull)(this._countVolumeBid=s.querySelector(".js-count-volume-buy")),m=(0,c.ensureNotNull)(this._countVolumeAsk=s.querySelector(".js-count-volume-sell"));d.appendChild(this._totalVolumeBidTextNode),d.setAttribute("title",r.t(null,void 0,i(353723))),u.appendChild(this._totalVolumeAskTextNode),u.setAttribute("title",r.t(null,void 0,i(977088))),h.appendChild(this._countVolumeBuyTextNode),
m.appendChild(this._countVolumeSellTextNode),o.setAttribute("title",r.t(null,void 0,i(702333))),n.setAttribute("title",r.t(null,void 0,i(139710))),a.setAttribute("title",r.t(null,void 0,i(785663))),o.addEventListener("click",(e=>{e.preventDefault(),this.uiCancelAllOrders(1)})),n.addEventListener("click",(e=>{e.preventDefault(),this.uiCancelAllOrders(-1)})),a.addEventListener("click",(e=>{e.preventDefault(),this.uiCenter();const s=this._data.toggleDynamicModeState(),o=s?t.on:t.off,n=s?r.t(null,void 0,i(44316)):r.t(null,void 0,i(785663));a.setAttribute("title",n),l.removeChild(l.children[0]),l.appendChild((0,c.ensureNotNull)((0,I.parseHtmlElement)(o)))})),this._svgTimerPath=s.querySelector(".js-timer-path"),this._navButtons={clearBuy:o,clearSell:n},e.append(s)}_createNoticeBlock(){const e=(0,c.ensureNotNull)(this._container);this._noDataNoticeBlock=document.createElement("div"),this._noDataNoticeBlock.className=Me["tv-dome-panel__no-data-notice"],e.append(this._noDataNoticeBlock)}_showNoDataNotice(){var e;const t=null===(e=this._realtimeProvider.activeBroker())||void 0===e?void 0:e.metainfo().title;null!==this._noDataNoticeBlock&&void 0!==t&&o.render(n.createElement(Informer,{header:r.t(null,void 0,i(697174)),content:r.t(null,void 0,i(706844)).replace("{brokerName}",t),informerIntent:"warning"}),this._noDataNoticeBlock)}_hideNoDataNotice(){null!==this._noDataNoticeBlock&&o.unmountComponentAtNode(this._noDataNoticeBlock)}_syncActionButtons(){const{isPositionBlocked:e,isTradable:t,hasPosition:i,hasBuyOrders:s,hasSellOrders:o,hasFlatten:n,hasReverse:r}=this._uiState;if(this._actionPositionButtons&&this._actionMarketButtons){const a={...this._actionPositionButtons,...this._actionMarketButtons},l="i-disabled";a.flatten.disabled=e||!t||!i||!n,a.reverse.disabled=e||!t||!i||!r,a.clear.disabled=!t||!(s||o),a.flatten.title=this._flattenTitle,a.reverse.title=this._reverseTitle,a.clear.title=this._csxAllTitle;const d=this._isOrderTypeSupported(2);a.buyMarket.classList.toggle(l,!d),a.sellMarket.classList.toggle(l,!d)}if(this._navButtons){const e=this._navButtons,i=Be["tv-dome-widget-nav__button--disabled"];e.clearBuy.classList.toggle(i,!t||!s),e.clearSell.classList.toggle(i,!t||!o)}}_mergeUiState(e){const t=this._uiState;let i,s=!1;for(i in e)t[i]!==e[i]&&(t[i]=e[i],s=!0);s&&(this._uiState$.next({...t}),this._syncActionButtons())}_handlers(){return{closeButtonClick:(e,t)=>{e.preventDefault(),this.uiCancelOrder(t&&t.id)},qtyClick:(e,t)=>{e.preventDefault(),this.uiModifyOrder(t)},bidAskClick:(e,{side:t,price:i,type:s})=>{e.preventDefault(),this.uiPlaceOrder({side:t,price:i,type:s||null})},bidAskContextMenu:(e,{side:t,price:i})=>{e.preventDefault(),this.uiContextMenu(e,t,i)},qtyChange:e=>{!isFinite(e)||e<0||(this._qtySuggester.setQty(u.linking.proSymbol.value(),e),this._mergeUiState({qty:e}))},qtyInput:e=>{!isFinite(e)||e<0||this._mergeUiState({qty:e})},orderMousedown:(e,{order:t,pricePropertyName:i})=>{this.uiOrderMousedown(e,t,i)}}}_mergeTimerLockState(e){const t=this._timerLockState;let i,s=!1;for(i in e)t[i]!==e[i]&&(t[i]=e[i],
s=!0);s&&(!t.autoCenterRequired||t.scroll||t.drag||t.dialog?this._timer.abort():this._timer.run())}_lockTimerUntilSettled(e){if(!e)return;this._mergeTimerLockState({dialog:e});const t=()=>{this._timerLockState.dialog===e&&this._mergeTimerLockState({dialog:null})};e.then(t,t)}_updateTimerUi(e){e=e||0,(0,c.ensureNotNull)(this._svgTimerPath).setAttribute("d",(e=>{let t="M 0 0";return e>0&&(e>=1?t="M 0 -1":t+="L 0 -1",e>.5&&(t+="A 1 1 0 0 1 0 1"),t+="A 1 1 0 0 1 "+Math.sin(2*e*Math.PI)+" "+-Math.cos(2*e*Math.PI)+"Z"),t})(e))}async _getSymbolData(e){const t=this._realtimeProvider.activeBroker(),[i,s,o,n]=await Promise.all([this._realtimeProvider.symbolInfo(e),this._realtimeProvider.quantityFormatter(e),null==t?void 0:t.getPositionCurrency(e),null==t?void 0:t.formatter(e,!0)]),r=null!=n?n:await this._realtimeProvider.formatter(e),a=Math.ceil(-Math.log10(i.qty.step)),l=new f.VolumeFormatter(a);return{minTick:i.minTick,pipSize:i.pipSize,priceFormatter:r,volumeFormatter:l,quantityFormatter:s,qtyProperties:i.qty,lotSize:i.lotSize,positionCurrency:o,variableMinTickData:i.variableMinTick?(0,C.makeVariableMinTickData)(i.minTick,i.variableMinTick):void 0}}_unsubscribeData(){var e;if(!this._subscription)return;const{broker:t,symbol:i,domeHandler:s,realtimeHandler:o,orderHandler:n,positionHandler:r,plHandler:a,plPositionId:l,fullUpdateOrders:d,fullUpdatePosition:c}=this._subscription;this._subscription=null,i&&o&&this._realtimeProvider.unsubscribeRealtime(i,o),i&&s&&this._realtimeProvider.unsubscribeDOME(i,s),t&&n&&t.orderUpdate.unsubscribe(null,n),t&&r&&t.positionUpdate.unsubscribe(null,r),t&&a&&l&&t.unsubscribePL(l,a),t&&d&&t.currentAccountUpdate.unsubscribe(null,d),t&&c&&t.currentAccountUpdate.unsubscribe(null,c),null===(e=this._suggestedQtySubscription)||void 0===e||e.unsubscribe()}_trackEvent(e,t){this._trading.trackEvent("DOM",e,t)}_processOrders(e){const t=[];let i=!1,s=!1;for(let o=0;o<e.length;o++){const n=e[o];if(4===n.status||3===n.status||6===n.status)switch(t.push(n),n.side){case 1:i=!0;break;case-1:s=!0}}this._data.updateOrders(t),this._updateValueBuySellOrders(),this._mergeUiState({hasBuyOrders:i,hasSellOrders:s})}_processPositions(e,t,i){const s=i.find((e=>0!==e.qty));this._mergeUiState({hasPosition:!!s}),void 0!==s&&s.id===t.plPositionId||t.plPositionId&&t.plHandler&&e.unsubscribePL&&(e.unsubscribePL(t.plPositionId,t.plHandler),delete t.plPositionId,t.plHandler=null),void 0===s||t.plPositionId===s.id&&t.plHandler||(t.plHandler=(e,i)=>{this._subscription===t&&this._calcData.updatePL(i)},t.plPositionId=s.id,e.subscribePL(t.plPositionId,t.plHandler)),this._data.updatePosition(s),this._calcData.updatePosition(s),this._calcData.updatePL()}_updateDurationMetainfo(e,t){if(this._durationMetaInfoList.setValue(null==e?void 0:e.metainfo().durations),null===e||void 0===this._durationMetaInfoList.value())return;const i=We(e.metainfo().id,t),s=h.getValue(i),o=void 0!==s?this._makeOrderDuration(s):this._makeDefaultOrderDuration();this._currentDuration.setValue(o),
void 0!==o&&this._domDetails.setDurationsInfo(o,this._durationMetaInfoList.value())}_makeDefaultOrderDuration(){const e=this._durationMetaInfoList.value();if(void 0===e||0===e.length)return;const t=e.find((e=>!0===e.default))||e[0];return(0,S.makeOrderDuration)(t)}_makeOrderDuration(e){var t;const i=null===(t=this._durationMetaInfoList.value())||void 0===t?void 0:t.find((t=>t.value===e));return void 0!==i?(0,S.makeOrderDuration)(i):void 0}async _onStateChange(){var e;const t=u.linking.proSymbol.value(),i=this._realtimeProvider.activeBroker(),s=null==i?void 0:i.metainfo().configFlags.calculatePLUsingLast;if(this._updateDurationMetainfo(i,t),!this._visible.value())return void this._unsubscribeData();this._noDataTimeout&&clearTimeout(this._noDataTimeout),this._noDataTimeout=setTimeout((()=>{var e;null===(e=this._warning)||void 0===e||e.classList.remove("i-hidden")}),3e3),this._symbolData=null,this._unsubscribeData(),this._data.reset(),this._calcData.setBrokerConfigFlags({calculatePLUsingLast:!0===s}),this._calcData.reset();const o=null===i||(null==i?void 0:i.metainfo().configFlags.supportDOM);this._configFlags=null==i?void 0:i.metainfo().configFlags,this._hasStopLimit=null!==i&&i.metainfo().configFlags.supportStopLimitOrders,this._mergeUiState({isTradable:!1,hasPosition:!1,hasBuyOrders:!1,hasSellOrders:!1,qty:void 0,hasFlatten:null!==i&&!i.metainfo().configFlags.supportMultiposition,hasReverse:null!==i&&i.metainfo().configFlags.supportReversePosition}),this._mergeTimerLockState({scroll:!1,drag:!1,dialog:null}),this.uiStopOrderDrag();let n=[],r=[];if(!t||!o)return;const a={broker:i,symbol:t,domeHandler:null,realtimeHandler:null,orderHandler:null,positionHandler:null,plHandler:null,plPositionId:void 0,fullUpdateOrders:null,fullUpdatePosition:null};this._subscription=a;const l=await this._qtySuggester.getQty(t);this._onSuggestedQtyChange(l),this._suggestedQtySubscription=this._qtySuggester.suggestedQtyChanged(t).subscribe(this._onSuggestedQtyChange);const d=await this._getSymbolData(t);if(this._calcData.setHasLotSize(void 0!==d.lotSize),!d)return;if(this._subscription!==a)return;this._symbolData=d,this._data.setSymbolInfo(d),this._calcData.setSymbolInfo(d),this.isBats.setValue(!1),a.realtimeHandler=(e,t)=>{var i;const s=t.trade||t.bid||t.ask;s&&this._noDataTimeout&&(null===(i=this._warning)||void 0===i||i.classList.add("i-hidden"),clearTimeout(this._noDataTimeout),this._noDataTimeout=null),this._data.updateLast(s||NaN),this._calcData.updateLast(t.trade||NaN,t.bid||NaN,t.ask||NaN),this.delayedData.setValue(Boolean(t.isDelayed)),!this.isBats.value()&&(0,S.isBatsQuotes)(t)&&this.isBats.setValue(!0)},a.domeHandler=(e,t)=>{this._data.updateData(t),this._scheduleUpdateViewTotalVolume()};const c=null===(e=await this._realtimeProvider.isTradable(t))||void 0===e?void 0:e.tradable;this._mergeUiState({isTradable:c}),this._realtimeProvider.subscribeRealtime(t,a.realtimeHandler),this._realtimeProvider.subscribeDOME(t,a.domeHandler),this._supportedOrderTypes=this._getSupportedOrderTypes(i),i&&c&&(a.orderHandler=e=>{
if(e.symbol!==a.symbol)return;const t=n.findIndex((t=>t.id===e.id));-1!==t?n[t]=e:n.push(e),this._processOrders(n)},a.positionHandler=e=>{if(e.symbol!==a.symbol)return;const t=r.findIndex((t=>t.id===e.id));-1!==t?r[t]=e:r.push(e),this._processPositions(i,a,r)},a.fullUpdateOrders=()=>{const e=i.orders(t);a.orderPromise=e,e.then((t=>{this._subscription===a&&a.orderPromise===e&&(n=t,this._processOrders(t))}))},a.fullUpdatePosition=()=>{const e=i.positions(t);a.positionPromise=e,e.then((t=>{this._subscription===a&&a.positionPromise===e&&(r=t,this._processPositions(i,a,t))}))},i.orderUpdate.subscribe(null,a.orderHandler),i.positionUpdate.subscribe(null,a.positionHandler),i.currentAccountUpdate.subscribe(null,a.fullUpdateOrders),i.currentAccountUpdate.subscribe(null,a.fullUpdatePosition),a.fullUpdateOrders(),a.fullUpdatePosition()),this._updateViewTotalVolume(),this._updateValueBuySellOrders()}async _updateDetails(){var e,t;const i=await(null===(e=this._realtimeProvider.activeBroker())||void 0===e?void 0:e.getOrderDialogOptions(u.linking.proSymbol.value())),s=null!==(t=null==i?void 0:i.customFields)&&void 0!==t?t:[];this._domDetails.setCustomFields(s)}_getSupportedOrderTypes(e){const t=[];return null===e||1!==e.connectionStatus()?[2]:(e.metainfo().configFlags.supportMarketOrders&&t.push(2),e.metainfo().configFlags.supportLimitOrders&&t.push(1),e.metainfo().configFlags.supportStopOrders&&t.push(3),e.metainfo().configFlags.supportStopLimitOrders&&t.push(4),t)}_isOrderTypeSupported(e){return-1!==this._supportedOrderTypes.indexOf(e)}_scheduleUpdateViewTotalVolume(){this._viewTotalVolumeScheduled||(this._viewTotalVolumeScheduled=!0,window.requestAnimationFrame((()=>this._updateViewTotalVolume())))}_updateViewTotalVolume(){if(this._viewTotalVolumeScheduled=!1,this._symbolData){const e=this._data.totalVolumeBid(),t=this._data.totalVolumeAsk(),i=(0,c.ensureNotNull)(this._totalVolumeBidTextNode),s=(0,c.ensureNotNull)(this._totalVolumeAskTextNode);i.nodeValue=isFinite(e)?this._data.formatVolume(e):"-",s.nodeValue=isFinite(t)?this._data.formatVolume(t):"-"}}_updateValueBuySellOrders(){const e=this._data.buyOrdersValue(),t=this._data.sellOrdersValue(),i=this._data.buyInactiveOrdersValue(),s=this._data.sellInactiveOrdersValue(),o=this._data.buyOrdersQuantity(),n=this._data.sellOrdersQuantity(),r=(0,c.ensureNotNull)(this._countVolumeBid),a=(0,c.ensureNotNull)(this._countVolumeAsk),l=(0,c.ensureNotNull)(this._countVolumeBuyTextNode),d=(0,c.ensureNotNull)(this._countVolumeSellTextNode);0!==e||0!==i?(r.setAttribute("title",this._setFormattingTextForCountVolume(e,i,+o)),r.classList.add("apply-common-tooltip")):(r.setAttribute("title",""),r.classList.remove("apply-common-tooltip")),0!==t||0!==s?(a.setAttribute("title",this._setFormattingTextForCountVolume(t,s,+n)),a.classList.add("apply-common-tooltip")):(a.setAttribute("title",""),a.classList.remove("apply-common-tooltip")),l.nodeValue=String(i>0?e:e||""),d.nodeValue=String(s>0?t:t||"")}_setFormattingTextForCountVolume(e,t,s){const o=r.t(null,{
plural:"{countOrders} active orders x {countQuantity}",count:e},i(726965)).format({countOrders:String(e),countQuantity:String(s)}),n=r.t(null,{plural:"{countInactiveOrders} inactive orders",count:t},i(373797)).format({countInactiveOrders:String(t)});return o+(t>0?`, ${n}`:"")}}var Ue=i(32133),ze=i(379266),$e=i(926909);const Ge=r.t(null,void 0,i(573712)),Qe=r.t(null,void 0,i(747987)),Ke=r.t(null,void 0,i(860469));function je(e){const t=(0,J.useWatchedValueReadonly)({watchedValue:e.symbol}),i=(0,J.useWatchedValueReadonly)({watchedValue:e.delayedData}),s=(0,J.useWatchedValueReadonly)({watchedValue:e.isBats}),[o,r]=(0,X.useWatchedValue)(e.domeSettings.zeroVolume),[a,l]=(0,X.useWatchedValue)(e.domeSettings.spread),d=n.createElement(n.Fragment,null,n.createElement(ze.PopupMenuItemToggle,{label:Ge,isChecked:o,onClick:()=>r(!o)}),n.createElement(ze.PopupMenuItemToggle,{label:Qe,isChecked:a,onClick:()=>l(!a)}));return n.createElement($e.Header,{title:t.symbol,description:t.exchange&&", "+t.exchange,symbol:t.symbol,settingsItems:d,hasDelayedWarning:i,hasCloseButton:!0,close:function(){(0,Ue.trackEvent)("GUI","DOM panel closed from panel"),e.closePanel()},delayedWarningMessage:Ke,hasBatsQuotes:s})}class Xe{constructor(e,t,s){var o;this._widget=null;this._resizerBridge=t,this._height=this._resizerBridge.height,this._innerHeight=new(l()),this._widgetBody=new(l()),this._height.subscribe((e=>{this._innerHeight.setValue(Math.max(e-42,0))}),{callWithLast:!0}),this._visible=new(l())(!1),this._close=()=>{},this._trading=e,this._qtySuggester=s,this._body=this._resizerBridge.container.value().querySelector(".trading-panel-content"),this._header=document.createElement("div"),this._container=document.createElement("div");const n=u.linking.proSymbol.value(),a=null===(o=this._trading.activeBroker())||void 0===o?void 0:o.metainfo().title;this._symbol=new(l())({symbol:n||"",exchange:a||""});const d=()=>{const e=this._trading.activeBroker();let t;if(e&&1===e.connectionStatus()&&!e.metainfo().configFlags.supportDOM){const e=document.querySelector(Me["tv-dome-panel__content"]);if(null!==document.querySelector(Me["tv-dome-panel__disabled"])||null===e)return;const s=document.createElement("span");return t=document.createElement("div"),s.classList.add(Me["tv-dome-panel__disabled-warning"]),s.innerText=r.t(null,void 0,i(848990)),t.classList.add(Me["tv-dome-panel__disabled"]),t.appendChild(s),void e.insertBefore(t,e.firstChild)}t=document.querySelector(Me[".tv-dome-panel__disabled"]),t&&t.parentNode&&t.parentNode.removeChild(t)},c=e=>{var t,i;e?(this._body.append(this._header),this._body.append(this._container)):(null===(t=this._body.querySelector(".tv-dome-header"))||void 0===t||t.remove(),null===(i=this._body.querySelector(Me["tv-dome-panel"]))||void 0===i||i.remove()),this._displayHeader(this._header,e)};this._trading.onConnectionStatusChange.subscribe(null,d),this._visible.subscribe(d),d(),this._visible.when((()=>{this._updateSymbol(u.linking.proSymbol.value()),this._resizerBridge.container.subscribe((e=>{
this._body=e.querySelector(".trading-panel-content"),this._createLayout(),this._trading.onBrokerChange.subscribe(this,(()=>this._updateSymbol(u.linking.proSymbol.value()))),u.linking.proSymbol.spawn().subscribe((e=>this._updateSymbol(e))),d()}),{callWithLast:!0}),this._widget=new qe(this._widgetBody,this._visible,this._trading,this._qtySuggester),this._visible.subscribe(c),this._displayHeader(this._header,!0)}))}setCloseHandler(e){this._close=e}setVisibility(e){this._visible.setValue(e)}_displayHeader(e,t){t&&this._widget?o.render(n.createElement(je,{symbol:this._symbol,closePanel:this._close,domeSettings:this._trading.showPricesWith(),delayedData:this._widget.delayedData,isBats:this._widget.isBats}),e):o.unmountComponentAtNode(e)}_createLayout(){this._header.classList.add("tv-dome-header"),this._body.append(this._header),this._container.classList.add(Me["tv-dome-panel"]);const e=document.createElement("div");return e.classList.add(Me["tv-dome-panel__content"],Me.mainblock),this._container.append(e),this._container.addEventListener("contextmenu",(e=>{e.target instanceof HTMLElement&&e.target.matches("input, textarea")||e.preventDefault()})),this._body.append(this._container),this._widgetBody.setValue(e),e}_updateSymbol(e){var t;const i=e,s=null===(t=this._trading.activeBroker())||void 0===t?void 0:t.metainfo().title;this._symbol.setValue({symbol:i||"",exchange:s||""})}}},613977:(e,t,i)=>{"use strict";i.d(t,{CheckboxCustomField:()=>b});var s,o=i(50959),n=i(302946),r=i(901317),a=i(497754),l=i(72571),d=i(744471),c=i(972535),u=i(952955),h=i(785508),m=i(686989);function _(){document.removeEventListener("scroll",_),document.removeEventListener("touchstart",_),(0,d.hide)()}function p(e){c.mobiletouch&&((0,d.showOnElement)(e.currentTarget,{tooltipDelay:0}),document.addEventListener("scroll",_),document.addEventListener("touchstart",_))}function g(e){var t;const{size:i=s.Small}=e,n=i===s.Medium?m:h;return o.createElement("span",{title:e.text,role:"img","aria-label":e.text,className:a("apply-common-tooltip",u["info-icon-wrap"],e.className),onClick:null!==(t=e.customClickHandler)&&void 0!==t?t:p},o.createElement(l.Icon,{icon:n,className:a(u["info-icon"],u[`size-${i}`]),"aria-hidden":"true"}))}!function(e){e.Small="s",e.Medium="m"}(s||(s={}));var v=i(253378);function b(e){const{title:t,help:i,disabled:a,checked:l,onControlFocused:d}=e,[c,u]=(0,r.useWatchedValue)(l);return o.createElement("div",{className:v.wrapper,onFocus:function(){null==d||d.fire()}},o.createElement(n.Checkbox,{label:t,checked:c,onChange:function(){u(!c)},disabled:a}),void 0!==i&&""!==i&&o.createElement(g,{size:s.Small,text:i,className:v.help}))}},587374:(e,t,i)=>{"use strict";i.d(t,{CustomComboboxContainer:()=>v});var s=i(50959),o=i(509806),n=i(497754),r=i.n(n),a=i(601227),l=i(917780),d=i(961428),c=i(269842),u=i(525388);const h=s.forwardRef(((e,t)=>{var i
;const{intent:o,onFocus:n,onBlur:r,onMouseOver:a,onMouseOut:h,hasErrors:m,hasWarnings:_,errors:p,warnings:g,alwaysShowAttachedErrors:v,messagesPosition:b,messagesAttachment:w,inheritMessagesWidthFromTarget:f,...y}=e,k=(0,d.useControlValidationLayout)({hasErrors:m,hasWarnings:_,errors:p,warnings:g,alwaysShowAttachedErrors:v,messagesPosition:b,messagesAttachment:w,iconHidden:!0,inheritMessagesWidthFromTarget:f}),x=(0,c.createSafeMulticastEventHandler)(n,k.onFocus),I=(0,c.createSafeMulticastEventHandler)(r,k.onBlur),C=(0,c.createSafeMulticastEventHandler)(a,k.onMouseOver),S=(0,c.createSafeMulticastEventHandler)(h,k.onMouseOut);return s.createElement(s.Fragment,null,s.createElement(l.Select,{...y,intent:null!==(i=k.intent)&&void 0!==i?i:o,onFocus:x,onBlur:I,onMouseOver:C,onMouseOut:S,ref:(0,u.useMergedRefs)([k.containerReference,t])}),k.renderedErrors)}));h.displayName="FormSelect";var m=i(192063),_=i(155185),p=i(684202);function g(e){const{items:t,forceUserToSelectValue:n,alwaysShowAttachedErrors:l,selectedItem:c,disabled:u,title:g,onClick:v,onItemSelected:b,onClose:w}=e,f=(0,s.useMemo)((()=>function(e){return e.map((e=>({value:e.value,content:e.text})))}(t)),[t]),y=(0,s.useMemo)((()=>Object.values(f).map(((e,t)=>{var i;return s.createElement(m.PopupMenuItem,{key:e.value,label:null!==(i=e.content)&&void 0!==i?i:e.value,onClickArg:t,onClick:C})}))),[f]),k=void 0===c&&n,x=s.createElement(h,{value:c,items:f,className:p.select,menuClassName:p.selectMenu,onClick:function(){void 0!==v&&v()},onChange:function(e){b(e)},disabled:u,placeholder:void 0===c?o.t(null,void 0,i(880280)):void 0,addPlaceholderToItems:!1,hasErrors:k,messagesPosition:d.MessagesPosition.Static,inheritMessagesWidthFromTarget:!0,hideArrowButton:f.length<=1,stretch:!0,alwaysShowAttachedErrors:l&&k,matchButtonAndListboxWidths:!0});return s.createElement(s.Fragment,null,s.createElement("div",{className:r()(p.title,k&&p.titleWithError)},k?o.t(null,{replace:{fieldTitle:String(g)}},i(693251)):g),a.CheckMobile.any()?s.createElement(_.ToolWidgetMenu,{className:p.menuButton,content:x,children:y,arrow:!1,onClose:I,isDrawer:!0,closeOnClickOutside:!0}):x);function I(){void 0!==w&&w()}function C(e){b(t[e||0].value),I()}}class v extends s.PureComponent{constructor(e){super(e),this._onItemSelected=e=>{this.props.selectedItem.setValue(e)},this._onClick=()=>{this.props.onControlFocused&&this.props.onControlFocused.fire()},this._callback=()=>this.forceUpdate()}componentDidMount(){this.props.selectedItem.subscribe(this._callback)}componentWillUnmount(){this.props.selectedItem.unsubscribe(this._callback)}render(){return s.createElement(g,{title:this.props.title,items:this.props.items,selectedItem:this.props.selectedItem.value(),onItemSelected:this._onItemSelected,disabled:this.props.disabled,onClick:this._onClick,onClose:this.props.onClose,forceUserToSelectValue:this.props.forceUserToSelectValue,alwaysShowAttachedErrors:this.props.alwaysShowAttachedErrors})}}},42107:(e,t,i)=>{"use strict";i.d(t,{DurationControl:()=>U})
;var s=i(509806),o=i(50959),n=i(601227),r=i(654936),a=i(72571),l=i(102691),d=i(838683),c=i(842974),u=i(922157),h=i.n(u),m=i(28466),_=i(917780),p=i(192063),g=i(155185),v=i(930052),b=i(996038),w=i(650151)
;const f=JSON.parse('{"ar_AE":{"language":"ar","language_name":"","flag":"ae","geoip_code":"ae","countries_with_this_language":["ae","bh","dj","dz","eg","er","iq","jo","km","kw","lb","ly","ma","mr","om","qa","sa","sd","so","sy","td","tn","ye"],"priority":500,"dir":"rtl","iso":"ar","iso_639_3":"arb","show_on_widgets":true,"global_name":"Arabic"},"br":{"language":"pt","language_name":"Portugus","flag":"br","geoip_code":"br","priority":650,"iso":"pt","iso_639_3":"por","show_on_widgets":true,"global_name":"Portuguese"},"ca_ES":{"language":"ca_ES","language_name":"Catal","flag":"es","geoip_code":"es","priority":745,"iso":"ca","iso_639_3":"cat","disabled":true,"show_on_widgets":true,"global_name":"Catalan"},"cs":{"language":"cs","language_name":"Czech","flag":"cz","geoip_code":"cz","priority":718,"iso":"cs","iso_639_3":"ces","show_on_widgets":true,"global_name":"Czech","is_in_european_union":true,"isBattle":true},"de_DE":{"language":"de","language_name":"Deutsch","flag":"de","geoip_code":"de","countries_with_this_language":["at","ch"],"priority":756,"iso":"de","iso_639_3":"deu","show_on_widgets":true,"global_name":"German","is_in_european_union":true},"en":{"language":"en","language_name":"English","flag":"us","geoip_code":"us","priority":1000,"iso":"en","iso_639_3":"eng","show_on_widgets":true,"global_name":"English","is_only_recommended_tw_autorepost":true},"es":{"language":"es","language_name":"Espaol","flag":"es","geoip_code":"es","countries_with_this_language":["mx","ar","ve","cl","co","pe","uy","py","cr","gt","c","bo","pa","pr"],"priority":744,"iso":"es","iso_639_3":"spa","show_on_widgets":true,"global_name":"Spanish","is_in_european_union":true},"fa_IR":{"language":"fa","language_name":"","flag":"ir","geoip_code":"ir","priority":480,"dir":"rtl","iso":"fa","iso_639_3":"fas","show_on_widgets":false,"global_name":"Iranian","disabled":true},"fr":{"language":"fr","language_name":"Franais","flag":"fr","geoip_code":"fr","priority":750,"iso":"fr","iso_639_3":"fra","show_on_widgets":true,"global_name":"French","is_in_european_union":true},"he_IL":{"language":"he_IL","language_name":"","flag":"il","geoip_code":"il","priority":490,"dir":"rtl","iso":"he","iso_639_3":"heb","show_on_widgets":true,"global_name":"Israeli"},"hu_HU":{"language":"hu_HU","language_name":"Magyar","flag":"hu","geoip_code":"hu","priority":724,"iso":"hu","iso_639_3":"hun","show_on_widgets":true,"global_name":"Hungarian","is_in_european_union":true,"disabled":true},"id":{"language":"id_ID","language_name":"Bahasa Indonesia","flag":"id","geoip_code":"id","priority":648,"iso":"id","iso_639_3":"ind","show_on_widgets":true,"global_name":"Indonesian"},"in":{"language":"en","language_name":"English (India)","flag":"in","geoip_code":"in","priority":800,"iso":"en","iso_639_3":"eng","show_on_widgets":true,"global_name":"Indian"},"it":{"language":"it","language_name":"Italiano","flag":"it","geoip_code":"it","priority":737,"iso":"it","iso_639_3":"ita","show_on_widgets":true,"global_name":"Italian","is_in_european_union":true},"ja":{"language":"ja","language_name":"","flag":"jp","geoip_code":"jp","priority":600,"iso":"ja","iso_639_3":"jpn","show_on_widgets":true,"global_name":"Japanese"},"kr":{"language":"ko","language_name":"","flag":"kr","geoip_code":"kr","priority":550,"iso":"ko","iso_639_3":"kor","show_on_widgets":true,"global_name":"Korean"},"ms_MY":{"language":"ms_MY","language_name":"Bahasa Melayu","flag":"my","geoip_code":"my","priority":647,"iso":"ms","iso_639_3":"zlm","show_on_widgets":true,"global_name":"Malaysian"},"pl":{"language":"pl","language_name":"Polski","flag":"pl","geoip_code":"pl","priority":725,"iso":"pl","iso_639_3":"pol","show_on_widgets":true,"global_name":"Polish","is_in_european_union":true},"ru":{"language":"ru","language_name":"","flag":"ru","geoip_code":"ru","countries_with_this_language":["am","by","kg","kz","md","tj","tm","uz"],"priority":700,"iso":"ru","iso_639_3":"rus","show_on_widgets":true,"global_name":"Russian","is_only_recommended_tw_autorepost":true},"sv_SE":{"language":"sv","language_name":"Svenska","flag":"se","geoip_code":"se","priority":723,"iso":"sv","iso_639_3":"swe","show_on_widgets":true,"global_name":"Swedish","is_in_european_union":true},"th_TH":{"language":"th","language_name":"","flag":"th","geoip_code":"th","priority":646,"iso":"th","iso_639_3":"tha","show_on_widgets":true,"global_name":"Thai"},"tr":{"language":"tr","language_name":"Trke","flag":"tr","geoip_code":"tr","priority":713,"iso":"tr","iso_639_3":"tur","show_on_widgets":true,"global_name":"Turkish","is_only_recommended_tw_autorepost":true},"vi_VN":{"language":"vi","language_name":"Ting Vit","flag":"vn","geoip_code":"vn","priority":645,"iso":"vi","iso_639_3":"vie","show_on_widgets":true,"global_name":"Vietnamese"},"zh_CN":{"language":"zh","language_name":"","flag":"cn","geoip_code":"cn","countries_with_this_language":["zh"],"priority":537,"iso":"zh-Hans","iso_639_3":"cmn","show_on_widgets":true,"global_name":"Chinese"},"zh_TW":{"language":"zh_TW","language_name":"","flag":"tw","geoip_code":"tw","countries_with_this_language":["hk"],"priority":536,"iso":"zh-Hant","iso_639_3":"cmn","show_on_widgets":true,"global_name":"Taiwanese"},"el":{"language":"el","language_name":"Greek","flag":"gr","geoip_code":"gr","priority":625,"iso":"el","iso_639_3":"ell","global_name":"Greek","is_in_european_union":true,"isBattle":true},"nl_NL":{"language":"nl_NL","language_name":"Dutch","flag":"nl","geoip_code":"nl","priority":731,"iso":"nl","iso_639_3":"nld","global_name":"Dutch","is_in_european_union":true,"isBattle":true},"ro":{"language":"ro","language_name":"Romanian","flag":"ro","geoip_code":"ro","priority":707,"iso":"ro","iso_639_3":"ron","global_name":"Romanian","is_in_european_union":true,"isBattle":true}}'),y=function(){
const e=document.querySelectorAll("link[rel~=link-locale][data-locale]");if(0===e.length)return f;const t={};return e.forEach((e=>{const i=(0,w.ensureNotNull)(e.getAttribute("data-locale"));t[i]={...f[i],href:e.href}})),t}();const k=(x=x||window.locale,null===(I=y[x])||void 0===I?void 0:I.iso);var x,I;const C=new Intl.DateTimeFormat(k,{hour:"2-digit",minute:"2-digit"});function S(e){return C.format(e)}function T(e,t){return(t.hasDatePicker?function(e){const t=e.toLocaleString(k,{day:"2-digit"}),i=e.toLocaleString(k,{month:"2-digit"});return`${e.toLocaleString(k,{year:"numeric"})}-${i}-${t}`}(e):"")+(t.hasTimePicker?", "+S(e):"")}var P=i(805184),D=i(350324),N=i(493173),O=i(50368),E=i(44807),M=i(508550),B=i(614793),V=i(421937);const L=(0,N.mergeThemes)(D.DEFAULT_INPUT_DATE_THEME,{container:V.mobileDateInputContainer,date:V.mobileDateInput,icon:V.mobileDateInputIcon}),F=n.CheckMobile.any();function A(e){return o.createElement(D.DateInput,{theme:F?L:void 0,...e})}class W extends o.PureComponent{constructor(e){super(e),this._todayMidnight=new Date((new Date).setHours(0,0,0,0)),this._onSelect=()=>{this.props.onSelect(this.state.date,this.state.time)},this._onDateSelect=e=>{null!==e&&this.setState({date:e},this._handleMobileSelect)},this._onTimeSelect=e=>{const t=function(e){const[t,i]=e.split(":"),s=new Date;return s.setHours(Number(t),Number(i)),s}(e);this.setState({time:t},this._handleMobileSelect)},this._handleMobileSelect=()=>{F&&this._onSelect()},this._onKeyDown=e=>{e.stopPropagation()},this.state={date:this.props.initDateTime,time:this.props.initDateTime}}render(){const e=o.createElement(B.DatePicker,{minDate:this._todayMidnight,initial:this.state.date,InputComponent:A,withCalendar:!1,onPick:this._onDateSelect,revertInvalidData:!0}),t=o.createElement(E.TimeInput,{className:!F&&V.timeInput,value:(n=this.state.time,(0,M.twoDigitsFormat)(n.getHours())+":"+(0,M.twoDigitsFormat)(n.getMinutes())),onChange:this._onTimeSelect});var n;return F?o.createElement("div",{className:V.mobileDateTimeWrapper},this.props.durationMetaInfo.hasDatePicker&&o.createElement("div",{className:V.mobilePickerControl},o.createElement("span",{className:V.title},s.t(null,void 0,i(676912))),e),this.props.durationMetaInfo.hasTimePicker&&o.createElement("div",{className:V.mobilePickerControl},o.createElement("span",{className:V.title},s.t(null,void 0,i(631976))),t)):o.createElement("div",{className:V.wrapper,onKeyDown:this._onKeyDown},o.createElement("div",{className:V.dateTimeWrapper},this.props.durationMetaInfo.hasDatePicker&&e,this.props.durationMetaInfo.hasTimePicker&&t),this.props.durationMetaInfo.hasDatePicker&&o.createElement(O.Calendar,{key:this.state.date.valueOf(),selectedDate:this.state.date,minDate:this._todayMidnight,onSelect:this._onDateSelect,popupStyle:!1}),o.createElement("div",{className:V.buttonWrapper},o.createElement(P.Button,{className:V.button,type:"submit",size:"l",onClick:this._onSelect},this._makeButtonText())))}_makeButtonText(){const e=this.state.date.getFullYear(),t=this.state.date.toLocaleString("default",{month:"2-digit"
}),o=this.state.date.toLocaleString("default",{day:"2-digit"}),n=S(this.state.time);return s.t(null,void 0,i(127446)).replace("{dateTime}",`${e}-${t}-${o} ${n}`)}}var H=i(383241),R=i(598475);const q=new(h());function U(e){const{currentDuration:t,durationMetaInfoList:u,onDurationChanged:h,onClick:p}=e,w=(0,c.findDurationMetaInfo)(u,t.type);if(void 0===w)return null;const f=w.hasDatePicker||w.hasTimePicker,y=n.CheckMobile.any(),k=(0,o.useMemo)((()=>void 0!==t.datetime?new Date(t.datetime):["GTT","GTD"].includes(t.type)?(0,c.makeDatePlus24UTCHours)():new Date),[t.datetime,t.type]),x=(0,o.useMemo)((()=>T(k,w)),[k,w]),I=(0,o.useMemo)((()=>u.map((e=>({content:e.name,value:e.value})))),[u]),C=I.length<2,S=o.createElement(W,{durationMetaInfo:w,initDateTime:k,onSelect:function(t,i){const s=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),i.getUTCHours(),i.getUTCMinutes());e.onDurationChanged({type:e.currentDuration.type,datetime:s}),n.CheckMobile.iOS()||V()}});function P(e){return o.createElement(_.Select,{onClick:p,className:H.select,menuClassName:e?H.selectMenu:void 0,value:null==w?void 0:w.value,items:I,"data-name":"duration-type-selector",disabled:C,hideArrowButton:C,onChange:B,stretch:!0,matchButtonAndListboxWidths:!0})}const[D,N]=(0,o.useState)(!1),O=o.createElement(r.Input,{className:D&&!y?H.focused:null,inputClassName:H.dateTimePickerInput,value:x,"data-name":"duration-datetime-selector",stretch:!0,readonly:!0,intent:D&&!y?"primary":"default",noReadonlyStyles:!0,endSlot:o.createElement(l.EndSlot,{icon:!0,interactive:!1},o.createElement(a.Icon,{icon:R,className:H.icon}))});return o.createElement(v.MatchMedia,{rule:b.DialogBreakpoints.TabletSmall},(e=>o.createElement("div",{className:H.wrapper},o.createElement("span",{className:H.title},s.t(null,void 0,i(625318))),e?o.createElement(g.ToolWidgetMenu,{className:H.menuButton,content:P(e),arrow:!1,children:o.createElement(z,{menuItems:I,onTypeSelect:B}),isDrawer:!0,isDisabled:C,closeOnClickOutside:!0}):P(e),f&&(y?S:o.createElement(m.CloseDelegateContext.Provider,{value:q},o.createElement(g.ToolWidgetMenu,{className:H.dateTimePickerWrapper,content:O,arrow:!1,closeOnClickOutside:!0,verticalDropDirection:d.VerticalDropDirection.FromBottomToTop,horizontalDropDirection:d.HorizontalDropDirection.FromRightToLeft,horizontalAttachEdge:d.HorizontalAttachEdge.Right,verticalAttachEdge:d.VerticalAttachEdge.Top,onOpen:E,onClose:M},S))))));function E(){N(!0)}function M(){N(!1)}function B(e){const i={type:e},s=(0,c.findDurationMetaInfo)(u,e);void 0!==s&&(s.hasDatePicker||s.hasTimePicker)&&(i.datetime=t.datetime||(0,c.getTimestamp)((0,c.makeDatePlus24UTCHours)())),h(i),V()}function V(){void 0!==e.onClose&&e.onClose(),q.fire()}}function z(e){const{menuItems:t,onTypeSelect:i}=e;return o.createElement(o.Fragment,null,Object.values(t).map((e=>{var t;return o.createElement(p.PopupMenuItem,{key:e.value,label:null!==(t=e.content)&&void 0!==t?t:e.value,onClick:i,onClickArg:e.value})})))}},926909:(e,t,i)=>{"use strict";i.d(t,{Header:()=>D})
;var s=i(509806),o=i(72571),n=i(50959),r=i(497754),a=i.n(r),l=i(930052),d=i(155185),c=i(392745),u=i(996038),h=i(652945),m=i(363111),_=i(561738),p=i(838683),g=i(404096);function v(e){const{icon:t,iconClassName:i,title:s,titleColor:r,text:l,solutionId:c}=e;return n.createElement(d.ToolWidgetMenu,{arrow:!1,content:n.createElement(o.Icon,{icon:t}),className:a()(g.icon,g.button,i),drawerBreakpoint:_.TradingLayoutBreakpoint.Mobile,title:s,horizontalAttachEdge:p.HorizontalAttachEdge.Right,horizontalDropDirection:p.HorizontalDropDirection.FromRightToLeft},n.createElement("div",{className:g.wrapper},n.createElement(o.Icon,{icon:t,className:a()(g.icon,i)}),n.createElement("div",{className:g.infoContainer},n.createElement("span",{className:g.title,style:{color:r}},s),n.createElement("span",{className:g.text},l),false)))}var b=i(643959),w=i(966883),f=i(513729),y=i(29834),k=i(167189),x=i(458189),I=i(220423);const C=s.t(null,void 0,i(365636)),S=(0,h.htmlEscape)(s.t(null,void 0,i(107435))),T=(0,h.htmlEscape)(s.t(null,void 0,i(806667))),P=(0,h.htmlEscape)(s.t(null,void 0,i(668025)));class D extends n.PureComponent{render(){const e=this.context.mode===m.OrderEditorDisplayMode.Popup?{"data-dragg-area":!0}:{};let t;if(this.props.hasDelayedWarning&&(t={icon:k,iconClassName:I.delayedDataIcon,title:s.t(null,void 0,i(675649)),titleColor:I.delayedDataTitleColor,text:this.props.delayedWarningMessage}),this.props.hasBatsQuotes){const[e,i]=this.props.symbol.split(":"),s=`${T.replace("{symbolName}",i).replace("{exchange}",C)} ${P.replace("{exchange}",e)}`;t={icon:x,iconClassName:I.batsQuotesIcon,title:S.format({exchange:e,originalExchange:C}),titleColor:I.batsQuotesTitleColor,text:s,solutionId:43000473924}}return n.createElement("div",{className:r(I.header,this.props.className)},this.props.hasBackButton&&n.createElement(c.ToolWidgetIconButton,{title:s.t(null,void 0,i(762592)),onClick:this.props.back,className:I.button,"data-name":"button-back",icon:b}),n.createElement("div",{className:I.wrapper,...e},n.createElement("span",{className:I.text},this.props.title,this.props.description)),void 0!==t&&n.createElement(v,{...t}),this.props.hasCancelButton&&n.createElement(c.ToolWidgetIconButton,{title:s.t(null,void 0,i(620036)),onClick:this.props.cancel,className:I.button,"data-name":"button-cancel",icon:w}),0!==n.Children.count(this.props.settingsItems)&&n.createElement(l.MatchMedia,{rule:u.DialogBreakpoints.TabletSmall},(e=>n.createElement(d.ToolWidgetMenu,{className:I.settingsButton,content:n.createElement(o.Icon,{icon:y}),menuClassName:I.settingsPopupMenu,children:this.props.settingsItems,isDrawer:e,title:s.t(null,void 0,i(389517)),arrow:!1,closeOnClickOutside:!0,"data-name":"order-ticket-settings"}))),this.props.hasCloseButton&&n.createElement(c.ToolWidgetIconButton,{title:s.t(null,{context:"input"},i(309633)),onClick:this.props.close,className:I.button,"data-name":"button-close",icon:f}))}}D.contextType=m.Context},363111:(e,t,i)=>{"use strict";i.d(t,{OrderPanelStatus:()=>s,OrderPlacingStatus:()=>o,OrderEditorDisplayMode:()=>n,
BracketDefaultPips:()=>r,BracketSubControlType:()=>a,QuantitySubControlType:()=>l,PriceSubControlType:()=>d,CalculatorDecKeyCodes:()=>c,CalculatorIncKeyCodes:()=>u,Context:()=>_,orderTypes:()=>p});var s,o,n,r,a,l,d,c,u,h=i(50959),m=i(509806);!function(e){e[e.Wait=0]="Wait",e[e.Active=1]="Active",e[e.Editing=2]="Editing",e[e.Preview=3]="Preview"}(s||(s={})),function(e){e[e.Creating=0]="Creating",e[e.Placed=1]="Placed"}(o||(o={})),function(e){e.Popup="popup",e.Panel="panel"}(n||(n={})),function(e){e[e.TakeProfit=75]="TakeProfit",e[e.StopLoss=25]="StopLoss"}(r||(r={})),function(e){e.Price="Price",e.Pips="Pips",e.Money="Money",e.Percent="Percent"}(a||(a={})),function(e){e.Units="Units",e.RiskInCurrency="RiskInCurrency",e.RiskInPercent="RiskInPercent",e.BaseCurrency="BaseCurrency",e.QuoteCurrency="QuoteCurrency"}(l||(l={})),function(e){e.Absolute="Absolute",e.Relative="Relative"}(d||(d={})),function(e){e[e.Minus=189]="Minus",e[e.NumMinus=109]="NumMinus",e[e.FirefoxMinus=173]="FirefoxMinus"}(c||(c={})),function(e){e[e.Plus=187]="Plus",e[e.NumPlus=107]="NumPlus",e[e.FirefoxPlus=61]="FirefoxPlus"}(u||(u={}));const _=h.createContext({resizerWidth:null,mode:n.Panel,supportTrailingStop:!1}),p={1:m.t(null,void 0,i(398157)),2:m.t(null,void 0,i(359758)),3:m.t(null,void 0,i(905023)),4:m.t(null,void 0,i(802654))}},163694:(e,t,i)=>{"use strict";i.d(t,{DrawerManager:()=>n,DrawerContext:()=>r});var s=i(50959),o=i(285089);class n extends s.PureComponent{constructor(e){super(e),this._isBodyFixed=!1,this._addDrawer=e=>{this.setState((t=>({stack:[...t.stack,e]})))},this._removeDrawer=e=>{this.setState((t=>({stack:t.stack.filter((t=>t!==e))})))},this.state={stack:[]}}componentDidUpdate(e,t){!t.stack.length&&this.state.stack.length&&((0,o.setFixedBodyState)(!0),this._isBodyFixed=!0),t.stack.length&&!this.state.stack.length&&this._isBodyFixed&&((0,o.setFixedBodyState)(!1),this._isBodyFixed=!1)}componentWillUnmount(){this.state.stack.length&&this._isBodyFixed&&(0,o.setFixedBodyState)(!1)}render(){return s.createElement(r.Provider,{value:{addDrawer:this._addDrawer,removeDrawer:this._removeDrawer,currentDrawer:this.state.stack.length?this.state.stack[this.state.stack.length-1]:null}},this.props.children)}}const r=s.createContext(null)},759339:(e,t,i)=>{"use strict";i.d(t,{Drawer:()=>h});var s=i(50959),o=i(650151),n=i(497754),r=i(220863),a=i(8361),l=i(163694),d=i(28466),c=i(742554),u=i(945966);function h(e){const{position:t="Bottom",onClose:i,children:h,className:m,theme:_=u}=e,p=(0,o.ensureNotNull)((0,s.useContext)(l.DrawerContext)),[g]=(0,s.useState)((()=>(0,r.randomHash)())),v=(0,s.useRef)(null),b=(0,s.useContext)(d.CloseDelegateContext);return(0,s.useLayoutEffect)((()=>((0,o.ensureNotNull)(v.current).focus({preventScroll:!0}),b.subscribe(p,i),p.addDrawer(g),()=>{p.removeDrawer(g),b.unsubscribe(p,i)})),[]),s.createElement(a.Portal,null,s.createElement("div",{className:n(u.wrap,u[`position${t}`])},g===p.currentDrawer&&s.createElement("div",{className:u.backdrop,onClick:i}),s.createElement(c.TouchScrollContainer,{
className:n(u.drawer,_.drawer,u[`position${t}`],m),tabIndex:-1,ref:v,"data-name":e["data-name"]},h)))}},661851:(e,t,i)=>{"use strict";i.d(t,{useObservable:()=>o});var s=i(50959);function o(e,t){const[i,o]=(0,s.useState)(t);return(0,s.useEffect)((()=>{const t=e.subscribe(o);return()=>t.unsubscribe()}),[e]),i}},297265:(e,t,i)=>{"use strict";i.d(t,{useWatchedValueReadonly:()=>o});var s=i(50959);const o=(e,t=!1)=>{const i="watchedValue"in e?e.watchedValue:void 0,o="defaultValue"in e?e.defaultValue:e.watchedValue.value(),[n,r]=(0,s.useState)(i?i.value():o);return(t?s.useLayoutEffect:s.useEffect)((()=>{if(i){r(i.value());const e=e=>r(e);return i.subscribe(e),()=>i.unsubscribe(e)}return()=>{}}),[i]),n}},901317:(e,t,i)=>{"use strict";i.d(t,{useWatchedValue:()=>o});var s=i(50959);const o=e=>{const[t,i]=(0,s.useState)(e.value());return(0,s.useEffect)((()=>{const t=e=>i(e);return e.subscribe(t),()=>e.unsubscribe(t)}),[e]),[t,t=>e.setValue(t)]}},379266:(e,t,i)=>{"use strict";i.d(t,{PopupMenuItemToggle:()=>l});var s=i(50959),o=i(497754),n=i(192063),r=i(302946),a=i(181621);function l(e){const{isDisabled:t,hint:i,label:l,isChecked:d,checkboxClassName:c,labelClassName:u,indeterminate:h,...m}=e;return s.createElement(n.PopupMenuItem,{...m,isDisabled:t,shortcut:i,dontClosePopup:!0,labelRowClassName:u,label:s.createElement(r.Checkbox,{disabled:t,label:l,checked:d,indeterminate:h,className:o(a.checkbox,c)})})}},515783:(e,t,i)=>{"use strict";i.d(t,{ToolWidgetCaret:()=>l});var s=i(50959),o=i(497754),n=i(72571),r=i(190948),a=i(100578);function l(e){const{dropped:t,className:i}=e;return s.createElement(n.Icon,{className:o(i,r.icon,{[r.dropped]:t}),icon:a})}},742554:(e,t,i)=>{"use strict";i.d(t,{TouchScrollContainer:()=>a});var s=i(50959),o=i(259142),n=i(650151),r=i(601227);const a=(0,s.forwardRef)(((e,t)=>{const{children:i,...n}=e,a=(0,s.useRef)(null);return(0,s.useImperativeHandle)(t,(()=>a.current)),(0,s.useLayoutEffect)((()=>{if(r.CheckMobile.iOS())return null!==a.current&&(0,o.disableBodyScroll)(a.current,{allowTouchMove:l(a)}),()=>{null!==a.current&&(0,o.enableBodyScroll)(a.current)}}),[]),s.createElement("div",{ref:a,...n},i)}));function l(e){return t=>{const i=(0,n.ensureNotNull)(e.current),s=document.activeElement;return!i.contains(t)||null!==s&&i.contains(s)&&s.contains(t)}}},181436:(e,t,i)=>{"use strict";i.d(t,{getPixelsFromEvent:()=>o});const s=[()=>navigator.userAgent.includes("Win")&&navigator.userAgent.includes("Chrome")?1/window.devicePixelRatio:1,()=>16,(e=(()=>0))=>{var t;return.8*(null!==(t=e())&&void 0!==t?t:0)}];function o(e,t=(()=>({}))){return{x:e.deltaX*s[e.deltaMode]((()=>t().width)),y:e.deltaY*s[e.deltaMode]((()=>t().height))}}},906132:(e,t,i)=>{"use strict";var s=i(522134);function o(){}function n(){}n.resetWarningCache=o,e.exports=function(){function e(e,t,i,o,n,r){if(r!==s){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}
function t(){return e}e.isRequired=e;var i={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:n,resetWarningCache:o};return i.PropTypes=i,i}},719036:(e,t,i)=>{e.exports=i(906132)()},522134:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},635194:e=>{e.exports={button:"button-uO7HM85b",hover:"hover-uO7HM85b",isInteractive:"isInteractive-uO7HM85b",isGrouped:"isGrouped-uO7HM85b",isActive:"isActive-uO7HM85b",isOpened:"isOpened-uO7HM85b",isDisabled:"isDisabled-uO7HM85b",text:"text-uO7HM85b",icon:"icon-uO7HM85b"}},574749:e=>{e.exports={button:"button-rqVQ8gUB"}},17049:e=>{e.exports={button:"button-reABrhVR",hover:"hover-reABrhVR",arrow:"arrow-reABrhVR",arrowWrap:"arrowWrap-reABrhVR",isOpened:"isOpened-reABrhVR"}},572480:e=>{e.exports={mobile:"screen and (max-width: 567px)"}},152867:(e,t,i)=>{"use strict";i.d(t,{DEFAULT_TOOL_WIDGET_BUTTON_THEME:()=>a,ToolWidgetButton:()=>l});var s=i(50959),o=i(497754),n=i(72571),r=i(635194);const a=r,l=s.forwardRef(((e,t)=>{const{icon:i,isActive:a,isOpened:l,isDisabled:d,isGrouped:c,isHovered:u,onClick:h,text:m,textBeforeIcon:_,title:p,theme:g=r,className:v,forceInteractive:b,"data-name":w,...f}=e,y=o(v,g.button,p&&"apply-common-tooltip",{[g.isActive]:a,[g.isOpened]:l,[g.isInteractive]:(b||Boolean(h))&&!d,[g.isDisabled]:d,[g.isGrouped]:c,[g.hover]:u}),k=i&&("string"==typeof i?s.createElement(n.Icon,{className:g.icon,icon:i}):s.cloneElement(i,{className:o(g.icon,i.props.className)}));return s.createElement("div",{...f,ref:t,"data-role":"button",className:y,onClick:d?void 0:h,title:p,"data-name":w},_&&m&&s.createElement("div",{className:o("js-button-text",g.text)},m),k,!_&&m&&s.createElement("div",{className:o("js-button-text",g.text)},m))}))},392745:(e,t,i)=>{"use strict";i.d(t,{ToolWidgetIconButton:()=>a});var s=i(50959),o=i(497754),n=i(152867),r=i(574749);const a=s.forwardRef(((e,t)=>{const{className:i,id:a,...l}=e;return s.createElement(n.ToolWidgetButton,{"data-name":a,...l,ref:t,className:o(i,r.button)})}))},155185:(e,t,i)=>{"use strict";i.d(t,{DEFAULT_TOOL_WIDGET_MENU_THEME:()=>m,ToolWidgetMenu:()=>_});var s=i(50959),o=i(497754),n=i(544377),r=i(515783),a=i(800417),l=i(163694),d=i(759339),c=i(838683),u=i(930052),h=i(17049);const m=h;class _ extends s.PureComponent{constructor(e){super(e),this._wrapperRef=null,this._controller=s.createRef(),this._handleWrapperRef=e=>{this._wrapperRef=e,this.props.reference&&this.props.reference(e)},this._handleClick=e=>{e.target instanceof Node&&e.currentTarget.contains(e.target)&&(this._handleToggleDropdown(),this.props.onClick&&this.props.onClick(e,!this.state.isOpened))},this._handleToggleDropdown=e=>{const{onClose:t,onOpen:i}=this.props,{isOpened:s}=this.state,o="boolean"==typeof e?e:!s;this.setState({isOpened:o}),o&&i&&i(),!o&&t&&t()},this._handleClose=()=>{this.close()},this.state={isOpened:!1}}render(){
const{id:e,arrow:t,content:i,isDisabled:n,isDrawer:l,isShowTooltip:d,title:c,className:h,hotKey:m,theme:_,drawerBreakpoint:p}=this.props,{isOpened:g}=this.state,v=o(h,_.button,{"apply-common-tooltip":d||!n,[_.isDisabled]:n,[_.isOpened]:g});return s.createElement("div",{id:e,className:v,onClick:n?void 0:this._handleClick,title:c,"data-tooltip-hotkey":m,ref:this._handleWrapperRef,"data-role":"button",...(0,a.filterDataProps)(this.props)},i,t&&s.createElement("div",{className:_.arrow},s.createElement("div",{className:_.arrowWrap},s.createElement(r.ToolWidgetCaret,{dropped:g}))),this.state.isOpened&&(p?s.createElement(u.MatchMedia,{rule:p},(e=>this._renderContent(e))):this._renderContent(l)))}close(){this._handleToggleDropdown(!1)}update(){null!==this._controller.current&&this._controller.current.update()}_renderContent(e){const{menuDataName:t,minWidth:i,menuClassName:o,maxHeight:r,drawerPosition:a="Bottom",children:u}=this.props,{isOpened:h}=this.state,m={horizontalMargin:this.props.horizontalMargin||0,verticalMargin:this.props.verticalMargin||2,verticalAttachEdge:this.props.verticalAttachEdge,horizontalAttachEdge:this.props.horizontalAttachEdge,verticalDropDirection:this.props.verticalDropDirection,horizontalDropDirection:this.props.horizontalDropDirection,matchButtonAndListboxWidths:this.props.matchButtonAndListboxWidths},_=Boolean(h&&e&&a),p=function(e){return"function"==typeof e}(u)?u({isDrawer:_}):u;return _?s.createElement(l.DrawerManager,null,s.createElement(d.Drawer,{onClose:this._handleClose,position:a,"data-name":t},p)):s.createElement(n.PopupMenu,{controller:this._controller,closeOnClickOutside:this.props.closeOnClickOutside,doNotCloseOn:this,isOpened:h,minWidth:i,onClose:this._handleClose,position:(0,c.getPopupPositioner)(this._wrapperRef,m),className:o,maxHeight:r,"data-name":t},p)}}_.defaultProps={arrow:!0,closeOnClickOutside:!0,theme:h}},561738:(e,t,i)=>{"use strict";i.d(t,{TradingLayoutBreakpoint:()=>o});var s=i(572480);const o={Mobile:s.mobile}},699958:(e,t,i)=>{"use strict";i.d(t,{SplitThousandsFormatter:()=>n});var s=i(604406),o=i(561626);class n{constructor(e=" "){this._divider=e}format(e){const t=(0,s.splitThousands)(e,this._divider);return(0,o.isRtl)()?(0,o.startWithLTR)(t):t}parse(e){const t=(0,o.stripLTRMarks)(e).split(this._divider).join(""),i=Number(t);return isNaN(i)||/e/i.test(t)?{res:!1}:{res:!0,value:i,suggest:this.format(i)}}}},465890:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 9" width="11" height="9" fill="none"><path stroke-width="2" d="M0.999878 4L3.99988 7L9.99988 1"/></svg>'},611902:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><path stroke="currentcolor" stroke-linecap="round" d="M4 7l5 4 5-4"/></svg>'},643959:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentcolor" stroke-width="1.2" d="M17 21l-7.5-7.5L17 6"/></svg>'},966883:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" fill="none" stroke="currentcolor"><path d="M3.5 10A6.5 6.5 0 1 0 10 3.5H5.233M7.5 6.5l-3-3 3-3"/></svg>'},488263:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><path stroke="currentcolor" stroke-linecap="round" d="M4 11l5-4 5 4"/></svg>'},11728:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 9" width="9" height="9"><path stroke="currentcolor" stroke-width="1.2" d="M1 1l7 7m0-7L1 8"/></svg>'},781957:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 17" width="16" height="17" fill="none"><rect width="15" height="9" stroke="currentcolor" rx="2.5" x=".5" y="7.5"/><circle stroke="currentcolor" cx="8" cy="12" r=".5"/><path stroke="currentcolor" d="M3.5 7c0 .28.22.5.5.5h8a.5.5 0 0 0 .5-.5V5a4.5 4.5 0 1 0-9 0v2z"/></svg>'},943145:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 17" width="16" height="17" fill="none"><path fill="currentcolor" fill-rule="evenodd" clip-rule="evenodd" d="M4 5v2h9a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V5a5 5 0 0 1 8.66-3.4l-.74.66A3.99 3.99 0 0 0 4 5z"/><rect width="15" height="9" stroke="currentcolor" rx="2.5" x=".5" y="7.5"/><circle stroke="currentcolor" cx="8" cy="12" r=".5"/></svg>'},237699:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 7" width="12" height="7"><path d="M1 0a1 1 0 0 0-1 1c0 .276.1.538.28.72l5 5c.182.18.444.28.72.28.276 0 .538-.1.72-.28l5-5c.18-.182.28-.444.28-.72a1 1 0 0 0-1-1c-.276 0-.538.1-.72.28L6 4.563 1.72.282C1.537.1 1.275 0 1 0z"/></svg>'},826724:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 7" width="12" height="7"><path d="M1 7a1 1 0 0 1-1-1c0-.276.1-.538.28-.72l5-5C5.463.1 5.725 0 6 0c.276 0 .538.1.72.28l5 5c.18.182.28.444.28.72a1 1 0 0 1-1 1c-.276 0-.538-.1-.72-.28L6 2.437l-4.28 4.28C1.537 6.9 1.275 7 1 7z"/></svg>'},513729:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" stroke-width="1.2" d="M7 6l15 15m0-15L7 21"/></svg>'},167189:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.84 13.7H5.78V4.4l2.48-.06c1.35 0 2.42.4 3.22 1.2.8.78 1.19 1.83 1.19 3.15 0 3.34-1.61 5.01-4.83 5.01zm-.41-7.85v6.35c.26.02.55.03.86.03.83 0 1.48-.3 1.95-.9.48-.6.72-1.46.72-2.54 0-2-.93-2.99-2.78-2.99-.18 0-.43.02-.75.05z"/></svg>'},458189:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M13.4 5.9c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.45-1.96-.45-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.71.4-.48.86-.72 1.4-.72.56 0 1.31.16 2.27.46.95.3 1.62.45 2.01.45.64 0 1.06-.3 1.27-.9h1.03zm0 3.87c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.46-1.96-.46-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.7.4-.48.86-.72 1.4-.72.56 0 1.31.15 2.27.46.95.3 1.62.44 2.01.44.64 0 1.06-.3 1.27-.9h1.03z"/></svg>'},548927:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 9" width="9px" height="9px"><path d="M2 1L1 2l2.5 2.5L1 7l1 1 2.5-2.5L7 8l1-1-2.5-2.5L8 2 7 1 4.5 3.5z"/></svg>'},785508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><path stroke="currentColor" d="M8 8.5h1.5V14"/><circle fill="currentColor" cx="9" cy="5" r="1"/><path stroke="currentColor" d="M16.5 9a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0z"/></svg>'},686989:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M14 4a10 10 0 1 0 0 20 10 10 0 0 0 0-20zM3 14a11 11 0 1 1 22 0 11 11 0 0 1-22 0z"/><path fill="currentColor" d="M13.5 20v-7.5H12V11h3v9h-1.5z"/><circle fill="currentColor" cx="14" cy="9" r="1"/></svg>'},29834:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M7.5 13a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM5 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM12 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM19 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0z"/></svg>'}}]);