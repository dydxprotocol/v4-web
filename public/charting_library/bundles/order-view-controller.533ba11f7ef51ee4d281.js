(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[660],{363111:(e,t,i)=>{"use strict";i.d(t,{BracketDefaultPips:()=>a,BracketSubControlType:()=>n,CalculatorDecKeyCodes:()=>c,CalculatorIncKeyCodes:()=>d,Context:()=>_,OrderEditorDisplayMode:()=>o,OrderPanelStatus:()=>s,OrderPlacingStatus:()=>r,PriceSubControlType:()=>u,QuantitySubControlType:()=>l,orderTypes:()=>y});var s,r,o,a,n,l,u,c,d,h=i(50959),p=i(509806);!function(e){e[e.Wait=0]="Wait",e[e.Active=1]="Active",e[e.Editing=2]="Editing",e[e.Preview=3]="Preview"}(s||(s={})),function(e){e[e.Creating=0]="Creating",e[e.Placed=1]="Placed"}(r||(r={})),function(e){e.Popup="popup",e.Panel="panel"}(o||(o={})),function(e){e[e.TakeProfit=75]="TakeProfit",e[e.StopLoss=25]="StopLoss"}(a||(a={})),function(e){e.Price="Price",e.Pips="Pips",e.Money="Money",e.Percent="Percent"}(n||(n={})),function(e){e.Units="Units",e.RiskInCurrency="RiskInCurrency",e.RiskInPercent="RiskInPercent",e.BaseCurrency="BaseCurrency",e.QuoteCurrency="QuoteCurrency"}(l||(l={})),function(e){e.Absolute="Absolute",e.Relative="Relative"}(u||(u={})),function(e){e[e.Minus=189]="Minus",e[e.NumMinus=109]="NumMinus",e[e.FirefoxMinus=173]="FirefoxMinus"}(c||(c={})),function(e){e[e.Plus=187]="Plus",e[e.NumPlus=107]="NumPlus",e[e.FirefoxPlus=61]="FirefoxPlus"}(d||(d={}));const _=h.createContext({resizerWidth:null,mode:o.Panel,supportTrailingStop:!1}),y={1:p.t(null,void 0,i(398157)),2:p.t(null,void 0,i(359758)),3:p.t(null,void 0,i(905023)),4:p.t(null,void 0,i(802654))}},895318:(e,t,i)=>{"use strict";i.d(t,{SettingsContext:()=>a,defaultCryptoBracketsSettings:()=>o,defaultSettings:()=>r});var s=i(50959);const r={showRelativePriceControl:!0,showCurrencyRiskInQty:!0,showPercentRiskInQty:!0,showBracketsInCurrency:!0,showBracketsInPercent:!0,showOrderPreview:!0,showCryptoBracketsInCurrency:!1,showCryptoBracketsInPercent:!1},o={showCryptoBracketsInCurrency:!1,showCryptoBracketsInPercent:!1},a=s.createContext({value:r,setValue:e=>{console.warn("unable to modify order ticket settings because context.setValue is not defined")}})},312282:e=>{e.exports={mobile:"screen and (max-width: 567px)"}},935291:(e,t,i)=>{"use strict";i.r(t),i.d(t,{OrderViewController:()=>kt});var s=i(870122),r=i(650151),o=i(6835),a=i(148442),n=i(156963),l=i(588517),u=i.n(l),c=i(637401),d=i(509806),h=i(46130),p=i(58121),_=i(312694),y=i(757604),b=i(997345),m=i(947488),k=i(275734),g=i(265728),P=i(737538),v=i(815544),f=i(771035);var T={connector:function(){return new P.Subject},resetOnDisconnect:!0};function w(e,t){void 0===t&&(t=T);var i=null,s=t.connector,r=t.resetOnDisconnect,o=void 0===r||r,a=s(),n=new v.Observable((function(e){return a.subscribe(e)}));return n.connect=function(){var t;return i&&!i.closed||(i=(t=function(){return e},new v.Observable((function(e){(0,f.innerFrom)(t()).subscribe(e)}))).subscribe(a),o&&i.add((function(){return a=s()}))),i},n}var S=i(958261),M=i(586639),C=i(656846),B=i(363111),$=i(481330),I=i(232192),V=i(189904),O=i(466052),L=i.n(O),q=i(815628),N=i(807107),D=i(529719)
;const E=d.t(null,void 0,i(273064)),F=d.t(null,void 0,i(777851));class R{constructor({displaySymbolName:e,symbol:t,brokerName:i,mode:s,status:r,parentType:o,existingOrder:a,isTradable:l,quotes$:c,isUndockAllowed:d,data:h,formatter:p,isBats:_=!1,informerMessage$:y}){this.description="",this.isTradable=!0,this._pinButtonClicked=new(L()),this._backButtonClicked=new(L()),this._cancelButtonClicked=new(L()),this._closeButtonClicked=new(L()),this._onStatusChanged=()=>{this.hasBackButton.setValue(this._hasBackButton()),this.hasCloseButton.setValue(n.enabled("order_panel_close_button")),this.hasCancelButton.setValue(this._hasCancelButton()),this.description=this._text(),this.title=this._title()},this._onQuotes=e=>{this.hasDelayedWarning.setValue(Boolean(e.isDelayed))},this._data=h,this._displaySymbolName=e,this._formatter=p,this._brokerName=i,this.status=r,this._mode=s,this.type=o,this._existingOrder=a,this.isTradable=l,this.isUndockAllowed=d,this.symbol=t,this.hasBackButton=new(u())(this._hasBackButton()),this.hasCloseButton=new(u())(n.enabled("order_panel_close_button")),this.hasCancelButton=new(u())(!1),this.hasDelayedWarning=new(u())(!1),this.hasBatsQuotes=_,this.informerMessage$=y,this.title=this._title(),this.description=this._text(),this.status.subscribe(this._onStatusChanged),this._mode.subscribe(this._onStatusChanged),c&&(this._quotesSubscription=c.subscribe(this._onQuotes))}unsubscribe(){this._mode.unsubscribe(this._onStatusChanged),this.status.unsubscribe(this._onStatusChanged),this._quotesSubscription&&this._quotesSubscription.unsubscribe()}showCancelButton(){this.hasCancelButton.setValue(!0)}hideCancelButton(){this.hasCancelButton.setValue(!1)}back(){this._backButtonClicked.fire()}pin(){this._pinButtonClicked.fire()}cancel(){this._cancelButtonClicked.fire()}close(){this._closeButtonClicked.fire()}pinButtonClicked(){return this._pinButtonClicked}backButtonClicked(){return this._backButtonClicked}cancelButtonClicked(){return this._cancelButtonClicked}closeButtonClicked(){return this._closeButtonClicked}_hasBackButton(){return!(this._mode.value()!==B.OrderEditorDisplayMode.Panel||!this._existingOrder&&2!==this.type&&this.status.value()!==B.OrderPanelStatus.Preview)}_hasCancelButton(){return this._mode.value()===B.OrderEditorDisplayMode.Panel&&this.status.value()===B.OrderPanelStatus.Active&&!this._existingOrder&&2!==this.type}_title(){return this.status.value()===B.OrderPanelStatus.Preview?d.t(null,void 0,i(147380)):this._displaySymbolName}_text(){if(this.status.value()===B.OrderPanelStatus.Preview)return"";if(this._existingOrder&&this._data&&this._formatter){if(2===this.type){const e=this._data.side,t=this._data.qty,i=this._formatter.format(this._data.price||this._data.avgPrice||this._data.limitPrice);return", "+(1===e?E:F)+" "+t+" @ "+i}return", "+d.t(null,void 0,i(35387))+" "+this._data.id}return this._brokerName?", "+this._brokerName:""}}var x=i(446685),z=function(e){function t(t,i){return e.call(this)||this}return(0,x.__extends)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t
}(i(303448).Subscription),W={setInterval:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=W.delegate;return((null==i?void 0:i.setInterval)||setInterval).apply(void 0,(0,x.__spreadArray)([],(0,x.__read)(e),!1))},clearInterval:function(e){var t=W.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},j=i(3955),A=function(e){function t(t,i){var s=e.call(this,t,i)||this;return s.scheduler=t,s.work=i,s.pending=!1,s}return(0,x.__extends)(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(s,this.id,t),this},t.prototype.requestAsyncId=function(e,t,i){return void 0===i&&(i=0),W.setInterval(e.flush.bind(e,this),i)},t.prototype.recycleAsyncId=function(e,t,i){if(void 0===i&&(i=0),null!=i&&this.delay===i&&!1===this.pending)return t;W.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var i,s=!1;try{this.work(e)}catch(e){s=!0,i=e||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,i=this.scheduler,s=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,j.arrRemove)(s,this),null!=t&&(this.id=this.recycleAsyncId(i,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(z),Q=i(712813),U=function(){function e(t,i){void 0===i&&(i=e.now),this.schedulerActionCtor=t,this.now=i}return e.prototype.schedule=function(e,t,i){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(i,t)},e.now=Q.dateTimestampProvider.now,e}(),H=new(function(e){function t(t,i){void 0===i&&(i=U.now);var s=e.call(this,t,i)||this;return s.actions=[],s._active=!1,s._scheduled=void 0,s}return(0,x.__extends)(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}},t}(U))(A),Y=H,K=i(116217),G=i(138966),J={leading:!0,trailing:!1};var Z=i(337160);function X(e,t,i){void 0===e&&(e=0),void 0===i&&(i=Y);var s=-1;return null!=t&&((0,Z.isScheduler)(t)?i=t:s=t),new v.Observable((function(t){var r,o=(r=e)instanceof Date&&!isNaN(r)?+e-i.now():e;o<0&&(o=0);var a=0;return i.schedule((function(){t.closed||(t.next(a++),0<=s?this.schedule(void 0,s):t.complete())}),o)}))}function ee(e,t,i){void 0===t&&(t=H),void 0===i&&(i=J);var s,r,o,a,n,l=X(e,t);return s=function(){return l},a=(o=void 0===(r=i)?J:r).leading,n=o.trailing,(0,K.operate)((function(e,t){var i=!1,r=null,o=null,l=!1,u=function(){null==o||o.unsubscribe(),o=null,n&&(h(),l&&t.complete())},c=function(){o=null,l&&t.complete()
},d=function(e){return o=(0,f.innerFrom)(s(e)).subscribe(new G.OperatorSubscriber(t,u,c))},h=function(){if(i){i=!1;var e=r;r=null,t.next(e),!l&&d(e)}};e.subscribe(new G.OperatorSubscriber(t,(function(e){i=!0,r=e,(!o||o.closed)&&(a?h():d(e))}),(function(){l=!0,(!(n&&i&&o)||o.closed)&&t.complete()})))}))}var te=i(372605);class ie{constructor({initialSide:e,quotes$:t,priceFormatter:i,spreadFormatter:s,status:r,baseCurrency:o}){this.baseCurrency=null,this.onControlFocused=new(L()),this._formattedQuotes$=new m.BehaviorSubject({ask:" ",bid:" "}),this._restrictionTypes$=new m.BehaviorSubject([]),this._quotes={ask:0,bid:0},this._waitQuotesTimeout=void 0,this._subscriptions=[],this.getValue=()=>this._value$.getValue(),this.setValue=e=>{this._value$.next(e)},this.getFormattedQuotes=()=>this._formattedQuotes$.getValue(),this.currentQuotes=()=>this._quotes,this.getRestrictionTypes=()=>this._restrictionTypes$.getValue(),this._value$=new m.BehaviorSubject(e),this.value$=this._value$.asObservable(),this.formattedQuotes$=this._formattedQuotes$.asObservable(),this.restrictionTypes$=this._restrictionTypes$.asObservable(),this.baseCurrency=o,this.status=r,this._quotes$=t,this._priceFormatter=i,this._spreadFormatter=s}subscribe(){this._waitQuotesTimeout=setTimeout((()=>{this._formattedQuotes$.next({}),this._quotes={}}),5e3);const e=this._quotes$.subscribe((e=>{this._formattedQuotes$.next(this._generateText(e)),this._quotes=e,clearTimeout(this._waitQuotesTimeout)})),t=this._quotes$.pipe(ee(2e3,H,{leading:!0,trailing:!0})).subscribe((e=>{this._restrictionTypes$.next(this._generateRestrictionTypes(e))}));return this._subscriptions=[e,t],this._subscriptions}unsubscribe(){this._subscriptions.forEach((e=>e.unsubscribe())),clearTimeout(this._waitQuotesTimeout)}_generateText(e){const t={},i=(0,$.getAsk)(e),s=(0,$.getBid)(e);return t.ask=this._priceFormatter.format(i),t.bid=this._priceFormatter.format(s),t.spread=(0,te.isNumber)(e.spread)?this._spreadFormatter.format(e.spread):this._priceFormatter.format(i-s),t}_generateRestrictionTypes(e){const t=[];return e.isHalted&&t.push(C.RestrictionType.Halted),e.isHardToBorrow&&t.push(C.RestrictionType.HardToBorrow),e.isNotShortable&&t.push(C.RestrictionType.NotShortable),t}}var se=i(960521),re=i.n(se),oe=i(346502),ae=i(218286),ne=i(472484),le=i(177441),ue=i(595940);function ce(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=(0,ue.popResultSelector)(e);return(0,K.operate)((function(t,s){for(var r=e.length,o=new Array(r),a=e.map((function(){return!1})),n=!1,l=function(t){(0,f.innerFrom)(e[t]).subscribe(new G.OperatorSubscriber(s,(function(e){o[t]=e,n||a[t]||(a[t]=!0,(n=a.every(ne.identity))&&(a=null))}),le.noop))},u=0;u<r;u++)l(u);t.subscribe(new G.OperatorSubscriber(s,(function(e){if(n){var t=(0,x.__spreadArray)([e],(0,x.__read)(o),!1);s.next(i?i.apply(void 0,(0,x.__spreadArray)([],(0,x.__read)(t),!1)):t)}})))}))}var de=i(957877);const he=d.t(null,void 0,i(145088));function pe(e,t,i,s){const r=new se.Big(t),o=r.mul(e).div(100);return r.minus(o.mul(i).mul(s)).toNumber()}class _e{
constructor({priceType:e,quotes$:t,side$:s,info:r,status$:o,formatter:a,orderType$:n,settings:l,brokerTitle:u,orderWidgetStat:h,initialPrice:p,orderRules:_,forceAbsolutePriceUpdate:y,stopPriceControlData$:k,supportStopOrdersInBothDirections:g,supportStopLimitOrdersInBothDirections:P}){var v,f;this.id=(0,V.randomHashN)(6),this.onControlFocused=new(L()),this._focusedControl$=new m.BehaviorSubject(0),this._priceControlData$=new m.BehaviorSubject(null),this._value$=new m.BehaviorSubject(null),this._error$=new m.BehaviorSubject({res:!1}),this._controlError$=new m.BehaviorSubject({res:!1}),this._subscriptions=[],this._symbolType="",this._priceRules=[],this._stopLimitPercentPriceRuleCheckers=[],this.getError=()=>this._error$.getValue(),this.setControlError=(e,t)=>{this._controlError$.next({res:e,severity:"error",msg:t})},this.setAbsolutePrice=e=>{var t;let i;if(i=void 0!==this.formatter.parse?this.formatter.parse(e):{res:!1,error:"Formatter does not support parse"},!i.res){const i=null!==(t=this.getPriceControlData())&&void 0!==t?t:{index:0,value:0,absolutePrice:"",offset:0,base:"ask"};return void this._setPrice({...i,absolutePrice:e})}const s=i.value,r=this._priceToIndex(s);let o=0;(0,S.combineLatest)({focusedControl:this._focusedControl$,quotes:this.quotes$,stopPriceControlData:this._stopPriceControlData$,side:this.side$,orderType:this.orderType$}).pipe((0,oe.take)(1)).subscribe((t=>{const{quotes:i,stopPriceControlData:a,side:n,orderType:l}=t,u=this._getBase(n,l);switch(u){case"stop":null!==a&&(o=Math.round(r-a.index));break;case"ask":const e=this._priceToIndex((0,$.getAsk)(i));o=Math.round(r-e);break;case"bid":const t=this._priceToIndex((0,$.getBid)(i));o=Math.round(r-t)}this._setPrice({index:r,value:s,absolutePrice:e,offset:o,base:u})}))},this.setPriceValue=(e,t=!1)=>{(0,S.combineLatest)({focusedControl:this._focusedControl$,quotes:this.quotes$,stopPriceControlData:this._stopPriceControlData$,side:this.side$,orderType:this.orderType$}).pipe((0,oe.take)(1)).subscribe((i=>{const{quotes:s,stopPriceControlData:r,side:o,orderType:a}=i;(this._roundToStepRequired()||t)&&(e=(0,c.roundToStepByPriceTypeAndSide)(e,this.getStep(e),this.priceType,o));const n=this._priceToIndex(e),l=this._getBase(o,a);let u=0;switch(l){case"stop":null!==r&&(u=Math.round(n-r.index));break;case"ask":const e=this._priceToIndex((0,$.getAsk)(s));u=Math.round(n-e);break;case"bid":const t=this._priceToIndex((0,$.getBid)(s));u=Math.round(n-t)}this._setPrice({index:n,value:e,absolutePrice:this.formatter.format(e),offset:u,base:l})}))},this.setPriceOffset=e=>{(0,S.combineLatest)({focusedControl:this._focusedControl$,quotes:this.quotes$,stopPriceControlData:this._stopPriceControlData$,side:this.side$,orderType:this.orderType$}).pipe((0,oe.take)(1)).subscribe((t=>{const{quotes:i,stopPriceControlData:s,side:r,orderType:o}=t;let a=0;const n=this._getBase(r,o);switch(n){case"stop":null!==s&&(a=Math.round(s.index+e));break;case"ask":const t=this._priceToIndex((0,$.getAsk)(i));a=Math.round(t+e);break;case"bid":const r=this._priceToIndex((0,$.getBid)(i))
;a=Math.round(r+e)}const l=this.indexToPrice(a);this._setPrice({index:a,value:l,absolutePrice:this.formatter.format(l),offset:e,base:n})}))},this.forcePriceUpdate=e=>{null!==e&&(this.setControlError(!1),this.setFocusedControl(0),this.setPriceValue(e,!0))},this.getPriceControlData=()=>this._priceControlData$.getValue(),this.getPrice=()=>{var e,t;return null!==(t=null===(e=this.getPriceControlData())||void 0===e?void 0:e.value)&&void 0!==t?t:null},this.getValue=()=>this._value$.getValue(),this.getFocusedControl=()=>this._focusedControl$.getValue(),this.getStep=e=>void 0===e?this._minTick:(0,$.getPriceStep)({price:e,priceType:this.priceType,minTick:this._minTick,variableMinTickData:this._variableMinTickData,limitPriceStep:this._instrumentInfo.limitPriceStep,stopPriceStep:this._instrumentInfo.stopPriceStep}),this.setFocusedControl=e=>{this._focusedControl$.next(e)},this._isPriceRules=e=>"limitPriceDistance"===e.id||"stopPriceDistance"===e.id,this._updateFocusIfNeeded=()=>{1!==this.getFocusedControl()||!this.isRelativePriceControlHidden&&this._settings.value().showRelativePriceControl||this.setFocusedControl(0)},this._setPrice=e=>{this._priceControlData$.next(e)},this._setError=e=>{const{priceControlData:t,quotes:s,side:r,orderType:o,controlError:a,status:n}=e;if(n===B.OrderPanelStatus.Wait)return void this._error$.next({res:!1});if(a.res)return void this._error$.next(a);let l={res:!1},u={res:!1};if(null===t)l={res:!0,severity:"error",msg:d.t(null,void 0,i(347957))};else{const e=this.getStep(t.value);if(u=this._checkPriceWarning(t.value,s,r),null!==o&&2!==o){const i=(0,$.getQuotePrice)(s,r);l=(0,de.validatePrice)({price:t.value,askOrBid:i,orderType:o,side:r,isStopPrice:2===this.priceType,isForex:"forex"===this._symbolType,formatter:this.formatter,supportStopOrdersInBothDirections:this.supportStopOrdersInBothDirections,supportStopLimitOrdersInBothDirections:this.supportStopLimitOrdersInBothDirections,step:e,roundedToStep:this._roundToStepRequired()});for(const s of this._stopLimitPercentPriceRuleCheckers)if(l=s({orderPrice:t.value,currentPrice:i,side:r,orderType:o,priceStep:e,priceType:this.priceType,isStatusEditing:n===B.OrderPanelStatus.Editing}),l.res)break}}l.res?this._error$.next(l):u.res?this._error$.next(u):this._error$.next({res:!1})},this.quotes$=t,this.side$=s,this._instrumentInfo=r,this.status$=o,this.formatter=a,this.orderType$=n,this.priceType=e,this._settings=l,this._brokerTitle=u,this.orderWidgetStat=h,this.supportStopOrdersInBothDirections=Boolean(g),this.supportStopLimitOrdersInBothDirections=Boolean(P),this._symbolType=r.type||"",this._pipSize=r.pipSize,this._minTick=r.minTick||r.pipSize,this._variableMinTickData=r.variableMinTick?(0,N.makeVariableMinTickData)(this._minTick,r.variableMinTick):void 0;const T=this.getStep();this.indexToPrice=(0,N.makePriceIndexToPriceConverter)(T,this._variableMinTickData),this._priceToIndex=(0,N.makePriceToPriceIndexConverter)(T,this._variableMinTickData),this.priceControlData$=this._priceControlData$.asObservable(),this.value$=this._value$.asObservable(),
this.focusedControl$=this._focusedControl$.asObservable(),this.error$=this._error$.pipe((0,ae.distinctUntilChanged)()),this._stopPriceControlData$=(0,S.combineLatest)({stopPriceControlData:null!=k?k:(0,M.of)(null),orderType:this.orderType$}).pipe((0,b.map)((t=>{const{stopPriceControlData:i,orderType:s}=t;return 1===e&&4===s?i:null})),(0,ae.distinctUntilChanged)()),this.isRelativePriceControlHidden=this._roundToStepRequired();!y&&!this.isRelativePriceControlHidden&&this._settings.value().showRelativePriceControl&&this.setFocusedControl(1),this.modifiedAbsolutePriceControlStat=null!==h?()=>h.setPriceControlModifiedProperty(B.PriceSubControlType.Absolute):()=>{},this.modifiedRelativePriceControlStat=null!==h?()=>h.setPriceControlModifiedProperty(B.PriceSubControlType.Relative):()=>{},void 0!==p&&this.setPriceValue(p,!0);const w=null!=_?_:[];this._priceRules=null!==(v=w.filter(this._isPriceRules))&&void 0!==v?v:[];const C=null!==(f=w.filter(I.isStopLimitPercentValidationRule))&&void 0!==f?f:[],O=1===this.priceType?I.isLimitPercentValidationRule:I.isStopPercentValidationRule;C.filter(O).forEach((e=>{this._stopLimitPercentPriceRuleCheckers.push(function(e,t){let s;return r=>{const{orderPrice:o,currentPrice:a,side:n,orderType:l,priceStep:u,priceType:h,isStatusEditing:p}=r,_=-1===n?1:-1,y=3===l?1:-1,b=pe(e,a,_,y),m=pe(t,a,_,y),k=(0,c.roundToStepByPriceTypeAndSide)(b,u,h,n),g=(0,c.roundToStepByPriceTypeAndSide)(m,u,h,n);let P=Math.min(k,g),v=Math.max(k,g);return p&&(void 0===s&&(s=o),P=Math.min(P,s),v=Math.max(v,s)),o>=P&&o<=v?{res:!1}:{res:!0,severity:"error",msg:d.t(null,void 0,i(445944)).replace("{min}",P.toString()).replace("{max}",v.toString())}}}(e.options.min,e.options.max))}))}subscribe(){this._settings.subscribe(this._updateFocusIfNeeded);const e=(0,S.combineLatest)({quotes:this.quotes$,side:this.side$,focusedControl:this.focusedControl$,status:this.status$}).pipe(ce(this._priceControlData$)).subscribe((([e,t])=>{const{quotes:i,side:s,focusedControl:r,status:o}=e;null!==t&&o!==B.OrderPanelStatus.Wait?0===r?this.setAbsolutePrice(t.absolutePrice):this.setPriceOffset(t.offset):this.setPriceValue(1===s?(0,$.getAsk)(i):(0,$.getBid)(i),!1)})),t=(0,S.combineLatest)({priceControlData:this._priceControlData$,quotes:this.quotes$,side:this.side$,orderType:this.orderType$,controlError:this._controlError$,status:this.status$}).subscribe(this._setError),i=(0,S.combineLatest)({priceControlData:this._priceControlData$,error:this._error$}).subscribe((e=>{const{priceControlData:t,error:i}=e;this._value$.next(i.res&&"error"===i.severity||null===t?null:t.value)}));this._subscriptions=[e,t,i]}unsubscribe(){this._settings.unsubscribe(this._updateFocusIfNeeded),this._subscriptions.map((e=>e.unsubscribe()))}resetPrice(){this.setControlError(!1),this.setFocusedControl(this._settings.value().showRelativePriceControl&&!this.isRelativePriceControlHidden?1:0),(0,S.combineLatest)([this.quotes$,this.side$]).pipe((0,oe.take)(1)).subscribe((([e,t])=>{this.setPriceValue(1===t?(0,$.getAsk)(e):(0,$.getBid)(e),!1)}))}_checkPriceWarning(e,t,i){
const s=this._priceRules.find((s=>this._isDistanceRuleViolated(e,t,s,i)));return s?{res:!0,severity:s.severity,msg:he.format({brokerTitle:this._brokerTitle})}:{res:!1,msg:void 0}}_isDistanceRuleViolated(e,t,i,s){if("limitPriceDistance"===i.id&&2===this.priceType||"stopPriceDistance"===i.id&&1===this.priceType)return!1;const r=1===s,o=(0,$.getQuotePrice)(t,s);let a=null;if(r&&"buyDirectionPips"in i.options&&(a=i.options.buyDirectionPips),!r&&"sellDirectionPips"in i.options&&(a=i.options.sellDirectionPips),null===a)return!1;return Math.abs(o-e)<a*this._pipSize}_getBase(e,t){return 1===this.priceType&&4===t?"stop":1===e?"ask":"bid"}_roundToStepRequired(){return(0,$.roundToStepRequired)({priceType:this.priceType,minTick:this._minTick,limitPriceStep:this._instrumentInfo.limitPriceStep,stopPriceStep:this._instrumentInfo.stopPriceStep})}}function ye(e,t){return(0,$.getLast)(e)||(0,$.getQuotePrice)(e,t)||0}class be{constructor({stopPriceModel:e,limitPriceModel:t,orderType$:i,side$:s,quotes$:r}){this._subscriptions=[],this._calculateLimitModelPrice=e=>{const t=this._stopPriceModel.getPrice();if(null===t)return null;const i=this._limitPriceModel.getStep(t),s=1===e?1:-1;return new(re())(i).mul(s).plus(t).toNumber()},this._orderType$=i,this._side$=s,this._stopPriceModel=e,this._limitPriceModel=t,this.price$=(0,S.combineLatest)({orderType:i,side:s,quotes:r,stopPrice:e.value$,limitPrice:t.value$}).pipe((0,b.map)((e=>{const{orderType:t,side:i,quotes:s,stopPrice:r,limitPrice:o}=e;switch(t){case 1:case 4:return o||ye(s,i);case 3:return r||ye(s,i);default:return(0,$.getQuotePrice)(s,i)}})),(0,ae.distinctUntilChanged)())}subscribe(){const e=this._orderType$.pipe((0,K.operate)((function(e,t){var i,s=!1;e.subscribe(new G.OperatorSubscriber(t,(function(e){var r=i;i=e,s&&t.next([r,e]),s=!0})))})),ce(this._side$),(0,b.map)((([e,t])=>{const[i,s]=e,r=this._stopPriceModel.getPrice(),o=this._limitPriceModel.getPrice();if(1===s&&null!==i&&[3,4].includes(i))this._limitPriceModel.forcePriceUpdate(r);else if(3!==s||1!==i){if(4===s){1===i&&this._stopPriceModel.forcePriceUpdate(o);const e=this._calculateLimitModelPrice(t);this._limitPriceModel.forcePriceUpdate(e)}}else this._stopPriceModel.forcePriceUpdate(o)}))).subscribe();this._subscriptions.push(e)}unsubscribe(){this._subscriptions.map((e=>e.unsubscribe()))}}var me=i(316230),ke=i(233064),ge=Array.isArray;function Pe(e){return 1===e.length&&ge(e[0])?e[0]:e}var ve=i(423869);function fe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=(0,ue.popResultSelector)(e),s=Pe(e);return s.length?new v.Observable((function(e){var t=s.map((function(){return[]})),r=s.map((function(){return!1}));e.add((function(){t=r=null}));for(var o=function(o){(0,f.innerFrom)(s[o]).subscribe(new G.OperatorSubscriber(e,(function(s){if(t[o].push(s),t.every((function(e){return e.length}))){var a=t.map((function(e){return e.shift()}));e.next(i?i.apply(void 0,(0,x.__spreadArray)([],(0,x.__read)(a),!1)):a),t.some((function(e,t){return!e.length&&r[t]}))&&e.complete()}}),(function(){r[o]=!0,!t[o].length&&e.complete()
})))},a=0;!e.closed&&a<s.length;a++)o(a);return function(){t=r=null}})):ve.EMPTY}var Te=i(476007),we=i(99708);function Se(e,t,i,s,r){if(!t)return 0;return $e((0,se.Big)(e).div(t).div(i).div(r||1),s).toNumber()}function Me(e,t,i,s,r,o){if(!i)return 0;return $e((0,se.Big)(e).mul(t).div(i).div(s).div(o||1).div(100),r).toNumber()}function Ce(e,t,i,s){return(0,se.Big)(t).mul(i).mul(e).mul(s||1).toNumber()}function Be(e,t,i,s,r){return s&&e?(0,se.Big)(t).mul(i).mul(e).mul(r||1).mul(100).div(s).toNumber():0}function $e(e,t){return e.div(t).round(0,0).mul(t)}class Ie{constructor({stopLossAvailable$:e,stopLossPips$:t,equity$:i,pipValue$:s,settings:r,initialQty:o,info:a,currency:n,orderWidgetStat:l,showRiskControls:u}){var c;this.formatter=new Te.SplitThousandsFormatter,this.riskInCurrencyFormatter=new q.PriceFormatter(100),this.riskInPercentFormatter=new q.PriceFormatter(100),this.riskStep=.01,this.onControlFocused=new(L()),this._subscriptions=[],this._value$=new m.BehaviorSubject(null),this._focusedControl$=new m.BehaviorSubject(0),this._isRiskAvailable$=new m.BehaviorSubject(!1),this._error$=new m.BehaviorSubject({res:!1}),this._riskInCurrency$=new m.BehaviorSubject(null),this._riskInPercent$=new m.BehaviorSubject(null),this._controlError$=new m.BehaviorSubject({res:!1}),this.setControlError=e=>{this._controlError$.next({res:e})},this._updateFocusIfNeeded=e=>{const t=this._focusedControl$.getValue(),i=1===t&&!e.showCurrencyRiskInQty,s=2===t&&!e.showPercentRiskInQty;(i||s)&&this.setFocusedControl(0)},this._setQuantity=e=>{this._quantity$.next((0,D.formatValue)(e,this.formatter))},this._setRiskInCurrency=e=>{this._riskInCurrency$.next((0,D.formatValue)(e,this.riskInCurrencyFormatter))},this._setRiskInPercent=e=>{this._riskInPercent$.next((0,D.formatValue)(e,this.riskInPercentFormatter))},this.qty=a.qty,this.units=a.units,this._lotSize=a.lotSize,this.showRiskControls=u,this.currency=n,this._equity$=i,this._pipValue$=s,this._stopLossAvailable$=e,this._stopLossPips$=t,this._settings=r,this._quantity$=new m.BehaviorSubject(null!==(c=null!=o?o:this.qty.default)&&void 0!==c?c:null),this.value$=this._value$.asObservable(),this.focusedControl$=this._focusedControl$.asObservable(),this.error$=this._error$.asObservable(),this.isRiskAvailable$=this._isRiskAvailable$.asObservable(),this.quantity={value$:this._quantity$.asObservable(),getValue:()=>this._quantity$.getValue(),setValue:this._setQuantity,onModifiedCallback:()=>null!==l?l.setQtyControlModifiedProperty(B.QuantitySubControlType.Units):()=>{},calculatorUsedStat:()=>null!==l?l.setCalculatorUsedProperty():()=>{}},this.riskInCurrency={value$:this._riskInCurrency$.asObservable(),getValue:()=>this._riskInCurrency$.getValue(),setValue:this._setRiskInCurrency,onModifiedCallback:()=>null!==l?l.setQtyControlModifiedProperty(B.QuantitySubControlType.RiskInCurrency):()=>{},calculatorUsedStat:()=>null!==l?l.setCalculatorUsedProperty():()=>{}},this.riskInPercent={value$:this._riskInPercent$.asObservable(),getValue:()=>this._riskInPercent$.getValue(),setValue:this._setRiskInPercent,
onModifiedCallback:()=>null!==l?l.setQtyControlModifiedProperty(B.QuantitySubControlType.RiskInPercent):()=>{},calculatorUsedStat:()=>null!==l?l.setCalculatorUsedProperty():()=>{}},this._quantityValuesWithFocusedControl$=this._quantityValuesWithFocusedControlObservable()}subscribe(){this._settings.subscribe(this._updateFocusIfNeeded);const e=this._stopLossAvailable$.subscribe((e=>{this._isRiskAvailable$.next(e),e||this.setFocusedControl(0)})),t=(0,S.combineLatest)({quantityValuesWithFocusedControl:this._quantityValuesWithFocusedControl$,pipValue:this._pipValue$,stopLossPips:this._stopLossPips$,equity:this._equity$}).subscribe((({quantityValuesWithFocusedControl:e,pipValue:t,stopLossPips:i,equity:s})=>{const{focusedControl:r,quantity:o,riskInCurrency:a,riskInPercent:n}=e,{quantity:l,riskInCurrency:u,riskInPercent:c}=this._calculateQuantityValues({focusedControl:r,pipValue:t,quantity:o,riskInCurrency:a,riskInPercent:n,stopLossPips:i,equity:s});o===l&&a===u&&n===c||this._setUnfocusedControlsValues(r,l,u,c)})),i=(0,S.combineLatest)({qty:this.quantity.value$,controlError:this._controlError$,focus:this._focusedControl$}).pipe((0,ae.distinctUntilChanged)(me.default)).subscribe((e=>{const{qty:t,controlError:i,focus:s}=e,r=(0,we.checkQtyError)(this.qty,t,!0),o=i.res?i.msg:r.msg;this._error$.next({res:r.res||i.res,msg:o}),this._value$.next(r.res||i.res||null===s?null:t)}));this._subscriptions=[e,t,i]}unsubscribe(){this._subscriptions.map((e=>e.unsubscribe())),this._settings.unsubscribe(this._updateFocusIfNeeded)}getValue(){return this._value$.getValue()}getFocusedControl(){return this._focusedControl$.getValue()}getError(){return this._error$.getValue()}setFocusedControl(e){this._focusedControl$.next(e)}isRiskAvailable(){return this._isRiskAvailable$.getValue()}_calculateQuantityValues(e){return{quantity:(0,D.formatValue)(this._calculateQuantity(e),this.formatter),riskInCurrency:(0,D.formatValue)(this._calculateRiskInCurrency(e),this.riskInCurrencyFormatter),riskInPercent:(0,D.formatValue)(this._calculateRiskInPercent(e),this.riskInPercentFormatter)}}_setUnfocusedControlsValues(e,t,i,s){0!==e&&this._setQuantity(t),1!==e&&this._setRiskInCurrency(i),2!==e&&this._setRiskInPercent(s)}_quantityValuesWithFocusedControlObservable(){return this._focusedControl$.pipe((0,ke.switchMap)((e=>1===e?this._riskInCurrencyObservable(e):2===e?this._riskInPercentObservable(e):this._quantityObservable(e))))}_quantityObservable(e){return this._quantity$.pipe((0,ke.switchMap)((t=>fe([this._riskInCurrency$,this._riskInPercent$]).pipe((0,b.map)((i=>{const[s,r]=i;return{focusedControl:e,quantity:t,riskInCurrency:s,riskInPercent:r}}))))))}_riskInCurrencyObservable(e){return this._riskInCurrency$.pipe((0,ke.switchMap)((t=>fe([this._quantity$,this._riskInPercent$]).pipe((0,b.map)((i=>{const[s,r]=i;return{focusedControl:e,quantity:s,riskInCurrency:t,riskInPercent:r}}))))))}_riskInPercentObservable(e){return this._riskInPercent$.pipe((0,ke.switchMap)((t=>fe([this._quantity$,this._riskInCurrency$]).pipe((0,b.map)((i=>{const[s,r]=i;return{focusedControl:e,
quantity:s,riskInCurrency:r,riskInPercent:t}}))))))}_calculateQuantity(e){const{focusedControl:t,pipValue:i,quantity:s,riskInCurrency:r,riskInPercent:o,stopLossPips:a,equity:n}=e;switch(t){case 0:default:return s;case 1:return null===r||null===a?null:Se(r,a,i,this.qty.step,this._lotSize);case 2:return null===o||null===a?null:Me(o,n,a,i,this.qty.step,this._lotSize)}}_calculateRiskInCurrency(e){const{focusedControl:t,pipValue:i,quantity:s,riskInCurrency:r,riskInPercent:o,stopLossPips:a,equity:n}=e;switch(t){case 0:return null===s||null===a?null:Ce(s,a,i,this._lotSize);case 1:return r;case 2:if(null===o||null===a)return null;return Ce(Me(o,n,a,i,this.qty.step,this._lotSize),a,i,this._lotSize);default:return null===s||null===a?null:Ce(s,a,i)}}_calculateRiskInPercent(e){const{focusedControl:t,pipValue:i,quantity:s,riskInCurrency:r,riskInPercent:o,stopLossPips:a,equity:n}=e,l=null===a;switch(t){case 0:default:return null===s||l?null:Be(s,a,i,n,this._lotSize);case 1:if(null===r||l)return null;return Be(Se(r,a,i,this.qty.step,this._lotSize),a,i,n,this._lotSize);case 2:return o}}}var Ve=i(803966);class Oe{constructor({info:e,price$:t,baseCurrencyCryptoBalance$:i,quoteCurrencyCryptoBalance$:s,initialQty:r,side$:o,sideGetter:a,orderWidgetStat:n,isExistingOrder:l,orderQty:u,orderPrice:d}){this.formatter=new Ve.QuantityFormatter,this.onControlFocused=new(L()),this._value$=new m.BehaviorSubject(null),this._quoteCurrencyQuantity$=new m.BehaviorSubject(null),this._error$=new m.BehaviorSubject({res:!1}),this._focusedControl$=new m.BehaviorSubject(3),this._controlError$=new m.BehaviorSubject({res:!1}),this._baseCurrencyCryptoBalanceValue$=new m.BehaviorSubject(null),this._quoteCurrencyCryptoBalanceValue$=new m.BehaviorSubject(null),this._subscriptions=[],this.setControlError=e=>{this._controlError$.next({res:e})},this.getFocusedControl=()=>this._focusedControl$.getValue(),this.setFocusedControl=e=>{this._focusedControl$.next(e)},this._setBaseCurrencyQuantity=e=>{this._baseCurrencyQuantity$.next((0,D.formatValue)(e,this.formatter))},this._setQuoteCurrencyQuantity=e=>{this._quoteCurrencyQuantity$.next((0,D.formatValue)(e,this.formatter))},this.info=e,this.side$=o,this.getSide=a,this._price$=t,this._orderQty=u,this._orderPrice=d,this._isExistingOrder=l,this._baseCurrencyCryptoBalance$=i,this._quoteCurrencyCryptoBalance$=s,this._baseCurrencyQuantity$=new m.BehaviorSubject(null!==r?r:e.qty.default||e.qty.step),this.value$=this._value$.asObservable(),this.focusedControl$=this._focusedControl$.asObservable(),this.error$=this._error$.asObservable(),this.baseCurrencyCryptoBalanceValue$=this._baseCurrencyCryptoBalanceValue$.asObservable(),this.quoteCurrencyCryptoBalanceValue$=this._quoteCurrencyCryptoBalanceValue$.asObservable(),this.quoteCurrencyUiParams$=t.pipe((0,b.map)((t=>{const i=(0,se.Big)(t).mul(e.qty.step),s=(0,c.roundDownToPowerOf10)(i.toNumber()),r=(0,se.Big)(Math.ceil(i.div(s).toNumber())).mul(s),o=(0,se.Big)(e.qty.min).div(e.qty.step);return{min:r.mul(o).toNumber(),step:s}}))),this.quantity={
value$:this._baseCurrencyQuantity$.asObservable(),getValue:()=>this._baseCurrencyQuantity$.getValue(),setValue:this._setBaseCurrencyQuantity,onModifiedCallback:null!==n?()=>n.setQtyControlModifiedProperty(B.QuantitySubControlType.BaseCurrency):()=>{}},this.quoteCurrencyQuantity={value$:this._quoteCurrencyQuantity$.asObservable(),getValue:()=>this._quoteCurrencyQuantity$.getValue(),setValue:this._setQuoteCurrencyQuantity,onModifiedCallback:null!==n?()=>n.setQtyControlModifiedProperty(B.QuantitySubControlType.QuoteCurrency):()=>{}},this._quantityValuesWithFocusedControl$=this._quantityValuesWithFocusedControlObservable()}subscribe(){null!==this._baseCurrencyCryptoBalance$&&this._subscriptions.push((0,S.combineLatest)([this.side$,this._baseCurrencyCryptoBalance$]).subscribe((e=>{const[t,i]=e;this._baseCurrencyCryptoBalanceValue$.next(this._getBalance(t,i))}))),null!==this._quoteCurrencyCryptoBalance$&&this._subscriptions.push((0,S.combineLatest)([this.side$,this._quoteCurrencyCryptoBalance$]).subscribe((e=>{const[t,i]=e;this._quoteCurrencyCryptoBalanceValue$.next(this._getBalance(t,i))})));const e=(0,S.combineLatest)({price:this._price$,quantityValuesWithFocusedControl:this._quantityValuesWithFocusedControl$}).subscribe((e=>{const{price:t,quantityValuesWithFocusedControl:i}=e,{focusedControl:s,baseCurrencyQuantity:r,quoteCurrencyQuantity:o}=i,{baseCurrencyQuantity:a,quoteCurrencyQuantity:n}=this._calculateQuantityValues({focusedControl:s,price:t,baseCurrencyQuantity:r,quoteCurrencyQuantity:o});r===a&&o===n||this._setUnfocusedControlsValues(s,a,n)})),t=(0,S.combineLatest)({baseValue:this._baseCurrencyQuantity$,quoteValue:this._quoteCurrencyQuantity$,controlError:this._controlError$,focus:this._focusedControl$,side:this.side$,baseBalanceValue:this._baseCurrencyCryptoBalanceValue$,quoteBalanceValue:this._quoteCurrencyCryptoBalanceValue$}).subscribe((e=>{const{baseValue:t,quoteValue:i,controlError:s,focus:r,side:o,baseBalanceValue:a,quoteBalanceValue:n}=e,l=(0,we.checkQtyError)(this.info.qty,t),u=this._isSellSide(o)?this._checkBalanceError(t,a):this._checkBalanceError(i,n);this._error$.next({res:l.res||u.res||s.res,msg:l.msg||u.msg||s.msg}),this._value$.next(l.res||u.res||s.res||null===r?null:t)}));this._subscriptions.push(e,t)}getError(){return this._error$.getValue()}unsubscribe(){this._subscriptions.forEach((e=>e&&e.unsubscribe()))}getValue(){return this._value$.getValue()}_quantityValuesWithFocusedControlObservable(){return this._focusedControl$.pipe((0,ke.switchMap)((e=>{const t=3===e,i=t?this._baseCurrencyQuantity$:this._quoteCurrencyQuantity$,s=t?this._quoteCurrencyQuantity$:this._baseCurrencyQuantity$;return i.pipe((0,ke.switchMap)((i=>s.pipe((0,b.map)((s=>({focusedControl:e,baseCurrencyQuantity:t?i:s,quoteCurrencyQuantity:t?s:i})))))))})))}_checkBalanceError(e,t){return null!==e&&null!==t&&e>t?{res:!0,msg:we.qtyErrors.balance}:{res:!1}}_getBalance(e,t){return null===t?null:this._makeOrderBalanceValue(e).plus(t.available).toNumber()}_makeOrderBalanceValue(e){
return this._isExistingOrder&&this._orderQty&&this._orderPrice?this._isSellSide(e)?new se.Big(this._orderQty):new se.Big(this._orderQty).mul(this._orderPrice):new se.Big(0)}_isSellSide(e){return-1===e}_setUnfocusedControlsValues(e,t,i){3!==e&&this._setBaseCurrencyQuantity(t),4!==e&&this._setQuoteCurrencyQuantity(i)}_calculateQuantityValues(e){const{focusedControl:t,price:i,baseCurrencyQuantity:s,quoteCurrencyQuantity:r}=e;let o=s,a=r;switch(t){case 3:null!==s&&(a=(0,se.Big)(s).mul(i).toNumber());break;case 4:null!==r&&(o=(0,se.Big)(r).div(i).div(this.info.qty.step).round(0,0).mul(this.info.qty.step).toNumber())}return{baseCurrencyQuantity:(0,D.formatValue)(o,this.formatter),quoteCurrencyQuantity:(0,D.formatValue)(a,this.formatter)}}}var Le=i(346849),qe=i(943778);class Ne{constructor({initialPrice:e,initialEnabled:t,initialBracketType:s,formatter:r,equity$:o,quotes$:a,info:n,pipValue$:l,side$:u,amount$:c,parentPrice$:h,orderType$:p,currency:_,parentType:y,savedPips:k,settings:g,orderWidgetStat:P,showRiskControls:v,status:f,validationRules:T,supportModifyBrackets:w,supportModifyTrailingStop:M,supportCryptoBrackets:I,supportAddBracketsToExistingOrder:V,hasTrailingStopBracket:O}){if(this.isValuesInitialized=!1,this.onControlFocused=new(L()),this.stopLossTypes=[C.BracketType.StopLoss,C.BracketType.TrailingStop],this.roundToStopLimitPriceStepRequired=!1,this._value$=new m.BehaviorSubject(null),this._pips$=new m.BehaviorSubject(null),this._price$=new m.BehaviorSubject(null),this._riskInCurrency$=new m.BehaviorSubject(null),this._riskInPercent$=new m.BehaviorSubject(null),this._focusedControl$=new m.BehaviorSubject(1),this._error$=new m.BehaviorSubject({res:!1}),this._controlError$=new m.BehaviorSubject({res:!1}),this._subscriptions=[],this._bracketPercentPriceRuleCheckers=[],this.getValue=()=>this._value$.getValue(),this.getFocusedControl=()=>this._focusedControl$.getValue(),this.getEnabled=()=>this._enabled$.getValue(),this.getBracketType=()=>this._bracketType$.getValue(),this.getError=()=>this._error$.getValue(),this.setFocusedControl=e=>{this._focusedControl$.next(e)},this.setEnabled=e=>{this._enabled$.next(e)},this.setBracketType=e=>{this._bracketType$.next(e)},this.setControlError=e=>{this._controlError$.next({res:e,msg:void 0})},this._bracketValuesWithFocusedControlObservable=()=>this._focusedControl$.pipe((0,ke.switchMap)((e=>1===e?this._priceObservable(e):2===e?this._riskInCurrencyObservable(e):3===e?this._riskInPercentObservable(e):this._pipsObservable(e)))),this._updateFocusIfNeeded=e=>{const t=this.getFocusedControl(),i=this._supportCryptoBrackets?"showCryptoBracketsInPercent":"showBracketsInPercent",s=this._supportCryptoBrackets?"showCryptoBracketsInCurrency":"showBracketsInCurrency";(3===t&&!e[i]||2===t&&!e[s])&&this.setFocusedControl(0)},this._getPips=()=>this._pips$.getValue(),this._getPrice=()=>this._price$.getValue(),this._getRiskInCurrency=()=>this._riskInCurrency$.getValue(),this._getRiskInPercent=()=>this._riskInPercent$.getValue(),this._setPips=e=>{this._pips$.next((0,
D.formatValue)(e,this._pipsFormatter))},this._setPrice=e=>{this._price$.next((0,D.formatValue)(e,this._priceFormatter))},this._setRiskInCurrency=e=>{this._riskInCurrency$.next((0,D.formatValue)(e,this._riskInCurrencyFormatter))},this._setRiskInPercent=e=>{this._riskInPercent$.next((0,D.formatValue)(e,this._riskInPercentFormatter))},this._enabled$=new m.BehaviorSubject(t),this._bracketType$=new m.BehaviorSubject(s),this._equity$=o,this._pipValue$=l,this._side$=u,this._sideSign$=u.pipe((0,b.map)((e=>(s!==C.BracketType.TakeProfit?-1:1)*e))),this._quotes$=a,this._amount$=c,this._pipSize=n.pipSize,this._lotSize=n.lotSize,this._settings=g,this._parentType=y,this._priceType=s===C.BracketType.TakeProfit?1:2,this._supportCryptoBrackets=Boolean(I),this._isStatusEditing=1!==y||f===B.OrderPanelStatus.Editing,this._pipsFormatter=new q.PriceFormatter(n.pipSize!==n.minTick?10:1),this._priceFormatter=r,this._riskInCurrencyFormatter=new q.PriceFormatter(100),this._riskInPercentFormatter=new q.PriceFormatter(100),this._priceMagnifier=n.priceMagnifier||1,this._hasTrailingStopBracket=O,this._parentPrice$=(0,S.combineLatest)({parentPrice:h,orderType:p,bracketType:this._bracketType$,quotes:this._quotes$,parentSide:this._side$}).pipe((0,b.map)((e=>{const{parentPrice:t,orderType:i,bracketType:s,quotes:r,parentSide:o}=e;if(s===C.BracketType.TrailingStop){if(2===i)return 1===o?(0,$.getAsk)(r):(0,$.getBid)(r);if(1!==this._parentType)return 1===o?(0,$.getBid)(r):(0,$.getAsk)(r)}return t}))),void 0!==T)for(const e of T)this._bracketPercentPriceRuleCheckers.push((0,Le.makeBracketPercentPriceRuleChecker)(e.options.min,e.options.max));this._priceStep=(0,$.getPriceStep)({priceType:this._priceType,minTick:n.minTick||n.pipSize,limitPriceStep:n.limitPriceStep,stopPriceStep:n.stopPriceStep}),this.roundToStopLimitPriceStepRequired=(0,$.roundToStepRequired)({priceType:this._priceType,minTick:n.minTick||n.pipSize,limitPriceStep:n.limitPriceStep,stopPriceStep:n.stopPriceStep}),(0,S.combineLatest)({parentPrice:this._parentPrice$,sideSign:this._sideSign$,pipValue:this._pipValue$,equity:this._equity$,amount:this._amount$}).pipe((0,oe.take)(1)).subscribe((t=>{const{parentPrice:i,sideSign:r,pipValue:o,equity:a,amount:n}=t;let l,u,c=0;null!==e?(c=1,l=null,u=e):(l=null!==k?k:this._getDefaultPips(s),u=null);const{pips:d,price:h,riskInCurrency:p,riskInPercent:_}=this._calculateBracketValues({sideSign:r,pipValue:o,equity:a,parentPrice:i,amount:n,focusedControl:c,pips:l,price:u,riskInCurrency:null,riskInPercent:null});this.setFocusedControl(c),this._setPips(d),this._setPrice(h),this._setRiskInCurrency(p),this._setRiskInPercent(_),this.isValuesInitialized=!0})),this._bracketValuesWithFocusedControl$=this._bracketValuesWithFocusedControlObservable(),this.pips={value$:this._pips$.asObservable(),step:1,formatter:this._pipsFormatter,getValue:this._getPips,setValue:this._setPips,onModifiedCallback:null!==P?()=>P.setBracketControlModifiedProperty(s,B.BracketSubControlType.Pips):()=>{}},this.price={value$:this._price$.asObservable(),step:this._priceStep,
formatter:this._priceFormatter,getValue:this._getPrice,setValue:this._setPrice,onModifiedCallback:null!==P?()=>P.setBracketControlModifiedProperty(s,B.BracketSubControlType.Price):()=>{}},this.riskInCurrency={value$:this._riskInCurrency$.asObservable(),step:.01,formatter:this._riskInCurrencyFormatter,getValue:this._getRiskInCurrency,setValue:this._setRiskInCurrency,onModifiedCallback:null!==P?()=>P.setBracketControlModifiedProperty(s,B.BracketSubControlType.Money):()=>{}},this.riskInPercent={value$:this._riskInPercent$.asObservable(),step:.01,formatter:this._riskInPercentFormatter,getValue:this._getRiskInPercent,setValue:this._setRiskInPercent,onModifiedCallback:null!==P?()=>P.setBracketControlModifiedProperty(s,B.BracketSubControlType.Percent):()=>{}},this.value$=this._value$.asObservable(),this.enabled$=this._enabled$.asObservable(),this.bracketType$=this._bracketType$.asObservable(),this.focusedControl$=this._focusedControl$.asObservable(),this.error$=this._error$.asObservable(),this.controlState=this._computeControlState(y,s,w,M,V),this.currency=_.length>0?_:d.t(null,void 0,i(470500)),this.showRiskControls=v}subscribe(){this._settings.subscribe(this._updateFocusIfNeeded);const e=(0,S.combineLatest)({enabled:this._enabled$,parentPrice:this._parentPrice$,sideSign:this._sideSign$,pipValue:this._pipValue$,equity:this._equity$,amount:this._amount$,bracketValuesWithFocusedControl:this._bracketValuesWithFocusedControl$}).subscribe((e=>{const{enabled:t,parentPrice:i,sideSign:s,pipValue:r,equity:o,amount:a,bracketValuesWithFocusedControl:n}=e,{focusedControl:l,pips:u,price:c,riskInCurrency:d,riskInPercent:h}=n,{pips:p,price:_,riskInCurrency:y,riskInPercent:b}=this._calculateBracketValues({sideSign:s,pipValue:r,equity:o,parentPrice:i,amount:a,focusedControl:l,pips:u,price:c,riskInCurrency:d,riskInPercent:h});!t&&null!==d||u===p&&c===_&&d===y&&h===b||this._setUnfocusedControlsValues(l,p,_,y,b)})),t=(0,S.combineLatest)({side:this._side$,enabled:this._enabled$,controlError:this._controlError$,bracketValuesWithFocusedControl:this._bracketValuesWithFocusedControl$,parentPrice:this._parentPrice$,quotes:this._quotes$,bracketType:this._bracketType$}).subscribe((e=>{const{side:t,enabled:i,controlError:s,bracketValuesWithFocusedControl:r,parentPrice:o,quotes:a,bracketType:n}=e,{focusedControl:l,pips:u,price:c}=r;i&&this._setError({side:t,parentPrice:o,quotes:a,bracketType:n,controlError:s,focusedControl:l,pips:u,price:c})})),i=(0,S.combineLatest)({pips:this._pips$,error:this._error$,enabled:this._enabled$}).subscribe((e=>{const{pips:t,error:i,enabled:s}=e;this._value$.next(i.res||!s||null===t?null:(0,se.Big)(t).div(this._priceMagnifier).toNumber())}));return this._subscriptions=[e,t,i],this._subscriptions}unsubscribe(){this._subscriptions.forEach((e=>e.unsubscribe())),this._settings.unsubscribe(this._updateFocusIfNeeded)}isValueIncorrect(){const e=this.getEnabled(),t=this.getValue();return e&&null===t}_getDefaultPips(e){return e===C.BracketType.TakeProfit?B.BracketDefaultPips.TakeProfit:B.BracketDefaultPips.StopLoss}
_setUnfocusedControlsValues(e,t,i,s,r){0!==e&&this._setPips(t),1!==e&&this._setPrice(i),2!==e&&this._setRiskInCurrency(s),3!==e&&this._setRiskInPercent(r)}_setError(e){const{side:t,parentPrice:i,quotes:s,bracketType:r,controlError:o,focusedControl:a,pips:n,price:l}=e;o.res?this._error$.next(o):this._error$.next((0,Le.checkBracketError)({quotes:s,side:t,price:l,pips:n,priceType:this._priceType,priceStep:this._priceStep,parentPrice:i,parentType:this._parentType,bracketType:r,isStatusEditing:this._isStatusEditing,isEnabled:this.getEnabled(),bracketPercentPriceRuleCheckers:this._bracketPercentPriceRuleCheckers,priceFormatter:this._priceFormatter,isRoundToPriceStep:this.roundToStopLimitPriceStepRequired&&1===a}))}_pipsObservable(e){return this._pips$.pipe((0,ke.switchMap)((t=>fe([this._price$,this._riskInCurrency$,this._riskInPercent$]).pipe((0,b.map)((i=>{const[s,r,o]=i;return{focusedControl:e,pips:t,price:s,riskInCurrency:r,riskInPercent:o}}))))))}_priceObservable(e){return this._price$.pipe((0,ke.switchMap)((t=>fe([this._pips$,this._riskInCurrency$,this._riskInPercent$]).pipe((0,b.map)((i=>{const[s,r,o]=i;return{focusedControl:e,pips:s,price:t,riskInCurrency:r,riskInPercent:o}}))))))}_riskInCurrencyObservable(e){return this._riskInCurrency$.pipe((0,ke.switchMap)((t=>fe([this._pips$,this._price$,this._riskInPercent$]).pipe((0,b.map)((i=>{const[s,r,o]=i;return{focusedControl:e,pips:s,price:r,riskInCurrency:t,riskInPercent:o}}))))))}_riskInPercentObservable(e){return this._riskInPercent$.pipe((0,ke.switchMap)((t=>fe([this._pips$,this._price$,this._riskInCurrency$]).pipe((0,b.map)((i=>{const[s,r,o]=i;return{focusedControl:e,pips:s,price:r,riskInCurrency:o,riskInPercent:t}}))))))}_calculateBracketValues(e){return{pips:(0,D.formatValue)(this._calculatePips(e),this._pipsFormatter),price:(0,D.formatValue)(this._calculatePrice(e),this._priceFormatter),riskInCurrency:(0,D.formatValue)(this._calculateRiskInCurrency(e),this._riskInCurrencyFormatter),riskInPercent:(0,D.formatValue)(this._calculateRiskInPercent(e),this._riskInPercentFormatter)}}_calculatePips(e){const{sideSign:t,pipValue:i,equity:s,parentPrice:r,amount:o,focusedControl:a,pips:n,price:l,riskInCurrency:u,riskInPercent:c}=e;switch(a){case 0:default:return n;case 1:return null===l?null:(0,qe.priceToPips)(l,r,t,this._pipSize);case 2:return null===u||null===o?null:(0,qe.riskInCurrencyToPips)(u,o,i,this._priceMagnifier,this._lotSize);case 3:return null===c||null===o?null:(0,qe.riskInPercentToPips)(c,o,s,i,this._priceMagnifier,this._lotSize)}}_calculatePrice(e){const{sideSign:t,pipValue:i,equity:s,parentPrice:r,amount:o,focusedControl:a,pips:n,price:l,riskInCurrency:u,riskInPercent:d}=e;let h,p;switch(a){case 0:default:if(null===n)return null;p=(0,qe.pipsToPrice)(n,r,t,this._pipSize);break;case 1:return l;case 2:if(null===u||null===o)return null;h=(0,qe.riskInCurrencyToPips)(u,o,i,this._priceMagnifier,this._lotSize),p=(0,qe.pipsToPrice)(h,r,t,this._pipSize);break;case 3:if(null===d||null===o)return null;h=(0,
qe.riskInPercentToPips)(d,o,s,i,this._priceMagnifier,this._lotSize),p=(0,qe.pipsToPrice)(h,r,t,this._pipSize)}return this.roundToStopLimitPriceStepRequired?(0,c.roundToStepByPriceTypeAndSide)(p,this._priceStep,this._priceType,t):p}_calculateRiskInCurrency(e){const{sideSign:t,pipValue:i,equity:s,parentPrice:r,amount:o,focusedControl:a,pips:n,price:l,riskInCurrency:u,riskInPercent:c}=e;let d;const h=null===n||null===o;switch(a){case 0:default:return h?null:(0,qe.pipsToRiskInCurrency)(n,o,i,this._priceMagnifier,this._lotSize);case 1:return null===l||h?null:(d=(0,qe.priceToPips)(l,r,t,this._pipSize),(0,qe.pipsToRiskInCurrency)(d,o,i,this._priceMagnifier,this._lotSize));case 2:return u;case 3:return null===c||h?null:(d=(0,qe.riskInPercentToPips)(c,o,s,i,this._priceMagnifier,this._lotSize),(0,qe.pipsToRiskInCurrency)(d,o,i,this._priceMagnifier,this._lotSize))}}_calculateRiskInPercent(e){const{sideSign:t,pipValue:i,equity:s,parentPrice:r,amount:o,focusedControl:a,pips:n,price:l,riskInCurrency:u,riskInPercent:c}=e;let d;const h=null===n||null===o;switch(a){case 0:default:return h?null:(0,qe.pipsToRiskInPercent)(n,o,s,i,this._priceMagnifier,this._lotSize);case 1:return null===l||h?null:(d=(0,qe.priceToPips)(l,r,t,this._pipSize),(0,qe.pipsToRiskInPercent)(d,o,s,i,this._priceMagnifier,this._lotSize));case 2:return null===u||null===o?null:(d=(0,qe.riskInCurrencyToPips)(u,o,i,this._priceMagnifier,this._lotSize),(0,qe.pipsToRiskInPercent)(d,o,s,i,this._priceMagnifier,this._lotSize));case 3:return c}}_computeControlState(e,t,i,s,r){const o=this._isStatusEditing&&t===C.BracketType.TrailingStop&&!s&&this._hasTrailingStopBracket,a=this._isStatusEditing&&t!==C.BracketType.TakeProfit&&this.getEnabled()&&!s&&this._hasTrailingStopBracket,n=this._isStatusEditing&&!i,l=Boolean(1===e&&this._isStatusEditing&&!this.getEnabled()&&!r);return{inputDisabled:o||n||l,labelDisabled:a||n||l,checkboxDisabled:n||l}}}function De(e){return(0,K.operate)((function(t,i){(0,f.innerFrom)(e).subscribe(new G.OperatorSubscriber(i,(function(){return i.complete()}),le.noop)),!i.closed&&t.subscribe(i)}))}var Ee=i(409432);class Fe{constructor({initialDuration:e,orderType:t,orderWidgetStat:i,orderDurations:s,symbolDurations:r}){this.onControlFocused=new(L()),this._stop$=new P.Subject,this.durationMetaInfoList=void 0!==s?(0,$.filterDurationsBySymbolDurations)(s,r):[],this.orderType=t;const o=this._getDurationByOrderType(e,t.value());this.$value=new m.BehaviorSubject(o),this.currentDuration=new Ee.WatchedObject(o,D.comparator),this._currentDurationSubscription=(0,D.makeSubjectFromWatchedValue)(this.currentDuration),this._orderTypeSubscription=(0,D.makeSubjectFromWatchedValue)(this.orderType),this._currentDurationSubscription.subject.pipe(De(this._stop$)).subscribe((e=>{this.$value.next(e)})),this._orderTypeSubscription.subject.pipe(De(this._stop$)).subscribe((e=>{const t=this._getDurationByOrderType(this.getValue(),e);this.currentDuration.setValue(t)})),this.onModifiedCallback=null!==i?()=>i.setDurationControlModifiedProperty():()=>{}}isDurationsAvailable(){
return null!==this._getDurationByOrderType(this.currentDuration.value(),this.orderType.value())}unsubscribe(){this._stop$.next(),this._stop$.complete(),this._currentDurationSubscription.unsubscribe(),this._orderTypeSubscription.unsubscribe()}getValue(){const e=this.$value.getValue();if(null===e)return null;const t=this.durationMetaInfoList.find((t=>e.type===t.value));if(void 0===t)return null;const i={type:e.type};return(t.hasDatePicker||t.hasTimePicker)&&(i.datetime=e.datetime),i}_getDurationByOrderType(e,t){const i=(0,$.filterDurationsByOrderType)(this.durationMetaInfoList,t);if(0===i.length)return null;return null!==e&&i.some((t=>e.type===t.value))?e:(0,$.makeInitialOrderDuration)(t,i)}}var Re=i(173587);function xe(e,t=100,i){const s=new Map,r=new Map;return function(...o){var a;const n=String(i?i.apply(null,o):o),l=Date.now();if(s.has(n)&&(null!==(a=r.get(n))&&void 0!==a?a:-1/0)>l)return s.get(n);const u=e.apply(this,o);return s.set(n,u),r.set(n,l+t),u}}const ze=(0,o.getLogger)("Trading.LeverageViewModel");class We{constructor({adapterLeverageInfo:e,adapterSetLeverage:t,adapterPreviewLeverage:s,brokerName:o,symbol:a,displaySymbol:n,orderType$:l,side$:u,initialSide:h,customFieldModels:p,customFieldsGetter:_,blocked$:y,onBlockedClick:b}){this.onControlFocused=new(L()),this._leverageInfo$=new m.BehaviorSubject(null),this._leveragePreviewResult$=new m.BehaviorSubject(null),this._subscriptions=[],this.leverageInfo=()=>this._leverageInfo$.getValue(),this.leveragePreviewResult=()=>this._leveragePreviewResult$.getValue(),this.setLeverage=async e=>{try{const t=await this._adapterSetLeverage(e),i=this.leverageInfo();null!==i&&this._leverageInfo$.next({...i,leverage:t.leverage})}catch(e){throw ze.logError(`Failed to set leverage: ${(0,c.getLoggerMessage)(e)}`),new Error(d.t(null,void 0,i(368662)))}},this.previewLeverage=async e=>{try{const t=await this._adapterPreviewLeverage(e);return this._leveragePreviewResult$.next(t),t}catch(e){throw this._leveragePreviewResult$.next(null),ze.logError(`Failed to preview leverage: ${(0,c.getLoggerMessage)(e)}`),new Error(d.t(null,void 0,i(575681)))}},this._updateLeverageInfo=async()=>{if(this.getBlocked())return;const e=await this.getLeverageInfo({symbol:this.symbol,orderType:this.orderType,side:this.side,customFields:this.customFields});this._leverageInfo$.next(e)},this._adapterLeverageInfo=e,this._adapterSetLeverage=t,this._adapterPreviewLeverage=s,this.symbol=a,this.displaySymbol=n,this._orderType$=l,this._side$=u,this._customFieldModels=p,this.brokerName=o,this.leverageInfo$=this._leverageInfo$.asObservable(),this.orderType=(0,r.ensureNotNull)(l.value),this.side=h,this.customFields=_(this._customFieldModels.value()),this._customFieldsGetter=_,this._blocked$=y,this.blocked$=this._blocked$.asObservable(),this.onBlockedClick=b,this._selectedItems$=this._customFieldModels.value().filter((e=>"ComboBox"===e.type&&"selectedItem"in e)).map((e=>{const t=(0,D.makeSubjectFromWatchedValue)(e.selectedItem);return e.subscription=t,t.subject})),this._subscribe(),
this.getLeverageInfo=xe(this.getLeverageInfo)}unsubscribe(){this._subscriptions.forEach((e=>{e.unsubscribe()}))}async getLeverageInfo(e){try{return await this._adapterLeverageInfo(e)}catch(e){return ze.logError(`Failed to get leverage info: ${(0,c.getLoggerMessage)(e)}`),null}}getBlocked(){return this._blocked$.getValue()}_subscribe(){const e=(0,S.combineLatest)([this._orderType$,this._side$]).pipe((0,Re.skip)(1)).subscribe((async([e,t])=>{this.orderType=(0,r.ensureNotNull)(e),this.side=t,this._updateLeverageInfo()})),t=(0,S.combineLatest)(this._selectedItems$).pipe((0,Re.skip)(1)).subscribe((()=>{this.customFields=this._customFieldsGetter(this._customFieldModels.value()),this._updateLeverageInfo()})),i=this.blocked$.pipe((0,Re.skip)(1)).subscribe(this._updateLeverageInfo);this._subscriptions=[e,t,i]}}i(336379);const je="",Ae=(e,t)=>d.t(null,void 0,i(896582)).format({qty:e,symbol:t,whitespaceNoBreak:je}),Qe=(e,t,s)=>d.t(null,void 0,i(111828)).format({qty:e,symbol:t,stopPrice:s,whitespaceNoBreak:je}),Ue=(e,t,s)=>d.t(null,void 0,i(518088)).format({qty:e,symbol:t,limitPrice:s,whitespaceNoBreak:je}),He=(e,t,s,r)=>d.t(null,void 0,i(828749)).format({qty:e,symbol:t,stopPrice:s,limitPrice:r,whitespaceNoBreak:je}),[Ye,Ke]=d.t(null,void 0,i(134569)).split(/{line_break}/);class Ge{constructor(e,t){this.getValue=()=>this._value.getValue(),this.subscribe=()=>{const e=(0,r.ensureDefined)(this._props);if(e.existingOrder||this._tradingEntityType===C.TradingEntityType.Position)return;const t={status:e.status,orderType:e.orderType,orderPlacingStatus:e.orderPlacingStatus,side:e.side,quantity:e.quantity,stopPrice:e.stopPrice,limitPrice:e.limitPrice};this._orderSubscription=(0,S.combineLatest)(t).subscribe(this._orderSubscriptionValues)},this.unsubscribe=()=>{this._orderSubscription&&this._orderSubscription.unsubscribe()},this._orderSubscriptionValues=e=>{const t=(0,r.ensureDefined)(this._props),{status:s,orderType:o,orderPlacingStatus:a,side:n,quantity:l,stopPrice:u,limitPrice:c}=e;if(s===B.OrderPanelStatus.Preview)return this._value.next({primaryText:d.t(null,void 0,i(68160))});if(s===B.OrderPanelStatus.Wait)return a===B.OrderPlacingStatus.Placed?this._value.next({primaryText:d.t(null,void 0,i(862349))}):this._value.next({primaryText:Ye,secondaryText:Ke});const h=null!==u?t.formatter.format(u):"",p=null!==c?t.formatter.format(c):"",_=null!==l?t.quantityFormatter.format(l):"",y=1===n?d.t(null,void 0,i(618156)):d.t(null,void 0,i(392553));switch(o){case 2:return this._value.next({primaryText:y,secondaryText:Ae(_,t.symbol)});case 3:return this._value.next({primaryText:y,secondaryText:Qe(_,t.symbol,h)});case 1:return this._value.next({primaryText:y,secondaryText:Ue(_,t.symbol,p)});case 4:return this._value.next({primaryText:y,secondaryText:He(_,t.symbol,h,p)})}},this._tradingEntityType=e,this._value=new m.BehaviorSubject({primaryText:""}),this.value$=this._value.asObservable(),this._props=t,this._setInitialValue()}_setInitialValue(){var e;switch(this._tradingEntityType){case C.TradingEntityType.Order:
const t=!0===(null===(e=this._props)||void 0===e?void 0:e.existingOrder)?d.t(null,void 0,i(305806)):"";this._value.next({primaryText:t});break;case C.TradingEntityType.Position:this._value.next({primaryText:d.t(null,void 0,i(768527))})}}}class Je{constructor({marginAvailable$:e,qty$:t,currency:i,pipValue$:s,price$:r,side$:o,showTotalInsteadOfTradeValue:a,showRiskControls:n,info:l,tpInfo:u,slInfo:c,supportMargin:d,pipValueType$:h,leverageInfo$:p}){this._infoTableData$=new m.BehaviorSubject({rows:[]}),this._availableMargin$=new m.BehaviorSubject(0),this._usedMargin$=new m.BehaviorSubject(0),this._leverageInfo=null,this._subscriptions=[],this._tpEnabled$=null,this._tpRiskInCurrency$=null,this._tpRiskInPercent$=null,this._slEnabled$=null,this._slRiskInCurrency$=null,this._slRiskInPercent$=null,this._riskFormatter=new q.PriceFormatter(100),this._marginAvailable$=e,this._qty$=t,this._pipValue$=s,this._side$=o,this._type=l.type,this._pipValueType$=h,this._currency=i,this._marginRate=l.marginRate,this._hasMarginMeter=d&&(void 0!==p||void 0!==this._marginRate),this._price$=r,this._showTotalInsteadOfTradeValue=a,this._showRiskControls=n,this._bigPointValue=l.bigPointValue||1,this._instrumentCurrency=l.currency,this._leverageInfo$=p,this._leverage=l.leverage,this._lotSize=l.lotSize,this._symbolPipSize=l.pipSize,this._pipValueForCurrentQuantity=0,this._tradeValueInSymbolCurrency=0,this._tradeValue=0,this._priceMagnifier=l.priceMagnifier,u&&c&&(this._tpEnabled$=u.enabled,this._tpRiskInCurrency$=u.riskInCurrency,this._tpRiskInPercent$=u.riskInPercent,this._slEnabled$=c.enabled,this._slRiskInCurrency$=c.riskInCurrency,this._slRiskInPercent$=c.riskInPercent)}subscribe(){this._subscriptions=[(0,S.combineLatest)({price:this._price$,pipValue:this._pipValue$,pipValueType:this._pipValueType$,side:this._side$,qty:this._qty$,leverageInfo:void 0!==this._leverageInfo$?this._leverageInfo$:(0,M.of)(null),tpEnabled:null!==this._tpEnabled$?this._tpEnabled$:(0,M.of)(null),tpRiskInCurrency:null!==this._tpRiskInCurrency$?this._tpRiskInCurrency$:(0,M.of)(null),tpRiskInPercent:null!==this._tpRiskInPercent$?this._tpRiskInPercent$:(0,M.of)(null),slEnabled:null!==this._slEnabled$?this._slEnabled$:(0,M.of)(null),slRiskInCurrency:null!==this._slRiskInCurrency$?this._slRiskInCurrency$:(0,M.of)(null),slRiskInPercent:null!==this._slRiskInPercent$?this._slRiskInPercent$:(0,M.of)(null)}).subscribe((e=>{const{price:t,pipValue:i,pipValueType:s,qty:r,leverageInfo:o,tpEnabled:a,tpRiskInCurrency:n,tpRiskInPercent:l,slEnabled:u,slRiskInCurrency:c,slRiskInPercent:d}=e;if(this._leverageInfo=o,this._pipValueForCurrentQuantity=(0,D.convertToBaseMonetaryUnit)((0,D.calculatePipValue)(r,i,this._lotSize),this._priceMagnifier),null===r)this._tradeValue=0,this._tradeValueInSymbolCurrency=0;else{const e="crypto"===this._type?(0,se.Big)(r).mul(t).toNumber():(0,D.calculateTradeValue)(r,t,i,this._symbolPipSize,this._lotSize);this._tradeValue=(0,D.convertToBaseMonetaryUnit)(e,this._priceMagnifier);const s=(0,
D.calculateTradeValueByBigPointValue)(r,t,this._bigPointValue,this._lotSize);this._tradeValueInSymbolCurrency=(0,D.convertToBaseMonetaryUnit)(s,this._priceMagnifier)}const h=[];h.push(...this._makeLotSizeInfo(),...this._makePipValueInfo(s),...this._makeTradeValueInfo(),...this._makeRewardInfo(a,n,l),...this._makeRiskInfo(u,c,d));const p=this._getMarginRate();null===o&&h.unshift(...this._makeLeverageInfo()),this._usedMargin$.next((0,D.calculateUsedMargin)(this._tradeValue,p)),this._infoTableData$.next({rows:h})}))],this._hasMarginMeter&&this._subscriptions.push((0,r.ensureNotNull)(this._marginAvailable$).subscribe((e=>this._updateAvailableMargin(e))))}unsubscribe(){this._subscriptions.map((e=>e.unsubscribe()))}title(){return d.t(null,void 0,i(163003))}infoTableData(){return this._infoTableData$.asObservable()}getOrderInfoTableRowsCount(){return this._infoTableData$.getValue().rows.length}hasMarginMeter(){return this._hasMarginMeter}availableMargin(){return this._availableMargin$.asObservable()}usedMargin(){return this._usedMargin$.asObservable()}_getTradeValue(){const e=this._getMarginRate();if(this._showRiskControls&&Number.isFinite(this._tradeValue)&&(this._isSymbolTypeSupportTradeValue()||void 0!==e))return(0,D.formatInfoValue)(this._tradeValue*(null!=e?e:1))}_updateAvailableMargin(e){this._availableMargin$.next(e)}_makeLeverageInfo(){const e=(0,D.displayedLeverage)(this._leverage,this._marginRate);return null===e?[]:[{title:d.t(null,void 0,i(956220)),value:e}]}_makeLotSizeInfo(){return"number"==typeof this._lotSize&&Number.isFinite(this._lotSize)?[{title:d.t(null,void 0,i(127531)),value:String(this._lotSize)}]:[]}_makePipValueInfo(e){return this._showRiskControls&&e!==C.PipValueType.None&&Number.isFinite(this._pipValueForCurrentQuantity)?[{title:e===C.PipValueType.Pips?d.t(null,void 0,i(419489)):d.t(null,void 0,i(696709)),value:`${(0,D.formatInfoValue)(this._pipValueForCurrentQuantity)} ${this._currency}`}]:[]}_makeTradeValueInfo(){const e=this._getTradeValue();if(void 0===e)return[];const t=this._showTotalInsteadOfTradeValue?d.t(null,void 0,i(613937)):d.t(null,void 0,i(207710)),s=this._getTradeValueInSymbolCurrency();return void 0===s?[{title:t,value:`${e} ${this._currency}`}]:[{title:t},{title:d.t(null,void 0,i(278770)),value:`${e} ${this._currency}`,listMarker:!0},{title:d.t(null,void 0,i(689544)),value:`${s} ${this._instrumentCurrency}`,listMarker:!0}]}_getTradeValueInSymbolCurrency(){var e;const t=null!==(e=this._getMarginRate())&&void 0!==e?e:1;if(void 0!==this._instrumentCurrency&&this._instrumentCurrency!==this._currency&&Number.isFinite(this._tradeValueInSymbolCurrency))return(0,D.formatInfoValue)(this._tradeValueInSymbolCurrency*t)}_getMarginRate(){return null!==this._leverageInfo?0!==this._leverageInfo.leverage?(0,se.Big)(1).div(this._leverageInfo.leverage).toNumber():void 0:void 0!==this._marginRate&&this._marginRate>0?this._marginRate:void 0}_isSymbolTypeSupportTradeValue(){return void 0!==this._type&&["stock","dr","right","bond","warrant","structured"].includes(this._type)}_makeRewardInfo(e,t,s){
return this._showRiskControls&&e&&null!==t&&null!==s?[{title:d.t(null,void 0,i(356979)),value:`${this._riskFormatter.format(s)}% (${this._riskFormatter.format(t)} ${this._currency})`}]:[]}_makeRiskInfo(e,t,s){return this._showRiskControls&&e&&null!==t&&null!==s?[{title:d.t(null,void 0,i(563833)),value:`${this._riskFormatter.format(s)}% (${this._riskFormatter.format(t)} ${this._currency})`}]:[]}}const Ze=(0,o.getLogger)("PromiseWithDefault");function Xe(e,t,i){return e.catch((e=>(Ze.logError(e),i&&i(),t)))}const et={symbol:d.t(null,void 0,i(589053)),ask:d.t(null,void 0,i(987300)),bid:d.t(null,void 0,i(6205)),orderType:d.t(null,void 0,i(158416)),side:d.t(null,void 0,i(750441)),quantity:d.t(null,void 0,i(766596)),price:d.t(null,void 0,i(25684)),stopPrice:d.t(null,void 0,i(722028)),limitPrice:d.t(null,void 0,i(627262)),currency:d.t(null,void 0,i(50985)),stopLoss:d.t(null,void 0,i(241648)),takeProfit:d.t(null,void 0,i(129266)),buy:d.t(null,void 0,i(618156)),sell:d.t(null,void 0,i(392553)),warning:d.t(null,void 0,i(658028))};class tt{constructor(e,t,i,s,r,o,a,n){this.warnings=[],this.errors=[],this._infoTableQuotesData=new Ee.WatchedObject({rows:[]},D.comparator),this._infoTableOrderData={rows:[]},this._infoTableCustomData=[],this.order=e,this.confirmId=t.confirmId,this.onCancelClick=s,this.onPlaceClick=r,this._quotes$=i,this._currency=n,this._formatter=o,this._quantityFormatter=a,this._infoTableCustomData=t.sections,this._fillQuotesInfo(),this._fillOrderInfo(),(e.takeProfit||e.stopLoss)&&this.warnings.push(et.warning),t.warnings&&this.warnings.push(...t.warnings),t.errors&&this.errors.push(...t.errors)}subscribe(){return this._quotes$.subscribe((e=>this._fillQuotesInfo(e)))}infoTableQuotesData(){return this._infoTableQuotesData}infoTableOrderData(){return this._infoTableOrderData}infoTableCustomData(){return this._infoTableCustomData}_fillQuotesInfo(e){const t=[{title:et.symbol,value:this.order.symbol},{title:et.ask,value:e?this._formatter.format(e.ask):""},{title:et.bid,value:e?this._formatter.format(e.bid):""}];this._infoTableQuotesData.setValue({rows:t})}_fillOrderInfo(){this._infoTableOrderData.rows.push({title:et.orderType,value:this.order.type?B.orderTypes[this.order.type]:""},{title:et.side,value:1===this.order.side?et.buy:et.sell,type:1===this.order.side?0:1},{title:et.quantity,value:this._quantityFormatter.format(this.order.qty)}),3!==this.order.type&&1!==this.order.type||this._infoTableOrderData.rows.push({title:et.price,value:this._formatter.format(3===this.order.type?this.order.stopPrice:this.order.limitPrice)}),4===this.order.type&&this._infoTableOrderData.rows.push({title:et.stopPrice,value:this._formatter.format(this.order.stopPrice)},{title:et.limitPrice,value:this._formatter.format(this.order.limitPrice)}),this.order.stopLoss&&this._infoTableOrderData.rows.push({title:et.stopLoss,value:String(this.order.stopLoss)}),this.order.takeProfit&&this._infoTableOrderData.rows.push({title:et.takeProfit,value:String(this.order.takeProfit)}),this._currency.length>0&&this._infoTableOrderData.rows.push({
title:et.currency,value:this._currency})}}const it=(0,o.getLogger)("Trading.OrderViewModel");function st(e){return"ComboBox"===e.type}class rt{constructor({adapter:e,order:t,mode:s,settings:o,isTradable:a,isUndockAllowed:n,orderWidgetStat:l=null,pipValueType$:c,onNeedSelectBroker:b,trackEvent:P,toggleTradingWidget:v,toggleTradingPanelPopup:f,showErrorNotification:T,handler:S,orderViewInputState:M,forceAbsolutePriceUpdate:I,qtySuggester:O,isVisible:E,orderDialogOptions:F,informerMessage$:R,warningMessage$:x}){var z,W,j;if(this.orderType=new(u())(null),this.orderInfoModel=null,this.orderPreviewModel=null,this.customFieldModels=new(u())([]),this.onDoneButtonClicked=(0,h.createDeferredPromise)(),this.status=new(u())(B.OrderPanelStatus.Active),this.rewardRisk=new(u())(""),this.disabled=new(u())(!0),this.loading=new(u())(!1),this.needSignIn=!1,this.noBroker=!1,this.isNoQuotes=new(u())(!1),this.symbolHasLotSize=!1,this.id=(0,V.randomHashN)(6),this.existingOrder=!1,this._isEmptyRequiredCustomFieldsHighlighted=new(u())(!1),this._onModeChanged=new(L()),this._onInputStateChanged=new(L()),this._onCloseButtonClicked=new(L()),this._onBackButtonClicked=new(L()),this._subscriptions=[],this._stopLossPips$=new m.BehaviorSubject(null),this._orderWidgetStat=null,this._existingPlacedOrder=null,this._marginAvailable$=null,this._baseCurrencyCryptoBalance$=null,this._quoteCurrencyCryptoBalance$=null,this._orderPlacingStatus=new m.BehaviorSubject(B.OrderPlacingStatus.Creating),this._destroyed=!1,this._setSolutionAccount=null,this._isBats=!1,this._isCustomFieldsNotSelected$=new m.BehaviorSubject(!1),this.doneButtonClick=()=>{var e;if(this.loading.value())return;this.loading.setValue(!0);const t=this.sideModel.currentQuotes(),s=this.sideModel.getValue(),o=null!==(e=1===s?t.ask:t.bid)&&void 0!==e?e:0;let a={symbol:this.symbol,type:(0,r.ensureNotNull)(this.orderType.value()),side:s,qty:0,seenPrice:o};a.qty=(0,r.ensureNotNull)(this.quantityModel.getValue()),void 0!==t.ask&&void 0!==t.bid&&(a.currentQuotes={ask:t.ask,bid:t.bid}),4===this.orderType.value()?(a.stopPrice=(0,r.ensureNotNull)(this.stopPriceModel.getValue()),a.limitPrice=(0,r.ensureNotNull)(this.limitPriceModel.getValue())):3===this.orderType.value()?a.stopPrice=(0,r.ensureNotNull)(this.stopPriceModel.getValue()):1===this.orderType.value()&&(a.limitPrice=(0,r.ensureNotNull)(this.limitPriceModel.getValue()));const n=this.durationModel.getValue();null!==n&&(a.duration=n),this.stopLossModel&&(delete a.stopLoss,delete a.trailingStopPips,this.stopLossModel.getBracketType()===C.BracketType.StopLoss&&(a.stopLoss=this.stopLossModel.getEnabled()?(0,r.ensureNotNull)(this.stopLossModel.getValue()&&this.stopLossModel.price.getValue()):void 0,a.trailingStopPips=void 0),this.stopLossModel.getBracketType()===C.BracketType.TrailingStop&&(a.trailingStopPips=this.stopLossModel.getEnabled()?(0,r.ensureNotNull)(this.stopLossModel.getValue()):void 0,a.stopLoss=void 0!==a.trailingStopPips?void 0:a.stopLoss)),this.takeProfitModel&&(a.takeProfit=this.takeProfitModel.getEnabled()?(0,
r.ensureNotNull)(this.takeProfitModel.getValue()&&this.takeProfitModel.price.getValue()):void 0),Array.isArray(this.customFieldModels.value())&&(a.customFields=this._getCustomFields());if((this.existingOrder?this.supportModifyOrderPreview:this.supportPlaceOrderPreview)&&this._settings.value().showOrderPreview){if(null===this.orderPreviewModel){const e=this.supportModifyOrderPreview&&null!==this._existingPlacedOrder?{...a,id:this._existingPlacedOrder.id}:a;return void this._adapter.previewOrder(e).then((t=>{const i=this.supportCurrencyInOrderPreview&&void 0!==this._symbolInfo.currency?this._symbolInfo.currency:"";this.orderPreviewModel=new tt(e,t,this._quotes$,this._back,this.doneButtonClick,this.formatter,this.quantityModel.formatter,i),this._subscriptions.push(this.orderPreviewModel.subscribe()),this.loading.setValue(!1),this.status.setValue(B.OrderPanelStatus.Preview)})).catch((e=>{this.loading.setValue(!1),this._showErrorNotification(d.t(null,void 0,i(455897)),"object"==typeof e?e.message:e)}))}a=this.orderPreviewModel.order}this._doneHandler(a,null!==this.orderPreviewModel?this.orderPreviewModel.confirmId:void 0).then((e=>{this.loading.setValue(!1),e&&(this.onDoneButtonClicked.resolve(!0),this.mode.value()===B.OrderEditorDisplayMode.Popup?this.headerModel.close():this._cancel(),this.existingOrder||this._orderPlacingStatus.next(B.OrderPlacingStatus.Placed)),e||this.mode.value()!==B.OrderEditorDisplayMode.Panel||null===this.orderPreviewModel||1!==this._adapter.connectionStatus()||this._back(),this.orderPreviewModel=null}))},this.activateOrderTicket=()=>{this.status.setValue(this.existingOrder?B.OrderPanelStatus.Editing:B.OrderPanelStatus.Active),this.orderType.unsubscribe(this.activateOrderTicket),this.sideModel&&this.sideModel.onControlFocused.unsubscribe(this,this.activateOrderTicket),this.limitPriceModel&&this.limitPriceModel.onControlFocused.unsubscribe(this,this.activateOrderTicket),this.stopPriceModel&&this.stopPriceModel.onControlFocused.unsubscribe(this,this.activateOrderTicket),this.quantityModel&&this.quantityModel.onControlFocused.unsubscribe(this,this.activateOrderTicket),this.leverageModel&&this.leverageModel.onControlFocused.unsubscribe(this,this.activateOrderTicket),this.takeProfitModel&&this.takeProfitModel.onControlFocused.unsubscribe(this,this.activateOrderTicket),this.stopLossModel&&this.stopLossModel.onControlFocused.unsubscribe(this,this.activateOrderTicket),this.durationModel&&this.durationModel.onControlFocused.unsubscribe(this,this.activateOrderTicket),Array.isArray(this.customFieldModels.value())&&this.customFieldModels.value().length>0&&this.customFieldModels.value().forEach((e=>{e.onControlFocused.unsubscribe(this,this.activateOrderTicket)})),this._orderPlacingStatus.next(B.OrderPlacingStatus.Creating)},this._noQuotesCallback=()=>{this._trackEvent("Order Ticket","No Quotes")},this._updateMode=()=>{this.mode.value()===B.OrderEditorDisplayMode.Popup&&this.status.value()!==B.OrderPanelStatus.Preview&&this.activateOrderTicket(),this.toggleCancelButton()},this._mergeInputStateDiff=e=>{
void 0!==e.duration&&(this._currentInputState.duration=null),(0,p.default)(this._currentInputState,e)},this._back=()=>{this._cleanUp(),this._onBackButtonClicked.fire()},this._highlightEmptyRequiredCustomFields=()=>{this._isEmptyRequiredCustomFieldsHighlighted.setValue(!0)},this._checkIsCustomFieldNotSelected=()=>{const e=[];for(const t of this.customFieldModels.value())st(t)&&e.push(t);const t=e.some((e=>void 0===e.selectedItem.value()));this._isCustomFieldsNotSelected$.next(t)},this._onSuggestedQtyChange=e=>{this._suggestedQty=e,this.quantityModel&&this.quantityModel.getValue()!==e&&(this.quantityModel.setFocusedControl(this.supportCryptoExchangeOrderTicket()?3:0),this.quantityModel.quantity.setValue(e))},this._onQtyChange=e=>{null!==e&&this._qtySuggester.setQty(this.symbol,e)},this._toggleTradingWidget=v,this._toggleTradingPanelPopup=f,this._onNeedSelectBroker=b,this._showErrorNotification=T,this._trackEvent=P,this._orderWidgetStat=l,this._pipValueType$=c,this._qtySuggester=O,this._informerMessage$=R,this.mode=s,this._settings=o,function(e){return e.hasOwnProperty("id")}(t)&&(this.existingOrder=!0,this._existingPlacedOrder=t),this.warningMessage$=x,this.status=new(u())(this.existingOrder?B.OrderPanelStatus.Editing:B.OrderPanelStatus.Active),this.isEmptyRequiredCustomFieldsHighlighted=this._isEmptyRequiredCustomFieldsHighlighted.readonly(),this.symbol=t.symbol,this._orderStatusSubscription=(0,D.makeSubjectFromWatchedValue)(this.status),this._loadingSubscription=(0,D.makeSubjectFromWatchedValue)(this.loading),this._status=this._orderStatusSubscription.subject,this._loading=this._loadingSubscription.subject,this._isUndockAllowed=n,this._isVisible=E,this._stopLossAvailable$=new m.BehaviorSubject(Boolean(t.trailingStopPips?t.trailingStopPips:t.stopLoss)),null===e)return void(this.onReady=Promise.resolve());if(this._adapter=e,this.brokerName=e.metainfo().title,!a.tradable)return void(this.onReady=this._prepareTradableSolution(a));this._handler=S,this._orderTemplate=Object.assign({},t),this.existingOrder=t.hasOwnProperty("id"),this.status.setValue(this.existingOrder?B.OrderPanelStatus.Editing:B.OrderPanelStatus.Active);const A=e.metainfo().configFlags;this.supportModifyOrderPrice=A.supportModifyOrderPrice,this.supportModifyQuantity=!this.existingOrder||Boolean(this.existingOrder&&A.supportEditAmount),this.showQuantityInsteadOfAmount=A.showQuantityInsteadOfAmount,this.supportMarketOrders=A.supportMarketOrders,this.supportLimitOrders=A.supportLimitOrders,this.supportStopOrders=A.supportStopOrders,this.supportStopLimitOrders=A.supportStopLimitOrders,this.supportBrackets=A.supportOrderBrackets&&!(t.hasOwnProperty("parentId")&&t.parentId),this.supportModifyBrackets=this.supportBrackets&&A.supportModifyBrackets,this.supportAddBracketsToExistingOrder=this.supportModifyBrackets&&A.supportAddBracketsToExistingOrder,this.supportTrailingStop=this.supportBrackets&&A.supportTrailingStop,this.supportModifyTrailingStop=this.supportTrailingStop&&A.supportModifyTrailingStop,
this.supportMarketBrackets=this.supportBrackets&&A.supportMarketBrackets,this.supportModifyDuration=A.supportModifyDuration,this.supportLeverage=A.supportLeverage,this.supportLeverageButton=A.supportLeverage&&A.supportLeverageButton,this.supportPlaceOrderPreview=A.supportPlaceOrderPreview,this.supportModifyOrderPreview=A.supportModifyOrderPreview,this.supportBalances=A.supportBalances,this.supportCryptoBrackets=A.supportCryptoBrackets,this.supportStopOrdersInBothDirections=A.supportStopOrdersInBothDirections,this.supportStopLimitOrdersInBothDirections=A.supportStopLimitOrdersInBothDirections,this.supportCurrencyInOrderPreview=A.supportCurrencyInOrderPreview,this.supportModifyOrderType=A.supportModifyOrderType,this.orderType.setValue(null!==(j=null!==(W=null!==(z=t.type)&&void 0!==z?z:null==M?void 0:M.orderType)&&void 0!==W?W:(0,$.getDefaultOrderType)(A))&&void 0!==j?j:null),this._orderTypeSubscription=(0,D.makeSubjectFromWatchedValue)(this.orderType),this._orderType=this._orderTypeSubscription.subject,this.onReady=Promise.all([e.symbolInfo(t.symbol),Xe(e.accountMetainfo(),{id:e.currentAccount(),name:e.metainfo().title}),Xe(e.quotesSnapshot(t.symbol),{},this._noQuotesCallback),Xe(e.formatter(t.symbol,!1),new q.PriceFormatter),Xe(e.spreadFormatter(t.symbol),new q.PriceFormatter)]).then((async([i,s,r,o,n])=>{var l;if(this._isBats=(0,$.isBatsQuotes)(r),this._supportCryptoExchangeOrderTicket=A.supportCryptoExchangeOrderTicket||A.supportSymbolSpecificCryptoOrderTicket&&"crypto"===i.type,this._symbolInfo=i,this._destroyed)return;this.displaySymbolName=i.brokerSymbol||"brokerSymbol"in t&&t.brokerSymbol||this.symbol,this.symbolType=i.type,this.currency=(0,$.getCurrency)(s),this._currencyName=(0,$.getCurrency)(s,!0),this.formatter=o,this.symbolHasLotSize=i.hasOwnProperty("lotSize"),this.showRiskControls=A.supportRiskControls&&0!==i.pipValue,this._suggestedQty=await this._qtySuggester.getQty(this.symbol),this._initialInputState=this._getInitialInputState(t,i,M),this._currentInputState=Object.assign({},this._initialInputState),this.customFieldModels.setValue((0,D.createCustomFieldModels)(this.existingOrder,this.status,this._isEmptyRequiredCustomFieldsHighlighted,F,null!==(l=this._initialInputState.customFields)&&void 0!==l?l:void 0)),this._checkIsCustomFieldNotSelected();const u=i.variableMinTick?(0,N.makeVariableMinTickData)(i.minTick,i.variableMinTick):void 0;this._quotes$=(0,k.fromEventPattern)((i=>e.subscribeRealtime(t.symbol,i)),(i=>e.unsubscribeRealtime(t.symbol,i)),((e,t)=>(0,D.alignQuotesToMinTick)(t,i.minTick,u))).pipe((0,_.share)({connector:()=>new g.ReplaySubject(1)})),this._equity$=(0,k.fromEventPattern)((t=>e.subscribeEquity(t)),(t=>e.unsubscribeEquity(t)),((e,t)=>t)).pipe((0,y.startWith)(NaN),(0,_.share)({connector:()=>new g.ReplaySubject(1)})),this._marginAvailable$=A.supportMargin?w((0,k.fromEventPattern)((t=>e.subscribeMarginAvailable(t)),(t=>e.unsubscribeMarginAvailable(t)),((e,t)=>t))):null,this._baseCurrencyCryptoBalance$=A.supportBalances?w((0,
k.fromEventPattern)((t=>e.subscribeCryptoBalance(i.baseCurrency||"",t)),(t=>e.unsubscribeCryptoBalance(i.baseCurrency||"",t)),((e,t)=>t)).pipe((0,y.startWith)({symbol:i.baseCurrency||"",total:0,available:0}))):null,this._quoteCurrencyCryptoBalance$=A.supportBalances?w((0,k.fromEventPattern)((t=>e.subscribeCryptoBalance(i.quoteCurrency||"",t)),(t=>e.unsubscribeCryptoBalance(i.quoteCurrency||"",t)),((e,t)=>t)).pipe((0,y.startWith)({symbol:i.quoteCurrency||"",total:0,available:0}))):null,this._pipValues$=w((0,k.fromEventPattern)((i=>e.subscribePipValue(t.symbol,i)),(i=>e.unsubscribePipValue(t.symbol,i)),((e,t)=>t)).pipe((0,y.startWith)({buyPipValue:i.pipValue,sellPipValue:i.pipValue}))),void 0===this._orderTemplate.limitPrice&&!1===this.existingOrder&&(this._orderTemplate.limitPrice=1===this._initialInputState.side?(0,$.getAsk)(r):(0,$.getBid)(r)),void 0===this._orderTemplate.stopPrice&&!1===this.existingOrder&&(this._orderTemplate.stopPrice=1===this._initialInputState.side?(0,$.getBid)(r):(0,$.getAsk)(r)),this._createModels(t,i,n,a.tradable,I,F),this._subscribe(),this._onInputStateChanged.fire(this._getCurrentInputState())})).catch((e=>{throw it.logError("Failed to create order model: "+e),e}))}destroy(){var e;this._destroyed=!0,this.onInputStateChanged().unsubscribe(this,this._mergeInputStateDiff),this._subscriptions.forEach((e=>e&&e.unsubscribe())),null===(e=this.orderInfoModel)||void 0===e||e.unsubscribe(),this._orderStatusSubscription.unsubscribe(),this._loadingSubscription.unsubscribe(),this._orderTypeSubscription&&this._orderTypeSubscription.unsubscribe(),this.headerModel&&(this.headerModel.unsubscribe(),this.headerModel.pinButtonClicked().unsubscribe(this,this._toggleMode),this.headerModel.cancelButtonClicked().unsubscribe(this,this._cancel),this.headerModel.closeButtonClicked().unsubscribe(this,this._closeWidget),this.headerModel.backButtonClicked().unsubscribe(this,this._back)),this.sideModel&&(this.sideModel.unsubscribe(),this.sideModel.onControlFocused.unsubscribe(this,this.activateOrderTicket)),this.limitPriceModel&&(this.limitPriceModel.unsubscribe(),this.limitPriceModel.onControlFocused.unsubscribe(this,this.activateOrderTicket)),this.stopPriceModel&&(this.stopPriceModel.unsubscribe(),this.stopPriceModel.onControlFocused.unsubscribe(this,this.activateOrderTicket)),this.priceGroupModel&&this.priceGroupModel.unsubscribe(),this.quantityModel&&(this.quantityModel.unsubscribe(),this.quantityModel.onControlFocused.unsubscribe(this,this.activateOrderTicket)),this.takeProfitModel&&(this.takeProfitModel.unsubscribe(),this.takeProfitModel.onControlFocused.unsubscribe(this,this.activateOrderTicket)),this.stopLossModel&&(this.stopLossModel.unsubscribe(),this.stopLossModel.onControlFocused.unsubscribe(this,this.activateOrderTicket)),this.durationModel&&(this.durationModel.unsubscribe(),this.durationModel.onControlFocused.unsubscribe(this,this.activateOrderTicket)),void 0!==this.leverageModel&&(this.leverageModel.unsubscribe(),this.leverageModel.onControlFocused.unsubscribe(this,this.activateOrderTicket)),
Array.isArray(this.customFieldModels.value())&&this.customFieldModels.value().length>0&&this.customFieldModels.value().forEach((e=>{e.onControlFocused.unsubscribe(this,this.activateOrderTicket),e.subscription&&e.subscription.unsubscribe(),e.destroy()})),void 0!==this.buttonModel&&this.buttonModel.unsubscribe(),this._customFieldsSubscription&&this._customFieldsSubscription.unsubscribe(),this._adapter&&this._adapter.orderUpdate.unsubscribe(this,this._orderUpdate),this.orderType.unsubscribe(this.activateOrderTicket),this.mode.unsubscribe(this._updateMode)}supportCryptoExchangeOrderTicket(){return Boolean(this._supportCryptoExchangeOrderTicket)}onModeChanged(){return this._onModeChanged}onInputStateChanged(){return this._onInputStateChanged}onCloseButtonClicked(){return this._onCloseButtonClicked}onBackButtonClicked(){return this._onBackButtonClicked}side(){var e;return null===(e=this.sideModel)||void 0===e?void 0:e.getValue()}setSolutionAccount(){null!==this._setSolutionAccount&&this._setSolutionAccount()}selectBroker(){this._toggleTradingWidget().then((()=>this._onNeedSelectBroker.fire()))}orderWidgetStat(){return this._orderWidgetStat}resetOrderPanel(){this._cancel()}deactivateOrderTicket(){this.status.value()!==B.OrderPanelStatus.Wait&&(this.status.setValue(B.OrderPanelStatus.Wait),this.orderType.subscribe(this.activateOrderTicket),this.sideModel&&this.sideModel.onControlFocused.subscribe(this,this.activateOrderTicket),this.limitPriceModel&&this.limitPriceModel.onControlFocused.subscribe(this,this.activateOrderTicket),this.stopPriceModel&&this.stopPriceModel.onControlFocused.subscribe(this,this.activateOrderTicket),this.quantityModel&&this.quantityModel.onControlFocused.subscribe(this,this.activateOrderTicket),void 0!==this.leverageModel&&this.leverageModel.onControlFocused.subscribe(this,this.activateOrderTicket),this.takeProfitModel&&(this.takeProfitModel.setEnabled(!1),this.takeProfitModel.onControlFocused.subscribe(this,this.activateOrderTicket)),this.stopLossModel&&(this.stopLossModel.setEnabled(!1),this.stopLossModel.onControlFocused.subscribe(this,this.activateOrderTicket)),this.durationModel&&this.durationModel.onControlFocused.subscribe(this,this.activateOrderTicket),Array.isArray(this.customFieldModels.value())&&this.customFieldModels.value().length>0&&this.customFieldModels.value().forEach((e=>{e.onControlFocused.subscribe(this,this.activateOrderTicket)})),this._setDisabledIfNeeded({status:this._status.getValue(),loading:this._loading.getValue(),quotes:null,side:this.sideModel?this.sideModel.getValue():null,limitPrice:this.limitPriceModel?this.limitPriceModel.getValue():null,stopPrice:this.stopPriceModel?this.stopPriceModel.getValue():null,quantity:this.quantityModel?this.quantityModel.getValue():null,isTakeProfitIncorrect:!!this.takeProfitModel&&this.takeProfitModel.isValueIncorrect(),isStopLossIncorrect:!!this.stopLossModel&&this.stopLossModel.isValueIncorrect(),customFields:this._getCustomFields(this.customFieldModels.value())}))}toggleCancelButton(){
this.mode.value()===B.OrderEditorDisplayMode.Panel&&this.status.value()===B.OrderPanelStatus.Active?this.headerModel.showCancelButton():this.headerModel.hideCancelButton()}_createSimpleDialog(e){this.orderType.setValue(null),this.status.setValue(B.OrderPanelStatus.Wait),this.headerModel=new R({displaySymbolName:this.symbol,symbol:this.symbol,brokerName:e?e.metainfo().title:"",mode:this.mode,status:this.status,parentType:1,existingOrder:!1,isTradable:!1,quotes$:this._quotes$,isUndockAllowed:this._isUndockAllowed,data:void 0,formatter:void 0,isBats:this._isBats,informerMessage$:this._informerMessage$}),this.headerModel.closeButtonClicked().subscribe(this,this._closeWidget)}_createModels(e,t,i,s,o,a){var n,l,u,c;const d=this.supportCryptoExchangeOrderTicket();this.sideModel=new ie({initialSide:this._initialInputState.side,quotes$:this._quotes$,priceFormatter:this.formatter,spreadFormatter:i,status:this.status,baseCurrency:d&&"crypto"===t.type&&t.baseCurrency||null}),this._pipValue$=(0,S.combineLatest)([this._pipValues$,this.sideModel.value$]).pipe((0,b.map)((([e,t])=>1===t?e.buyPipValue:e.sellPipValue)));const{orderRules:h=[],title:p}=this._adapter.metainfo();let _=[],y=[];this.supportStopOrdersInBothDirections&&this.supportStopLimitOrdersInBothDirections||(_=null!==(n=(0,I.extractLimitValidationRules)(this._adapter,this.symbol))&&void 0!==n?n:[],y=null!==(l=(0,I.extractStopValidationRules)(this._adapter,this.symbol))&&void 0!==l?l:[]),this.stopPriceModel=new _e({priceType:2,quotes$:this._quotes$,side$:this.sideModel.value$,info:t,status$:this._status,formatter:this.formatter,orderType$:this._orderType,settings:this._settings,brokerTitle:p,orderWidgetStat:this._orderWidgetStat,initialPrice:this._orderTemplate.stopPrice,orderRules:[...h,...y],forceAbsolutePriceUpdate:o,supportStopOrdersInBothDirections:this.supportStopOrdersInBothDirections,supportStopLimitOrdersInBothDirections:this.supportStopLimitOrdersInBothDirections}),this.limitPriceModel=new _e({priceType:1,quotes$:this._quotes$,side$:this.sideModel.value$,info:t,status$:this._status,formatter:this.formatter,orderType$:this._orderType,settings:this._settings,brokerTitle:p,orderWidgetStat:this._orderWidgetStat,initialPrice:this._orderTemplate.limitPrice,orderRules:[...h,..._],forceAbsolutePriceUpdate:o,stopPriceControlData$:this.stopPriceModel.priceControlData$}),this.priceGroupModel=new be({stopPriceModel:this.stopPriceModel,limitPriceModel:this.limitPriceModel,orderType$:this._orderType,side$:this.sideModel.value$,quotes$:this._quotes$}),this.quantityModel=d?new Oe({info:t,price$:this.priceGroupModel.price$,baseCurrencyCryptoBalance$:this._baseCurrencyCryptoBalance$,quoteCurrencyCryptoBalance$:this._quoteCurrencyCryptoBalance$,initialQty:this._initialInputState.quantity,side$:this.sideModel.value$,sideGetter:this.sideModel.getValue,orderWidgetStat:this._orderWidgetStat,isExistingOrder:this.existingOrder,orderQty:e.qty,orderPrice:1===e.type?e.limitPrice:e.stopPrice}):new Ie({stopLossAvailable$:this._stopLossAvailable$,stopLossPips$:this._stopLossPips$,
equity$:this._equity$,pipValue$:this._pipValue$,info:t,currency:null!==(u=this.currency)&&void 0!==u?u:"",initialQty:this._initialInputState.quantity,settings:this._settings,orderWidgetStat:this._orderWidgetStat,showRiskControls:this.showRiskControls}),(this.supportBrackets||this.supportCryptoBrackets)&&this._createBracketsModels(e,t,(0,r.ensureDefined)(this.currency)),this.headerModel=new R({displaySymbolName:this.displaySymbolName,symbol:this.symbol,brokerName:this._adapter.metainfo().title,mode:this.mode,status:this.status,parentType:1,existingOrder:this.existingOrder,isTradable:s,quotes$:this._quotes$,isUndockAllowed:this._isUndockAllowed,data:e,formatter:this.formatter,isBats:this._isBats,informerMessage$:this._informerMessage$});const m=(0,D.shouldShowTotal)(a);this.supportLeverage&&(this.leverageModel=new We({adapterLeverageInfo:this._adapter.leverageInfo,adapterSetLeverage:this._adapter.setLeverage,adapterPreviewLeverage:this._adapter.previewLeverage,brokerName:this._adapter.metainfo().title,symbol:this.symbol,displaySymbol:this.displaySymbolName,orderType$:this._orderType,side$:this.sideModel.value$,initialSide:this.sideModel.getValue(),customFieldModels:this.customFieldModels,customFieldsGetter:this._getCustomFields,blocked$:this._isCustomFieldsNotSelected$,onBlockedClick:this._highlightEmptyRequiredCustomFields})),d||(this.orderInfoModel=new Je({marginAvailable$:this._marginAvailable$,qty$:this.quantityModel.value$,currency:(0,r.ensureDefined)(this._currencyName),pipValue$:this._pipValue$,price$:this.priceGroupModel.price$,side$:this.sideModel.value$,showTotalInsteadOfTradeValue:m,showRiskControls:this.showRiskControls,info:t,tpInfo:this.supportBrackets&&this.takeProfitModel?{enabled:this.takeProfitModel.enabled$,riskInCurrency:this.takeProfitModel.riskInCurrency.value$,riskInPercent:this.takeProfitModel.riskInPercent.value$}:null,slInfo:this.supportBrackets&&this.stopLossModel?{enabled:this.stopLossModel.enabled$,riskInCurrency:this.stopLossModel.riskInCurrency.value$,riskInPercent:this.stopLossModel.riskInPercent.value$}:null,supportMargin:this._adapter.metainfo().configFlags.supportMargin||!1,pipValueType$:this._pipValueType$,leverageInfo$:null===(c=this.leverageModel)||void 0===c?void 0:c.leverageInfo$})),this.durationModel=new Fe({initialDuration:this._initialInputState.duration,orderType:this.orderType,orderWidgetStat:this._orderWidgetStat,orderDurations:this._adapter.metainfo().durations,symbolDurations:this._symbolInfo.allowedDurations});const k={orderType:(0,D.makeSubjectFromWatchedValue)(this.orderType).subject.asObservable(),side:this.sideModel.value$,quantity:this.quantityModel.value$,symbol:this.displaySymbolName,stopPrice:this.stopPriceModel.value$,limitPrice:this.limitPriceModel.value$,formatter:this.formatter,quantityFormatter:this.quantityModel.formatter,orderPlacingStatus:this._orderPlacingStatus.asObservable(),status:(0,D.makeSubjectFromWatchedValue)(this.status).subject.asObservable(),existingOrder:this.existingOrder};this.buttonModel=new Ge(C.TradingEntityType.Order,k)}
_createBracketsModels(e,t,i){const s=(0,I.extractTakeProfitValidationRules)(this._adapter,this.symbol),r=(0,I.extractStopLossValidationRules)(this._adapter,this.symbol);this.takeProfitModel=new Ne({initialPrice:e.takeProfit||null,initialEnabled:Boolean(e.takeProfit),initialBracketType:C.BracketType.TakeProfit,formatter:this.formatter,equity$:this._equity$,quotes$:this._quotes$,info:t,pipValue$:this._pipValue$,side$:this.sideModel.value$,amount$:this.quantityModel.value$,parentPrice$:this.priceGroupModel.price$,orderType$:this._orderType,currency:i,parentType:1,savedPips:this._currentInputState.takeProfitPips,settings:this._settings,orderWidgetStat:this._orderWidgetStat,showRiskControls:this.showRiskControls,status:this.status.value(),validationRules:s,supportModifyBrackets:this.supportModifyBrackets,supportModifyTrailingStop:this.supportModifyTrailingStop,supportCryptoBrackets:this.supportCryptoBrackets,supportAddBracketsToExistingOrder:this.supportAddBracketsToExistingOrder});const o=Boolean(e.trailingStopPips);this.stopLossModel=new Ne({initialPrice:o?null:e.stopLoss||null,initialEnabled:Boolean(o?e.trailingStopPips:e.stopLoss),initialBracketType:o?C.BracketType.TrailingStop:C.BracketType.StopLoss,formatter:this.formatter,equity$:this._equity$,quotes$:this._quotes$,info:t,pipValue$:this._pipValue$,side$:this.sideModel.value$,amount$:this.quantityModel.value$,parentPrice$:this.priceGroupModel.price$,orderType$:this._orderType,currency:i,parentType:1,savedPips:(o?e.trailingStopPips:this._currentInputState.stopLossPips)||null,settings:this._settings,orderWidgetStat:this._orderWidgetStat,showRiskControls:this.showRiskControls,status:this.status.value(),validationRules:r,supportModifyBrackets:this.supportModifyBrackets,supportModifyTrailingStop:this.supportModifyTrailingStop,supportCryptoBrackets:this.supportCryptoBrackets,supportAddBracketsToExistingOrder:this.supportAddBracketsToExistingOrder,hasTrailingStopBracket:e.hasTrailingStopBracket})}_subscribe(){var e,t,i,s,r,o,a,n,l;this.mode.subscribe(this._updateMode),this.onInputStateChanged().subscribe(this,this._mergeInputStateDiff),this.headerModel.pinButtonClicked().subscribe(this,this._toggleMode),this.headerModel.cancelButtonClicked().subscribe(this,this._cancel),this.headerModel.closeButtonClicked().subscribe(this,this._closeWidget),this.headerModel.backButtonClicked().subscribe(this,this._back),this._buttonDataSubscription=(0,S.combineLatest)({orderType:this._orderType,status:this._status,side:this.sideModel.value$,loading:this._loading,quotes:this._quotes$,limitPrice:this.limitPriceModel.value$,stopPrice:this.stopPriceModel.value$,quantity:this.quantityModel.value$,takeProfitPips:null!==(t=null===(e=this.takeProfitModel)||void 0===e?void 0:e.value$)&&void 0!==t?t:(0,M.of)(null),stopLossPips:null!==(s=null===(i=this.stopLossModel)||void 0===i?void 0:i.value$)&&void 0!==s?s:(0,M.of)(null),takeProfitEnabled:null!==(o=null===(r=this.takeProfitModel)||void 0===r?void 0:r.enabled$)&&void 0!==o?o:(0,M.of)(!1),
stopLossEnabled:null!==(n=null===(a=this.stopLossModel)||void 0===a?void 0:a.enabled$)&&void 0!==n?n:(0,M.of)(!1),duration:this.durationModel.$value}).subscribe((e=>{const{orderType:t,status:i,side:s,loading:r,quotes:o,limitPrice:a,stopPrice:n,quantity:l,takeProfitPips:u,stopLossPips:c,takeProfitEnabled:d,stopLossEnabled:h,duration:p}=e;this._setDisabledIfNeeded({status:i,loading:r,quotes:o,side:s,limitPrice:a,stopPrice:n,quantity:l,isTakeProfitIncorrect:d&&null===u,isStopLossIncorrect:h&&null===c,customFields:this._getCustomFields(this.customFieldModels.value())}),this._compareInputStates({orderType:t,side:s,limitPrice:a,stopPrice:n,quantity:l,takeProfitPips:u,stopLossPips:c,duration:p})})),this._waitQuotesTimeout=setTimeout((()=>this.isNoQuotes.setValue(!0)),5e3);const u=(0,S.combineLatest)([this._quotes$,this.sideModel.value$]).subscribe((([e,t])=>{const i=1===t?(0,$.getAsk)(e):(0,$.getBid)(e);this._initialInputState.limitPrice=i,this._initialInputState.stopPrice=i})),c=this._quotes$.subscribe((e=>{this.isNoQuotes.setValue((0,$.isNoQuotes)(e)),clearTimeout(this._waitQuotesTimeout)}));if(this.customFieldModels){const e=[];for(const t of this.customFieldModels.value()){const i="Checkbox"===t.type?t.checked:"ComboBox"===t.type?t.selectedItem:t.text,s=(0,D.makeSubjectFromWatchedValue)(i);e.push(s.subject),t.subscription=s}this._customFieldsSubscription=(0,S.combineLatest)(e).subscribe((()=>{this._setDisabledIfNeeded({status:this._status.getValue(),loading:this._loading.getValue(),quotes:this.sideModel.currentQuotes(),side:this.sideModel?this.sideModel.getValue():null,limitPrice:this.limitPriceModel?this.limitPriceModel.getValue():null,stopPrice:this.stopPriceModel?this.stopPriceModel.getValue():null,quantity:this.quantityModel?this.quantityModel.getValue():null,isTakeProfitIncorrect:!!this.takeProfitModel&&this.takeProfitModel.isValueIncorrect(),isStopLossIncorrect:!!this.stopLossModel&&this.stopLossModel.isValueIncorrect(),customFields:this._getCustomFields(this.customFieldModels.value())}),this._onInputStateChanged.fire({customFields:this._getCustomFields(this.customFieldModels.value())}),this._checkIsCustomFieldNotSelected()}))}if(this._subscriptions=[...this.sideModel.subscribe(),this._qtySuggester.suggestedQtyChanged(this.symbol).subscribe(this._onSuggestedQtyChange),this.quantityModel.value$.subscribe(this._onQtyChange)],this.limitPriceModel.subscribe(),this.stopPriceModel.subscribe(),this.priceGroupModel.subscribe(),this.quantityModel.subscribe(),null===(l=this.orderInfoModel)||void 0===l||l.subscribe(),this.buttonModel&&this.buttonModel.subscribe(),void 0!==this.takeProfitModel&&this._subscriptions.push(...this.takeProfitModel.subscribe()),void 0!==this.stopLossModel){if(!this.supportCryptoExchangeOrderTicket()){const e=(0,S.combineLatest)([this.stopLossModel.value$,this.stopLossModel.enabled$]).subscribe((([e,t])=>{this._stopLossAvailable$.next(t),t&&this._stopLossPips$.next(e)})),t=this.stopLossModel.focusedControl$.subscribe((e=>{2!==e&&3!==e||this.quantityModel.setFocusedControl(0)
})),i=this.quantityModel.focusedControl$.subscribe((e=>{!this.stopLossModel||1===this.stopLossModel.getFocusedControl()||1!==e&&2!==e||this.stopLossModel.setFocusedControl(0)}));this._subscriptions.push(e,t,i)}this._subscriptions.push(...this.stopLossModel.subscribe())}if(void 0!==this.takeProfitModel&&void 0!==this.stopLossModel){const e=(0,S.combineLatest)([this.takeProfitModel.value$,this.stopLossModel.value$]).subscribe((([e,t])=>{this.rewardRisk.setValue((0,D.formatRiskReward)(e,t))}));this._subscriptions.push(e)}this._subscriptions.push(this._buttonDataSubscription,u,c,this._pipValues$.connect()),null!==this._marginAvailable$&&this._subscriptions.push(this._marginAvailable$.connect()),null!==this._baseCurrencyCryptoBalance$&&this._subscriptions.push(this._baseCurrencyCryptoBalance$.connect()),null!==this._quoteCurrencyCryptoBalance$&&this._subscriptions.push(this._quoteCurrencyCryptoBalance$.connect()),this._adapter.orderUpdate.subscribe(this,this._orderUpdate)}_orderUpdate(e){this._isVisible()&&!this.loading.value()&&this.existingOrder&&e.id===this._orderTemplate.id&&6!==e.status&&(this.mode.value()===B.OrderEditorDisplayMode.Popup?this.headerModel.close():this._back())}async _doneHandler(e,t){await this._getAndSendStatistics(e),null!==this._orderWidgetStat&&this._orderWidgetStat.clear();const i=this._handler;if(this._isHandlerPlacedOrder(i)){const s=Object.assign({},this._existingPlacedOrder,e);return[2,1].includes(s.type)&&delete s.stopPrice,[2,3].includes(s.type)&&delete s.limitPrice,i(s,t)}return i(e,t)}_isHandlerPlacedOrder(e){return this.existingOrder}async _getAndSendStatistics(e){var t;const i=this.stopLossModel&&this.stopLossModel.getEnabled(),s=this.takeProfitModel&&this.takeProfitModel.getEnabled(),o=i&&this.supportTrailingStop,a=1===e.side?"Buy":"Sell",n=["Price","Pips"],l=["Units","RiskInCurrency","RiskInPercent","BaseCurrencyQuantity","QuoteCurrencyQuantity"],u=this.quantityModel.getFocusedControl(),c=["Pips","Price","RiskInCurrency","RiskInPercent"],d=["Limit","Market","Stop","StopLimit"][e.type-1],h=this.durationModel.getValue(),p=this.leverageModel?this.leverageModel.leverageInfo():null,_=4===e.type,y=3===e.type||_,b=1===e.type||_,m=Object.assign({},this._settings.value()),k=this.limitPriceModel&&!this.limitPriceModel.isRelativePriceControlHidden||this.stopPriceModel&&!this.stopPriceModel.isRelativePriceControlHidden,g=Boolean(this.supportBrackets);function P(e,t){return t[null!==e?e:0]}m.showRelativePriceControl=m.showRelativePriceControl&&k,m.showCurrencyRiskInQty=m.showCurrencyRiskInQty&&g,m.showPercentRiskInQty=m.showPercentRiskInQty&&g,m.showBracketsInCurrency=m.showBracketsInCurrency&&g,m.showBracketsInPercent=m.showBracketsInPercent&&g,m.showOrderPreview=m.showOrderPreview&&Boolean(this.supportPlaceOrderPreview||this.supportModifyOrderPreview),null!==this._orderWidgetStat&&(this._orderWidgetStat.setStaticSnowplowEventDataProperty({accountType:this._adapter.currentAccountType(),brokerId:this._adapter.metainfo().id,orderTicketMode:this.mode.value(),side:a,orderType:d,leverageInfo:p,
symbolType:void 0!==this._symbolInfo.type?this._symbolInfo.type:null,operation:this.existingOrder?"Modify":"Place",stopLoss:i?(0,r.ensureDefined)(this.stopLossModel).getValue():null,takeProfit:s?(0,r.ensureDefined)(this.takeProfitModel).getValue():null,trailingStop:o?(0,r.ensureDefined)(this.stopLossModel).getValue():null,guaranteedStop:null,focusedTPField:s?P((0,r.ensureDefined)(this.takeProfitModel).getFocusedControl(),c):null,focusedSLField:i?P((0,r.ensureDefined)(this.stopLossModel).getFocusedControl(),c):null,focusedQtyField:null!==(t=l[null!==u?u:0])&&void 0!==t?t:null,focusedLimitPriceField:b||_&&this.limitPriceModel?P(this.limitPriceModel.getFocusedControl(),n):null,focusedStopPriceField:y&&this.stopPriceModel?n[this.stopPriceModel.getFocusedControl()]:null,duration:null!==h?h.type:null,isDefaultDuration:null!==h?h.type===this._getDefaultDuration().value:null,showBracketsInCurrency:m.showBracketsInCurrency,showBracketsInPercent:m.showBracketsInPercent,showCurrencyRiskInQty:m.showCurrencyRiskInQty,showOrderPreview:m.showOrderPreview,showPercentRiskInQty:m.showPercentRiskInQty,showRelativePriceControl:m.showRelativePriceControl}),await this._orderWidgetStat.trackStat())}_getInitialInputState(e,t,i){var s,r,o,a,n,l;const u=void 0!==e.customFields?{...e.customFields}:void 0;return{symbol:this.symbol,orderType:this.orderType.value(),side:null!==(r=null!==(s=e.side)&&void 0!==s?s:null==i?void 0:i.side)&&void 0!==r?r:1,limitPrice:e.limitPrice||e.price||e.stopPrice||null,stopPrice:e.stopPrice||e.price||e.limitPrice||null,quantity:e.qty||(null==i?void 0:i.quantity)||this._suggestedQty||t.qty.min,takeProfitPips:null!==(o=null==i?void 0:i.takeProfitPips)&&void 0!==o?o:B.BracketDefaultPips.TakeProfit,stopLossPips:null!==(a=null==i?void 0:i.stopLossPips)&&void 0!==a?a:B.BracketDefaultPips.StopLoss,customFields:null!==(n=null!=u?u:null==i?void 0:i.customFields)&&void 0!==n?n:{},duration:(0,$.getOrderDuration)({orderDuration:e.duration,orderType:this.orderType.value(),savedDuration:null!==(l=null==i?void 0:i.duration)&&void 0!==l?l:null,orderDurations:this._adapter.metainfo().durations,symbolDurations:this._symbolInfo.allowedDurations})}}_compareInputStates({orderType:e,side:t,limitPrice:i,stopPrice:s,quantity:r,takeProfitPips:o,stopLossPips:a,duration:n}){const l={};let u=null===i;if(null!==i){const t=this.formatter.format(i),s=null!==this._currentInputState.limitPrice?this.formatter.format(this._currentInputState.limitPrice):null;u=3!==e&&t!==s}e!==this._currentInputState.orderType&&(l.orderType=e),u&&(l.limitPrice=i);let c=null!==s;if(null!==s){const t=this.formatter.format(s),i=null!==this._currentInputState.stopPrice?this.formatter.format(this._currentInputState.stopPrice):null;c=(3===e||4===e)&&t!==i}c&&(l.stopPrice=s),null!==r&&this._currentInputState.quantity!==r&&(l.quantity=r),null!==o&&this._currentInputState.takeProfitPips!==o&&(l.takeProfitPips=o),null!==a&&this._currentInputState.stopLossPips!==a&&(l.stopLossPips=a),
null===n||null===this._currentInputState.duration||this._currentInputState.duration.type===n.type&&this._currentInputState.duration.datetime===n.datetime||(l.duration=n),null!==t&&this._currentInputState.side!==t&&(l.side=t),this._currentInputState.symbol!==this.symbol&&(l.symbol=this.symbol),0!==Object.keys(l).length&&this._onInputStateChanged.fire(l)}_getSavableComboBoxModels(){return this.customFieldModels.value().filter((e=>e.saveToSettings&&"ComboBox"===e.type))}_getSavableCheckboxModels(){return this.customFieldModels.value().filter((e=>e.saveToSettings&&"Checkbox"===e.type))}_getSavableCustomFieldsModels(){return[...this._getSavableComboBoxModels(),...this._getSavableCheckboxModels()]}_getCustomFields(e){e||(e=this.customFieldModels.value());const t={};return e.forEach((e=>{"TextWithCheckBox"===e.type&&(t[e.id]={text:e.text.value().replace(/&quote;/g,'"'),checked:e.checked.value()}),"Checkbox"===e.type&&(t[e.id]=e.checked.value()),"ComboBox"===e.type&&(t[e.id]=e.selectedItem.value())})),t}_getCurrentInputState(){return{symbol:this.symbol,orderType:this.orderType.value(),side:this.sideModel.getValue(),limitPrice:this.limitPriceModel.getValue(),stopPrice:this.stopPriceModel.getValue(),quantity:this.quantityModel.getValue(),takeProfitPips:this.takeProfitModel?this.takeProfitModel.pips.getValue():null,stopLossPips:this.stopLossModel?this.stopLossModel.pips.getValue():null,duration:this.durationModel.getValue(),customFields:this._getCustomFields(this._getSavableCustomFieldsModels())}}_setDisabledIfNeeded({status:e,loading:t,quotes:i,side:s,limitPrice:r,stopPrice:o,quantity:a,isTakeProfitIncorrect:n,isStopLossIncorrect:l,customFields:u}){this.disabled.setValue(this.mode.value()===B.OrderEditorDisplayMode.Panel&&e===B.OrderPanelStatus.Wait||t||(0,$.isNoQuotes)(i)||null===s||(0,D.checkPriceByOrderType)(this.orderType.value(),r,o)||null===a||n||l||Object.values(u).some((e=>void 0===e))||this.customFieldModels.value().some((e=>!e.isValid.value())))}_toggleMode(){this.mode.setValue(this.mode.value()===B.OrderEditorDisplayMode.Panel?B.OrderEditorDisplayMode.Popup:B.OrderEditorDisplayMode.Panel),this._onModeChanged.fire(this.mode.value())}_closeWidget(){this._cleanUp(),this._onCloseButtonClicked.fire()}_cancel(){this._cleanUp(),this.deactivateOrderTicket(),this._currentInputState=Object.assign({},this._initialInputState),this.limitPriceModel&&this.limitPriceModel.resetPrice(),this.stopPriceModel&&this.stopPriceModel.resetPrice(),this.takeProfitModel&&this.takeProfitModel.setEnabled(!1),this.stopLossModel&&this.stopLossModel.setEnabled(!1),this.quantityModel&&void 0!==this._suggestedQty&&this.quantityModel.quantity.setValue(this._suggestedQty),this._orderPlacingStatus.next(B.OrderPlacingStatus.Creating),this.existingOrder&&this._back()}_cleanUp(){this.orderPreviewModel=null,this.onDoneButtonClicked.resolve(!1)}_getDefaultDuration(){const e=(0,r.ensureDefined)(this._adapter.metainfo().durations);return e.find((e=>Boolean(e.default)))||e[0]}async _prepareTradableSolution(e){this.tradableSolution=await(0,
D.prepareTradableSolution)(e,this._adapter),this._createSimpleDialog(this._adapter),this.notTradableText=e.reason}}class ot{constructor({qty:e,currency:t,positionPrice:i,showTotalInsteadOfTradeValue:s,info:r,pipValueType$:o,tpInfo:a,slInfo:n,showRiskControls:l}){this._infoTableData$=new m.BehaviorSubject({rows:[]}),this._riskFormatter=new q.PriceFormatter(100),this._tpEnabled$=null,this._tpRiskInCurrency$=null,this._tpRiskInPercent$=null,this._slEnabled$=null,this._slRiskInCurrency$=null,this._slRiskInPercent$=null,this._currency=t,this._showTotalInsteadOfTradeValue=s,this._showRiskControls=l,this._type=r.type,this._leverage=r.leverage,this._marginRate=r.marginRate,this._lotSize=r.lotSize,this._pipValue=(0,D.calculatePipValue)(e,r.pipValue,this._lotSize),this._pipValueType$=o,null===e?this._tradeValue=0:"crypto"===this._type?this._tradeValue=e*i:this._tradeValue=(0,D.calculateTradeValue)(e,i,r.pipValue,r.pipSize,this._lotSize),a&&n&&(this._tpEnabled$=a.enabled,this._tpRiskInCurrency$=a.riskInCurrency,this._tpRiskInPercent$=a.riskInPercent,this._slEnabled$=n.enabled,this._slRiskInCurrency$=n.riskInCurrency,this._slRiskInPercent$=n.riskInPercent)}subscribe(){this._subscription=(0,S.combineLatest)({tpEnabled:null!==this._tpEnabled$?this._tpEnabled$:(0,M.of)(null),tpRiskInCurrency:null!==this._tpRiskInCurrency$?this._tpRiskInCurrency$:(0,M.of)(null),tpRiskInPercent:null!==this._tpRiskInPercent$?this._tpRiskInPercent$:(0,M.of)(null),slEnabled:null!==this._slEnabled$?this._slEnabled$:(0,M.of)(null),slRiskInCurrency:null!==this._slRiskInCurrency$?this._slRiskInCurrency$:(0,M.of)(null),slRiskInPercent:null!==this._slRiskInPercent$?this._slRiskInPercent$:(0,M.of)(null),pipValueType:this._pipValueType$}).subscribe((e=>{const{tpEnabled:t,tpRiskInCurrency:i,tpRiskInPercent:s,slEnabled:r,slRiskInCurrency:o,slRiskInPercent:a,pipValueType:n}=e,l=[];l.push(...this._makeLeverageInfo(),...this._makeLotSizeInfo(),...this._makePipValueInfo(n),...this._makeTradeValueInfo(),...this._makeRewardInfo(t,i,s),...this._makeRiskInfo(r,o,a)),this._infoTableData$.next({rows:l})}))}unsubscribe(){var e;null===(e=this._subscription)||void 0===e||e.unsubscribe()}title(){return d.t(null,void 0,i(440339))}infoTableData(){return this._infoTableData$.asObservable()}getOrderInfoTableRowsCount(){return this._infoTableData$.getValue().rows.length}_getTradeValue(){const e=this._getMarginRate();if(this._showRiskControls&&Number.isFinite(this._tradeValue)&&(this._isSymbolTypeSupportTradeValue()||void 0!==e))return(0,D.formatInfoValue)(this._tradeValue*(null!=e?e:1))}_makeLeverageInfo(){const e=(0,D.displayedLeverage)(this._leverage,this._marginRate);return null===e?[]:[{title:d.t(null,void 0,i(956220)),value:e}]}_makeLotSizeInfo(){return"number"==typeof this._lotSize&&Number.isFinite(this._lotSize)?[{title:d.t(null,void 0,i(127531)),value:String(this._lotSize)}]:[]}_makePipValueInfo(e){return this._showRiskControls&&e!==C.PipValueType.None&&Number.isFinite(this._pipValue)?[{title:e===C.PipValueType.Pips?d.t(null,void 0,i(419489)):d.t(null,void 0,i(696709)),
value:`${(0,D.formatInfoValue)(this._pipValue)} ${this._currency}`}]:[]}_makeTradeValueInfo(){const e=this._getTradeValue();if(void 0===e)return[];return[{title:this._showTotalInsteadOfTradeValue?d.t(null,void 0,i(613937)):d.t(null,void 0,i(207710)),value:`${e} ${this._currency}`}]}_getMarginRate(){return void 0!==this._marginRate&&this._marginRate>0?this._marginRate:void 0}_isSymbolTypeSupportTradeValue(){return void 0!==this._type&&["stock","dr","right","bond","warrant","structured"].includes(this._type)}_makeRewardInfo(e,t,s){return this._showRiskControls&&e&&null!==t&&null!==s?[{title:d.t(null,void 0,i(356979)),value:`${this._riskFormatter.format(s)}% (${this._riskFormatter.format(t)} ${this._currency})`}]:[]}_makeRiskInfo(e,t,s){return this._showRiskControls&&e&&null!==t&&null!==s?[{title:d.t(null,void 0,i(563833)),value:`${this._riskFormatter.format(s)}% (${this._riskFormatter.format(t)} ${this._currency})`}]:[]}}var at;!function(e){e[e.Position=0]="Position",e[e.Trade=1]="Trade"}(at||(at={}));class nt{constructor({adapter:e,position:t,brackets:i,mode:s,settings:r,realtimeProvider:o,isUndockAllowed:a,isVisible:n,viewType:l,pipValueType$:c,handler:d,trackEvent:p,orderDialogOptions:_}){this.positionInfoModel=null,this.customFieldModels=new(u())([]),this.onDoneButtonClicked=(0,h.createDeferredPromise)(),this.rewardRisk=new(u())(""),this.disabled=new(u())(!1),this.loading=new(u())(!1),this.status=new(u())(B.OrderPanelStatus.Active),this.id=(0,V.randomHashN)(6),this.warning=new(u())(void 0),this.isEmptyRequiredCustomFieldsHighlighted=new(u())(!1),this._onModeChanged=new(L()),this._onBackButtonClicked=new(L()),this._onCloseButtonClicked=new(L()),this._loadingSubscription=(0,D.makeSubjectFromWatchedValue)(this.loading),this._loading=this._loadingSubscription.subject,this.mode=s,this._position=t,this._settings=r,this._adapter=e,this._pipValueType$=c,this.position=t,this.symbol=t.symbol,this.brackets=i,this._handler=d,this._isUndockAllowed=a,this._isVisible=n;const m=this._adapter.metainfo().configFlags;this.supportBrackets=l===at.Trade?m.supportTradeBrackets:m.supportPositionBrackets,this.supportTrailingStop=this.supportBrackets&&m.supportTrailingStop,this.supportModifyTrailingStop=this.supportTrailingStop&&m.supportModifyTrailingStop,this.supportPositions=l===at.Position&&m.supportPositions,this.supportTrades=l===at.Trade&&m.supportTrades,this.supportOnlyPairPositionBrackets=m.supportOnlyPairPositionBrackets,this.supportCryptoExchangeOrderTicket=m.supportCryptoExchangeOrderTicket,this._adapter.orders().then((e=>{var i;const s=e.filter((e=>2===e.parentType&&e.parentId===t.id)),r=null===(i=s[0])||void 0===i?void 0:i.customFields,o=this._adapter.getPositionDialogOptions();this.customFieldModels.setValue((0,D.createCustomFieldModels)(Boolean(s.length),this.status,new(u())(!1),o,r)),this.supportOnlyPairPositionBrackets&&this._updateWarning()})),this._trackEvent=p,this.onReady=Promise.all([e.symbolInfo(t.symbol),Xe(e.accountMetainfo(),{id:e.metainfo().id,name:e.metainfo().title
}),Xe(e.formatter(t.symbol,!1),new q.PriceFormatter)]).then((([s,r,a])=>{this.showRiskControls=m.supportRiskControls&&0!==s.pipValue,this.currency=(0,$.getCurrency)(r),this.symbolType=s.type,this.brokerSymbol=s.brokerSymbol||t.brokerSymbol||this.symbol,this._quotes$=w((0,k.fromEventPattern)((e=>o.subscribeRealtime(t.symbol,e)),(e=>o.unsubscribeRealtime(t.symbol,e)),((e,t)=>t))),this._equity$=w((0,k.fromEventPattern)((t=>e.subscribeEquity(t)),(t=>e.unsubscribeEquity(t)),((e,t)=>t))),this._pipValues$=w((0,k.fromEventPattern)((i=>e.subscribePipValue(t.symbol,i)),(i=>e.unsubscribePipValue(t.symbol,i)),((e,t)=>t)).pipe((0,y.startWith)({buyPipValue:s.pipValue,sellPipValue:s.pipValue}))),this._pipValue$=this._pipValues$.pipe((0,b.map)((e=>1===t.side?e.buyPipValue:e.sellPipValue))),this._createModels(i,s,r,this.mode,a,_),this._subscribe()}))}destroy(){this._subscriptions&&this._subscriptions.forEach((e=>e.unsubscribe())),this.headerModel&&(this.headerModel.unsubscribe(),this.headerModel.pinButtonClicked().unsubscribe(this,this._toggleMode),this.headerModel.backButtonClicked().unsubscribe(this,this._back),this.headerModel.closeButtonClicked().unsubscribe(this,this._closeWidget)),null!==this.positionInfoModel&&this.positionInfoModel.unsubscribe(),this.supportPositions&&this._adapter.positionUpdate.unsubscribe(this,this._positionOrTradeUpdate),this.supportTrades&&this._adapter.tradeUpdate.unsubscribe(this,this._positionOrTradeUpdate),this.supportOnlyPairPositionBrackets&&this._adapter.orderUpdate.unsubscribe(this,this._updateWarning)}side(){return this._position.side}doneButtonClick(){this.loading.setValue(!0),this._doneHandler().then((e=>{e&&(this.onDoneButtonClicked.resolve(!0),this.mode.value()===B.OrderEditorDisplayMode.Popup?this.headerModel.close():this._back(),this._trackEvent("Position Ticket","Modify Position",this.mode.value()===B.OrderEditorDisplayMode.Panel?"Panel":"Popup")),this.loading.setValue(!1)}))}onModeChanged(){return this._onModeChanged}onBackButtonClicked(){return this._onBackButtonClicked}onCloseButtonClicked(){return this._onCloseButtonClicked}_createModels(e,t,i,s,r,o){const a=(0,I.extractTakeProfitValidationRules)(this._adapter,this.symbol),n=(0,I.extractStopLossValidationRules)(this._adapter,this.symbol),l=(0,$.getCurrency)(i)||"$",u=new m.BehaviorSubject(this._position.side||-1);this.headerModel=new R({displaySymbolName:this.brokerSymbol,symbol:this.symbol,brokerName:" ",mode:s,status:this.status,parentType:2,existingOrder:!0,isTradable:!0,quotes$:this._quotes$,isUndockAllowed:this._isUndockAllowed,data:this._position,formatter:this._position.priceFormatter?this._position.priceFormatter:r}),this.takeProfitModel=new Ne({initialPrice:e.takeProfit||this._position.takeProfit||null,initialEnabled:Boolean(e.takeProfit||this._position.takeProfit),initialBracketType:C.BracketType.TakeProfit,formatter:r,equity$:this._equity$,quotes$:this._quotes$,info:t,pipValue$:this._pipValue$,side$:u,amount$:new m.BehaviorSubject(this._position.qty),parentPrice$:new m.BehaviorSubject(this._position.avgPrice),
orderType$:new m.BehaviorSubject(null),currency:l,parentType:2,savedPips:null,settings:this._settings,orderWidgetStat:null,showRiskControls:this.showRiskControls,status:this.status.value(),validationRules:a,supportModifyBrackets:this.supportBrackets,supportModifyTrailingStop:this.supportModifyTrailingStop});const c=null!==this._position.trailingStopPips,d=e.trailingStopPips||this._position.trailingStopPips,h=e.stopLoss||this._position.stopLoss,p=Boolean(d);this.stopLossModel=new Ne({initialPrice:p?null:h||null,initialEnabled:Boolean(p?d:h),initialBracketType:p?C.BracketType.TrailingStop:C.BracketType.StopLoss,formatter:r,equity$:this._equity$,quotes$:this._quotes$,info:t,pipValue$:this._pipValue$,side$:u,amount$:new m.BehaviorSubject(this._position.qty),parentPrice$:new m.BehaviorSubject(this._position.avgPrice),orderType$:new m.BehaviorSubject(null),currency:l,parentType:2,savedPips:d||null,settings:this._settings,orderWidgetStat:null,showRiskControls:this.showRiskControls,status:this.status.value(),validationRules:n,supportModifyBrackets:this.supportBrackets,supportModifyTrailingStop:this.supportModifyTrailingStop,hasTrailingStopBracket:c});const _=(0,D.shouldShowTotal)(o);this.supportCryptoExchangeOrderTicket||(this.positionInfoModel=new ot({qty:this._position.qty,currency:(0,$.getCurrency)(i),positionPrice:this._position.avgPrice,showTotalInsteadOfTradeValue:_,info:t,pipValueType$:this._pipValueType$,tpInfo:this.supportBrackets&&this.takeProfitModel?{enabled:this.takeProfitModel.enabled$,riskInCurrency:this.takeProfitModel.riskInCurrency.value$,riskInPercent:this.takeProfitModel.riskInPercent.value$}:null,slInfo:this.supportBrackets&&this.stopLossModel?{enabled:this.stopLossModel.enabled$,riskInCurrency:this.stopLossModel.riskInCurrency.value$,riskInPercent:this.stopLossModel.riskInPercent.value$}:null,showRiskControls:this.showRiskControls})),this.buttonModel=new Ge(C.TradingEntityType.Position)}_updateWarning(){this._adapter.orders().then((e=>{const t=e.find((e=>e.symbol===this._position.symbol&&e.side!==this._position.side&&(6===e.status&&void 0===e.parentId||3===e.status)));this.warning.setValue(t?d.t(null,void 0,i(698311)):void 0)}))}_subscribe(){if(this.headerModel.pinButtonClicked().subscribe(this,this._toggleMode),this.headerModel.backButtonClicked().subscribe(this,this._back),this.headerModel.closeButtonClicked().subscribe(this,this._closeWidget),this._buttonDataSubscription=(0,S.combineLatest)({loading:this._loading,quotes:this._quotes$,takeProfit:this.takeProfitModel.value$,stopLoss:this.stopLossModel.value$,takeProfitEnabled:this.takeProfitModel.enabled$,stopLossEnabled:this.stopLossModel.enabled$}).subscribe((e=>{const{loading:t,quotes:i,takeProfit:s,stopLoss:r,takeProfitEnabled:o,stopLossEnabled:a}=e;this.disabled.setValue(t||(0,$.isNoQuotes)(i)||o&&null===s||a&&null===r)})),this._rewardRiskSubscription=(0,S.combineLatest)([this.takeProfitModel.value$,this.stopLossModel.value$]).subscribe((([e,t])=>{this.rewardRisk.setValue((0,D.formatRiskReward)(e,t))})),
this._subscriptions=[...this.takeProfitModel.subscribe(),...this.stopLossModel.subscribe(),this._rewardRiskSubscription,this._buttonDataSubscription,this._equity$.connect(),this._quotes$.connect(),this._pipValues$.connect()],null!==this.positionInfoModel&&this.positionInfoModel.subscribe(),this.supportPositions&&this._adapter.positionUpdate.subscribe(this,this._positionOrTradeUpdate),this.supportTrades&&this._adapter.tradeUpdate.subscribe(this,this._positionOrTradeUpdate),this.supportOnlyPairPositionBrackets){this._adapter.orderUpdate.subscribe(this,this._updateWarning);const e=this.stopLossModel.enabled$.pipe(ce(this.takeProfitModel.enabled$)).subscribe((e=>{const[t,i]=e;i!==t&&this.takeProfitModel.setEnabled(t)})),t=this.takeProfitModel.enabled$.pipe(ce(this.stopLossModel.enabled$)).subscribe((e=>{const[t,i]=e;i!==t&&this.stopLossModel.setEnabled(t)}));this._subscriptions.push(t,e)}}_doneHandler(){const e=null!==this.stopLossModel.getValue()?this.stopLossModel.price.getValue():null,t=this.stopLossModel.getValue(),i=null!==this.takeProfitModel.getValue()?this.takeProfitModel.price.getValue():null,s={};if(null!==t&&null!==e&&(this.stopLossModel.getBracketType()===C.BracketType.StopLoss&&(s.stopLoss=e),this.stopLossModel.getBracketType()===C.BracketType.TrailingStop&&(s.trailingStopPips=t)),null!==i&&(s.takeProfit=i),Array.isArray(this.customFieldModels.value())){const e={};return this.customFieldModels.value().forEach((t=>{"TextWithCheckBox"===t.type&&(e[t.id]={text:t.text.value().replace(/&quote;/g,'"'),checked:t.checked.value()}),"Checkbox"===t.type&&(e[t.id]={checked:t.checked.value()}),"ComboBox"===t.type&&(e[t.id]=t.selectedItem.value())})),this._getAndSendStatistics(),this._handler(this.position.id,s,e)}return this._getAndSendStatistics(),this._handler(this.position.id,s)}_getAndSendStatistics(){const e=this.stopLossModel.getEnabled(),t=this.stopLossModel.getFocusedControl(),i=this.takeProfitModel.getEnabled(),s=this.takeProfitModel.getFocusedControl(),r=this.stopLossModel&&this.stopLossModel.getBracketType(),o=["Pips","Price","RiskInCurrency","RiskInPercent"],a=[" Disabled"," Active"],n=["StopLoss","TakeProfit","TrailingStop"],l={SL:{active:a[+e],mode:o[t]},TP:{active:a[+i],mode:o[s]}};this.supportTrailingStop&&(l.SLType={active:a[+e],mode:n[r]});const u=this._settings.value();Object.keys(u).filter((e=>["showBracketsInCurrency","showBracketsInPercent"].includes(e))).forEach((e=>{this._trackEvent("Order Ticket",e,u[e]?"on":"off")})),Object.keys(l).forEach((e=>{l[e].active&&this._trackEvent("Position Ticket",e,l[e].mode)}))}_positionOrTradeUpdate(e){!this._isVisible()||this.loading.value()||e.id!==this.position.id||0!==e.qty&&this.position.side===e.side||(this.mode.value()===B.OrderEditorDisplayMode.Popup?this.headerModel.close():this._back())}_toggleMode(){this.mode.setValue(this.mode.value()===B.OrderEditorDisplayMode.Panel?B.OrderEditorDisplayMode.Popup:B.OrderEditorDisplayMode.Panel),this._onModeChanged.fire(this.mode.value())}_closeWidget(){this.onDoneButtonClicked.resolve(!1),
this._onCloseButtonClicked.fire()}_back(){this.onDoneButtonClicked.resolve(!1),this._onBackButtonClicked.fire()}}var lt=i(322625);class ut{constructor(e){this._brokerId="",this._settingsAdapter=e}setBrokerId(e){this._brokerId=e}saveSettings(e){this._settingsAdapter.setValue(this._makeKey(lt.settingsKeys.ORDER_PANEL_SETTINGS,this._brokerId),JSON.stringify(e))}getSettings(){const e=this._settingsAdapter.getValue(this._makeKey(lt.settingsKeys.ORDER_PANEL_SETTINGS,this._brokerId));try{return JSON.parse(e)}catch(e){return null}}setWidgetMode(e){this._settingsAdapter.setValue(lt.settingsKeys.ORDER_WIDGET_MODE,e)}widgetMode(){const e=this._settingsAdapter.getValue(lt.settingsKeys.ORDER_WIDGET_MODE);return e||null}_makeKey(e,t,i){return e+t+("string"==typeof i?"."+i:"")}}var ct,dt=i(758094),ht=i(895318),pt=i(75577),_t=i(768819);!function(e){let t=0;const i=new(u())(!1);e.value=i.readonly(),e.wrap=function(e){return async(...s)=>{i.setValue(!0),t++;try{return await e(...s)}finally{t--,i.setValue(0!==t)}}}}(ct||(ct={}));const yt=(0,o.getLogger)("Trading.OrderViewController");function bt(){return Promise.all([i.e(2980),i.e(9951),i.e(580),i.e(8194),i.e(2191),i.e(6639),i.e(7845),i.e(5518),i.e(2639),i.e(4474),i.e(7194),i.e(6036),i.e(5295),i.e(6747),i.e(3889),i.e(6260),i.e(1889),i.e(9894),i.e(2315),i.e(9934),i.e(9872),i.e(2567),i.e(1945),i.e(7125),i.e(993),i.e(9781),i.e(9791),i.e(3563),i.e(9789),i.e(7502)]).then(i.bind(i,112745))}function mt(){return Promise.all([i.e(2980),i.e(580),i.e(8194),i.e(2191),i.e(6639),i.e(7845),i.e(5518),i.e(2109),i.e(4474),i.e(7194),i.e(6036),i.e(1889),i.e(9894),i.e(2315),i.e(6209),i.e(4420),i.e(7125),i.e(9791),i.e(3563),i.e(8751)]).then(i.bind(i,382799))}class kt{constructor(e,t,i,r){if(this._orderViewModel=null,this._positionViewModel=null,this._dialogVisibility=new _t.DialogVisibility,this._orderWidgetStat=null,this._settings=new(u())(ht.defaultSettings),this._mode=new(u())(B.OrderEditorDisplayMode.Panel),this.openPanel=async()=>{try{await this._closeOrderDialog(),await this._closePositionDialog(),this._setDisplayMode(B.OrderEditorDisplayMode.Panel),this._openTradingPanelPage(dt.TradingPage.OrderPanel),await this._recreateOrderViewModel(null),this._resetOrderPanel(),await this._openOrderPanel()}catch(e){yt.logWarn(`Failed to open panel: ${(0,c.getLoggerMessage)(e)}`)}},this.closePanel=()=>{null!==this._positionViewModel&&(this._positionViewModel.onDoneButtonClicked.reject(),this._unmountPositionPanel(),this._unsubscribePositionViewModel()),null!==this._orderViewModel&&(this._orderViewModel.existingOrder&&this._orderViewModel.onDoneButtonClicked.reject(),this._unmountOrderPanel(),this._unsubscribeOrderViewModel()),this._closeTradingPanel()},this._onActiveTradingPanelChanged=e=>{e!==dt.TradingPage.OrderPanel&&(null!==this._positionViewModel&&(this._unmountPositionPanel(),this._unsubscribePositionViewModel()),null!==this._orderViewModel&&this._mode.value()===B.OrderEditorDisplayMode.Panel&&(this._orderViewModel.existingOrder&&this._orderViewModel.onDoneButtonClicked.reject(),
this._unsubscribeOrderViewModel(),this._unmountOrderPanel()))},this._onStatusChanged=async e=>{try{const t=this._state,i=this._makeState();i.symbol===t.symbol&&i.broker===t.broker&&i.accountId===t.accountId&&i.isAuthenticated===t.isAuthenticated||(this._state=i,this._setSettings(),await this._closeOrderDialog(),await this._closePositionDialog(),!(null==e?void 0:e.aborted)&&this._isTradingPanelOpened.value()&&this._mode.value()===B.OrderEditorDisplayMode.Panel&&this._tradingPanelActivePage.value()===dt.TradingPage.OrderPanel&&(await this._recreateOrderViewModel(e),this._deactivateOrderTicket(),this._openOrderPanel()))}catch(e){yt.logWarn(`Failed to change status: ${(0,c.getLoggerMessage)(e)}`)}},this._saveSettings=e=>{this._orderViewDataStorage.saveSettings(e)},this._recreateOrderViewModel=async(e,t)=>{var i,s,r,o;null!==this._orderViewModel&&(this._orderViewModel.existingOrder&&this._orderViewModel.onDoneButtonClicked.reject(),this._unsubscribeOrderViewModel()),null!==this._positionViewModel&&(this._positionViewModel.onDoneButtonClicked.reject(),this._unsubscribePositionViewModel()),this._orderStub=null!=t?t:this._createOrderStub();const{broker:n,symbol:l,side:u}=this._state;let c=null;if(null===n)c=new rt({...this._commonOrderViewModelProps(),adapter:n,isTradable:{tradable:!1},handler:()=>Promise.resolve(!0)});else{const d=await(0,a.respectAbort)(e,n.isTradable(l)),h=(null==t?void 0:t.hasOwnProperty("id"))?n.modifyOrder.bind(n):n.placeOrder.bind(n);let p=null;d.tradable&&(p=null!==(o=null!==(r=null!==(i=null==t?void 0:t.type)&&void 0!==i?i:null===(s=this._getTradingSettingsStorage())||void 0===s?void 0:s.orderType(l))&&void 0!==r?r:(0,$.getDefaultOrderType)(n.config))&&void 0!==o?o:null);const _=await(0,a.respectAbort)(e,n.getOrderDialogOptions(l)),y=this._makeOrderViewInputState(l,p,u,_);this._setState({orderType:p}),c=new rt({...this._commonOrderViewModelProps(),adapter:n,isTradable:d,handler:h,orderViewInputState:y,forceAbsolutePriceUpdate:!0,orderDialogOptions:_})}if(this._orderViewModel=c,await(0,a.respectAbort)(e,c.onReady),this._orderViewModel!==c)return Promise.reject("OrderViewModel was recreated during the initialization");this._subscribeOrderViewModel()},this._onOrderWidgetModeChanged=async e=>{e===B.OrderEditorDisplayMode.Panel?(await this._closeOrderDialog(),await this._openOrderPanel()):(await this._closeOrderPanel(),await this._showOrderDialog()),this._setDisplayMode(e)},this._onOrderWidgetInputStateChanged=e=>{const{symbol:t,orderType:i}=this._state;if((0,$.isDefined)(e.side)&&this._setState({side:e.side}),!(0,$.isDefined)(i))return;const s=this._getTradingSettingsStorage();if(null!==s){if((0,$.isDefined)(e.quantity)&&s.setSymbolQty(t,e.quantity),(0,$.isDefined)(e.takeProfitPips)&&s.setTakeProfitPips(t,e.takeProfitPips,B.BracketDefaultPips.TakeProfit),(0,$.isDefined)(e.stopLossPips)&&s.setStopLossPips(t,e.stopLossPips,B.BracketDefaultPips.StopLoss),(0,$.isDefined)(e.orderType)&&s.setOrderType(t,e.orderType),(0,$.isDefined)(e.duration)){
const t=this._state.broker&&this._state.broker.metainfo().durations,r=t&&(t.find((e=>e.default))||t[0]),o=r&&r.name===e.duration.type?null:e.duration;s.setDuration(this._state.symbol,i,o)}(0,$.isDefined)(e.customFields)&&s.setCustomFields(t,i,e.customFields)}},this._onOrderWidgetCloseButtonClicked=()=>{this._mode.value()===B.OrderEditorDisplayMode.Panel?this.closePanel():this._closeOrderDialog()},this._onOrderWidgetBackButtonClicked=()=>{if(this._orderViewModel&&this._orderViewModel.status.value()===B.OrderPanelStatus.Preview)return this._activateOrderTicket(),void(this._mode.value()===B.OrderEditorDisplayMode.Panel?this._openOrderPanel():this._showOrderDialog());this.showOrderView({order:this._createOrderStub(),isDeactivated:!0})},this._onPositionWidgetModeChanged=async e=>{e===B.OrderEditorDisplayMode.Panel?(await this._closePositionDialog(),await this._openPositionPanel()):(await this._closePositionPanel(),await this._showPositionDialog()),this._setDisplayMode(e)},this._onPositionWidgetBackButtonClicked=()=>{this._unmountPositionPanel(),this._unsubscribePositionViewModel(),this.showOrderView({order:this._createOrderStub(),isDeactivated:!0})},this._onPositionWidgetCloseButtonClicked=()=>{this._mode.value()===B.OrderEditorDisplayMode.Panel?this.closePanel():this._closePositionDialog()},this._isVisible=()=>this._mode.value()===B.OrderEditorDisplayMode.Panel?this._isTradingPanelOpened.value():this._dialogVisibility.getValue().isVisible,this._onOrderTypeChanged=e=>{this._setState({orderType:e})},this._tradingCommands=e,this._trackEvent=e.trackEvent,this._realtimeProvider=e.realtimeProvider,this._resizerBridge=e.resizerBridge,this._orderViewDataStorage=new ut(s),this._tradingPanelContainer=t.container,this._isOpeningTradingPanelAvailable=t.isOpeningAvailable,this._isTradingPanelOpened=t.isOpened,this._qtySuggester=i,this._tradingLinking=r,this._tradingPanelActivePage=t.activePage,this._closeTradingPanel=t.close,this._openTradingPanelPage=t.openPage,this._getTradingSettingsStorage=e.getTradingSettingsStorage,this.dialogVisibility=this._dialogVisibility.value$,window.matchMedia(pt.TradingLayoutBreakpoint.Mobile).matches)this._setDisplayMode(B.OrderEditorDisplayMode.Popup);else if(n.enabled("order_panel")){const e=this._orderViewDataStorage.widgetMode();this._setDisplayMode(null!=e?e:B.OrderEditorDisplayMode.Panel)}else this._setDisplayMode(B.OrderEditorDisplayMode.Popup);t.isOpeningAvailable.subscribe((e=>{e||this._mode.value()!==B.OrderEditorDisplayMode.Panel||this._setDisplayMode(B.OrderEditorDisplayMode.Popup)})),this._state=this._makeState(),this.stateChanging=ct.value,this._onStatusChanged=(0,a.respectLatest)(this._onStatusChanged),this._recreateOrderViewModel=ct.wrap((0,a.respectLatest)(this._recreateOrderViewModel)),this.openPanel=ct.wrap(this.openPanel),this._realtimeProvider.onStatusChanged.subscribe(null,(()=>this._onStatusChanged(null))),this._tradingLinking.valueObservable().subscribe((()=>this._onStatusChanged(null))),
window.loginStateChange&&window.loginStateChange.subscribe(this,(()=>this._onStatusChanged(null))),t.activePage.subscribe(this._onActiveTradingPanelChanged)}async showOrderView(e){try{const{order:t,focus:i,forceOrderDialog:s,isDeactivated:o=!1}=e;await this._closeOrderDialog(),await this._closePositionDialog(),s&&this._setDisplayMode(B.OrderEditorDisplayMode.Popup);const a=Object.assign(this._createOrderStub(),t);return t.symbol!==this._state.symbol&&this._setState({symbol:t.symbol}),await this._recreateOrderViewModel(null,a),o&&this._deactivateOrderTicket(),this._mode.value()===B.OrderEditorDisplayMode.Panel?this._openOrderPanel(i):this._showOrderDialog(i),(0,r.ensureNotNull)(this._orderViewModel).onDoneButtonClicked.promise}catch(e){return yt.logWarn(`Failed to show order view: ${(0,c.getLoggerMessage)(e)}`),!1}}async showPositionView(e,t,i){try{return this._createAndShowPositionViewModel({position:e,viewType:at.Position,brackets:t,focus:i})}catch(e){return yt.logWarn(`Failed to show position view: ${(0,c.getLoggerMessage)(e)}`),!1}}async showTradeView(e,t,i){try{return this._createAndShowPositionViewModel({position:e,viewType:at.Trade,brackets:t,focus:i})}catch(e){return yt.logWarn(`Failed to show trade view: ${(0,c.getLoggerMessage)(e)}`),!1}}mode(){return this._mode}_setState(e){this._state={...this._state,...e}}_setDisplayMode(e){this._mode.setValue(e),this._orderViewDataStorage.setWidgetMode(e)}_makeState(){var e,t,i,s;const r=window.is_authenticated,o=this._tradingLinking.value().symbol||"",a=this._realtimeProvider.activeBroker(),n=null==a?void 0:a.metainfo().configFlags,l=void 0!==n?(0,$.getDefaultOrderType)(n):null,u=null!==(i=null!==(t=null===(e=this._orderViewModel)||void 0===e?void 0:e.orderType.value())&&void 0!==t?t:l)&&void 0!==i?i:null,c=null!==(s=null==a?void 0:a.currentAccount())&&void 0!==s?s:null,d=a?a.metainfo().id:"";return this._orderViewDataStorage.setBrokerId(d),{isAuthenticated:r,broker:a,symbol:o,accountId:c,side:1,orderType:u}}async _createAndShowPositionViewModel({position:e,viewType:t,brackets:i,focus:s}){await this._closeOrderDialog(),await this._closePositionDialog(),e.symbol!==this._state.symbol&&this._setState({symbol:e.symbol}),null!==this._positionViewModel&&(this._positionViewModel.onDoneButtonClicked.reject(),this._unsubscribePositionViewModel()),null!==this._orderViewModel&&(this._orderViewModel.existingOrder&&this._orderViewModel.onDoneButtonClicked.reject(),this._unsubscribeOrderViewModel());const{broker:r,symbol:o}=this._state,a=r?await r.isTradable(o):null;if(null===r||null===a||!a.tradable)return await this.showOrderView({order:this._createOrderStub()}),!1;const n=await r.getOrderDialogOptions(o),l=t===at.Position?r.editPositionBrackets.bind(r):r.editTradeBrackets.bind(r),u=new nt({adapter:r,position:e,brackets:i,mode:this._mode,settings:this._settings,realtimeProvider:this._tradingCommands.realtimeProvider,isUndockAllowed:this._isOpeningTradingPanelAvailable.value(),isVisible:this._isVisible,viewType:t,pipValueType$:this._tradingCommands.pipValueType$,handler:l,
trackEvent:this._tradingCommands.trackEvent,orderDialogOptions:n});return this._positionViewModel=u,await this._positionViewModel.onReady,this._positionViewModel!==u?Promise.reject("PositionViewModel was recreated during the initialization"):(this._subscribePositionViewModel(),this._mode.value()===B.OrderEditorDisplayMode.Panel?this._openPositionPanel(s):this._showPositionDialog(s),this._positionViewModel.onDoneButtonClicked.promise)}_setSettings(){if(null===this._state.broker)return;this._settings.unsubscribe(this._saveSettings);const e=this._state.broker.metainfo().configFlags.supportCryptoBrackets;let t=this._orderViewDataStorage.getSettings()||ht.defaultSettings;e&&(t=Object.assign({},ht.defaultCryptoBracketsSettings,t)),this._settings.setValue(t),this._settings.subscribe(this._saveSettings)}_createOrderStub(){return{limitPrice:void 0,stopPrice:void 0,qty:0,side:void 0,symbol:this._state.symbol,type:void 0,takeProfit:void 0,stopLoss:void 0}}_activateOrderTicket(){var e;null===(e=this._orderViewModel)||void 0===e||e.activateOrderTicket()}_deactivateOrderTicket(){var e;null===(e=this._orderViewModel)||void 0===e||e.deactivateOrderTicket()}_resetOrderPanel(){var e;null===(e=this._orderViewModel)||void 0===e||e.resetOrderPanel()}async _openOrderPanel(e){await this._mountOrderPanel(e),this._openTradingPanelPage(dt.TradingPage.OrderPanel)}async _mountOrderPanel(e){const{mountOrderPanel:t}=await bt();null!==this._orderViewModel&&t(this._orderViewModel,this._settings,this._tradingPanelContainer,(0,r.ensureNotNull)(this._resizerBridge).width,e,this._trackEvent)}async _closeOrderPanel(){await this._unmountOrderPanel(),this._closeTradingPanel()}async _unmountOrderPanel(){const{unmountOrderPanel:e}=await bt();e((0,r.ensureNotNull)(this._tradingPanelContainer))}async _showOrderDialog(e){const{showOrderDialog:t}=await bt();null!==this._orderViewModel&&t({viewModel:this._orderViewModel,settings:this._settings,focus:e,trackEvent:this._trackEvent,onOpen:e=>{this._dialogVisibility.setValue({isVisible:!0,isFullScreen:e})},onClose:()=>{this._dialogVisibility.setValue({isVisible:!1})}})}async _closeOrderDialog(){const{closeOrderDialog:e}=await bt();e((()=>this._dialogVisibility.setValue({isVisible:!1})))}_subscribeOrderViewModel(){(0,r.ensureNotNull)(this._orderViewModel).onModeChanged().subscribe(this,this._onOrderWidgetModeChanged),(0,r.ensureNotNull)(this._orderViewModel).onInputStateChanged().subscribe(this,this._onOrderWidgetInputStateChanged),(0,r.ensureNotNull)(this._orderViewModel).onCloseButtonClicked().subscribe(this,this._onOrderWidgetCloseButtonClicked),(0,r.ensureNotNull)(this._orderViewModel).onBackButtonClicked().subscribe(this,this._onOrderWidgetBackButtonClicked),(0,r.ensureNotNull)(this._orderViewModel).orderType.subscribe(this._onOrderTypeChanged)}_unsubscribeOrderViewModel(){(0,r.ensureNotNull)(this._orderViewModel).onModeChanged().unsubscribe(this,this._onOrderWidgetModeChanged),(0,r.ensureNotNull)(this._orderViewModel).onInputStateChanged().unsubscribe(this,this._onOrderWidgetInputStateChanged),(0,
r.ensureNotNull)(this._orderViewModel).onCloseButtonClicked().unsubscribe(this,this._onOrderWidgetCloseButtonClicked),(0,r.ensureNotNull)(this._orderViewModel).onBackButtonClicked().unsubscribe(this,this._onOrderWidgetBackButtonClicked),(0,r.ensureNotNull)(this._orderViewModel).orderType.unsubscribe(this._onOrderTypeChanged),(0,r.ensureNotNull)(this._orderViewModel).destroy(),this._orderViewModel=null}async _openPositionPanel(e){await this._mountPositionPanel(e),this._openTradingPanelPage(dt.TradingPage.OrderPanel)}async _mountPositionPanel(e){const{mountPositionPanel:t}=await mt();if(null!==this._positionViewModel)return t(this._positionViewModel,this._settings,this._tradingPanelContainer,e)}async _closePositionPanel(){await this._unmountPositionPanel(),this._closeTradingPanel()}async _unmountPositionPanel(){const{unmountPositionPanel:e}=await mt();e(this._tradingPanelContainer)}async _showPositionDialog(e){const{showPositionDialog:t}=await mt();null!==this._positionViewModel&&t({viewModel:this._positionViewModel,settings:this._settings,focus:e,onOpen:e=>{this._dialogVisibility.setValue({isVisible:!0,isFullScreen:e})},onClose:()=>{this._dialogVisibility.setValue({isVisible:!1})}})}async _closePositionDialog(){const{closePositionDialog:e}=await mt();e((()=>this._dialogVisibility.setValue({isVisible:!1})))}_subscribePositionViewModel(){(0,r.ensureNotNull)(this._positionViewModel).onModeChanged().subscribe(this,this._onPositionWidgetModeChanged),(0,r.ensureNotNull)(this._positionViewModel).onBackButtonClicked().subscribe(this,this._onPositionWidgetBackButtonClicked),(0,r.ensureNotNull)(this._positionViewModel).onCloseButtonClicked().subscribe(this,this._onPositionWidgetCloseButtonClicked)}_unsubscribePositionViewModel(){(0,r.ensureNotNull)(this._positionViewModel).onModeChanged().unsubscribe(this,this._onPositionWidgetModeChanged),(0,r.ensureNotNull)(this._positionViewModel).onBackButtonClicked().unsubscribe(this,this._onPositionWidgetBackButtonClicked),(0,r.ensureNotNull)(this._positionViewModel).onCloseButtonClicked().unsubscribe(this,this._onPositionWidgetCloseButtonClicked),(0,r.ensureNotNull)(this._positionViewModel).onDoneButtonClicked.resolve(!1),(0,r.ensureNotNull)(this._positionViewModel).destroy(),this._positionViewModel=null}_makeOrderViewInputState(e,t,i,s){var r,o,a,n,l;let u;s&&s.customFields&&null!==t&&(u=null===(r=this._getTradingSettingsStorage())||void 0===r?void 0:r.customFields(e,t,s.customFields.map((e=>e.id))));const c=null!==t?null===(o=this._getTradingSettingsStorage())||void 0===o?void 0:o.duration(e,t):null;return{symbol:e,side:i,orderType:t,limitPrice:null,stopPrice:null,quantity:(null===(a=this._getTradingSettingsStorage())||void 0===a?void 0:a.symbolQty(e))||null,takeProfitPips:(null===(n=this._getTradingSettingsStorage())||void 0===n?void 0:n.takeProfitPips(e))||null,stopLossPips:(null===(l=this._getTradingSettingsStorage())||void 0===l?void 0:l.stopLossPips(e))||null,duration:c||null,customFields:u||null}}_commonOrderViewModelProps(){return{order:this._orderStub,mode:this._mode,
settings:this._settings,orderWidgetStat:this._orderWidgetStat,isUndockAllowed:this._isOpeningTradingPanelAvailable.value(),pipValueType$:this._tradingCommands.pipValueType$,onNeedSelectBroker:this._tradingCommands.onNeedSelectBroker,trackEvent:this._tradingCommands.trackEvent,toggleTradingWidget:this._tradingCommands.toggleTradingWidget,toggleTradingPanelPopup:this._tradingCommands.toggleTradingPanelPopup,showErrorNotification:this._tradingCommands.showErrorNotification,qtySuggester:this._qtySuggester,isVisible:this._isVisible}}}},75577:(e,t,i)=>{"use strict";i.d(t,{TradingLayoutBreakpoint:()=>r});var s=i(312282);const r={Mobile:s.mobile}},476007:(e,t,i)=>{"use strict";i.d(t,{SplitThousandsFormatter:()=>o});var s=i(793361),r=i(710263);class o{constructor(e=" "){this._divider=e}format(e){const t=(0,s.splitThousands)(e,this._divider);return(0,r.isRtl)()?(0,r.startWithLTR)(t):t}parse(e){const t=(0,r.stripLTRMarks)(e).split(this._divider).join(""),i=Number(t);return isNaN(i)||/e/i.test(t)?{res:!1}:{res:!0,value:i,suggest:this.format(i)}}}},50985:e=>{e.exports={ar:[""],ca_ES:["Divisa"],cs:["Mna"],de:["Whrung"],el:"Currency",en:"Currency",es:["Divisa"],fa:"Currency",fr:["Devise"],he_IL:[""],hu_HU:["Valuta"],id_ID:["Mata Uang"],it:["Valuta"],ja:[""],ko:[""],ms_MY:["Mata wang"],nl_NL:"Currency",pl:["Waluta"],pt:["Moeda"],ro:"Currency",ru:[""],sv:["Valuta"],th:[""],tr:["Dviz"],vi:["Tin t"],zh:[""],zh_TW:[""]}},987300:e=>{e.exports={ar:[" "],ca_ES:"Ask",cs:"Ask",de:"Ask",el:"Ask",en:"Ask",es:"Ask",fa:"Ask",fr:["Demande"],he_IL:[" "],hu_HU:["Vteli r"],id_ID:"Ask",it:["Lettera"],ja:"Ask",ko:[""],ms_MY:["Tawar"],nl_NL:"Ask",pl:["Cena Ask"],pt:["Venda"],ro:"Ask",ru:[""],sv:["Frga"],th:[""],tr:["Al"],vi:"Ask",zh:"Ask",zh_TW:"Ask"}},6205:e=>{e.exports={ar:[" "],ca_ES:"Bid",cs:"Bid",de:"Bid",el:"Bid",en:"Bid",es:"Bid",fa:"Bid",fr:["Offre"],he_IL:[" "],hu_HU:["Knlati r"],id_ID:"Bid",it:["Denaro"],ja:"Bid",ko:[""],ms_MY:["Bida"],nl_NL:"Bid",pl:["Cena Bid"],pt:["Compra"],ro:"Bid",ru:[""],sv:"Bid",th:[""],tr:["Sat"],vi:"Bid",zh:"Bid",zh_TW:"Bid"}},618156:e=>{e.exports={ar:[""],ca_ES:"Buy",cs:"Buy",de:["Kauf"],el:"Buy",en:"Buy",es:["Comprar"],fa:"Buy",fr:"Buy",he_IL:[""],hu_HU:["Vtel"],id_ID:["Pembelian"],it:["Compra"],ja:[""],ko:[""],ms_MY:["Beli"],nl_NL:"Buy",pl:["Kup"],pt:["Compra"],ro:"Buy",ru:[""],sv:["Kp"],th:[""],tr:["Al"],vi:["Mua"],zh:[""],zh_TW:[""]}},658028:e=>{e.exports={ar:["       "],ca_ES:"Estimated money impact is for main order only.",cs:"Estimated money impact is for main order only.",de:["Die geschtzte Auswirkung gilt nur fr die Hauptorder"],el:"Estimated money impact is for main order only.",en:"Estimated money impact is for main order only.",es:["El impacto monetario calculado se aplica nicamente en la orden principal"],fa:"Estimated money impact is for main order only.",
fr:["L'impact financier estim concerne uniquement l'ordre principal"],he_IL:["      "],hu_HU:"Estimated money impact is for main order only.",id_ID:["Perkiraan dampak uangnya hanya untuk order utamanya saja."],it:["La stima dell'impatto monetario  per il solo ordine principale"],ja:[""],ko:["    "],ms_MY:["Jangkaan impak wang  adalah untuk pesanan utama sahaja"],nl_NL:"Estimated money impact is for main order only.",pl:["Szacunkowy wpyw pieniny dotyczy wycznie gwnego zlecenia"],pt:["O impacto estimado do dinheiro  apenas para o pedido principal"],ro:"Estimated money impact is for main order only.",ru:["      ."],sv:["Berknad pengar effekten r fr huvud order endast"],th:[""],tr:["Tahmini para etkisi yalnzca ana emir iindir"],vi:["Tc ng tin d kin ch dnh cho lnh chnh"],zh:[""],zh_TW:[""]}},575681:e=>{e.exports={ar:["    "],ca_ES:"Failed to preview leverage",cs:"Failed to preview leverage",de:["Vorschau der Hebelwirkung fehlgeschlagen"],el:"Failed to preview leverage",en:"Failed to preview leverage",es:["Error al obtener una vista previa del apalancamiento"],fa:"Failed to preview leverage",fr:["chec de la prvisualisation de l'effet de levier"],he_IL:["    "],hu_HU:"Failed to preview leverage",id_ID:["Gagal melalukan pratinjau leverage"],it:["Impossibile vedere in anteprima la leva"],ja:[""],ko:["   ."],ms_MY:["Gagal untuk melihat keumpilan."],nl_NL:"Failed to preview leverage",pl:["Nie udao si wywietli podgldu dwigni"],pt:["Falha ao pr-visualizar a alavancagem"],ro:"Failed to preview leverage",ru:["    "],sv:["Misslyckades med att frhandsgranska hvstngseffekten"],th:[""],tr:["Kaldra nizlenemedi"],vi:["Khng th xem trc n by"],zh:[""],zh_TW:[""]}},368662:e=>{e.exports={ar:["    "],ca_ES:"Failed to set leverage",cs:"Failed to set leverage",de:["Hebelwirkung konnte nicht eingestellt werden"],el:"Failed to set leverage",en:"Failed to set leverage",es:["Error al establecer el apalancamiento"],fa:"Failed to set leverage",fr:["chec de la fixation de l'effet de levier"],he_IL:["  "],hu_HU:"Failed to set leverage",id_ID:["Gagal mengatur leverage"],it:["Impossibile impostare leva"],ja:[""],ko:["  ."],ms_MY:["Gagal untuk menyediakan keumpilan."],nl_NL:"Failed to set leverage",pl:["Nie udao si ustawi dwigni"],pt:["Falha ao definir a alavancagem"],ro:"Failed to set leverage",ru:["   "],sv:["Misslyckades med att stlla in hvstngen"],th:[""],tr:["Kaldra ayarlanamad"],vi:["Tht bi khi t n by"],zh:[""],zh_TW:[""]}},147380:e=>{e.exports={ar:[" "],ca_ES:"Order confirmation",cs:"Order confirmation",
de:["Order Besttigung"],el:"Order confirmation",en:"Order confirmation",es:["Confirmacin de la orden"],fa:"Order confirmation",fr:["Confirmation d'ordre"],he_IL:[" "],hu_HU:"Order confirmation",id_ID:["Konfirmasi order"],it:["Conferma d'ordine"],ja:[""],ko:[" "],ms_MY:["Pengesahan pesanan"],nl_NL:"Order confirmation",pl:["Potwierdzenie zlecenia"],pt:["Confirmao de ordem"],ro:"Order confirmation",ru:[" "],sv:["Orderbekrftelse"],th:[""],tr:["Emir onay"],vi:["Xc nhn vo lnh"],zh:[""],zh_TW:[""]}},163003:e=>{e.exports={ar:[" "],ca_ES:"Order info",cs:["Order Info"],de:["Order Info"],el:["Order Info"],en:"Order info",es:["Informacin de la orden"],fa:["Order Info"],fr:["Info sur l'ordre"],he_IL:[" "],hu_HU:["Order Info"],id_ID:["Info Order"],it:["Informazioni ordine"],ja:[""],ko:[" "],ms_MY:["Maklumat Pesanan"],nl_NL:["Order Info"],pl:["Informacje o zleceniu"],pt:["Informaes da ordem"],ro:["Order Info"],ru:["  "],sv:["Order Info"],th:[""],tr:["Emir Bilgisi"],vi:["Thng tin lnh"],zh:[""],zh_TW:[""]}},862349:e=>{e.exports={ar:["  "],ca_ES:"Order sent",cs:"Order sent",de:["Order abgeschickt"],el:"Order sent",en:"Order sent",es:["Orden enviada"],fa:"Order sent",fr:["Ordre envoy"],he_IL:[" "],hu_HU:"Order sent",id_ID:["Order terkirim"],it:["Ordine inviato"],ja:[""],ko:[" "],ms_MY:["Pesanan dihantar"],nl_NL:"Order sent",pl:["Przekazano zlecenie"],pt:["Ordem enviada"],ro:"Order sent",ru:[" "],sv:["Order skickad"],th:[""],tr:["Emir gnderildi"],vi:[" gi lnh"],zh:[""],zh_TW:[""]}},455897:e=>{e.exports={ar:[" "],ca_ES:"Order preview",cs:"Order preview",de:["Order Vorschau"],el:"Order preview",en:"Order preview",es:["Vista previa de las rdenes"],fa:"Order preview",fr:["Aperu de l'ordre"],he_IL:["   "],hu_HU:"Order preview",id_ID:["Kilas order"],it:["Anteprima ordine"],ja:[""],ko:[" "],ms_MY:["Pratonton pesanan"],nl_NL:"Order preview",pl:["Podgld zlecenia"],pt:["Pr-visualizao da ordem"],ro:"Order preview",ru:[" "],sv:["Order frhandsvisning"],th:[""],tr:["Emir nizleme"],vi:["Xem li lnh"],zh:[""],zh_TW:[""]}},145088:e=>{e.exports={ar:["       .               {brokerTitle}"],ca_ES:"Order price is too close to the market price. It can lead to placing wrong order type due to specifics of the order placement in {brokerTitle}",cs:"Order price is too close to the market price. It can lead to placing wrong order type due to specifics of the order placement in {brokerTitle}",de:["Der Orderpreis liegt zu nah am Marktpreis. Dies kann zu einer falschen Auftragsart aufgrund von Besonderheiten des Orderplacements von {brokerTitle} fhren."],
el:"Order price is too close to the market price. It can lead to placing wrong order type due to specifics of the order placement in {brokerTitle}",en:"Order price is too close to the market price. It can lead to placing wrong order type due to specifics of the order placement in {brokerTitle}",es:["El precio de la orden se acerca demasiado al precio de mercado. Puede conllevar que se coloque un tipo de orden incorrecto debido a detalles especficos en la colocacin de la orden en {brokerTitle}"],fa:"Order price is too close to the market price. It can lead to placing wrong order type due to specifics of the order placement in {brokerTitle}",fr:["Le prix de l'ordre est trop proche du prix du march. Cela peut conduire  placer un type d'ordre incorrect en raison des spcificits du placement de l'ordre dans {brokerTitle}"],he_IL:["     .              {brokerTitle}"],hu_HU:"Order price is too close to the market price. It can lead to placing wrong order type due to specifics of the order placement in {brokerTitle}",id_ID:["Harga order terlalu dekat dengan harga pasar. Ini dapat mengarah pada peletakan tipe order yang tidak tepat dikarenakan oleh ketentuan peletakkan order dari {brokerTitle}"],it:["Il prezzo d'ordine  troppo vicino al prezzo di mercato. Pu portare a sbagliare il tipo di ordine a causa delle specifiche tecniche per l'inserimento dell'ordine di {brokerTitle}"],ja:["{brokerTitle}"],ko:["     . {brokerTitle}            "],ms_MY:["Harga pesanan adalah terlalu dekat dengan harga pasaran. Ia boleh membawa kepada jenis pesanan yang salah disebabkan spesifikasi penempatan pesanan di {brokerTitle}"],nl_NL:"Order price is too close to the market price. It can lead to placing wrong order type due to specifics of the order placement in {brokerTitle}",pl:["Cena zlecenia jest za blisko ceny rynkowej. Moe to prowadzi do zoenia zego typu zlecenia ze wzgldu na specyfik skadania zlece w {brokerTitle}"],pt:["O preo da ordem est muito prximo do preo de mercado. Isso pode levar a uma entrada incorreta devido aos detalhes do posicionamento da ordem em {brokerTitle}"],ro:"Order price is too close to the market price. It can lead to placing wrong order type due to specifics of the order placement in {brokerTitle}",ru:["      .         -     {brokerTitle}"],sv:["Orderpriset r fr nra marknadspriset. Det kan leda till att en felaktig typ av order lggs p grund av detaljer kring placeringen av ordern hos {brokerTitle}"],th:["   {brokerTitle}"],tr:["Emir fiyat piyasa fiyatna ok yakn. {brokerTitle} 'daki emir verme zellikleri nedeniyle yanl emir tr verilmesine yol aabilir."],
vi:["Gi ca lnh qu gn vi gi th trng. Vic ny c th dn n vic t loi lnh sai do cc chi tit c th ca vic t lnh trong {brokerTitle}"],zh:[" {brokerTitle}"],zh_TW:[" {brokerTitle}"]}},445944:e=>{e.exports={ar:["       {min} {max}"],ca_ES:"Order price should be in the range of {min} and {max}",cs:"Order price should be in the range of {min} and {max}",de:["Der Order-Preis sollte im Bereich von {min} und {max} liegen"],el:"Order price should be in the range of {min} and {max}",en:"Order price should be in the range of {min} and {max}",es:["El precio de la orden debe estar entre {min} y {max}"],fa:"Order price should be in the range of {min} and {max}",fr:["Le prix de l'ordre doit tre compris entre {min} et {max}."],he_IL:["      {min} -{max}"],hu_HU:"Order price should be in the range of {min} and {max}",id_ID:["Harga order harus berada dalam rentang {min} dan {max}"],it:["Il prezzo d'ordine dovrebbe oscillare tra {min} e {max}"],ja:[" {min}  {max} "],ko:["  {min}  {max}  ."],ms_MY:["Harga pesanan hendaklah di dalam julat {min} dan {max}"],nl_NL:"Order price should be in the range of {min} and {max}",pl:["Cena zlecenia powinna mieci si w przedziale {min} i {max}"],pt:["O valor da ordem deve estar no intervalo de {min} a {max}"],ro:"Order price should be in the range of {min} and {max}",ru:["     {min}  {max}"],sv:["Orderpriset br ligga inom intervallet {min} och {max}."],th:[" {min}  {max}"],tr:["Emir fiyat {min} {max} aralnda olmaldr"],vi:["Gi phi trong khong {min} v {max}"],zh:["{min}{max}"],zh_TW:["{min}{max}"]}},127531:e=>{e.exports={ar:["  "],ca_ES:["Mida del lot"],cs:"Lot size",de:["Lot Gre"],el:"Lot size",en:"Lot size",es:["Tamao del lote"],fa:"Lot size",fr:["Taille du lot"],he_IL:[" "],hu_HU:"Lot size",id_ID:["Ukuran lot"],it:["Dimensione lotto"],ja:[""],ko:[" "],ms_MY:["Saiz lot"],nl_NL:"Lot size",pl:["Wielko lota"],pt:["Tamanho do lote"],ro:"Lot size",ru:[" "],sv:["Partistorlek"],th:[""],tr:["Birim bykl"],vi:["C lot"],zh:[""],zh_TW:[""]}},956220:e=>{e.exports={ar:[""],ca_ES:"Leverage",cs:"Leverage",de:["Hebelwirkung"],el:"Leverage",en:"Leverage",es:["Apalancamiento"],fa:"Leverage",fr:["Effet de levier"],he_IL:[""],hu_HU:"Leverage",id_ID:"Leverage",it:["Leva"],ja:[""],ko:[""],ms_MY:["Keumpilan"],nl_NL:"Leverage",pl:["Dwignia finansowa"],pt:["Alavancagem"],ro:"Leverage",ru:[" "],sv:["Hvstng"],th:[""],tr:["Kaldra"],vi:["n by"],zh:[""],zh_TW:[""]}},627262:e=>{e.exports={ar:[" "],ca_ES:"Limit price",cs:"Limit price",de:["Limitkurs"],el:"Limit price",en:"Limit price",es:["Precio Lmite"],fa:"Limit price",fr:["Prix limite"],he_IL:[" "],hu_HU:"Limit price",id_ID:["Harga limit"],it:["Prezzo limite"],ja:[""],ko:[" "],
ms_MY:["Harga Had"],nl_NL:"Limit price",pl:["Cena Limit"],pt:["Preo limit"],ro:"Limit price",ru:["-"],sv:["Limitpris"],th:[" Limit"],tr:["Limit fiyat"],vi:["Gi ch"],zh:[""],zh_TW:[""]}},768527:e=>{e.exports={ar:[""],ca_ES:"Modify",cs:"Modify",de:["ndern"],el:"Modify",en:"Modify",es:["Modificar"],fa:"Modify",fr:["Modifier"],he_IL:[""],hu_HU:["Mdosts"],id_ID:["Modifikasi"],it:["Modifica"],ja:[""],ko:[""],ms_MY:["Ubah Suai"],nl_NL:"Modify",pl:["Zmodyfikuj"],pt:["Modificar"],ro:"Modify",ru:[""],sv:["Modifiera"],th:[""],tr:["Dzenle"],vi:["Sa i"],zh:[""],zh_TW:[""]}},305806:e=>{e.exports={ar:[" "],ca_ES:"Modify order",cs:"Modify order",de:["Order bearbeiten"],el:"Modify order",en:"Modify order",es:["Modificar orden"],fa:"Modify order",fr:["Modifier l'ordre"],he_IL:[" "],hu_HU:"Modify order",id_ID:["Ubah order"],it:["Modifica ordine"],ja:[""],ko:[" "],ms_MY:["Ubah suai pesanan"],nl_NL:"Modify order",pl:["Modyfikuj zlecenie"],pt:["Modificar ordem"],ro:"Modify order",ru:[" "],sv:["ndra order"],th:[""],tr:["Emri deitir"],vi:["iu chnh lnh"],zh:[""],zh_TW:[""]}},470500:e=>{e.exports={ar:[""],ca_ES:"Money",cs:"Money",de:["Kapital"],el:"Money",en:"Money",es:["Dinero"],fa:"Money",fr:["Argent"],he_IL:[""],hu_HU:["Pnz"],id_ID:["Uang"],it:["Denaro"],ja:[""],ko:[""],ms_MY:["Wang"],nl_NL:"Money",pl:["Pienidze"],pt:["Dinheiro"],ro:"Money",ru:[""],sv:["Pengar"],th:[""],tr:["Para"],vi:["Tin"],zh:[""],zh_TW:[""]}},134569:e=>{e.exports={ar:["  {line_break}   "],ca_ES:"Select any field{line_break}to activate order placement",cs:"Select any field{line_break}to activate order placement",de:["Whlen Sie ein Feld aus,{line_break}um die Order-Platzierung zu aktivieren"],el:"Select any field{line_break}to activate order placement",en:"Select any field{line_break}to activate order placement",es:["Seleccione cualquier campo{line_break}para activar y cursar la orden"],fa:"Select any field{line_break}to activate order placement",fr:["Slectionnez un champ{line_break}pour activer le placement d'ordres"],he_IL:["  {line_break}    "],hu_HU:"Select any field{line_break}to activate order placement",id_ID:["Pilih bidang apa pun{line_break}untuk mengaktifkan penempatan order"],it:["Seleziona un campo qualsiasi{line_break} per attivare l'inserimento dell'ordine"],ja:["{line_break}"],ko:["   {line_break} ."],ms_MY:["Pilih mana-mana ruangan {line_break}untuk mengaktifkan penempatan pesanan"],nl_NL:"Select any field{line_break}to activate order placement",pl:["Wybierz dowolne pole,{line_break}aby aktywowa skadanie zlece"],pt:["Selecione qualquer campo{line_break}para ativar a colocao de ordem"],ro:"Select any field{line_break}to activate order placement",ru:["  ,{line_break}   "],
sv:"Select any field{line_break}to activate order placement",th:[" {line_break} "],tr:["Emir vermeyi etkinletirmek iin {line_break}herhangi bir alan sein"],vi:["Chn bt k trng no{line_break} kch hot vic t lnh"],zh:["{line_break}"],zh_TW:["{line_break}"]}},392553:e=>{e.exports={ar:[""],ca_ES:"Sell",cs:"Sell",de:["Verkauf"],el:"Sell",en:"Sell",es:["Vender"],fa:"Sell",fr:["Vendre"],he_IL:[""],hu_HU:["Elads"],id_ID:["Penjualan"],it:["Vendi"],ja:[""],ko:[""],ms_MY:["Jual"],nl_NL:"Sell",pl:["Sprzedaj"],pt:["Venda"],ro:"Sell",ru:[""],sv:["Slj"],th:[""],tr:["Sat"],vi:["Bn"],zh:[""],zh_TW:[""]}},68160:e=>{e.exports={ar:[""],ca_ES:["Enviar"],cs:"Send",de:["Senden"],el:"Send",en:"Send",es:["Enviar"],fa:"Send",fr:["Envoyer"],he_IL:[""],hu_HU:["Klds"],id_ID:["Kirim"],it:["Invia"],ja:[""],ko:[""],ms_MY:["Hantar"],nl_NL:"Send",pl:["Wylij"],pt:["Enviar"],ro:"Send",ru:[""],sv:["Skicka"],th:[""],tr:["Gnder"],vi:["Gi i"],zh:[""],zh_TW:[""]}},750441:e=>{e.exports={ar:[""],ca_ES:"Side",cs:"Side",de:["Seite"],el:"Side",en:"Side",es:["Lado"],fa:"Side",fr:["Ct"],he_IL:[""],hu_HU:["Oldal"],id_ID:["Arah"],it:["Lato"],ja:[""],ko:[""],ms_MY:["Sisi"],nl_NL:"Side",pl:["Strona"],pt:["Lado"],ro:"Side",ru:[""],sv:["Sida"],th:[""],tr:["Pozisyon"],vi:["Bn"],zh:["/"],zh_TW:["/"]}},905023:e=>{e.exports={ar:[""],ca_ES:"Stop",cs:"Stop",de:"Stop",el:"Stop",en:"Stop",es:"Stop",fa:"Stop",fr:"Stop",he_IL:[""],hu_HU:"Stop",id_ID:"Stop",it:"Stop",ja:[""],ko:[""],ms_MY:["Renti"],nl_NL:"Stop",pl:"Stop",pt:"Stop",ro:"Stop",ru:[""],sv:["Stopp"],th:[""],tr:"Stop",vi:["im ct l"],zh:[""],zh_TW:[""]}},802654:e=>{e.exports={ar:[" "],ca_ES:"Stop Limit",cs:"Stop Limit",de:"Stop Limit",el:"Stop Limit",en:"Stop Limit",es:"Stop Limit",fa:"Stop Limit",fr:"Stop Limit",he_IL:[" "],hu_HU:"Stop Limit",id_ID:"Stop Limit",it:"Stop Limit",ja:[""],ko:[" "],ms_MY:["Had Renti"],nl_NL:"Stop Limit",pl:["Zlecenie Stop Limit"],pt:["Stop Limite"],ro:"Stop Limit",ru:["-"],sv:["Stopgrns"],th:[""],tr:["Durdur Limit"],vi:["Lnh dng gii hn"],zh:[""],zh_TW:[""]}},722028:e=>{e.exports={ar:["  "],ca_ES:"Stop price",cs:"Stop price",de:["Stopkurs"],el:"Stop price",en:"Stop price",es:["Precio Stop"],fa:"Stop price",fr:["Prix darrt"],he_IL:[" "],hu_HU:"Stop price",id_ID:["Harga stop"],it:["Prezzo stop"],ja:[""],ko:[" "],ms_MY:["Harga henti"],nl_NL:"Stop price",pl:["Cena Stop"],pt:["Preo stop"],ro:"Stop price",ru:["-"],sv:["Stopp-pris"],th:[""],tr:["Dur fiyat"],vi:["Gi dng"],zh:[""],zh_TW:[""]}},589053:e=>{e.exports={ar:[""],ca_ES:["Smbol"],cs:"Symbol",de:"Symbol",el:[""],en:"Symbol",es:["Smbolo"],fa:[""],fr:["Symbole"],he_IL:[""],hu_HU:["Szimblum"],id_ID:["Simbol"],it:["Simbolo"],ja:[""],ko:[""],ms_MY:["Simbol"],nl_NL:["Symbool"],
pl:"Symbol",pt:["Smbolo"],ro:"Symbol",ru:[""],sv:"Symbol",th:[""],tr:["Sembol"],vi:["M"],zh:[""],zh_TW:[""]}},440339:e=>{e.exports={ar:["  "],ca_ES:"Position info",cs:["Position Info"],de:["Positions Info"],el:["Position Info"],en:"Position info",es:["Informacin de la posicin"],fa:["Position Info"],fr:["Info sur la position"],he_IL:["  "],hu_HU:["Position Info"],id_ID:["Info Posisi"],it:["Informazioni posizione"],ja:[""],ko:[" "],ms_MY:["Maklumat Kedudukan"],nl_NL:["Position Info"],pl:["Informacje o pozycji"],pt:["Informaes da posio"],ro:["Position Info"],ru:["  "],sv:["Positionsinfo"],th:[""],tr:["Pozisyon Bilgisi"],vi:["Thng tin V th"],zh:[""],zh_TW:[""]}},419489:e=>{e.exports={ar:[" "],ca_ES:"Pip value",cs:["Pip Value"],de:["Pip Wert"],el:["Pip Value"],en:"Pip value",es:["Valor del pip"],fa:["Pip Value"],fr:["Valeur du pip"],he_IL:[" "],hu_HU:["Pip Value"],id_ID:["Nilai Pip"],it:["Valore pip"],ja:["Pip"],ko:[" "],ms_MY:["Nilai Pip"],nl_NL:["Pip Value"],pl:["Warto pipsa"],pt:["Valor do Pip"],ro:["Pip Value"],ru:[" "],sv:["punktvrde"],th:[""],tr:["Pip Deeri"],vi:["Gi tr Pip"],zh:[""],zh_TW:[""]}},25684:e=>{e.exports={ar:[""],ca_ES:["Preu"],cs:["Cena"],de:["Preis"],el:[""],en:"Price",es:["Precio"],fa:[""],fr:["Prix"],he_IL:[""],hu_HU:["r"],id_ID:["Harga"],it:["Prezzo"],ja:[""],ko:[""],ms_MY:["Harga"],nl_NL:["Prijs"],pl:["Cena"],pt:["Preo"],ro:"Price",ru:[""],sv:["Pris"],th:[""],tr:["Fiyat"],vi:["Gi"],zh:[""],zh_TW:[""]}},356979:e=>{e.exports={ar:[""],ca_ES:"Reward",cs:"Reward",de:["Chance"],el:"Reward",en:"Reward",es:["Beneficio"],fa:"Reward",fr:["Rcompense"],he_IL:[""],hu_HU:["Hozam"],id_ID:["Perolehan"],it:["Rendimento"],ja:[""],ko:[""],ms_MY:["Ganjaran"],nl_NL:"Reward",pl:["Profit"],pt:["Retorno"],ro:"Reward",ru:[""],sv:"Reward",th:[""],tr:["dl"],vi:["Li nhun"],zh:[""],zh_TW:[""]}},563833:e=>{e.exports={ar:[""],ca_ES:["Risc"],cs:"Risk",de:["Risiko"],el:"Risk",en:"Risk",es:["Riesgo"],fa:"Risk",fr:["Risque"],he_IL:[""],hu_HU:["Kockzat"],id_ID:["Risiko"],it:["Rischio"],ja:[""],ko:[""],ms_MY:["Risiko"],nl_NL:"Risk",pl:["Ryzyko"],pt:["Risco"],ro:"Risk",ru:[""],sv:"Risk",th:[""],tr:"Risk",vi:["Ri ro"],zh:[""],zh_TW:[""]}},613937:e=>{e.exports={ar:[""],ca_ES:"Total",cs:["Celkem"],de:["Gesamt"],el:"Total",en:"Total",es:"Total",fa:"Total",fr:"Total",he_IL:['"'],hu_HU:["sszesen"],id_ID:"Total",it:["Totale"],ja:[""],ko:[""],ms_MY:["Jumlah"],nl_NL:"Total",pl:["Razem"],pt:"Total",ro:"Total",ru:[""],sv:["Totalt"],th:[""],tr:["Toplam"],vi:["Tng"],zh:[""],zh_TW:[""]}},696709:e=>{e.exports={ar:[" "],ca_ES:"Tick value",cs:"Tick value",de:["Tick Wert"],el:"Tick value",en:"Tick value",es:["Valor del tick"],fa:"Tick value",fr:["Valeur du tick"],he_IL:[" "],hu_HU:"Tick value",id_ID:["Nilai tick"],
it:["Valore tick"],ja:[""],ko:[" "],ms_MY:["Nilai tanda"],nl_NL:"Tick value",pl:["Warto ticka"],pt:["Valor do tick"],ro:"Tick value",ru:[" "],sv:["Kreditvrde"],th:[""],tr:["Sembol deeri"],vi:["Gi tr Tick"],zh:[""],zh_TW:["Tick"]}},207710:e=>{e.exports={ar:[" "],ca_ES:"Trade value",cs:["Trade Value"],de:["Trade Wert"],el:["Trade Value"],en:"Trade value",es:["Valor de la negociacin"],fa:["Trade Value"],fr:["Valeur du trade"],he_IL:[" "],hu_HU:["Trade Value"],id_ID:["Nilai Trade"],it:["Valore trade"],ja:[""],ko:[" "],ms_MY:["Nilai Dagangan"],nl_NL:["Trade Value"],pl:["Warto transakcji"],pt:["Valor negociado"],ro:["Trade Value"],ru:[" "],sv:["handelsvrde"],th:[""],tr:["lem Deeri"],vi:["Gi tr Giao dch"],zh:[""],zh_TW:[""]}},158416:e=>{e.exports={ar:[""],ca_ES:["Tipus"],cs:["Typ"],de:["Typ"],el:[""],en:"Type",es:["Tipo"],fa:[""],fr:"Type",he_IL:[""],hu_HU:["Tpus"],id_ID:["Tipe"],it:["Tipo"],ja:[""],ko:[""],ms_MY:["Jenis"],nl_NL:"Type",pl:["Typ"],pt:["Tipo"],ro:"Type",ru:[""],sv:["Typ"],th:[""],tr:["Tip"],vi:["Loi"],zh:[""],zh_TW:[""]}},698311:e=>{e.exports={ar:["            "],ca_ES:"You already have at least one working order that can affect this position",cs:"You already have at least one working order that can affect this position",de:["Sie haben bereits mindestens eine aktive Order, welche diese Position betreffen kann."],el:"You already have at least one working order that can affect this position",en:"You already have at least one working order that can affect this position",es:["Ya tiene al menos una orden abierta que puede afectar a esta posicin"],fa:"You already have at least one working order that can affect this position",fr:["Vous avez dj au moins un ordre actif pouvant affecter cette position"],he_IL:["          "],hu_HU:"You already have at least one working order that can affect this position",id_ID:["Anda telah memiliki setidaknya satu order bekerja yang dapat mempengaruhi posisi ini"],it:[" gi presente almeno un ordine attivo che pu avere un effetto su questa posizione"],ja:["1"],ko:["              "],ms_MY:["Anda sudah mempunyai sekurang-kurangnya satu perintah kerja yang boleh menjejaskan kedudukan ini"],nl_NL:"You already have at least one working order that can affect this position",pl:["Masz ju co najmniej jedno aktywne zlecenie, ktre moe wpyn na t pozycj"],pt:["Voc j tem pelo menos uma ordem ativa que pode afetar esta posio"],ro:"You already have at least one working order that can affect this position",ru:["      ,      "],sv:["Du har redan minst en arbetsorder som kan pverka den hr positionen"],th:[""],
tr:["Zaten bu pozisyonu etkileyebilecek en az bir ileyen emriniz var"],vi:["Bn  c t nht mt lnh ang hot ng c th nh hng n v th ny"],zh:[""],zh_TW:[""]}},278770:e=>{e.exports={ar:[" "],ca_ES:"in account currency",cs:"in account currency",de:["in Kontowhrung"],el:"in account currency",en:"in account currency",es:["en la divisa de la cuenta"],fa:"in account currency",fr:["dans la devise du compte"],he_IL:[" "],hu_HU:"in account currency",id_ID:["dalam mata uang akun"],it:["nella valuta del conto"],ja:[""],ko:[" "],ms_MY:["di dalam mata wang akaun"],nl_NL:"in account currency",pl:["w walucie konta"],pt:["na moeda da conta"],ro:"in account currency",ru:["  "],sv:["i kontovaluta"],th:[""],tr:["hesap para birimi cinsinden"],vi:["bng n v tin t ca ti khon"],zh:[""],zh_TW:[""]}},689544:e=>{e.exports={ar:[" "],ca_ES:"in symbol currency",cs:"in symbol currency",de:["in Symbolwhrung"],el:"in symbol currency",en:"in symbol currency",es:["en la divisa del smbolo"],fa:"in symbol currency",fr:["dans le symbole du compte"],he_IL:[" "],hu_HU:"in symbol currency",id_ID:["dalam mata uang simbol"],it:["nella valuta del simbolo"],ja:[""],ko:[" "],ms_MY:["di dalam mata wang simbol"],nl_NL:"in symbol currency",pl:["w walucie symbolu"],pt:["em moeda do smbolo"],ro:"in symbol currency",ru:["  "],sv:["i symbolvaluta"],th:[""],tr:["sembol para birimi cinsinden"],vi:["bng n v tin t ca m giao dch"],zh:[""],zh_TW:[""]}},35387:e=>{e.exports={ar:[""],ca_ES:"order",cs:"order",de:["Order"],el:"order",en:"order",es:["orden"],fa:"order",fr:["ordre"],he_IL:[""],hu_HU:"order",id_ID:"order",it:["ordine"],ja:[""],ko:[""],ms_MY:["pesanan"],nl_NL:"order",pl:["zlecenie"],pt:["ordem"],ro:"order",ru:[""],sv:"order",th:[""],tr:["emir"],vi:["lnh"],zh:[""],zh_TW:[""]}},518088:e=>{e.exports={ar:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",ca_ES:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",cs:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",de:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",el:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",en:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",es:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",fa:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",fr:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",he_IL:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",hu_HU:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",id_ID:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",it:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",
ja:["{symbol}{whitespaceNoBreak} {limitPrice}  {qty}{whitespaceNoBreak}"],ko:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",ms_MY:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",nl_NL:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",pl:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",pt:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",ro:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",ru:["{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}"],sv:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",th:["{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}"],tr:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",vi:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",zh:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT",zh_TW:"{qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT"}},111828:e=>{e.exports={ar:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",ca_ES:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",cs:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",de:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",el:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",en:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",es:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",fa:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",fr:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",he_IL:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",hu_HU:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",id_ID:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",it:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",ja:["{symbol}{whitespaceNoBreak} {stopPrice}  {qty}{whitespaceNoBreak}"],ko:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",ms_MY:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",nl_NL:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",pl:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",pt:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",ro:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",ru:["{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}"],sv:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",th:["{qty} {symbol} {whitespaceNoBreak} @{stopPrice} {whitespaceNoBreak} STP"],tr:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",vi:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",zh:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP",
zh_TW:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP"}},828749:e=>{e.exports={ar:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",ca_ES:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",cs:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",de:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",el:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",en:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",es:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",fa:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",fr:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",he_IL:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",hu_HU:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",id_ID:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",it:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",ja:["{symbol}{whitespaceNoBreak} {stopPrice}{whitespaceNoBreak} {limitPrice}  {qty}{whitespaceNoBreak}"],ko:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",ms_MY:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",nl_NL:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",pl:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",pt:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",ro:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",ru:["{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak} {limitPrice}{whitespaceNoBreak}"],sv:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",th:["{qty} {symbol} {whitespaceNoBreak}@{stopPrice} {whitespaceNoBreak} {limitPrice} {whitespaceNoBreak} "],tr:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",vi:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",zh:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT",
zh_TW:"{qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT"}},896582:e=>{e.exports={ar:"{qty} {symbol}{whitespaceNoBreak}MKT",ca_ES:"{qty} {symbol}{whitespaceNoBreak}MKT",cs:"{qty} {symbol}{whitespaceNoBreak}MKT",de:"{qty} {symbol}{whitespaceNoBreak}MKT",el:"{qty} {symbol}{whitespaceNoBreak}MKT",en:"{qty} {symbol}{whitespaceNoBreak}MKT",es:"{qty} {symbol}{whitespaceNoBreak}MKT",fa:"{qty} {symbol}{whitespaceNoBreak}MKT",fr:"{qty} {symbol}{whitespaceNoBreak}MKT",he_IL:"{qty} {symbol}{whitespaceNoBreak}MKT",hu_HU:"{qty} {symbol}{whitespaceNoBreak}MKT",id_ID:"{qty} {symbol}{whitespaceNoBreak}MKT",it:"{qty} {symbol}{whitespaceNoBreak}MKT",ja:["{symbol}{whitespaceNoBreak} {qty}"],ko:"{qty} {symbol}{whitespaceNoBreak}MKT",ms_MY:"{qty} {symbol}{whitespaceNoBreak}MKT",nl_NL:"{qty} {symbol}{whitespaceNoBreak}MKT",pl:"{qty} {symbol}{whitespaceNoBreak}MKT",pt:"{qty} {symbol}{whitespaceNoBreak}MKT",ro:"{qty} {symbol}{whitespaceNoBreak}MKT",ru:["{qty} {symbol}{whitespaceNoBreak}."],sv:"{qty} {symbol}{whitespaceNoBreak}MKT",th:["{qty} {symbol}{whitespaceNoBreak}"],tr:"{qty} {symbol}{whitespaceNoBreak}MKT",vi:"{qty} {symbol}{whitespaceNoBreak}MKT",zh:"{qty} {symbol}{whitespaceNoBreak}MKT",zh_TW:"{qty} {symbol}{whitespaceNoBreak}MKT"}}}]);