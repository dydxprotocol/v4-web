(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[4876],{51922:()=>{},48497:t=>{t.exports={"css-value-widgetbar-tabs-width":"45px","css-value-widgetbar-border-width":"1px"}},23523:t=>{t.exports={"css-value-widgets-margin":"4px",widget:"widget-1quyc-Kt",widgetHeader:"widgetHeader-1quyc-Kt",widgetTitle:"widgetTitle-1quyc-Kt",headerSpace:"headerSpace-1quyc-Kt"}},4839:()=>{},10090:()=>{},14750:t=>{t.exports={container:"container-3CL4Geq2",mirror:"mirror-3CL4Geq2",background:"background-3CL4Geq2",arrow:"arrow-3CL4Geq2"}},24816:t=>{t.exports={wrap:"wrap-379NmUSU",scrollWrap:"scrollWrap-379NmUSU",noScrollBar:"noScrollBar-379NmUSU",content:"content-379NmUSU",icon:"icon-379NmUSU",scrollBot:"scrollBot-379NmUSU",scrollTop:"scrollTop-379NmUSU",isVisible:"isVisible-379NmUSU",iconWrap:"iconWrap-379NmUSU",fadeBot:"fadeBot-379NmUSU",fadeTop:"fadeTop-379NmUSU"}},64656:t=>{t.exports={button:"button-2OmDro4I",icon:"icon-2OmDro4I"}},36427:t=>{t.exports={filler:"filler-1ggHJ4cQ"}},74423:t=>{t.exports={toolbar:"toolbar-OvhMiobx",isGrayed:"isGrayed-OvhMiobx"}},49761:t=>{t.exports={separator:"separator-3YbwEKtL"}},61552:t=>{t.exports={button:"button-DABaJZo4",hover:"hover-DABaJZo4",hoverMask:"hoverMask-DABaJZo4",icon:"icon-DABaJZo4",counterRow:"counterRow-DABaJZo4",counter:"counter-DABaJZo4",isGrayed:"isGrayed-DABaJZo4",isActive:"isActive-DABaJZo4",isTab:"isTab-DABaJZo4"}},66517:t=>{t.exports={wrapper:"wrapper-2eb-SI2I",touch:"touch-2eb-SI2I"}},21659:(t,e,i)=>{"use strict";i.d(e,{Icon:()=>n});var s=i(67294);const n=s.forwardRef((t,e)=>{const{icon:i="",...n}=t;return s.createElement("span",{...n,ref:e,dangerouslySetInnerHTML:{__html:i}})})},708:(t,e,i)=>{"use strict";i.d(e,{makeCancelable:()=>n,isCancelled:()=>a});class s{}function n(t){let e=!1;return{promise:new Promise((i,n)=>{t.then(t=>e?n(new s):i(t)),t.catch(t=>n(e?new s:t))}),cancel(){e=!0}}}function a(t){return t instanceof s}},89493:(t,e,i)=>{"use strict";i.r(e),i.d(e,{WidgetBar:()=>Ht});var s=i(25038),n=i(16282),a=(i(51922),i(48497),i(74245)),o=i(60028),r=i(67294),l=i(73935),h=i(19160),d=i.n(h);const c={isActive:!1,notificationCount:0};class g{constructor(t){const e={...c,...t};this.isActive=new(d())(e.isActive),this.notificationsCount=new(d())(e.notificationCount),this.icon=new(d())(e.icon),this.hint=new(d())(e.hint),this.onClick=new(d())(e.onClick),this.TabButtonComponent=t.TabButtonComponent}onActiveStateChange(t){this.isActive.setValue(t)}updateNotifications(t){this.notificationsCount.setValue(t)}}var u=i(31683),p=i(21726),_=i(32500),m=i(23523);const v=parseInt(m["css-value-widgets-margin"]),w={reuters_calendar:{title:(0,a.t)("Economic Calendar"),ctor:null,lazyLoad:!0,icon:"economic-calendar",options:{widgetType:"widgetbar"}},earnings_calendar:{title:(0,a.t)("Earnings Calendar"),ctor:null,lazyLoad:!0,icon:"earnings-calendar"},watchlist:{title:(0,a.t)("Watchlist"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,emptyHeader:!0,widgetClass:m.widget,headerClass:m.widgetHeader,margin:v,preloadDelay:6e4},hotlist:{title:(0,a.t)("Hotlist"),ctor:null,lazyLoad:!0,
chartWidgetAllowed:!0,emptyHeader:!0,widgetClass:m.widget,headerClass:m.widgetHeader,margin:v},detail:{title:(0,a.t)("Details"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,widgetClass:m.widget,headerClass:m.widgetHeader,margin:v,emptyHeader:!0},news:{title:(0,a.t)("Headlines"),ctor:null,noHeaderSpace:!0,widgetClass:m.widget,headerClass:m.widgetHeader,titleClass:m.widgetTitle,margin:v},chat:{title:(0,a.t)("Talks"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0},messages:{title:(0,a.t)("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0},messages_with_select:{title:(0,a.t)("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0,options:{layoutWithSelect:!0},emptyHeader:!0},notifications_user:{title:(0,a.t)("Notifications"),ctor:null,options:{type:"user"},chartWidgetAllowed:!0},notifications_following:{title:(0,a.t)("Ideas Stream"),ctor:null,options:{type:"following"},chartWidgetAllowed:!0},datawindow:{title:(0,a.t)("Data Window"),ctor:null,chartWidgetAllowed:!0,chartWidgetRequired:!0},publicchats:{title:(0,a.t)("All Talks"),ctor:null,doNotClearNotifications:!0},publicchats_with_select:{title:(0,a.t)("All Talks"),ctor:null,doNotClearNotifications:!0,options:{layoutWithSelect:!0},emptyHeader:!0},notes:{title:(0,a.t)("My Ideas"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},alerts_manage:{ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,emptyHeader:!0,noHeaderSpace:!0,widgetClass:m.widget,headerClass:m.widgetHeader,margin:v},alerts_log:{ctor:null,chartWidgetAllowed:!0,emptyHeader:!0,noHeaderSpace:!0,widgetClass:m.widget,headerClass:m.widgetHeader,margin:v},market_summary:{title:(0,a.t)("Market Summary"),ctor:null},object_tree:{title:(0,a.t)("Object tree. Multi-select drawings tools"),ctor:null,noHeader:!0,chartWidgetAllowed:!0,chartWidgetRequired:!0},streams:{title:(0,a.t)("Streams"),ctor:null,emptyHeader:!0,widgetClass:m.widget,headerClass:m.widgetHeader,margin:v,doNotClearNotifications:!0,doNotClearNotificationsOnVisibilityChange:!0}},b={base:u};b["object-tree"]=p,b.datawindow=_;var f=i(94184),y=i.n(f),C=i(62419),B=i(21526),S=i.n(B),T=i(79442),W=i(64879),P=i(42254),x=i(69671);class M{constructor(t){this._settingsKey=null,this._value=null,t&&t.settingsKey&&(this._settingsKey=t.settingsKey,this._value=x.getJSON(this._settingsKey,null)),t&&t.widgetBarWidget&&Object.defineProperty(this,"widgetBarWidget",{value:t.widgetBarWidget,configurable:!0})}value(){return this._value}setValue(t,e){return this._value=t,this._settingsKey&&(null==t?((0,P.trackEvent)("Settings debug","WigdetProperties.setValue: "+this._settingsKey,window.user.username),x.remove(this._settingsKey)):x.setJSON(this._settingsKey,t,e)),this._value}}var H,L=i(13951);const E=new((H=class t{postMessage(e,i){t._handlers.forEach(t=>{t.handler(e,i)})}onMessage(e){"function"==typeof e&&t._handlers.push({handler:e,widget:this})}offMessage(e){if("function"==typeof e){const i=t._handlers.findIndex(t=>t.handler===e);-1!==i&&t._handlers.splice(i,1)}}offWidget(e){t._handlers=t._handlers.filter(t=>t.widget!==e)}})._handlers=[],
H);var z=i(80068),N=i(37808);class A{constructor(t){this.heightRatio=A.heightRatio,this.minHeight=0,this.widgetConfig=null,this.widgetActive=new(d()),this.widgetMaximized=new(d()),this.widgetVisible=null,this.symbolLinking=null,this.intervalLinking=null,this._header=null,this._widget=null,this._headerIcon=null,this._headerspace=null,this._title=null,this._resizehandle=null,this._widgetStarted=new(S()),this._resizer=null,this._internalState={alive:new(d())(!0),container:new(d()),width:new(d()),height:new(d()),detachable:new(d())(!1)},t&&t.widgetBarPage&&(this.widgetBarPage=t.widgetBarPage),this._rdState=new C.ResizerDetacherState(this._internalState),this._rdState.owner.subscribe(t=>{t!==this._internalState&&(this._internalState.container.value().innerHTML="")})}element(t){switch(t){case"widget":return this._widget;case"header":return this._header;case"resize-handle":return this._resizehandle;default:return null}}setHeight(t){this._internalState.container.value()&&(this._internalState.container.value().style.height=t+"px"),this._internalState.height.setValue(t)}onWidthChange(t){this._internalState.width.setValue(t)}remove(){this.widgetBarPage&&this.widgetBarPage.removeWidget(this)}destroy(){var t,e,i,s,n,a;this.widgetObject&&"destroy"in this.widgetObject&&this.widgetObject.destroy(),this.remove(),this.symbolLinking&&(this.symbolLinking.destroy(),this.symbolLinking=null),this.intervalLinking&&(this.intervalLinking.destroy(),this.intervalLinking=null),this.widgetVisible&&(this.widgetVisible.unsubscribe(),this.widgetVisible=null),this.widgetActive&&(this.widgetActive.unsubscribe(),this.widgetActive=null),this.widgetMaximized&&(this.widgetMaximized.unsubscribe(),this.widgetMaximized=null),null===(t=this._header)||void 0===t||t.remove(),null===(e=this._widget)||void 0===e||e.remove(),null===(i=this._headerIcon)||void 0===i||i.remove(),null===(s=this._headerspace)||void 0===s||s.remove(),null===(n=this._title)||void 0===n||n.remove(),null===(a=this._resizehandle)||void 0===a||a.remove(),this._header=null,this._widget=null,this._headerIcon=null,this._headerspace=null,this._title=null,this._resizehandle=null,E.offWidget(this),this._preloadTimeout&&clearTimeout(this._preloadTimeout)}rdState(){return this._rdState}onActiveStateChange(t){var e;const i=(this.getWidgetBarOption("widgetConfig")||w)[this.type];t&&!i.doNotClearNotifications&&this.clearNotifications(),this.updateVisibleWatchedValue(),null===(e=this.widgetActive)||void 0===e||e.setValue(!!t)}toggleMaximize(t){var e,i,s;const n="boolean"!=typeof t?!(null===(e=this.widgetMaximized)||void 0===e?void 0:e.value()):t;n!==(null===(i=this.widgetMaximized)||void 0===i?void 0:i.value())&&(null===(s=this.widgetMaximized)||void 0===s||s.setValue(n),this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&this.widgetBarPage.widgetBarLayout.widgetBar.saveToTVSettings(),this.widgetBarPage&&this.widgetBarPage.updateWidgetsHeight())}startWidget(){var t;if(this.widgetObject||this.widgetStartDelayed)return;if(!this.id)return
;const e=this.getWidgetBarOption("widgetConfig")||w;if(!this.type)return;const i=e[this.type];if(!i)return;const s=i.ctor;if(!s)return;if(this.widgetVisible=this.widgetVisible||new(d()),this.updateVisibleWatchedValue(),i.lazyLoad&&!this.widgetVisible.value())return this.widgetStartDelayed=!0,this.widgetVisible.when(()=>{delete this.widgetStartDelayed,this.startWidget(),clearTimeout(this._preloadTimeout)}),void(i.preloadDelay&&(this._preloadTimeout=setTimeout(()=>{s.preload&&s.preload()},i.preloadDelay)));this.symbolLinking=T.linking.symbol.spawn(),this.intervalLinking=T.linking.interval.spawn();const a=this._rdState.bridge(),o={...{},header:(0,n.ensureNotNull)(this._header),headerspace:this._headerspace,widget:(0,n.ensureNotNull)(this._widget),container:a.container.value(),properties:this.properties,notify:this.notify.bind(this),clearNotifications:this.clearNotifications.bind(this),visible:this.widgetVisible.readonly(),active:(0,n.ensureNotNull)(this.widgetActive).readonly(),symbol:this.symbolLinking,interval:this.intervalLinking,height:a.height,setMinHeight:this.setMinHeight.bind(this),width:a.width,setTitle:this.setTitle.bind(this),setTitleHtml:this.setTitleHtml.bind(this),id:this.id,toggleMaximize:this.toggleMaximize.bind(this),maximized:(0,n.ensureNotNull)(this.widgetMaximized).readonly(),postMessage:E.postMessage.bind(this),onMessage:E.onMessage.bind(this),offMessage:E.offMessage.bind(this),hideDetach:!1,unAuthEditable:this.unAuthEditable};if(i.chartWidgetAllowed){const t=()=>this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&this.widgetBarPage.widgetBarLayout.widgetBar.chartWidgetCollection;o.getChartWidget=()=>{const e=t();return e?e.activeChartWidget.value():null},o.getChartWidgetCollection=()=>t()||null}void 0!==this.readonly?this.readonly&&(o.readonly=!0):this.getWidgetBarOption("readonly")&&(o.readonly=!0),void 0!==i.options&&(o.options=i.options),null!=this.stateData?o.data=this.stateData:null!=i.data&&(o.data=i.data);const r=this.widgetObject=new s(o);"hasLifecycle"in r&&(null===(t=this.widgetActive)||void 0===t||t.readonly().subscribe(t=>{t?r.mount():r.unmount()},{callWithLast:!i.lazyLoad})),this._widgetStarted.fire(this)}widgetStarted(){return this._widgetStarted}notify(t,e={}){if(this.widgetBarPage&&(!this.widgetBarPage.isActiveAndVisible()||e.force))return this.widgetBarPage.notify(t,e)}clearNotifications(){if(this.widgetBarPage)return this.widgetBarPage.clearNotifications()}onVisibilityChange(){this.updateVisibleWatchedValue()}updateVisibleWatchedValue(){this.widgetVisible&&this.widgetVisible.setValue(!!this.widgetBarPage&&this.widgetBarPage.isActiveAndVisible())}setTitle(t){this.customTitle=String(t),this._title&&(this._title.textContent=this.getTitle())}setTitleHtml(t){this._title&&(0,L.html)(this._title,t)}setMinHeight(t){const e=this.widgetBarPage;e&&(this.minHeight=0,this.minHeight=Math.min(t,e.getAvailableHeight()),e.updateWidgetsHeight())}getWidgetBarOption(t){
if(this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&t in this.widgetBarPage.widgetBarLayout.widgetBar)return this.widgetBarPage.widgetBarLayout.widgetBar[t]}getTitle(t){const e=function(t,e){var i,s;try{let n=null===(i=(e=e||w)[t])||void 0===i?void 0:i.title;return!n&&t&&(n=null===(s=String(t).match(/[A-Z]{2,}|\d+(?:\.\d+)?|[A-Z]?[a-z]+/g))||void 0===s?void 0:s.join(" ").replace(/^.|\s./g,t=>t.toUpperCase())),n||void 0}catch(t){return}}(this.type,this.getWidgetBarOption("widgetConfig"));return t&&this.customTitle&&e?this.customTitle.substring(0,e.length)===e?this.customTitle:e+": "+this.customTitle:this.customTitle||e||(0,a.t)("Widget")}createHTML(){const t=!!this.widgetConfig&&(!!this.widgetConfig.icon&&this.widgetConfig.icon),e=this.widgetConfig&&this.widgetConfig.emptyHeader,i=this.widgetConfig&&this.widgetConfig.noHeader,s=this.widgetConfig&&this.widgetConfig.noHeaderSpace,n=this.widgetConfig&&this.widgetConfig.widgetClass||"",a=this.widgetConfig&&this.widgetConfig.headerClass||"",o=this.widgetConfig&&this.widgetConfig.titleClass||"",r=this._widget=document.createElement("div");r.classList.value=y()(n,"widgetbar-widget","widgetbar-widget-"+this.type);const l=this._header=document.createElement("div");if(l.classList.value=a||"widgetbar-widgetheader",l.addEventListener("contextmenu",t=>{"input"!==t.target.tagName.toLowerCase()&&t.preventDefault()}),i||r.appendChild(l),t){const e=this._headerIcon=document.createElement("div");e.classList.value="widgetbar-widgetheader-icon widgetbar-widgetheader-icon-"+t,e.appendChild((0,W.parseHtml)(b[t])),l.appendChild(e)}if(!s){const t=this._headerspace=document.createElement("div");t.classList.value="widgetbar-headerspace",t.addEventListener("click",t=>t.preventDefault()),l.appendChild(t)}if(!e){const t=this._title=document.createElement("div");t.classList.value=y()("widgetbar-widgettitle",o),t.dataset.name=this.type+"_header",t.textContent=this.getTitle(),l.appendChild(t)}const h=document.createElement("div");h.classList.value="widgetbar-widgetbody",h.addEventListener("contextmenu",t=>{t.target===h&&t.preventDefault()}),r.appendChild(h),this._internalState.container.setValue(h);const d=this._resizehandle=document.createElement("div");d.classList.value="widgetbar-widgethandle",d.addEventListener("contextmenu",t=>{t.target===d&&t.preventDefault()}),null!==this._resizer&&this._resizer.destroy(),this._resizer=new N.PointerBackend({handle:d,onDragStart:t=>{var e;null===(e=this.widgetBarPage)||void 0===e||e.handleWidgetResizeStart(this,t)},onDragMove:t=>{var e;null===(e=this.widgetBarPage)||void 0===e||e.handleWidgetResizeChange(this,t)},onDragStop:t=>{var e;null===(e=this.widgetBarPage)||void 0===e||e.handleWidgetResizeStop(this,t)}}),r.appendChild(d),!0===this.maximized&&(this.toggleMaximize(!0),delete this.maximized)}demarshal(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}if(!t||"object"!=typeof t)return null;let e;if("id"in t?(this.id=String(t.id),
this.type=this.id.replace(/\..*/,"")):"type"in t?(this.type=String(t.type),this.id=this.type+"."+(0,z.randomHash)()):(delete this.type,delete this.id),null!=t.readonly?this.readonly=!!t.readonly:delete this.readonly,this.stateData=t.data,isFinite(Number(t.heightRatio))&&Number(t.heightRatio)>=0?this.heightRatio=Number(t.heightRatio):this.heightRatio=A.heightRatio,!0===t.maximized&&(this.maximized=!0),!0===t.unAuthEditable&&(this.unAuthEditable=!0),t.settingsKey)e=String(t.settingsKey);else if(this.id){const t=this.getWidgetBarOption("_settingsPrefix");t&&(e=t+".widget."+this.id)}if(this.properties=new M({widgetBarWidget:this,settingsKey:e}),null==t.properties||e&&null!==this.properties.value()||this.properties.setValue(t.properties),"news"!==this.type&&"hotlist"!==this.type||!e||this.properties.setValue((0,s.default)({},t.properties,this.properties.value())),"hotlist"===this.type)if(!e&&t.properties)this.properties.setValue(t.properties);else{const t=this.properties.value();("exchangeByLocale"in t||"groupByLocale"in t)&&(delete t.exchangeByLocale,delete t.groupByLocale,this.properties.setValue(t))}this.widgetConfig=null;const i=this.getWidgetBarOption("widgetConfig");return this.type&&i&&i[this.type]&&(this.widgetConfig=i[this.type]),this}marshal(){var t;const e={};return this.id&&(e.id=this.id),this.type&&(e.type=this.type),this.heightRatio!==A.heightRatio&&(e.heightRatio=this.heightRatio),(null===(t=this.widgetMaximized)||void 0===t?void 0:t.value())&&(e.maximized=!0),e}}A.heightRatio=1;class V{constructor(t){this.widgets=[],this.notificationCounter=0,this._page=null,this._invalidated=!1,this._resizeOperations=new WeakMap,this.widgets=[],t&&t.widgetBarLayout&&(this.widgetBarLayout=t.widgetBarLayout)}widget(t){for(const e of this.widgets)if(e.type===t)return e;return null}element(){return this._page}gaEvent(){return this._gaEvent}onActiveStateChange(t){var e;t=!!t,null===(e=this._page)||void 0===e||e.classList.toggle("active",!!t),(0,n.ensure)(this.tab).onActiveStateChange(t),t&&this.updateWidgetsHeight({skipIfHeightUnchanged:!0}),this.widgets.forEach(e=>{e.onActiveStateChange(t)})}getAvailableHeight(){var t,e;let i=(null===(e=null===(t=this.widgetBarLayout)||void 0===t?void 0:t.widgetBar)||void 0===e?void 0:e.resizerBridge.height.value())||0;if(!i)return 0;let s=0;return this.widgets.forEach((t,e)=>{if(i-=t.minHeight,e>0){const e=t.widgetConfig&&t.widgetConfig.margin||1;i-=e}const n=t.element("header");n&&(s||(s=(0,L.outerHeight)(n,!0)),i-=s)}),Math.max(i,0)}updateWidgetsHeight(t={}){if(!this._page)return;if(!this.widgetBarLayout||!this.widgetBarLayout.widgetBar)return;if(this.widgetBarLayout.getActivePage()!==this)return void(this._invalidated=!0);const e=this.widgetBarLayout.widgetBar.resizerBridge.height.value();if(this._pageHeight===e&&t.skipIfHeightUnchanged||(this._invalidated=!0,this._pageHeight=e),!this._invalidated)return;let i,s=e,a=0,o=this.widgets,r=null;const l=o.every(t=>0===t.heightRatio);for(let t=this.widgets.length;t--;)if((0,n.ensureNotNull)(this.widgets[t].widgetMaximized).value()){
r=this.widgets[t];break}if(o.length>0&&null===r&&l){const t=o[o.length-1];t.heightRatio=1,r=t}if(r){for(let t=this.widgets.length;t--;){const e=o[t];e!==r&&e.setHeight(0)}o=[r]}for(let t=o.length-1;t>0;t--){const e=o[t];s-=e.widgetConfig&&e.widgetConfig.margin||1}for(let t=o.length;t--;){const e=o[t],n=e.element("header");n&&(void 0===i&&(i=(0,L.outerHeight)(n,!0)),s-=i,a+=e.heightRatio)}const h=s/a;this._recalculateWidgetsHeightRatio(h);const d=o.length-1;for(let t=0;t<=d;t++){const e=o[t];let i;i=t===d?s:Math.round(h*e.heightRatio),i=Math.max(i,e.minHeight),e.setHeight(i),s-=i}}handleWidgetResizeStart(t,e){let i,s;for(let e=this.widgets.length-1;e>0;e--)this.widgets[e]===t&&(i=this.widgets[e],s=this.widgets[e-1]);(0,n.assert)(void 0!==i),(0,n.assert)(void 0!==s);const a=s.rdState().bridge().height.value(),o=s.heightRatio+i.heightRatio,r=a+i.rdState().bridge().height.value();0===r&&e.preventDefault(),this._resizeOperations.set(t,{bottomWidget:i,topWidget:s,summaryHeight:r,summaryRatio:o,startTopWidgetHeight:a,prevTopWidgetHeight:void 0})}handleWidgetResizeChange(t,e){var i;const s=this._resizeOperations.get(t);if(void 0===s)return;null===(i=this._page)||void 0===i||i.classList.add("widget-resize-mode");const{current:n,initial:a}=e.detail,o=n.pageY-a.pageY,r=Math.max(s.topWidget.minHeight,Math.min(s.startTopWidgetHeight+o,s.summaryHeight-s.bottomWidget.minHeight));s.prevTopWidgetHeight!==r&&(s.prevTopWidgetHeight=r,s.topWidget.heightRatio=r/s.summaryHeight*s.summaryRatio,s.bottomWidget.heightRatio=s.summaryRatio-s.topWidget.heightRatio,s.topWidget.setHeight(r),s.bottomWidget.setHeight(s.summaryHeight-r))}handleWidgetResizeStop(t,e){var i;const s=this._resizeOperations.get(t);void 0!==s&&(this._resizeOperations.delete(t),null===(i=this._page)||void 0===i||i.classList.remove("widget-resize-mode"),s.prevTopWidgetHeight!==s.startTopWidgetHeight&&(this.normalizeRatios(),this.widgetBarLayout&&this.widgetBarLayout.widgetBar&&this.widgetBarLayout.widgetBar.saveToTVSettings()))}normalizeRatios(){let t=1/0;for(let e=this.widgets.length;e--;){const i=this.widgets[e].heightRatio;i<=0||!isFinite(i)||i<t&&(t=i)}if(!isFinite(t))return;let e=1;for(;t<1;)t*=2,e*=2;for(;t>=2;)t/=2,e/=2;for(let t=this.widgets.length;t--;)this.widgets[t].heightRatio*=e}attachWidget(t,e){var i;e=Number(e);const s=this.widgets.indexOf(t);-1!==s?this.widgets.splice(s,1):t.widgetBarPage&&t.widgetBarPage!==this&&t.widgetBarPage.removeWidget(t),e<this.widgets.length?e<0&&(e=0):e=this.widgets.length,delete t.widgetBarPage,Object.defineProperty(t,"widgetBarPage",{value:this,configurable:!0}),this.widgets.splice(e,0,t);const n=this.widgets[e+1],a=t.element("widget");n?a&&a.insertAdjacentElement("beforebegin",n.element("widget")):a&&(null===(i=this._page)||void 0===i||i.appendChild(a)),this.updateWidgetsHeight(),t.updateVisibleWatchedValue()}removeWidget(t){var e;const i=this.widgets.indexOf(t);-1!==i&&(delete t.widgetBarPage,this.widgets.splice(i,1),null===(e=t.element("widget"))||void 0===e||e.remove(),this.updateWidgetsHeight())}remove(){
this.widgetBarLayout&&this.widgetBarLayout.removePage(this)}destroy(){var t;this.remove(),null===(t=this._page)||void 0===t||t.remove()}onVisibilityChange(t){const e=t&&this.widgetBarLayout&&this.widgetBarLayout.getActivePage()===this;this.widgets.forEach(t=>{const i=t.getWidgetBarOption("widgetConfig")[t.type];e&&!i.doNotClearNotificationsOnVisibilityChange&&t.clearNotifications(),t.onVisibilityChange()})}notify(t,e={}){!0!==e.clear?e.stopHighlightTab||(this.notificationCounter=this.notificationCounter+(~~t||1),this.updateNotifications(e.notificationValue)):this.clearNotifications()}clearNotifications(){this.notificationCounter=0,(0,n.ensure)(this.tab).updateNotifications(this.notificationCounter)}updateNotifications(t){const e="number"==typeof t?t:this.notificationCounter;(0,n.ensure)(this.tab).updateNotifications(e)}getWidgets(t){const e=[];for(let i=0;i<this.widgets.length;++i){const s=this.widgets[i];s.type===t&&e.push(s)}return e}isActiveAndVisible(){const t=this.widgetBarLayout;return!(!t||!t.visible)&&t.getActivePage()===this}createHTML(){const t=this._page=document.createElement("div");t.classList.value="widgetbar-page",this.widgets.forEach(e=>{e.createHTML();const i=e.element("widget");i&&t.appendChild(i)})}createTabButtonViewModel(){this.tab=new g({icon:b[this.icon],hint:this.title,onClick:t=>{this.widgetBarLayout&&this.widgetBarLayout.onTabClick(t,this)},TabButtonComponent:this.TabButtonComponent})}demarshal(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}if("object"!=typeof t||!t.widgets||!Array.isArray(t.widgets))return null;const e=this.widgets;return e.splice(0,e.length),this._gaEvent=t._gaEvent,this.title=t.title,this.name=t.name,this.icon=t.icon,this.spaceBottom=t.spaceBottom,this.spaceBottomText=t.spaceBottomText,this.onBottom=t.onBottom,this.TabButtonComponent=t.TabButtonComponent,this.createTabButtonViewModel(),t.widgets.forEach(t=>{const i=new A({widgetBarPage:this}).demarshal(t);i&&e.push(i)}),0===e.length?null:this}marshal(){const t=[];return this.widgets.forEach(e=>{const i=e.marshal();i&&t.push(i)}),0===t.length?null:t}_recalculateWidgetsHeightRatio(t){const e=this.widgets;e.length<=1||e.forEach((i,s)=>{if(t*i.heightRatio>=i.minHeight)return;let n=i.minHeight/t-i.heightRatio;for(let i=0;i<e.length;i++){if(i===s)continue;const a=e[i],o=a.heightRatio-a.minHeight/t;if(!(o<=0)&&(a.heightRatio-=Math.min(n,o),e[s].heightRatio+=Math.min(n,o),n-=o,n<=0))break}})}}var I=i(45697),D=i(89505),O=i(21659),k=i(64656),R=i(43101);function F(t){const e=f(t.className,k.button,t.isGrayed&&k.isGrayed);return r.createElement("div",{className:e,onClick:t.onClick,"data-role":"button","data-name":t.name},r.createElement(O.Icon,{className:k.icon,icon:R}))}var U=i(67046),q=i(61552);function j(t){t={isTab:!0,theme:q,...t};const{NotificationComponent:e=G}=t,i=f(t.className,t.theme.button,t.isTab&&t.theme.isTab,t.isActive&&t.theme.isActive,t.isGrayed&&t.theme.isGrayed,t.hint&&"apply-common-tooltip common-tooltip-vertical");return r.createElement("div",{className:i,title:t.hint,onClick:t.onClick,ref:t.reference,
"data-role":"button","data-name":t.name},r.createElement("div",{className:t.theme.hoverMask}),r.createElement(O.Icon,{icon:t.icon}),r.createElement("div",{className:t.theme.counterRow},r.createElement(e,{className:t.theme.counter,count:t.count,"data-name":"counter"})))}function G(t){return r.createElement("span",{className:t.className,"data-name":"counter"},t.count&&0!==t.count?t.count.toString():void 0)}var J=i(44521),K=i(27407),Z=i(73920);const Y=(0,a.t)("DOM"),X=(0,K.registryContextType)();class Q extends r.PureComponent{constructor(t,e){super(t,e),this._handleClick=()=>{const{setDomPanelVisibility:t}=(0,n.ensure)(this.context.widgetBar.tradingPanelAccessor);t(!this.state.isActive)},this._handleIsOpenedChange=()=>{this.setState({isActive:this._tradingPanel.isPageOpened(J.TradingPage.DomPanel)})},this._handleActivePageChange=t=>{this._tradingPanel.isOpened.value()&&this.setState({isActive:t===J.TradingPage.DomPanel})},(0,K.validateRegistry)(e,{widgetBar:I.any.isRequired}),this._tradingPanel=(0,n.ensure)(this.context.widgetBar.tradingPanelAccessor).tradingPanel,this.state={isActive:this._tradingPanel.isPageOpened(J.TradingPage.DomPanel)}}componentDidMount(){this._tradingPanel.isOpened.subscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.subscribe(this._handleActivePageChange)}componentWillUnmount(){this._tradingPanel.isOpened.unsubscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.unsubscribe(this._handleActivePageChange)}render(){return r.createElement(j,{...this.props,icon:Z,hint:Y,isActive:this.state.isActive,onClick:this._handleClick})}}Q.contextType=X;var $=i(34525);const tt=(0,a.t)("Order Panel"),et=(0,K.registryContextType)();class it extends r.PureComponent{constructor(t,e){super(t,e),this._handleClick=()=>{const{setOrderPanelVisibility:t}=(0,n.ensure)(this.context.widgetBar.tradingPanelAccessor),e=!this.state.isActive;t(e),e&&(0,P.trackEvent)("GUI","Open Order Panel")},this._handleIsOpenedChange=()=>{this.setState({isActive:this._tradingPanel.isPageOpened(J.TradingPage.OrderPanel)})},this._handleActivePageChange=t=>{this._tradingPanel.isOpened.value()&&this.setState({isActive:t===J.TradingPage.OrderPanel})},(0,K.validateRegistry)(e,{widgetBar:I.any.isRequired}),this._tradingPanel=(0,n.ensure)(this.context.widgetBar.tradingPanelAccessor).tradingPanel,this.state={isActive:this._tradingPanel.isPageOpened(J.TradingPage.OrderPanel)}}componentDidMount(){this._tradingPanel.isOpened.subscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.subscribe(this._handleActivePageChange)}componentWillUnmount(){this._tradingPanel.isOpened.unsubscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.unsubscribe(this._handleActivePageChange)}render(){return r.createElement(j,{...this.props,icon:$,hint:tt,isActive:this.state.isActive,onClick:this._handleClick})}}it.contextType=et;var st=i(49761);function nt(t){return r.createElement("div",{className:f(t.className,st.separator)})}var at=i(36427);function ot(t){return r.createElement("div",{className:f(at.filler,t.className)})}
function rt(t,e){return class extends r.PureComponent{constructor(t){super(t),this._bindedForceUpdate=()=>this.forceUpdate(),this.state={viewModel:e}}componentDidMount(){const{viewModel:t}=this.state;t.notificationsCount.subscribe(this._bindedForceUpdate),t.isActive.subscribe(this._bindedForceUpdate)}componentWillUnmount(){const{viewModel:t}=this.state;t.notificationsCount.unsubscribe(this._bindedForceUpdate),t.isActive.unsubscribe(this._bindedForceUpdate)}render(){const{viewModel:e}=this.state,i=e.notificationsCount.value();return r.createElement(t,{...this.props,icon:e.icon.value(),isActive:e.isActive.value(),onClick:e.onClick.value(),hint:e.hint.value(),count:i})}}}var lt=i(83122),ht=i(14071),dt=i(51720),ct=i(74423);const gt=(0,ht.getLogger)("Platform.GUI.RightToolbar"),ut=(0,K.registryContextType)();class pt extends r.PureComponent{constructor(t,e){super(t,e),this._pages={},this._isTradingPanelVisible=null,this._tradingActivePage=null,this._isTradingPanelOpened=null,this._handleMouseOver=t=>{(0,dt.hoverMouseEventFilter)(t)&&this.setState({isHovered:!0})},this._handleMouseOut=t=>{(0,dt.hoverMouseEventFilter)(t)&&this.setState({isHovered:!1})},this._handleFullscreenChange=t=>{this.setState({isFullscreen:t})},this._handleCloseClick=()=>{const{widgetBar:t}=this.context;(0,n.ensureDefined)(t.layout).setMinimizedState(!0)},this._handleGrayedChange=()=>{this.setState({isGrayed:this._isGrayed()})},this._handleDomButtonVisibilityChange=t=>{this.setState({isTradingButtonsVisible:t})},this._isGrayed=()=>{let t=this._isMinimized.value();return null!==this._isTradingPanelOpened&&(t=t&&!this._isTradingPanelOpened.value()),!t},(0,K.validateRegistry)(e,{widgetBar:I.any.isRequired});const{widgetBar:i}=this.context;if(this._isMinimized=(0,n.ensureDefined)(i.layout).isMinimized.spawn(),this._isFullscreen=i.resizerBridge.fullscreen.spawn(),i.tradingPanelAccessor){const t=i.tradingPanelAccessor.tradingPanel;this._isTradingPanelVisible=t.isVisible.spawn(),this._tradingActivePage=t.activePage.spawn(),this._isTradingPanelOpened=t.isOpened.spawn()}this.state={isHovered:!1,isGrayed:this._isGrayed(),isFullscreen:this._isFullscreen.value(),isTradingButtonsVisible:!1},null!==this._isTradingPanelVisible&&(this.state={...this.state,isTradingButtonsVisible:this._isTradingPanelVisible.value()}),(0,n.ensureDefined)(i.layout).pages.forEach(t=>{var e;void 0===t.name&&gt.logWarn('Page does not provide required field "name"');const i=t.tab;this._pages[t.name]=rt(null!==(e=i.TabButtonComponent)&&void 0!==e?e:j,i)}),this._toolset=this._createToolset()}componentDidMount(){this._isFullscreen.subscribe(this._handleFullscreenChange),this._isMinimized.subscribe(this._handleGrayedChange),null!==this._isTradingPanelVisible&&this._isTradingPanelVisible.subscribe(this._handleDomButtonVisibilityChange),null!==this._isTradingPanelOpened&&this._isTradingPanelOpened.subscribe(this._handleGrayedChange)}componentWillUnmount(){this._isFullscreen.destroy(),this._isMinimized.destroy(),null!==this._isTradingPanelVisible&&this._isTradingPanelVisible.destroy(),
null!==this._tradingActivePage&&this._tradingActivePage.destroy(),null!==this._isTradingPanelOpened&&this._isTradingPanelOpened.destroy()}render(){const{className:t,isDomButtonAvailable:e,isOrderPanelButtonAvailable:i}=this.props,{isHovered:s,isGrayed:n,isFullscreen:a,isTradingButtonsVisible:o}=this.state,{widgetBar:l}=this.context,h=this._toolset,d=i&&o,c=e&&o;return r.createElement(U.VerticalScroll,{isVisibleFade:D.mobiletouch,isVisibleButtons:!D.mobiletouch&&s,isVisibleScrollbar:!1,onMouseOver:this._handleMouseOver,onMouseOut:this._handleMouseOut},r.createElement("div",{className:f(t,ct.toolbar,n&&ct.isGrayed),"data-name":"right-toolbar",onContextMenu:lt.preventDefault},l.adaptive&&a&&r.createElement(F,{name:"close-button",onClick:this._handleCloseClick}),this._renderPages(),(d||c)&&r.createElement(nt,null),d&&r.createElement(it,{name:"order-panel-button",isGrayed:n}),c&&r.createElement(Q,{name:"dom-button",isGrayed:n}),r.createElement(ot,null),this._renderPages(!0),h.SupportTicketButton&&r.createElement(h.SupportTicketButton,{name:"bug-report-button",isGrayed:n,isTab:!1}),h.HelpButton&&r.createElement(h.HelpButton,{name:"help-button",isGrayed:n,isTab:!1})))}_renderPages(t){const e=[],{isGrayed:i}=this.state,{widgetBar:s}=this.context,{pages:a}=(0,n.ensureDefined)(s.layout);return a.forEach(s=>{const n=s.name;if(n in this._pages&&Boolean(s.onBottom)===Boolean(t)){const t=this._pages[n];e.push(r.createElement(t,{name:n,isGrayed:i,key:n})),s.spaceBottom&&e.push(r.createElement(nt,{key:s.spaceBottomText}))}}),e}_createToolset(){const{widgetBar:t}=this.context;return{SupportTicketButton:this.props.isSupportTicketButtonAvailable?rt(j,t.ensureSupportTicketButtonViewModel()):void 0,HelpButton:this.props.isHelpButtonAvailable?rt(j,t.ensureHelpButtonViewModel()):void 0}}}pt.contextType=ut;const _t={widgetBar:I.any};class mt extends r.PureComponent{constructor(t){super(t),this._registry={widgetBar:this.props.widgetBar}}render(){return r.createElement(K.RegistryProvider,{validation:_t,value:this._registry},this.props.children)}}class vt{constructor(t,e,i){this._widgetBar=t,this._container=e,this._options=i,this._render()}updateOptions(t){this._options=t,this._render()}destroy(){l.unmountComponentAtNode(this._container)}_render(){l.render(r.createElement(mt,{widgetBar:this._widgetBar},r.createElement(pt,{isDomButtonAvailable:this._options.isDomButtonAvailable,isOrderPanelButtonAvailable:this._options.isOrderPanelButtonAvailable,isHelpButtonAvailable:this._options.isHelpButtonAvailable,isSupportTicketButtonAvailable:this._options.isSupportTicketButtonAvailable})),this._container)}}var wt=i(22984);const bt=(0,a.t)("Hide Tab"),ft=(0,a.t)("Open Tab");function yt(t){const e=f(t.className,"apply-common-tooltip","common-tooltip-vertical","common-tooltip-otl");return r.createElement("div",{className:e,onClick:t.onClick,title:t.isMinimized?ft:bt},r.createElement(wt.VerticalToolbarHider,{direction:t.isMinimized?"left":"right"}))}var Ct=i(7424);class Bt{constructor(t={}){this.MIN_WIDTH=200,this.MINIMIZE_THRESHOLD=50,
this.activeIndex=Bt.activeIndex,this.activeName=Bt.activeName,this.minimized=Bt.minimized,this.visible=Bt.visible,this.width=Bt.width,this.version=Bt.version,this.pages=[],this.isMinimized=new(d()),this.activePageIndex=new(d())(this.activeIndex),this.tabRenderer=null,this._tabs=null,this._pages=null,this._pagescontent=null,this._handle=null,this._deviceButton=null,this._hider=null,this._draggable=null,this._rightToolbarOptions={isDomButtonAvailable:Ct.enabled("dome_widget")||Ct.enabled("dom_widget"),isOrderPanelButtonAvailable:Ct.enabled("order_panel"),isSupportTicketButtonAvailable:Ct.enabled("bugreport_button"),isHelpButtonAvailable:!Ct.enabled("widget")&&!Ct.enabled("charting_library_base")},this.widgetBar=t.widgetBar,this._rightToolbar=Boolean(t.rightToolbar)}element(t){switch(t){case"tabs":return this._tabs;case"pages":return this._pages;case"pages-content":return this._pagescontent;case"handle":return this._handle;case"device-button":return this._deviceButton;case"hider":return this._hider;default:return null}}widget(t){for(const e of this.pages){const i=e.widget(t);if(i)return i}return null}startWidgets(){this.pages.forEach(t=>{t.widgets.forEach(t=>{t.widgetObject||t.widgetStartDelayed||setTimeout(()=>{t.startWidget()},0)})});const t=this.getActivePage();t&&t.onActiveStateChange(!0)}syncHeight(){const t=(0,n.ensureDefined)(this.widgetBar).resizerBridge.height.value();if(null!==this._pages&&(this._pages.style.height=t+"px"),!this.minimized){const t=this.getActivePage();t&&t.updateWidgetsHeight()}}tabsWidth(){return this._rightToolbar?46:this.minimized?5:0}borderWidth(){return 1}canOpen(){return this.MIN_WIDTH+this.tabsWidth()+this.borderWidth()<=(0,n.ensureDefined)(this.widgetBar).resizerBridge.availWidth.value()}requestWidth(t){const e=(0,n.ensureDefined)(this.widgetBar).resizerBridge;t>0&&(t+=this.borderWidth());const i=this.tabsWidth(),s=t+i;this.canOpen()?e.width.value()!==s&&e.negotiateWidth([{min:i,max:i},{min:this.MIN_WIDTH+i,max:s}]):e.negotiateWidth(0)}requestOptimalWidth(){this.minimized?this.requestWidth(0):this.requestWidth(this.width)}updateResponsiveness(){var t,e;const i=!this.canOpen();null===(t=this._tabs)||void 0===t||t.classList.toggle("js-hidden",i),null===(e=this._pages)||void 0===e||e.classList.toggle("js-hidden",i)}syncWidth(){const t=(0,n.ensureDefined)(this.widgetBar).resizerBridge,e=this.tabsWidth(),i=this.borderWidth(),s=t.width.value(),a=Math.max(s-e-i,0)||0;a<this.MINIMIZE_THRESHOLD?this.setMinimizedState(!0):this.setMinimizedState(!1);const o=this._pages;if(o&&(o.style.width=a+"px",o.classList.toggle("hidden",!!this.minimized)),!this.minimized){const t=this.getActivePage();t&&t.widgets.forEach(t=>{t.onWidthChange(a)}),this.widgetBar&&this.widgetBar.loadWidgets()}const r=!this.canOpen();this._deviceButton&&this._deviceButton.classList.toggle("js-hidden",!r||!this.minimized)}setMinimizedState(t){const e=Boolean(t);!!this.minimized!==e&&(this.minimized=e,this.isMinimized.setValue(this.minimized),e&&(0,n.ensureDefined)(this.widgetBar).resizerBridge.exitFullscreen(),
this.requestOptimalWidth(),this.activeIndex>=0&&this.pages[this.activeIndex].onActiveStateChange(!this.minimized))}switchPage(t){if(-1===t||0===this.pages.length)return this.activeIndex=-1,void this.activePageIndex.setValue(this.activeIndex);let e;if(t instanceof V){if(e=this.pages.indexOf(t),-1===e)return}else e=+t;const i=this.pages[this.activeIndex];this.activeIndex=Math.min(this.pages.length-1,Math.max(0,e)),this.activePageIndex.setValue(this.activeIndex);const s=this.pages[this.activeIndex];this.activeName=s.name||"",this.minimized||i&&i===s||(i&&i.onActiveStateChange(!1),s&&s.onActiveStateChange(!0))}getActivePage(){return this.minimized?null:this.pages[this.activeIndex]||null}getWidgetByType(t){var e;const i=null===(e=this.getActivePage())||void 0===e?void 0:e.widgets;if(i)return i.find(e=>e.type===t)}onTabClick(t,e){if(t.isDefaultPrevented())return;const i=this.pages.indexOf(e);if(-1!==i){if(t.preventDefault(),this._trackClick(e.name),i!==this.activeIndex||this.minimized){const t=e.gaEvent();t&&(0,P.trackEvent)("Platform Widgets",t),this.switchPage(i),this.minimized&&this.setMinimizedState(!1)}else this.setMinimizedState(!0);this.widgetBar&&this.widgetBar.saveToTVSettings()}}removePage(t){const e=this.pages.indexOf(t);if(-1===e)return;delete t.widgetBarLayout,this.pages.splice(e,1);const i=t.element();null==i||i.remove(),this.activeIndex===e&&this.switchPage(e-1)}createPage(){var t;const e=new V({widgetBarLayout:this});this.pages.push(e),e.createHTML();const i=(0,n.ensureNotNull)(e.element());return null===(t=this._pagescontent)||void 0===t||t.append(i),e}createWidget(t,e){if(e){if(-1===this.pages.indexOf(e))return null}else e=this.createPage();const i=new A({widgetBarPage:e});return i.demarshal({type:t}),i.createHTML(),e.attachWidget(i),i}onVisibilityChange(){const t=!(!this.widgetBar||!this.widgetBar.resizerBridge.visible.value());this.visible=t,this.pages.forEach(e=>{e.onVisibilityChange(t)})}destroy(){var t,e,i,s,n,a;this.widgetBar&&this.widgetBar.layout===this&&delete this.widgetBar.layout,this.tabRenderer&&(this.tabRenderer.destroy(),this.tabRenderer=null),this._hider&&l.unmountComponentAtNode(this._hider);for(let t=this.pages.length;t--;){const e=this.pages[t];for(let t=e.widgets.length;t--;)e.widgets[t].destroy()}null===(t=this._tabs)||void 0===t||t.remove(),null===(e=this._pages)||void 0===e||e.remove(),null===(i=this._pagescontent)||void 0===i||i.remove(),null===(s=this._handle)||void 0===s||s.remove(),null===(n=this._deviceButton)||void 0===n||n.remove(),null===(a=this._hider)||void 0===a||a.remove()}updateRightToolbar(){var t;null===(t=this.tabRenderer)||void 0===t||t.updateOptions(this._rightToolbarOptions)}createHTML(){const t=(0,n.ensureDefined)(this.widgetBar);if(this._rightToolbar){const e=this._tabs=document.createElement("div");e.classList.value="widgetbar-tabs",this.tabRenderer&&(this.tabRenderer.destroy(),this.tabRenderer=null),this.tabRenderer=new vt(t,e,this._rightToolbarOptions)}const e=this._pages=document.createElement("div");e.classList.value="widgetbar-pages"
;const i=this._pagescontent=document.createElement("div");i.classList.value="widgetbar-pagescontent",e.appendChild(i),this._rightToolbar||(this._pages.style.right="-1px");const s=this._handle=document.createElement("div");if(s.classList.value="widgetbar-handle",e.appendChild(s),s.addEventListener("contextmenu",t=>{t.target===s&&t.preventDefault()}),this._createDraggable(s),t.showCloseButton){const t=this._hider=document.createElement("div");t.classList.value="widgetbar-hider";const e=()=>{t.classList.toggle("widgetbar-hider--closed",this.isMinimized.value()),t.classList.toggle("js-hidden",this._rightToolbar&&this.isMinimized.value()),l.render(r.createElement(yt,{isMinimized:this.isMinimized.value(),onClick:()=>{this.setMinimizedState(!this.minimized)}}),t)};this.isMinimized.subscribe(e),e()}this.pages.forEach(t=>{t.createHTML();const e=t.element();e&&i.appendChild(e)})}demarshal(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}if("object"!=typeof t)return null;this.width=Number(t.width),!isFinite(this.width)||this.width<=0?this.width=Bt.width:this.width<this.MIN_WIDTH&&(this.width=this.MIN_WIDTH),"minimized"in t?(this.minimized=Boolean(t.minimized),this.isMinimized.setValue(this.minimized)):(this.minimized=Bt.minimized,this.isMinimized.setValue(this.minimized)),"version"in t&&(this.version=t.version);let e=Number(t.activeIndex);const i=t.activeName;let s=!1;const n=this.pages;return n.splice(0,this.pages.length),Array.isArray(t.pages)&&t.pages.forEach((t,a)=>{const o=new V({widgetBarLayout:this}).demarshal(t);i?t.name===i&&o&&(e=a,s=!0):o||a!==e||e--,o&&n.push(o)}),i&&!s&&(e=0),0===n.length?(this.activeIndex=-1,this.activePageIndex.setValue(this.activeIndex)):e>=0&&e<n.length&&(this.activeIndex=e,this.activePageIndex.setValue(this.activeIndex)),this}marshal(){let t=[];this.pages.forEach(e=>{const i=e.marshal();i&&(t=t.concat(i))});const e={};for(let i=0;i<t.length;i++){const s=t[i].type;s&&(t[i].id&&delete t[i].type,e[s]?e[s].push(t[i]):e[s]=[t[i]])}const i={widgets:e,settings:{}};return this.minimized!==Bt.minimized&&(i.settings.minimized=this.minimized),this.width!==Bt.width&&(i.settings.width=this.width),this.activeIndex!==Bt.activeIndex&&(i.settings.activeIndex=this.activeIndex),this.activeName!==Bt.activeName&&(i.settings.activeName=this.activeName),this.version!==Bt.version&&(i.settings.version=this.version),i}_createDraggable(t){null!==this._draggable&&this._draggable.destroy();const e={initialWidth:0};this._draggable=new N.PointerBackend({handle:t,onDragStart:t=>{this.widgetBar?e.initialWidth=Math.max(this.widgetBar.resizerBridge.width.value()-this.tabsWidth()-this.borderWidth(),0):t.preventDefault()},onDragMove:t=>{const{current:i,initial:s}=t.detail,n=i.pageX-s.pageX;let a=e.initialWidth-n;a<this.MINIMIZE_THRESHOLD?a=0:a<this.MIN_WIDTH&&(a=this.MIN_WIDTH),a>0&&(this.width=a),this.requestWidth(a)},onDragStop:t=>{this.widgetBar&&this.widgetBar.saveToTVSettings()}})}_trackClick(t){0}}Bt.width=290,Bt.minimized=!Ct.enabled("show_right_widgets_panel_by_default"),Bt.activeIndex=0,Bt.activeName="",
Bt.visible=!0,Bt.version=void 0;var St=i(708),Tt=i(76774),Wt=i(49498),Pt=i(19814),xt=i(38225),Mt=i(60453);class Ht{constructor(t){this._wrap=null,this._tradingServiceCancelable=null,this.options=t,this._load=()=>{};const e=new Promise(t=>{this._load=t}),i=this.options.configuration;this._configuration=Promise.race([(0,Pt.delay)(null,5e3),e]).then(()=>i()).then(t=>{const e=this.widgetConfig;return e.reuters_calendar.ctor=t.ReutersCalendarWidget,e.earnings_calendar.ctor=t.CalendarWidget&&t.CalendarWidget.Earnings,e.watchlist.ctor=t.Watchlist,e.hotlist.ctor=t.HotlistWidget,e.detail.ctor=t.Detail&&t.Detail.Widget,e.news.ctor=t.NewsWidget,e.chat.ctor=t.ChatWidget,e.messages.ctor=t.Messages&&t.Messages.Widget,e.messages_with_select.ctor=t.Messages&&t.Messages.Widget,e.notifications_following.ctor=t.NotificationsWidgets,e.notifications_user.ctor=t.NotificationsWidgets,e.publicchats.ctor=t.PublicChatsWidget,e.publicchats_with_select.ctor=t.PublicChatsWidget,e.notes.ctor=t.NotesWidget,e.alerts_manage.ctor=t.AlertsManageWidget,e.alerts_log.ctor=t.AlertsLogWidget,e.streams.ctor=t.StreamsWidget,e.datawindow.ctor=t.DataWindowWidget,(0,n.ensure)(e.object_tree).ctor=t.ObjectTreeWidget,t});const a=this.resizerBridge=t.resizerBridge;this.adaptive=Boolean(t.adaptive),this.tradingPanelAccessor=t.tradingPanelAccessor||null,this._visible=(0,o.combine)((t,e,i)=>Boolean(t&&e&&i),a.width,a.height,a.visible),this.widgetConfig=(0,s.default)({},w),t.widgetConfig&&(this.widgetConfig=(0,s.default)(this.widgetConfig,t.widgetConfig)),this.layout=new Bt({widgetBar:this,rightToolbar:Lt()}),this._customization=t.customization||{},t.chartWidgetCollection&&(this.chartWidgetCollection=t.chartWidgetCollection),t.state?this.layout.demarshal(t.state):t.settingsPrefix&&(this._settingsPrefix=String(t.settingsPrefix),this.loadFromTVSettings()),t.readonly&&(this.readonly=!0),t.fixedMode&&(this.fixedMode=!0),t.showCloseButton&&(this.showCloseButton=!0),this._container=this.resizerBridge.container.value(),this.createHTML(),this.initLayout(),window.loginStateChange.subscribe(this,this.onLoginStateChange),this.resizerBridge.width.subscribe(()=>{var t;null===(t=this.layout)||void 0===t||t.syncWidth()}),this.resizerBridge.height.subscribe(()=>{var t;null===(t=this.layout)||void 0===t||t.syncHeight()}),this.resizerBridge.visible.subscribe(()=>{var t;null===(t=this.layout)||void 0===t||t.onVisibilityChange()}),this.resizerBridge.availWidth.subscribe(()=>{var t,e;null===(t=this.layout)||void 0===t||t.requestOptimalWidth(),null===(e=this.layout)||void 0===e||e.updateResponsiveness()}),this._tradingServiceCancelable=(0,St.makeCancelable)((0,Tt.waitTradingService)()),this._tradingServiceCancelable.promise.then(t=>{this._tradingServiceCancelable=null,t.onConnectionStatusChange.subscribe(this,this._onBrokerConnectionStatusChanged)})}destroy(){if(null!==this._tradingServiceCancelable)this._tradingServiceCancelable.cancel(),this._tradingServiceCancelable=null;else{(0,n.ensureNotNull)((0,
Tt.tradingService)()).onConnectionStatusChange.unsubscribe(this,this._onBrokerConnectionStatusChanged)}}widget(t){return this.layout?this.layout.widget(t):null}isVisible(){const t=this.resizerBridge;return Boolean(t.visible.value()&&t.height.value()&&t.width.value())}visible(){return this._visible}initLayout(){var t;this.options.instantLoad&&this._load(),this.layout&&(this._configuration.then(()=>{var t;null===(t=this.layout)||void 0===t||t.startWidgets()}),0===this.layout.pages.length&&(this.layout.setMinimizedState(!0),null===(t=this.layout.element("handle"))||void 0===t||t.classList.add("js-hidden")),this.layout.requestOptimalWidth(),this.layout.syncWidth(),this.layout.syncHeight(),this.layout.onVisibilityChange(),this.layout.updateResponsiveness())}loadWidgets(){this._widgetsLoadRequested||(this._widgetsLoadRequested=!0,this._load())}onLoginStateChange(t){t||window.is_authenticated&&(this.dropWidgetData(),this.refreshFromTVSettings())}dropWidgetData(){for(const t in this.widgetConfig)delete(0,n.ensure)(this.widgetConfig[t]).data}refreshFromTVSettings(){var t,e,i;if(!this._settingsPrefix)return;this.layout&&this.layout.destroy(),this.layout=new Bt({widgetBar:this,rightToolbar:Lt()}),this.loadFromTVSettings(),this.layout.createHTML();const s=this.layout.element("pages");s&&(null===(t=this._wrap)||void 0===t||t.appendChild(s));const n=this.layout.element("tabs");n&&(null===(e=this._wrap)||void 0===e||e.appendChild(n));const a=this.layout.element("hider");a&&(null===(i=this._wrap)||void 0===i||i.appendChild(a)),this.initLayout()}getWidgets(t){let e=[];if(!this.layout)return e;for(let i=0;i<this.layout.pages.length;++i)e=e.concat(this.layout.pages[i].getWidgets(t));return e}loadFromTVSettings(){if(!this._settingsPrefix)return;if(!this.layout)return;let t=this.getLayoutState();t=this.mergeProperties(t),this.layout.demarshal(t),this.saveToTVSettings();const e=this._getSerializedStateFromSetting();if(e){let t=[];for(const i in e.widgets){const s=e.widgets[i];t=t.concat(s.map(t=>t.id))}const i=x.keysMask(this._settingsPrefix+".widget.*.*");i&&i.forEach(e=>{const i=e.replace(this._settingsPrefix+".widget.","");-1===t.indexOf(i)&&0===e.indexOf(this._settingsPrefix+".widget.")&&((0,P.trackEvent)("Settings debug","loadFromTVSettings: "+e,window.user.username),x.remove(e))})}}mergeProperties(t){const e=this._getSerializedStateFromSetting();if(!e)return t;e.settings&&Object.assign(t,e.settings);const i={};for(let s=0;s<t.pages.length;s++)for(let n=0;n<t.pages[s].widgets.length;n++){const a=t.pages[s].widgets[n],o=i[a.type]||0;e.widgets[a.type]&&e.widgets[a.type][o]&&Object.assign(a,e.widgets[a.type][o]),i[a.type]=o+1}return t}saveToTVSettings(){if(!this._settingsPrefix)return;if(!this.layout)return;const t=this.layout.marshal();this._setSerializedStateToSettings(t)}getWidgetProperties(t,e=0){const i=(0,n.ensure)(this._settingsPrefix).replace(/\W/g,"\\$&")+".widget.";let s=x.keysMask(i+t+".*");return s&&s.length&&(s=s.sort(),s[e])?{id:s[e].replace(i,"")}:null}getGenericLayoutState(t){const e=(0,Wt.getDefaultState)(),i={
type:"news"},s=[{_gaEvent:"General Widget",title:(0,a.t)("Watchlist, details and news"),name:"base",icon:"base",widgets:[{type:"watchlist",properties:t&&t.length?{list:t}:void 0},{type:"detail"},{...i,isEnabled:!0}]},Ct.enabled("alerts")?{_gaEvent:"Alerts",title:(0,a.t)("Alerts"),name:"alerts",icon:"alarm-clock",widgets:[{type:"alerts_manage",properties:{}},{type:"alerts_log",properties:{}}]}:null,null,null,{_gaEvent:"Data Window",title:(0,a.t)("Data Window"),name:"data-window",icon:"datawindow",widgets:[{type:"datawindow"}]},{_gaEvent:"Hotlists",title:(0,a.t)("Hotlists"),name:"hotlist",icon:"hotlists",widgets:[{type:"hotlist",properties:{group:"volume_gainers"}},{type:"hotlist",properties:{group:"percent_change_gainers"}},{type:"hotlist",properties:{group:"percent_change_loosers"}}]},{_gaEvent:"Calendar",title:(0,a.t)("Calendar"),name:"calendar",icon:"calendar",widgets:[{type:"reuters_calendar",properties:{}},{type:"earnings_calendar",properties:{}}]},{_gaEvent:"My Ideas",title:(0,a.t)("My Ideas"),name:"notes",icon:"notes",spaceBottom:!0,spaceBottomText:(0,a.t)("Social"),widgets:[{type:"notes"}]},{_gaEvent:"Public Chats",title:(0,a.t)("Public Chats"),name:"chats",icon:"chat",widgets:[{type:"chat"},{type:"publicchats"}]},{_gaEvent:"Private Chats",title:(0,a.t)("Private Chats"),name:"pm_chats",icon:"messages",widgets:[{type:"messages"}]},{_gaEvent:"Ideas Stream",title:(0,a.t)("Ideas Stream"),name:"ideas_stream",icon:"ideas-stream",widgets:[{type:"notifications_following"}]},null,{_gaEvent:"Notifications",title:(0,a.t)("Notifications"),name:"notifications",icon:"notifications",widgets:[{type:"notifications_user"}]}];for(let t=0;t<s.length;t++){const i=s[t];i&&e.pages.push(i)}return e}getChartingPlatformLayoutState(t,e){const i=(0,Wt.getDefaultState)();if(this._customization.watchlist||this._customization.details||this._customization.news){let s="";const n=[];this._customization.watchlist&&(s=(0,a.t)("Watchlist"),n.push({type:"watchlist",id:"watchlist."+e,properties:t&&t.length?{list:t}:void 0})),this._customization.details&&(s=this._customization.watchlist?(0,a.t)("Watchlist and details"):(0,a.t)("Details"),n.push({type:"detail"})),this._customization.news&&(s=this._customization.watchlist&&this._customization.details?(0,a.t)("Watchlist and details and news"):this._customization.watchlist?(0,a.t)("Watchlist and news"):(0,a.t)("News"),n.push({type:"news",id:"news."+e})),i.pages.push({name:"base",title:s,icon:"base",widgets:n})}return this._customization.datawindow&&i.pages.push({title:(0,a.t)("Data Window"),name:"data-window",icon:"datawindow",widgets:[{type:"datawindow"}]}),Ct.enabled("right_toolbar")&&Ct.enabled("show_object_tree")&&this.chartWidgetCollection&&!this.chartWidgetCollection.readOnly()&&i.pages.push({title:(0,a.t)("Show Object tree"),name:"object_tree",icon:"object-tree",onBottom:!1,widgets:[{type:"object_tree"}]}),i}getLayoutState(){const t=x.getJSON("watchlist.list",[]);let e;e=Ct.enabled("trading_terminal")?this.getChartingPlatformLayoutState(t,"terminal"):this.getGenericLayoutState(t)
;const i=t=>!(void 0!==t.isEnabled&&!t.isEnabled)&&(this.chartWidgetCollection||!(0,n.ensure)(w[t.type]).chartWidgetRequired);for(let t=e.pages.length-1;t>=0;t--){const s=e.pages[t];s.widgets=s.widgets.filter(i)}return e.pages=e.pages.filter(t=>t.widgets&&t.widgets.length),e}createWidgetId(t){return t+"."+(0,z.randomHash)()}setPage(t){if(!this.layout)return null;this.layout.setMinimizedState(!1);let e=this.layout.activeIndex;return this.layout.pages.forEach((i,s)=>{i.name===t&&(e=s)}),this.layout.switchPage(e),this.layout.getActivePage()}ensureSupportTicketButtonViewModel(){return this._supportTicketButtonViewModel||(this._supportTicketButtonViewModel=new g({icon:xt,hint:(0,a.t)("Help Center"),onClick:()=>{this._configuration.then(t=>{const e=t.showSupportDialog;e&&e()}),this._load()}})),this._supportTicketButtonViewModel}ensureHelpButtonViewModel(){if(this._helpButtonViewModel)return this._helpButtonViewModel;const t=this.ensureSupportTicketButtonViewModel();return this._helpButtonViewModel=new g({icon:Mt,hint:(0,a.t)("Help Center"),onClick:t.onClick.value()}),this._helpButtonViewModel}createHTML(){const t=this._container;if(!t)return;if(!this.layout)return;t.innerHTML="",this.layout.createHTML();const e=this._wrap=document.createElement("div");e.classList.value="widgetbar-wrap unselectable js-right-boundary",t.appendChild(e);const i=this.layout.element("pages");i&&this._wrap.appendChild(i);const s=this.layout.element("tabs");Lt()&&s&&this._wrap.appendChild(s);const n=this.layout.element("device-button");n&&this._wrap.appendChild(n);const a=this.layout.element("hider");a&&this._wrap.appendChild(a)}_getSerializedStateFromSetting(){return this._settingsPrefix?x.getJSON(this._settingsPrefix+".layout-settings",null):null}_setSerializedStateToSettings(t){this._settingsPrefix&&x.setJSON(this._settingsPrefix+".layout-settings",t)}_onBrokerConnectionStatusChanged(){}}function Lt(){return Ct.enabled("right_toolbar")}},22984:(t,e,i)=>{"use strict";i.d(e,{DEFAULT_VERTICAL_TOOLBAR_HIDER_THEME:()=>r,VerticalToolbarHider:()=>h});var s=i(67294),n=i(94184),a=i(83122),o=i(14750);const r=o,l="http://www.w3.org/2000/svg";function h(t){const{direction:e,theme:i=o}=t;return s.createElement("svg",{xmlns:l,width:"9",height:"27",viewBox:"0 0 9 27",className:n(i.container,"right"===e?i.mirror:null),onContextMenu:a.preventDefault},s.createElement("g",{fill:"none",fillRule:"evenodd"},s.createElement("path",{className:i.background,d:"M4.5.5a4 4 0 0 1 4 4v18a4 4 0 1 1-8 0v-18a4 4 0 0 1 4-4z"}),s.createElement("path",{className:i.arrow,d:"M5.5 10l-2 3.5 2 3.5"})))}},67046:(t,e,i)=>{"use strict";i.d(e,{VerticalScroll:()=>g});var s=i(67294),n=i(94184),a=i.n(n),o=i(68961),r=i(21659),l=i(34475),h=i(37441),d=i(24816),c=i(47243);class g extends s.PureComponent{constructor(t){super(t),this._scroll=null,this._handleScrollTop=()=>{this.animateTo(Math.max(0,this.currentPosition()-(this.state.heightWrap-50)))},this._handleScrollBot=()=>{
this.animateTo(Math.min((this.state.heightContent||0)-(this.state.heightWrap||0),this.currentPosition()+(this.state.heightWrap-50)))},this._handleResizeWrap=({height:t})=>{this.setState({heightWrap:t})},this._handleResizeContent=({height:t})=>{this.setState({heightContent:t})},this._handleScroll=()=>{const{onScroll:t}=this.props;t&&t(this.currentPosition(),this.isAtTop(),this.isAtBot()),this._checkButtonsVisibility()},this._checkButtonsVisibility=()=>{const{isVisibleTopButton:t,isVisibleBotButton:e}=this.state,i=this.isAtTop(),s=this.isAtBot();i||t?i&&t&&this.setState({isVisibleTopButton:!1}):this.setState({isVisibleTopButton:!0}),s||e?s&&e&&this.setState({isVisibleBotButton:!1}):this.setState({isVisibleBotButton:!0})},this.state={heightContent:0,heightWrap:0,isVisibleBotButton:!1,isVisibleTopButton:!1}}componentDidMount(){this._checkButtonsVisibility()}componentDidUpdate(t,e){e.heightWrap===this.state.heightWrap&&e.heightContent===this.state.heightContent||this._handleScroll()}currentPosition(){return this._scroll?this._scroll.scrollTop:0}isAtTop(){return this.currentPosition()<=1}isAtBot(){return this.currentPosition()+this.state.heightWrap>=this.state.heightContent-1}animateTo(t,e=h.dur){const i=this._scroll;i&&(0,l.doAnimate)({onStep(t,e){i.scrollTop=e},from:i.scrollTop,to:Math.round(t),easing:h.easingFunc.easeInOutCubic,duration:e})}render(){const{children:t,isVisibleScrollbar:e,isVisibleFade:i,isVisibleButtons:n,onMouseOver:l,onMouseOut:h}=this.props,{heightContent:g,heightWrap:u,isVisibleBotButton:p,isVisibleTopButton:_}=this.state;return s.createElement(o,{whitelist:["height"],onMeasure:this._handleResizeWrap},s.createElement("div",{className:d.wrap,onMouseOver:l,onMouseOut:h},s.createElement("div",{className:a()(d.scrollWrap,{[d.noScrollBar]:!e}),onScroll:this._handleScroll,ref:t=>this._scroll=t},s.createElement(o,{onMeasure:this._handleResizeContent,whitelist:["height"]},s.createElement("div",{className:d.content},t))),i&&s.createElement("div",{className:a()(d.fadeTop,{[d.isVisible]:_&&g>u})}),i&&s.createElement("div",{className:a()(d.fadeBot,{[d.isVisible]:p&&g>u})}),n&&s.createElement("div",{className:a()(d.scrollTop,{[d.isVisible]:_&&g>u}),onClick:this._handleScrollTop},s.createElement("div",{className:d.iconWrap},s.createElement(r.Icon,{icon:c,className:d.icon}))),n&&s.createElement("div",{className:a()(d.scrollBot,{[d.isVisible]:p&&g>u}),onClick:this._handleScrollBot},s.createElement("div",{className:d.iconWrap},s.createElement(r.Icon,{icon:c,className:d.icon})))))}}g.defaultProps={isVisibleScrollbar:!0}},27407:(t,e,i)=>{"use strict";i.d(e,{validateRegistry:()=>r,RegistryProvider:()=>l,registryContextType:()=>h});var s=i(67294),n=i(45697),a=i.n(n);const o=s.createContext({});function r(t,e){a().checkPropTypes(e,t,"context","RegistryContext")}function l(t){const{validation:e,value:i}=t;return r(i,e),s.createElement(o.Provider,{value:i},t.children)}function h(){return o}},93500:(t,e,i)=>{"use strict";async function s(t,e,i){let s;for(let n=0;n<e;++n)try{return await t(s)}catch(t){s=t,await i(n)}throw s}
async function n(t,e){return s(t,e,()=>Promise.resolve())}i.d(e,{getAllSourcesIcons:()=>c,loadAllSourcesIcons:()=>d});const a=(0,i(14071).getLogger)("DataSourcesIcons");let o=null;function r(){const t=i.c[78726];return t?Promise.resolve(t.exports.lineToolsIcons):i.e(1890).then(i.bind(i,78726)).then(t=>t.lineToolsIcons)}function l(){const t=i.c[87304];return t?Promise.resolve(t.exports.SERIES_ICONS):i.e(3718).then(i.bind(i,87304)).then(t=>t.SERIES_ICONS)}let h=null;function d(){return null===h&&(h=function(){const t=n(r,2).then(t=>t).catch(t=>(a.logWarn(t),{})),e=n(l,2).then(t=>t).catch(t=>(a.logWarn(t),{}));return Promise.all([t,e])}()),h.then(t=>(o={linetool:t[0],series:t[1]},o))}function c(){return o}},20839:(t,e,i)=>{"use strict";i.r(e),i.d(e,{DataWindowWidget:()=>x});var s=i(16282),n=i(14563),a=i(74245),o=i(49972),r=i(27690),l=i(18695),h=i(32368),d=i(14853),c=i(5251),g=i(97391),u=i(19493),p=i(64879),_=i(19832),m=i(27652),v=i(7511),w=i(12757),b=i(34121);const f=new o.TranslatedString("change visibility",(0,a.t)("change visibility")),y=new o.TranslatedString("hide {title}",(0,a.t)("hide {title}")),C=new o.TranslatedString("show {title}",(0,a.t)("show {title}")),B=(0,a.t)("Data Window"),S=(0,a.t)("Color line"),T=(0,a.t)("Show"),W=(0,a.t)("Hide data"),P=(0,a.t)("Show data");class x{constructor(t){var e;const i=null===(e=t.getChartWidgetCollection)||void 0===e?void 0:e.call(t);if(!i)throw new Error("ChartWidgetCollection is required");this._chartWidgetCollection=i,this._chartWidget=this._chartWidgetCollection.activeChartWidget.value(),this._views=[],this._headerBinding=[],this._boxesBinding=[];const s=this._container=document.createElement("div");s.classList.add("chart-data-window"),t.container.appendChild(s),this._scroll=new u.SidebarCustomScroll(t.container,s),this.visible=t.visible.value(),this._updateChartWidget(),this._updateSource(),this._updateLayout(),this._chartWidgetCollection.activeChartWidget.subscribe(this.fullUpdate.bind(this)),t.visible.subscribe(this._onVisibilityChange.bind(this)),this._chartWidgetCollection.selectedSources.subscribe(t=>{const e=t[0];e&&this.updateHighlight({source:e,updateScroll:!0})}),t.setTitle(B)}update(){this.visible&&(this.updateHighlight(),this.updateValues())}updateHighlight(t){const e=(t||{}).source,i=!!(t||{}).updateScroll;if(!this.visible||!this._chartWidget||!this._chartWidget.hasModel())return;const s=this._chartWidget.model().hoveredSource(),n=e||this._chartWidgetCollection.selectedSources.value()[0];let a;for(let t=0;t<this._boxesBinding.length;++t){const e=this._boxesBinding[t].src,i=this._boxesBinding[t].element;if(e){const t=!(!n||e!==n);i.classList.toggle("hover",!(!s||e!==s)),i.classList.toggle("active",t),t&&(a=i)}}a&&i&&this._scroll.scrollTo(a)}updateValues(){if(!this.visible)return;const t=t=>t.visible(),e=t=>({value:t.value(),title:(0,_.clean)(t.title(),!0),color:t.color(),showColorInBox:this._showColorInBox(t.color())});for(let i=0;i<this._boxesBinding.length;++i){const s=this._boxesBinding[i];s.body.innerHTML="",s.view.items().filter(t).map(e).forEach(t=>{
var e,i;const n=document.createElement("div");n.classList.add("chart-data-window-item");const a=document.createElement("div");a.classList.add("chart-data-window-item-title"),a.textContent=t.title,n.appendChild(a);const o=document.createElement("div");if(o.classList.add("chart-data-window-item-value"),n.appendChild(o),t.showColorInBox){const i=document.createElement("div");i.classList.add("real-color"),i.style.backgroundColor=null!==(e=t.color)&&void 0!==e?e:"",i.title=S,o.appendChild(i),o.appendChild(document.createTextNode(t.value))}else{const e=document.createElement("span");e.style.color=null!==(i=t.color)&&void 0!==i?i:"",e.textContent=t.value,o.appendChild(e)}s.body.appendChild(n)})}for(let t=0;t<this._headerBinding.length;t++){const e=this._headerBinding[t].element;e&&(e.textContent=(0,_.clean)(this._headerBinding[t].value.header(),!0),e.title=(0,_.clean)(this._headerBinding[t].value.title(),!0))}}fullUpdate(){this._updateChartWidget(),this._updateSource(),this._updateLayout()}setSelectedSource(t){this._chartWidget.model().selectionMacro(e=>{e.addSourceToSelection(t)})}showContextMenuForSource(t,e){t.hasContextMenu()&&(this.setSelectedSource(t),t instanceof m.Series?this._showSeriesContextMenu(t,e):t instanceof v.Study&&this._showStudyContextMenu(t,e))}createActionShow(t){const e=new c.Action({actionId:"Chart.SelectedObject.Show",label:T,icon:b,checkable:!0});return e.setBinding(new r.ActionBinder(e,t.properties().visible,this._chartWidget.model(),f)),e.getBinding().setValue(t.properties().visible.value()),e}_updateChartWidget(){const t=this._chartWidget,e=this._chartWidgetCollection.activeChartWidget.value();t&&t.removeDataWindowWidget(),e&&(this._chartWidget=e,e.setDataWindowWidget(this))}_updateSource(){if(!this.visible)return;if(this._views=[],!this._chartWidget.hasModel())return;const t=this._chartWidget.model().model().dataSources();for(let e=0;e<t.length;e++){const i=t[e].dataWindowView();i&&this._views.push(i)}}_updateLayout(){if(this.visible){this._container.innerHTML="",this._headerBinding=[];for(let t=this._boxesBinding.length-1;t>=0;t--){const e=this._boxesBinding[t];e.src&&e.src.properties().visible.unsubscribe(this,e.visibilityHandler)}this._boxesBinding=[];for(let t=0;t<this._views.length;++t){const e=this._views[t];e.items().length&&this._bindView(e)}this.updateHighlight(),this.updateValues(),this._scroll.resize()}}_bindView(t){let e;t instanceof l.SeriesDataWindowView?e=t.series():(t instanceof d.StudyDataWindowView||t instanceof h.OverlayDataWindowView)&&(e=t.study());const i=(0,p.parseHtmlElement)('<div class="box with-actions"><div class="chart-data-window-header"><span class="text"></span><div class="hover-source-icon"></div></div><div class="chart-data-window-body"></div></div>'),n=(0,s.ensureNotNull)(i.querySelector(".chart-data-window-body")),a=(0,s.ensureNotNull)(i.querySelector(".chart-data-window-header"));if(a.classList.toggle("js-hidden",!Boolean(t.header())),this._container.appendChild(i),void 0!==e){const t=e;i.classList.toggle("hidden",!t.properties().visible.value()),
i.addEventListener("click",e=>{e.preventDefault(),this.setSelectedSource(t)}),i.addEventListener("contextmenu",e=>{e.preventDefault(),this._chartWidget.readOnly()||this.showContextMenuForSource(t,e)})}function r(t){return t?W:P}function c(t){i.classList.toggle("hidden",!t.value()),i.querySelectorAll(".toggle-source-icon").forEach(e=>{e.title=r(t.value())})}if(t.header()&&void 0!==e){const t=e,i=document.createElement("div");i.classList.add("toggle-source-icon"),i.title=r(t.properties().visible.value()),i.innerHTML=w,i.addEventListener("click",e=>{e.stopPropagation();const i=t.properties().visible.value();this._chartWidget.model().setProperty(t.properties().visible,!i,(i?y:C).format({title:new o.TranslatedString(t.name(),t.title())}))}),a.appendChild(i),a.addEventListener("dblclick",()=>{this._chartWidget.showChartPropertiesForSource(t)})}void 0!==e&&e.properties().visible.subscribe(this,c),this._headerBinding.push({value:t,element:a.querySelector(".text")}),this._boxesBinding.push({view:t,src:e,element:i,body:n,visibilityHandler:c})}_onVisibilityChange(t){this.visible=!!t,t&&this.fullUpdate()}_showColorInBox(t){return!!(t&&255-(0,n.rgbToGrayscale)((0,n.parseRgb)(t))<20)}_showSeriesContextMenu(t,e){const i=this._chartWidget.actions(),s=t.properties().visible.value();g.ContextMenuManager.showMenu([i.format,s?i.seriesHide:this.createActionShow(t)],e,void 0,{menuName:"DataWindowWidgetSeriesContextMenu",detail:{type:"series",id:t.instanceId()}})}_showStudyContextMenu(t,e){const i=this._chartWidget.actions(),s=t.properties().visible.value();g.ContextMenuManager.showMenu([i.format,s?i.studyHide:this.createActionShow(t),i.studyRemove],e,void 0,{menuName:"DataWindowWidgetStudyContextMenu",detail:{type:"study",id:t.id()}})}}},19493:(t,e,i)=>{"use strict";i.d(e,{SidebarCustomScroll:()=>g});var s=i(89505),n=i(21526),a=i.n(n),o=i(13951),r=i(34475),l=i(37808),h=i(96456),d=(i(10090),i(66517));const c={headerHeight:0,additionalClass:"",alwaysVisible:!1,showBottomShadow:!0,scrollMarginTop:1,bubbleScrollEvent:!1};class g{constructor(t,e,i={}){if(this.scrolled=new(a()),this.scrolltoend=new(a()),this.scrolltostart=new(a()),this.visibilityCallbacks=[],this._scrollTargetTop=0,this._scrollSpeed=40,this._shadowOffset=10,this._shadowTop=null,this._shadowBottom=null,this._bottomFixed=!1,this._dragInitialized=!1,this._dragging=!1,this._draggable=null,this._atStart=!1,this._atEnd=!1,this._stickyBottom=null,this._tempIntervalID=void 0,this._animation=null,this._saved=null,this._options={...c,...i},this._wrapper=t,this._wrapper.classList.add(d.wrapper),this._content=e,this._headerHeight=this._options.headerHeight,this._scrollMarginTop=this._options.scrollMarginTop,this._scrollBar=document.createElement("div"),this._scrollBar.classList.add("sb-scrollbar","sb-scrollbar-body"),this._options.additionalClass&&this._scrollBar.classList.add(this._options.additionalClass),this._scrollBar.classList.toggle("active-always",this._options.alwaysVisible),this._scrollBarWrapper=document.createElement("div"),
this._scrollBarWrapper.classList.add("sb-scrollbar-wrap"),this._touch=s.touch,this._touch)return this._content.style.position="relative",this._wrapper.classList.add(d.touch),void this._wrapper.addEventListener("scroll",()=>this._onScroll());this._wrapper.style.overflow="hidden",this._unsubscribe=(()=>{const t=()=>{this._bottomFixed||this._dragging||(this._options.alwaysVisible||this._scrollBar.classList.add("active"),this._onScroll())},e=()=>{this._bottomFixed||this._dragging||(this._options.alwaysVisible||this._scrollBar.classList.remove("active"),this._onScroll())},i=t=>{if(!t.defaultPrevented){const e=(0,h.getPixelsFromEvent)(t,()=>({height:this._wrapper.clientHeight})).y;this.scroll(-e,1)||(t.stopPropagation(),t.preventDefault())}};return this._wrapper.addEventListener("mouseenter",t),this._wrapper.addEventListener("mouseleave",e),this._wrapper.addEventListener("wheel",i),()=>{this._wrapper.removeEventListener("mouseenter",t),this._wrapper.removeEventListener("mouseleave",e),this._wrapper.removeEventListener("wheel",i)}})(),!1!==this._options.showTopShadow&&(this._shadowTop=document.createElement("div"),this._shadowTop.classList.add("sb-inner-shadow","top","i-invisible"),this._wrapper.appendChild(this._shadowTop)),!1!==this._options.showBottomShadow&&(this._shadowBottom=document.createElement("div"),this._shadowBottom.classList.add("sb-inner-shadow"),this._wrapper.appendChild(this._shadowBottom)),this._shadowTop&&this._headerHeight&&(this._shadowTop.style.top=this._headerHeight-this._shadowOffset+"px"),this._wrapper.appendChild(this._scrollBarWrapper),this._scrollBarWrapper.appendChild(this._scrollBar),this._onScroll()}isTouch(){return this._touch}getScrollBar(){return this._scrollBar}initDraggable(){return this._dragInitialized||(this._draggable=new l.Draggable({axis:"y",source:this._scrollBar,containment:this._scrollBarWrapper,start:()=>{this._dragging=!0},stop:()=>{this._dragging=!1},drag:()=>{this.updateScroll()}}),this._dragInitialized=!0),this}updateScroll(){if(this._touch)return this;const t=Math.ceil((0,o.position)(this._scrollBar).top-this._scrollMarginTop-this._headerHeight),e=this.getContainerHeightWithoutHeader(),i=(0,o.outerHeight)(this._content),s=i-e-1;return e<=0||(this._scrollTargetTop=s<=0?this._headerHeight:Math.min(-t*i/e+this._headerHeight,this._headerHeight),t+(0,o.contentHeight)(this._scrollBar)+2>=e?this.scrollToEnd():(this._content.style.top=this._scrollTargetTop+"px",this._onScroll())),this}getContainerHeightWithoutHeader(){return this._wrapper.getBoundingClientRect().height-this._headerHeight}getContainerHeight(){return this._wrapper.getBoundingClientRect().height}getContentHeight(){return this._content.getBoundingClientRect().height}updateScrollBar(){if(this._touch)return this;const t=(0,o.position)(this._content).top,e=this.getContentHeight(),i=this.getContainerHeight(),s=this.getContainerHeightWithoutHeader(),n=1+this._headerHeight,a=s-2,r=(Math.abs(t)-this._headerHeight)*a/e,l=i*i/e;return this.isContentShort()?(this._scrollBar.classList.add("js-hidden"),
this._wrapper.classList.remove("sb-scroll-active")):(this._scrollBar.classList.remove("js-hidden"),this._scrollBar.style.height=l+"px",this._scrollBar.style.top=n+r+"px",this._wrapper.classList.add("sb-scroll-active"),this.initDraggable()),this}scroll(t,e){const i=(0,o.position)(this._content).top,s=(0,o.outerHeight)(this._content)-this.getContainerHeightWithoutHeader()-1,n=e||this._scrollSpeed;return s<=0||(this._scrollTargetTop=Math.max(-s+this._headerHeight,Math.min(this._headerHeight,i+t*n)),this.setContentTop(this._scrollTargetTop),this._onScroll())}animateTo(t){if(this._touch)return this;const e=(0,o.outerHeight)(this._content)-this.getContainerHeightWithoutHeader()-1;if(e<=0)return!0;this._scrollTargetTop=Math.max(-e+this._headerHeight,Math.min(this._headerHeight,-t)),this._animation&&this._animation.stop(),this._animation=(0,r.doAnimate)({duration:500,from:parseFloat(getComputedStyle(this._content).top),to:this._scrollTargetTop,onStep:(t,e)=>{this._content.style.top=e+"px"},onComplete:()=>{this._onScroll()}})}resize(){if(this._bottomFixed)return;const t=(0,o.outerHeight)(this._content),e=(0,o.outerHeight)(this._wrapper);!this._options.vAlignBottom&&t<e?this.atStart()||this.scrollToStart():this.atEnd()?this.scrollToEnd():"number"==typeof this._stickyBottom&&this.setContentTop(Math.min(0,this._stickyBottom+(0,o.outerHeight)(this._wrapper)-(0,o.outerHeight)(this._content)))}resizeHeader(t){const e=t-this._headerHeight;this._headerHeight=t,this._scrollTargetTop+=e,this._shadowTop&&(this._shadowTop.style.top=this._headerHeight-this._shadowOffset+"px"),this.resize()}scrollTo(t,e){const i={position:"visible",areaHeight:t instanceof HTMLElement?(0,o.contentHeight)(t):0,...e};t instanceof HTMLElement&&(t=i.offsetTop||(0,o.position)(t).top);const s=(0,o.position)(this._content).top,n=this._content.getBoundingClientRect().height,a=this.getContainerHeightWithoutHeader();if(n-a-1<=0)return!0;const r=-1*(s-this._headerHeight),l=r+a;let h=0;if("visible"===i.position){if(t>r&&t+i.areaHeight<l)return!1;h=t+i.areaHeight>l?l-t-i.areaHeight:r-t}else"top"===i.position&&(h=r-t);return this.scroll(h,1),this._onScroll(),!1}scrollToEnd(){const t=(0,o.position)(this._content).top,e=(0,o.outerHeight)(this._content),i=(0,o.outerHeight)(this._wrapper),s=e>i?t+(i-(e+t))+1:1;return this.setContentTop(s),this._onScroll(),this}scrollToStart(){return this.setContentTop(this._headerHeight),this._onScroll(),this}currentPosition(){return Math.round((0,o.position)(this._content).top)}atStart(){return Math.round((0,o.position)(this._content).top)>=this._headerHeight}atEnd(t){"number"==typeof t&&isFinite(t)||(t=0);const e=Math.round((0,o.position)(this._content).top),i=Math.round((0,o.outerHeight)(this._content)),s=Math.round((0,o.outerHeight)(this._wrapper));return i-Math.abs(e)-1<=s+t}checkContentVisibility(){this._onContentVisible()}subscribeToContentVisible(t,e,i){this.visibilityCallbacks.push({id:t,element:e,callback:i})}triggerVisibilityCallbacks(t){this._onContentVisible(t)}save(){return this._saved={top:(0,o.position)(this._content).top,
height:(0,o.outerHeight)(this._content)},this}restore(){if(this._saved){if(this._saved.top===(0,o.position)(this._content).top&&this._saved.height===(0,o.outerHeight)(this._content))return this._saved=null,this;this._options.vAlignBottom&&(this._saved.top-=(0,o.outerHeight)(this._content)-this._saved.height,this._saved.top>this._headerHeight&&(this._saved.top=this._headerHeight)),this.setContentTop(this._saved.top),this._saved=null,this._onScroll(!0)}return this}fixBottom(){if(this._bottomFixed)return this;if(this._touch){const t=(0,o.outerHeight)(this._content),e=this._wrapper.scrollTop;this._tempIntervalID=setInterval(()=>{this._wrapper.scrollTop=e+((0,o.outerHeight)(this._content)-t)},0)}else this._content.style.top="auto",this._content.style.bottom=(0,o.outerHeight)(this._wrapper)-(0,o.position)(this._content).top-(0,o.outerHeight)(this._content)+"px";return this._bottomFixed=!0,this}releaseBottom(){return this._bottomFixed?(this._touch?clearInterval(this._tempIntervalID):(this._content.style.bottom="auto",this._content.style.top=(0,o.position)(this._content).top+"px"),this._bottomFixed=!1,this._onScroll(),this):this}setContentTop(t){return this._touch?this._options.vAlignBottom&&(0,o.outerHeight)(this._content)<(0,o.outerHeight)(this._wrapper)?(this._wrapper.style.overflowY="visible",this._content.style.position="absolute",this._content.style.bottom="0px"):(this._content.style.position="relative",this._content.style.position="auto",this._wrapper.style.overflowY="auto",this._wrapper.scrollTop=-t):this._content.style.top=t+"px",this}isContentShort(){return this.getContentHeight()<=this.getContainerHeightWithoutHeader()}destroy(){var t;this._animation&&this._animation.stop(),this._scrollBarWrapper&&this._scrollBarWrapper.remove(),this._shadowBottom&&this._shadowBottom.remove(),this._shadowTop&&this._shadowTop.remove(),this._draggable&&(this._draggable.destroy(),this._draggable=null),this._content.style.cssText="",this._wrapper.style.cssText="",null===(t=this._unsubscribe)||void 0===t||t.call(this)}_onScroll(t){this._touch||(this._content.style.bottom="auto"),this.scrolled.fire(),this._dragging&&!0!==t||this.updateScrollBar();const e=this.atStart(),i=this.atEnd();return this._shadowTop&&this._shadowTop.classList.toggle("i-invisible",!!e),this._shadowBottom&&this._shadowBottom.classList.toggle("i-invisible",!!i),this._onContentVisible(),!this._atStart&&e?(this._atStart=!0,this.scrolltostart.fire()):this._atStart&&!e&&(this._atStart=!1),!this._atEnd&&i?(this._atEnd=!0,this.scrolltoend.fire()):this._atEnd&&!i&&(this._atEnd=!1),this._options.vAlignBottom&&(this._stickyBottom=(0,o.outerHeight)(this._content)-Math.abs((0,o.position)(this._content).top)-(0,o.outerHeight)(this._wrapper)),(this._atStart||this._atEnd)&&("function"==typeof this._options.bubbleScrollEvent?Boolean(this._options.bubbleScrollEvent()):Boolean(this._options.bubbleScrollEvent))}_contentIsVisible(t){return(0,o.position)(t.element).top>-1*this.currentPosition()}_onContentVisible(t){if(!this.visibilityCallbacks.length)return
;const e=t||this._contentIsVisible.bind(this),i=[],s=this.visibilityCallbacks.filter((t,s)=>{if(!this._content.contains(t.element))return!1;const n=e(t);return n&&i.push(s),!n});i.forEach(e=>{this.visibilityCallbacks[e].callback(!!t)}),this.visibilityCallbacks=s}}},44521:(t,e,i)=>{"use strict";var s;i.d(e,{TradingPage:()=>s,MAX_PANEL_WIDTH:()=>n,PANEL_WIDTH:()=>a,PANEL_HEIGHT:()=>o}),function(t){t.DomPanel="domPanel",t.OrderPanel="orderPanel"}(s||(s={}));const n=400,a=315,o=451},33457:(t,e,i)=>{"use strict";i.r(e),i.d(e,{WidgetBarNews:()=>v});var s=i(16282),n=i(19493),a=i(51379);var o=i(708),r=i(7424),l=i(69701);function h(t){return function(t){let e,i=0;if(0===t.length)return i;for(var s=0;s<t.length;s++)e=t.charCodeAt(s),i=(i<<5)-i+e,i&=i;return i}(t.title+t.published)}var d=i(14071);const c=new Set([".","","","","","","","",",",":",";","-",""," ","(",")"]);function g(t,e){if(e<=0)return t;const i=t.length;if(i<=e)return t;if(i>e){const i=t[e],s=t[e-1];if(c.has(i)&&!c.has(s))return u(t,e)}let s=null;for(let i=e-1;i>0;i--){const e=t[i];if(c.has(e))s=i;else if(null!==s)return u(t,s)}return t+""}function u(t,e){return t.slice(0,e)+""}var p=i(29820),_=(i(4839),i(83660));const m=(0,d.getLogger)("News.Widget");class v{constructor(t){this.widgetName="widgetbar",this._newsScrollIterator=null,this._newsDiffResolver=null,this._updateWhenVisible=null,this._pendingNewsRequest=null,this._updateIntervalHandle=null,this._needsFullUpdate=!0,this._dataProvider=null,this._resize=this.resize.bind(this),this._onSymbolChange=this.onSymbolChange.bind(this),this._quoteSymbol=null,this._quoteMetaInfo=null,this._symbolName=null,this._bridge=t,this._widgetTitle=(0,s.ensureNotNull)(this._bridge.header.querySelector(".widgetbar-widgettitle")),this._container=t.container,this._prepareLayout(this._container);const e=function(){if(r.enabled("charting_library_base"))return new l.LibraryNewsProvider}();e&&(this._dataProvider=e),this._bridge.symbol.subscribe(this._onSymbolChange,{callWithLast:!0}),window.loginStateChange.subscribe(this,this._onLoginChange)}refresh(){this.update(!0)}update(t){if(!this._dataProvider)return;if(!this._bridge.visible.value())return void(null===this._updateWhenVisible&&(this._updateWhenVisible=t=>{t&&(null!==this._updateIntervalHandle&&this._setUpdateInterval(),this._bridge.visible.unsubscribe(this._updateWhenVisible),this._updateWhenVisible=null,this.update())},this._bridge.visible.subscribe(this._updateWhenVisible),this._updateIntervalHandle&&clearInterval(this._updateIntervalHandle)));const e=this._quoteMetaInfo;if(!e)return this._clear(),void this._stopLoading();const i=e.short_name;this._needsFullUpdate=t||i!==this._symbolName,this._symbolName=i,this._needsFullUpdate&&(this._startLoading(),this._updateIntervalHandle&&clearInterval(this._updateIntervalHandle),this._setUpdateInterval()),this._pendingNewsRequest&&this._pendingNewsRequest.cancel(),this._pendingNewsRequest=(0,o.makeCancelable)(this._dataProvider.getNews(e)),this._pendingNewsRequest.promise.then(t=>{this._pendingNewsRequest=null,
this._stopLoading(),this._setTitle(t.title),this.updateData(t.newsItems)}).catch(t=>{if(!(0,o.isCancelled)(t))throw this._pendingNewsRequest=null,this._stopLoading(),t})}updateData(t){var e;if(t&&t.length)if(this._needsFullUpdate){this._clear(),this._newsScrollIterator=function(t,e){if(!Number.isInteger(e))throw new TypeError("Chunks size must be an integer");if(e<=0)throw new RangeError("Chunk size must be a positive number");const i=t.slice();return{next(){const t=i.splice(0,e);return{value:t,done:!t.length}}}}(t,20);const i=this._newsScrollIterator.next().value,s=h(i[0]);this._newsDiffResolver=(e=s,{getDiff(t){if(0===t.length)return[];const i=t.findIndex(t=>h(t)===e);return e=h(t[0]),t.slice(0,-1===i?t.length:i)}}),this._renderItems(i,!1)}else{if(!this._newsDiffResolver)return void m.logError("Attempt to perform partial update before full update was committed");const e=this._newsDiffResolver.getDiff(t);this._renderItems(e,!0)}}resize(){this._scroll.resize()}highlight(t){t.classList.add(_["news-item--highlight"]);const e=()=>{t.classList.remove(_["news-item--highlight"]),t.removeEventListener("animationend",e)};t.addEventListener("animationend",e)}onSymbolChange(t){if((0,p.safeShortName)(t)===this._symbolName)return;const e=(0,a.getQuoteSessionInstance)("full");if(this._quoteSymbol&&e.unsubscribe(this._bridge.id,this._quoteSymbol),this._quoteMetaInfo=null,!t)return void(this._quoteSymbol=null);this._quoteSymbol=t,this._needsFullUpdate&&this.update(),this._bridge.clearNotifications();let i=!1;e.subscribe(this._bridge.id,t,s=>{i||("permission_denied"===s.status&&s.values&&s.values.alternative?this.onSymbolChange(s.values.alternative):s.values&&s.values.short_name&&(this._quoteMetaInfo={pro_name:s.values.pro_name,short_name:s.values.short_name,type:s.values.type,typespecs:s.values.typespecs,exchange:s.values.exchange},this.update(),i=!0,setTimeout(()=>{e.unsubscribe(this._bridge.id,t)},0)))})}destroy(){this._quoteSymbol&&(0,a.getQuoteSessionInstance)("full").unsubscribe(this._bridge.id,this._quoteSymbol),this._updateIntervalHandle&&(clearInterval(this._updateIntervalHandle),this._updateIntervalHandle=null),this._scroll.scrolltoend.unsubscribe(this,this._onScrollToEnd),this._updateWhenVisible&&this._bridge.visible.unsubscribe(this._updateWhenVisible),this._unmountAllNewsItems(),this._bridge.height.unsubscribe(this._resize),this._bridge.visible.unsubscribe(this._resize),this._bridge.symbol.unsubscribe(this._onSymbolChange),window.loginStateChange.unsubscribe(this,this._onLoginChange)}_setTitle(t){this._dataProvider&&(this._widgetTitle.textContent=t)}_clear(){this._clearListUI(),this._scroll.scrolltoend.unsubscribe(this,this._onScrollToEnd),this._scroll.scrollToStart(),this._scroll.scrolltoend.subscribe(this,this._onScrollToEnd)}_prepareLayout(t){this._container=t;const e=this._widget=document.createElement("div");e.classList.add("tv-news"),e.addEventListener("contextmenu",t=>{"a"!==t.target.tagName.toLowerCase()&&t.preventDefault()}),this._container.appendChild(e);const i=this._data=document.createElement("div")
;i.classList.add("ns-data"),i.setAttribute("data-name","news_list"),e.appendChild(i),this._scroll=new n.SidebarCustomScroll(this._widget,this._data),this._bridge.height.subscribe(this._resize),this._bridge.visible.subscribe(this._resize)}_setUpdateInterval(){if(!this._dataProvider)return;const t=this._dataProvider.timeout();t&&(this._updateIntervalHandle=setInterval(this.update.bind(this),t))}_renderItems(t,e=!1){if(!this._dataProvider)return;const i=document.createDocumentFragment();for(const s of t){const t={...s};t.shortDescription=g(s.shortDescription,170);const n=this._dataProvider.renderItem(t);this._dataProvider.addClickHandlers(s,n),e&&this.highlight(n),i.appendChild(n)}e?this._data.prepend(i):this._data.append(i)}_onScrollToEnd(){this._newsScrollIterator&&this._renderItems(this._newsScrollIterator.next().value,!1)}_onLoginChange(){window.is_authenticated||this.update()}_startLoading(){this._data.classList.add("loading")}_stopLoading(){this._data.classList.remove("loading")}_clearListUI(){this._data.innerHTML="",this._unmountAllNewsItems()}_unmountAllNewsItems(){this._dataProvider&&this._dataProvider.unmountItems()}}},19814:(t,e,i)=>{"use strict";function s(t){let e=null;return(i,...s)=>(null==e||e.abort(),e=new AbortController,null==i||i.addEventListener("error",()=>null==e?void 0:e.abort(),{once:!0}),t(e.signal,...s))}function n(t){if(!l(t))throw t}function a(t){if(l(t))throw t}function o(t){return(null==t?void 0:t.aborted)?Promise.reject(r()):new Promise((e,i)=>{null==t||t.addEventListener("abort",()=>i(r()),{once:!0})})}function r(){return new DOMException("Aborted","AbortError")}function l(t){return t instanceof Error&&"AbortError"===t.name}function h(t,e){return Promise.race([o(t),e])}async function d(t,e){let i;try{await h(t,new Promise(t=>{i=setTimeout(t,e)}))}finally{clearTimeout(i)}}i.d(e,{respectLatest:()=>s,skipAbortError:()=>n,rethrowAbortError:()=>a,isAbortError:()=>l,respectAbort:()=>h,delay:()=>d})},35127:(t,e,i)=>{"use strict";i.r(e),i.d(e,{DetailsContainer:()=>h,Widget:()=>d});var s=i(14071),n=i(19940),a=i(78280),o=i(19160);const r=new(i.n(o)())(!1),l=(0,s.getLogger)("Platform.GUI.Widgetbar.DetailsWidget");class h extends a.WidgetbarWidgetRenderer{constructor(t){super(t),this._mounted=!1,this._storedDetailsScreenPayload=null,this._contentRenderer=null,this._bridge=t,this.mount()}switchViewMode(t,e,i){this._storedDetailsScreenPayload={viewMode:t,symbolProName:e},this._contentRenderer&&this._contentRenderer(this._getContentRendererPayload().viewMode,this._getContentRendererPayload().symbolProName)}mount(){this._mounted?l.logWarn("Mount was called on already mounted widget"):(this._mounted=!0,this._load())}unmount(){this._mounted?(this._mounted=!1,r.setValue(!1),super.unmount(),this._loadModulePromise=null):l.logWarn("Unmount was called on already unmounted widget")}destroy(){super.destroy()}_load(){if(this._contentRenderer)return r.setValue(!0),void this._contentRenderer(this._getContentRendererPayload().viewMode,this._getContentRendererPayload().symbolProName)
;const t=this._loadModulePromise=Promise.all([Promise.all([i.e(3940),i.e(6520),i.e(8175),i.e(2688),i.e(6991)]).then(i.bind(i,65571)),Promise.resolve().then(i.t.bind(i,67294,19)),Promise.resolve().then(i.t.bind(i,73935,19))]).then(([e,i,s])=>{t===this._loadModulePromise&&(this._contentRenderer=(t,n)=>{s.render(i.createElement(e.DetailsWrapper,{viewModeSymbolPayload:n,bridge:this._bridge,viewMode:t,widgetHeaderElement:this._headerContainer}),this._container)},this._contentRenderer(this._getContentRendererPayload().viewMode,this._getContentRendererPayload().symbolProName),r.setValue(!0))})}_getContentRendererPayload(){var t;return null!==(t=this._storedDetailsScreenPayload)&&void 0!==t?t:{viewMode:n.ViewMode.DetailsInfo}}_handleLoginStateChange(){0}}const d=h},19940:(t,e,i)=>{"use strict";var s;i.d(e,{ViewMode:()=>s}),function(t){t.DetailsInfo="detailsInfo",t.SymbolNotes="symbolNotes"}(s||(s={}))},84380:(t,e,i)=>{"use strict";i.r(e),i.d(e,{ObjectTreeRenderer:()=>o});var s=i(63795),n=i(56417),a=i(93500);class o{constructor(t){this._viewModel=null,this._promise=null,this._activityChangeHandler=t=>{t?this.mount():this.destroy()},this._container=t.container,t.active.value()&&this.mount(),t.active.subscribe(this._activityChangeHandler)}mount(){const t=this._promise=Promise.all([Promise.resolve().then(i.t.bind(i,67294,19)),Promise.resolve().then(i.t.bind(i,73935,19)),Promise.all([i.e(9685),i.e(3876),i.e(7610),i.e(9448),i.e(8193),i.e(3894),i.e(3996),i.e(7936),i.e(9843),i.e(6637),i.e(3940),i.e(3660),i.e(6864),i.e(3230),i.e(5514),i.e(9253),i.e(268),i.e(3093),i.e(3668),i.e(4399),i.e(2688),i.e(5291),i.e(5181),i.e(5031)]).then(i.bind(i,71176)),Promise.all([i.e(9685),i.e(3876),i.e(7610),i.e(9448),i.e(8193),i.e(3894),i.e(3996),i.e(7936),i.e(9843),i.e(6637),i.e(3940),i.e(3660),i.e(6864),i.e(3230),i.e(5514),i.e(9253),i.e(268),i.e(3093),i.e(3668),i.e(4399),i.e(2688),i.e(5291),i.e(5181),i.e(5031)]).then(i.bind(i,36604)),Promise.all([i.e(9685),i.e(3876),i.e(7610),i.e(9448),i.e(8193),i.e(3894),i.e(3996),i.e(7936),i.e(9843),i.e(6637),i.e(3940),i.e(3660),i.e(6864),i.e(3230),i.e(5514),i.e(9253),i.e(268),i.e(3093),i.e(3668),i.e(4399),i.e(2688),i.e(5291),i.e(5181),i.e(5031)]).then(i.bind(i,49501)),(0,a.loadAllSourcesIcons)()]).then(([e,i,a,o,r])=>{if(this._promise===t){const t=(0,s.service)(n.CHART_WIDGET_COLLECTION_SERVICE);null===this._viewModel&&(this._viewModel=new r.ObjectTree(t.activeChartWidget)),i.render(e.createElement(o.ObjectTree,{nodeRenderer:a.NodeRenderer,viewModel:this._viewModel}),this._container)}})}unmount(){this._promise=null;const t=i.c[73935];if(t){t.exports.unmountComponentAtNode(this._container)}}destroy(){this.unmount(),null!==this._viewModel&&(this._viewModel.destroy(),this._viewModel=null)}}},29820:(t,e,i)=>{"use strict";i.d(e,{safeShortName:()=>n});var s=i(95418);function n(t){try{return(0,s.shortName)(t)}catch(e){return t}}},51720:(t,e,i)=>{"use strict";i.d(e,{hoverMouseEventFilter:()=>a,useAccurateHover:()=>o,useHover:()=>n});var s=i(67294);function n(){const[t,e]=(0,s.useState)(!1);return[t,{
onMouseOver:function(t){a(t)&&e(!0)},onMouseOut:function(t){a(t)&&e(!1)}}]}function a(t){return!t.currentTarget.contains(t.relatedTarget)}function o(t){const[e,i]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{const e=e=>{if(null===t.current)return;const s=t.current.contains(e.target);i(s)};return document.addEventListener("mouseover",e),()=>document.removeEventListener("mouseover",e)},[]),e}},96456:(t,e,i)=>{"use strict";i.d(e,{getPixelsFromEvent:()=>n});const s=[()=>navigator.userAgent.includes("Win")&&navigator.userAgent.includes("Chrome")?1/window.devicePixelRatio:1,()=>16,(t=(()=>0))=>{var e;return.8*(null!==(e=t())&&void 0!==e?e:0)}];function n(t,e=(()=>({}))){return{x:t.deltaX*s[t.deltaMode](()=>e().width),y:t.deltaY*s[t.deltaMode](()=>e().height)}}},43101:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17"><path stroke="currentColor" stroke-width="1.2" d="M1 1l15 15m0-15L1 16"/></svg>'},47243:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 10" width="20" height="10"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M2 1l8 8 8-8"/></svg>'},12757:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 23 16" width="23px" height="16px"><path d="M11.404 15.2c6.298 0 11.404-7.6 11.404-7.6S17.702 0 11.404 0 0 7.6 0 7.6s5.106 7.6 11.404 7.6zm-3.8-7.6c0-2.11 1.688-3.8 3.8-3.8s3.8 1.69 3.8 3.8-1.72 3.8-3.8 3.8c-2.112 0-3.8-1.69-3.8-3.8z"/></svg>'},21726:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M22.308 8.606a.5.5 0 0 0-.616 0l-11.5 9a.5.5 0 0 0 0 .788l11.5 9a.5.5 0 0 0 .616 0l11.5-9a.5.5 0 0 0 0-.788l-11.5-9zM22 26.366L11.311 18 22 9.635 32.689 18 22 26.365zm0 4l-11.192-8.76-.616.788 11.5 9a.5.5 0 0 0 .616 0l11.5-9-.616-.788L22 30.366zm0 4l-11.192-8.76-.616.788 11.5 9a.5.5 0 0 0 .616 0l11.5-9-.616-.788L22 34.366z"/></svg>'},38225:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><g fill="none" stroke="currentColor"><path d="M14.5 27.5c0 4.97 3.03 8 8 8 4.97 0 8-3.03 8-8v-6a3 3 0 0 0-3-3h-10a3 3 0 0 0-3 3v6z"/><path stroke-linecap="square" d="M22.5 19v16"/><path d="M27.5 18.5a5 5 0 1 0-10 0m13 3h2a2 2 0 0 1 2 2V25m-4 2.5h2a2 2 0 0 1 2 2V31M29 32.5h1.5a2 2 0 0 1 2 2V36m-18-14.5h-2a2 2 0 0 0-2 2V25m4 2.5h-2a2 2 0 0 0-2 2V31m5.5 1.5h-1.5a2 2 0 0 0-2 2V36"/><g transform="translate(12 8)"><circle cx="2.5" cy="2.5" r="2"/><path d="M3.911 3.911L7 7"/></g><g transform="translate(26 8)"><circle cx="4.5" cy="2.5" r="2"/><path d="M3.115 3.885L0 7"/></g></g></svg>'},32500:t=>{
t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m5 12v-1h4v1zm5-6h1v4h-1zm0 7h1v4h-1zm2-1v-1h4v1zm7 0v-1h10.5a4.5 4.5 0 0 1 4.5 4.5v14a4.5 4.5 0 0 1-4.5 4.5h-15a4.5 4.5 0 0 1-4.5-4.5V20h1v9.5a3.5 3.5 0 0 0 3.5 3.5h15a3.5 3.5 0 0 0 3.5-3.5v-14a3.5 3.5 0 0 0-3.5-3.5H19zm-3 5a1 1 0 0 0 0 2h12a1 1 0 0 0 0-2H16zm0-1h12a2 2 0 1 1 0 4H16a2 2 0 1 1 0-4zm-1 8v-1h8v1zm0 4v-1h8v1zm11-4v-1h3v1zm0 4v-1h3v1z"/></svg>'},73920:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m17 30a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m6 5a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m10 5a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2"/></svg>'},60453:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m18 18v-.5c0-1.2.6-2 1.5-2.7.8-.5 2-.8 3-.8s2.2.3 3 .8c.9.6 1.5 1.5 1.5 2.7a4 4 0 0 1-1.3 2.8l-2.3 2c-.3.3-.4.6-.4 1.2v.5h-1v-.5c0-.8.2-1.4.6-1.9l2.4-2c.6-.7 1-1.3 1-2.1a2 2 0 0 0-1-1.8c-.7-.5-1.6-.7-2.5-.7-1 0-1.8.2-2.5.7-.6.4-1 1-1 1.8v.5m3.5 8a1 1 0 0 0 0 5 1 1 0 0 0 0-5m0 1a1 1 0 0 1 0 3 1 1 0 0 1 0-3m0-17a1 1 0 0 0 0 25 1 1 0 0 0 0-25m0 1a1 1 0 0 1 0 23 1 1 0 0 1 0-23"/></svg>'},34525:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 45" width="45" height="45"><path fill="currentcolor" d="M16.5 21.5l8.146 8.146a.914.914 0 0 1-1.292 1.293L16.5 24.086l-6.854 6.853a.914.914 0 0 1-1.292-1.293L16.5 21.5zm0 4l6.146 6.146a1.914 1.914 0 0 0 2.708-2.707L16.5 20.086l-8.854 8.853a1.914 1.914 0 1 0 2.708 2.707L16.5 25.5zm13 0l8.146-8.146a.914.914 0 0 0-1.292-1.293L29.5 22.914l-6.854-6.853a.914.914 0 0 0-1.292 1.293L29.5 25.5zm0-4l6.146-6.146a1.914 1.914 0 0 1 2.708 2.707L29.5 26.914l-8.854-8.853a1.914 1.914 0 1 1 2.708-2.707L29.5 21.5z"/></svg>'},31683:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m29.5 11a4.5 4.5 0 0 1 4.5 4.5v14a4.5 4.5 0 0 1-4.5 4.5h-15a4.5 4.5 0 0 1-4.5-4.5v-14a4.5 4.5 0 0 1 4.5-4.5m0 1a3.5 3.5 0 0 0-3.5 3.5v14a3.5 3.5 0 0 0 3.5 3.5h15a3.5 3.5 0 0 0 3.5-3.5v-14a3.5 3.5 0 0 0-3.5-3.5M15 17v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1z"/></svg>'}}]);