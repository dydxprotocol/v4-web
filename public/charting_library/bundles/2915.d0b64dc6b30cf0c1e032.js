(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[2915],{316167:(t,e,o)=>{"use strict";o.d(e,{blendColors:()=>l,generateBlendColors:()=>a});var i=o(827147),r=o(822914),s=o(724377);const l=(t,e)=>(0,s.rgbaToString)((0,s.blendRgba)((0,s.parseRgba)(t),(0,s.parseRgba)(e)));function a(t,e){const o=(0,r.default)(t),s=Object.keys(o);for(const r of s){const s=t[r];(0,i.default)(s)?o[r]=l(s,e):o[r]=a(s,e)}return o}},662402:(t,e,o)=>{"use strict";var i;o.d(e,{TradedItemType:()=>i}),function(t){t[t.Position=0]="Position",t[t.Order=1]="Order"}(i||(i={}))},516703:(t,e,o)=>{"use strict";o.d(e,{priceToPips:()=>r,riskInCurrencyToPips:()=>s,riskInPercentToPips:()=>l,pipsToPrice:()=>a,pipsToRiskInCurrency:()=>n,pipsToRiskInPercent:()=>d});var i=o(960521);function r(t,e,o,r){return(0,i.Big)(t).minus(e).div(r).div(o).toNumber()}function s(t,e,o,r,s){const l=(0,i.Big)(o).mul(e).mul(s||1);if(l.eq(0))return 0;const a=(0,i.Big)(t).div(l).mul(r).toNumber();return Math.floor(a)}function l(t,e,o,r,s,l){const a=(0,i.Big)(r).mul(e).mul(l||1).mul(100);if(a.eq(0))return 0;const n=(0,i.Big)(t).mul(o).div(a).mul(s).toNumber();return Math.floor(n)}function a(t,e,o,r){return(0,i.Big)(o).mul(t).mul(r).plus(e).toNumber()}function n(t,e,o,r,s){return(0,i.Big)(t).mul(o).mul(e).mul(s||1).div(r).toNumber()}function d(t,e,o,r,s,l){return o?(0,i.Big)(t).mul(r).mul(e).mul(l||1).mul(100).div(o).div(s).toNumber():0}},992915:(t,e,o)=>{"use strict";o.d(e,{TradedGroupBase:()=>_t,isTradedGroupCustomSource:()=>ct});var i,r=o(822914),s=o(650151),l=o(509806),a=o(404493),n=o(744687),d=o(484727),c=o(122621),h=o(971204),u=o(662402),p=o(744517),_=o(837470),y=o(309142),f=o(314937),v=o(622394),m=o(574570),b=o(779292),C=o(777277),P=o(664114),g=o(927079),k=o(256776),T=o(86441),S=o(411404),M=o(601227),x=o(25775);function w(t,e,o,i,r,s){t.save(),t.fillStyle=s,t.fillRect(e,o,i,r),t.restore()}!function(t){t[t.Position=0]="Position",t[t.WithBracketButtons=1]="WithBracketButtons",t[t.Projection=2]="Projection",t[t.Default=3]="Default"}(i||(i={}));const L=M.CheckMobile.any();class D{constructor(t,e,o,i){this._height=L?23:19,this._bodyBorderRadius=4,this._font=null,this._offsets=null,this._alignedTop=null,this._wasSourceMoved=!1,this._cache=null,this._cacheWithOffset=null,this._textWidthCache=e,this._minMainTextWidthGetter=i,this._data=t,this._font=o,this._initCtx()}setFont(t){this._font!==t&&(this._font=t,this.clearCache())}data(){return this._data}clearCache(){this._cache=null,this._cacheWithOffset=null}applyOffset(t){this._offsets=t,this.clearCache()}setAlignedTopCoordinate(t){this._alignedTop=t}hitTest(t,e){var o;const i=this.rectWithOffsets(e),r=e.pixelRatio,l=Math.round(t.x*r),a=Math.round(t.y*r),n=l>=i.body.left,d=l<=i.body.right,c=n&&d;if(!(a>=i.top&&a<=i.bottom)||!c)return null;const h={cursorType:S.PaneCursorType.Default,hideCrosshairLinesOnHover:!0,activeItem:{id:this._data.id,part:8}};if(this._data.disabled)return new C.HitTestResult(C.HitTestResult.CUSTOM,h);let u={};if(void 0!==this._data.callbacks.onMove){const t=t=>{
this._data.callbacks.onMove&&this._data.callbacks.onMove(t),this._wasSourceMoved=!0},e=()=>{this._wasSourceMoved&&this._data.callbacks.onFinishMove&&this._data.callbacks.onFinishMove(),this._wasSourceMoved=!1};u={cursorType:S.PaneCursorType.Pointer,pressedMouseMoveHandler:t,touchMoveHandler:t,mouseUpHandler:e,touchEndHandler:e}}const p=this._data.callbacks.onContextMenu,_=this._data.callbacks.onContextMenu,y={...h,...u,hasOwnShortcutsBehaviourFor:{shiftKey:!0},contextMenuHandler:p,touchContextMenuHandler:_},f=Math.round(i.body.left/r),v=Math.round(i.top/r);if(l>=i.close.left&&d&&void 0!==this._data.callbacks.onClose){const t=Math.round(i.body.right/r),e=Math.round(i.close.left/r);return new C.HitTestResult(C.HitTestResult.CUSTOM,{...y,activeItem:{id:this._data.id,part:3},cursorType:S.PaneCursorType.Default,clickHandler:this._data.callbacks.onClose,tapHandler:this._data.callbacks.onClose,tooltip:{extendMargin:!0,text:(0,s.ensureDefined)(this._data.close).title,rect:{x:e,y:v,w:t-e,h:this._height}}})}if(null===(o=this._data.callbacks)||void 0===o?void 0:o.allInteractionsHandler)return new C.HitTestResult(C.HitTestResult.CUSTOM,{...h,clickHandler:this._data.callbacks.allInteractionsHandler,tapHandler:this._data.callbacks.allInteractionsHandler,contextMenuHandler:this._data.callbacks.allInteractionsHandler,touchContextMenuHandler:this._data.callbacks.allInteractionsHandler});if(l>=i.text.left&&l<i.close.left){const t=Math.round(i.text.left/r),e=Math.round(i.bottom/r),o=Math.round(i.text.width/r),s=this._data.callbacks.onText;if(void 0!==s){const i=i=>{const r=i.clientX-i.localX,l=i.clientY-i.localY,a=new T.Point(t+r,e+l);s((i=>i.x>t&&i.x<=t+o&&i.y>v&&i.y<=e),a)},r=i,l=t=>{t.preventDefault(),i(t)};return new C.HitTestResult(C.HitTestResult.CUSTOM,{...y,activeItem:{id:this._data.id,part:2},cursorType:S.PaneCursorType.Default,clickHandler:r,tapHandler:l,tooltip:{extendMargin:!0,text:this._data.text.title,rect:{x:t,y:v,w:o,h:this._height}}})}const l=Math.round(i.close.left/r);return new C.HitTestResult(C.HitTestResult.CUSTOM,{...y,tooltip:{extendMargin:!0,text:this._data.text.title,rect:{x:t,y:v,w:l-t,h:this._height}}})}const m=this._data.callbacks.onQtyModify;if(l>i.qty.left&&l<i.text.left&&void 0!==m){const t=Math.round(i.qty.left/r),e=Math.round(i.bottom/r),o=Math.round(i.qty.width/r),l=i=>{const r=i.clientX-i.localX,s=i.clientY-i.localY,l=new T.Point(t+o+r,e+s);m((i=>i.x>t&&i.x<=t+o&&i.y>v&&i.y<=e),l)},a=l,n=t=>{t.preventDefault(),l(t)},d=Math.round(i.text.left/r);return new C.HitTestResult(C.HitTestResult.CUSTOM,{...h,...u,activeItem:{id:this._data.id,part:1},cursorType:S.PaneCursorType.Default,clickHandler:a,tapHandler:n,tooltip:{extendMargin:!0,text:(0,s.ensureDefined)(this._data.qty).title,rect:{x:t,y:v,w:d-t,h:this._height}}})}if(n&&l<i.text.left&&void 0!==this._data.callbacks.onModify){const t=Math.round(i.text.left/r);return new C.HitTestResult(C.HitTestResult.CUSTOM,{...y,activeItem:{id:this._data.id,part:1},cursorType:S.PaneCursorType.Default,clickHandler:this._data.callbacks.onModify,
tapHandler:this._data.callbacks.onModify,tooltip:{extendMargin:!0,text:(0,s.ensureDefined)(this._data.qty).title,rect:{x:f,y:v,w:t-f,h:this._height}}})}return new C.HitTestResult(C.HitTestResult.CUSTOM,y)}drawBackground(t,e){!this._data.line.drawOnTop&&this._data.visible&&this._drawLine(t,e)}drawLine(t,e){this._isDataVisibleInViewport(e)&&this._data.line.drawOnTop&&this._data.visible&&this._drawLine(t,e)}drawPointOnLine(t,e,o){if(!this._isDataVisibleInViewport(e)||!this._data.point.visible||!this._data.visible)return;const i=this.rectWithOffsets(e),r=Math.round(3*e.pixelRatio),s=Math.max(1,Math.floor(1*e.pixelRatio)),l=s/2,a=2.5*e.pixelRatio+l,n=o+(l%1==0?0:.5),d=i.yMid+(l%1==0?0:.5);this._data.line.extend||this._data.bodyAlignment!==g.TradedGroupHorizontalAlignment.Left||(t.save(),t.strokeStyle=this._data.line.color,t.lineWidth=Math.max(1,Math.floor(this._data.line.thickness*e.pixelRatio)),(0,P.setLineStyle)(t,this._data.line.style),(0,P.drawHorizontalLine)(t,i.yMid,n,i.left),t.restore()),t.save(),t.lineWidth=s,(0,P.setLineStyle)(t,this._data.point.borderStyle),this._data.point.shadowColor&&!this._data.disabled&&(t.fillStyle=this._data.point.shadowColor,(0,P.createCircle)(t,n,d,a+r),t.fill()),t.strokeStyle=this._data.point.borderColor,t.fillStyle=this._data.point.backgroundColor,(0,P.createCircle)(t,n,d,a),t.fill(),t.stroke(),t.restore()}draw(t,e){if(!this._data.visible)return;const o=e.pixelRatio,i=this.rectWithOffsets(e);if(!this._isDataVisibleInViewport(e))return;const r=0!==i.qty.width,l=0!==i.text.width,a=0!==i.close.width,n=i.body.right-i.body.left,d=i.bottom-i.top,c=i.top+i.borderWidth,h=d-2*i.borderWidth,u=i.borderRadius-i.borderWidth;(0,P.drawRoundRectWithInnerBorder)(t,i.body.left,i.top,n,d,this._data.borderBackgroundColor,i.borderRadius,i.borderWidth,this._data.borderColor,this._data.borderStyle);let p=i.body.left+i.borderWidth;if(r){const e=(0,s.ensureDefined)(this._data.qty);this._drawQtyWithBackground(t,o,i,!0,!a&&!l),p+=i.qty.width,i.qty.rightDividerWidth&&(w(t,p,c,i.qty.rightDividerWidth,h,e.dividerColor),p+=i.qty.rightDividerWidth)}if(l&&(this._drawTextWithBackground(t,o,i,!r,!a),p+=i.text.width,i.text.rightDividerWidth&&(w(t,p,c,i.text.rightDividerWidth,h,this._data.text.dividerColor),p+=i.text.rightDividerWidth)),a){const e=(0,s.ensureDefined)(this._data.close),r=i.body.right-p-i.borderWidth;(0,P.drawRoundRectWithInnerBorder)(t,p,c,r,h,e.backgroundColor,[0,u,u,0]),e.active.visible&&(0,P.drawRoundRectWithInnerBorder)(t,p,c,r,h,e.active.backgroundColor,[0,u,u,0]),this._drawCloseButton(t,o,p,i.top,i.close.width,d,i.borderWidth)}}rect(t){return null===this._cache&&(this._cache=this._calculateCacheRect(t)),this._cache}rectWithOffsets(t){return null===this._cacheWithOffset&&(this._cacheWithOffset=this._calculateCacheRectWithOffsets(t)),this._cacheWithOffset}_calculateCacheRect(t){var e
;const o=t.pixelRatio,i=Math.round(t.cssWidth*o),r=Math.max(1,Math.floor(1*o)),s=this._bodyBorderRadius,l=Math.max(s,Math.floor(s*o)),a=this._quantityWidth(this._ctxInternal),n=Math.round(a*o),d=this._mainTextWidth(this._ctxInternal),c=Math.round(d*o),h=this._data.callbacks.onClose?this._closeWidth():0,u=Math.round(h*o);let p=0;const _=a&&(d||h),y=d&&h;p+=_&&1,p+=y&&1;const f=n+c+u+r*p+2*r;let v=Math.round(this._height*o);const m=Math.max(1,Math.floor(o));v%2!=m%2&&(v+=1);const b=Math.round(this._data.y*o),C=Math.floor(b+m/2-v/2)-Math.floor(.5*o),P=this._data.bodyAlignment===g.TradedGroupHorizontalAlignment.Center?Math.round(40*i/100):Math.round(this._data.rightPadding*o);let k=P;this._data.bodyAlignment===g.TradedGroupHorizontalAlignment.Left&&(k=i-P-f);const T=i-k,S=T-f,M=S+n+(n&&r)+(n&&r),x=M+c+(c&&r);return{borderWidth:r,borderRadius:l,yMid:b,top:C,bottom:C+v,left:S,right:T,body:{left:S,right:T},qty:{width:n,left:S+(n&&r),rightDividerWidth:_&&(null===(e=this._data.qty)||void 0===e?void 0:e.isDividerVisible)?r:0},text:{width:c,left:M,rightDividerWidth:y?r:0},close:{width:u,left:x}}}_calculateCacheRectWithOffsets(t){const e=this.rect(t),{left:o,right:i}=this._calcCoordinateWithOffset(e.left,e.right),{left:r,right:s}=this._calcCoordinateWithOffset(e.body.left,e.body.right);return{...e,left:o,right:i,top:this._alignedTop?this._alignedTop:e.top,bottom:this._alignedTop?this._alignedTop+(e.bottom-e.top):e.bottom,body:{...e.body,left:r,right:s},qty:{...e.qty,left:this._calcCoordinateWithOffset(e.qty.left,e.qty.left+e.qty.width).left},text:{...e.text,left:this._calcCoordinateWithOffset(e.text.left,e.text.left+e.text.width).left},close:{...e.close,left:this._calcCoordinateWithOffset(e.close.left,e.close.left+e.close.width).left}}}_calcCoordinateWithOffset(t,e){var o,i,r,s;if(null!==this._cache){const l=null!==(i=null===(o=this._offsets)||void 0===o?void 0:o.leftmostForItemOffset)&&void 0!==i?i:null;if(null!==l){const o=t-(this._cache.left-l);return{left:o,right:o+(e-t)}}const a=null!==(s=null===(r=this._offsets)||void 0===r?void 0:r.rightmostForItemOffset)&&void 0!==s?s:null;if(null!==a){const o=e+(a-this._cache.right);return{left:o-(e-t),right:o}}}return{left:t,right:e}}_calcAllWidth(t,e,o,i,r,s){return e+o+i+r+2*s}_isDataVisibleInViewport(t){const e=Math.ceil(this._height/2);return this._data.y>=-e&&this._data.y<=t.cssHeight+e}_mainTextWidth(t){return this._data.text.text?this._minMainTextWidthGetter(this._data,t)+14:0}_closeWidth(){return 23}_measureTextWidth(t,e){if(!e)return 0;const o=t.font;t.font=(0,s.ensureNotNull)(this._font);const i=Math.ceil(this._textWidthCache.measureText(t,e));return t.font=o,i}_textWidth(t,e){const o=this._measureTextWidth(t,e);return o?Math.round(14+o):0}_quantityWidth(t){var e,o,i;const r=this._measureTextWidth(t,null===(e=this._data.qty)||void 0===e?void 0:e.text);return Math.round(Math.max(this._height,14+r,null!==(i=null===(o=this._data.qty)||void 0===o?void 0:o.minTextWidth)&&void 0!==i?i:0))}_drawLine(t,e){const o=e.pixelRatio,i=this.rectWithOffsets(e),r=Math.round(e.physicalWidth)
;t.save(),t.strokeStyle=this._data.line.color,t.lineWidth=Math.max(1,Math.floor(this._data.line.thickness*o)),(0,P.setLineStyle)(t,this._data.line.style),(0,P.drawHorizontalLine)(t,i.yMid,i.body.right,r),this._data.line.extend&&(0,P.drawHorizontalLine)(t,i.yMid,0,i.body.right),t.restore()}_drawQtyBackground(t,e,o,i,r){const l=(0,s.ensureDefined)(this._data.qty),a=o.bottom-o.top,n=o.top+o.borderWidth,d=a-2*o.borderWidth,c=o.borderRadius-o.borderWidth;let h=0;r?h=i?c:[0,c,c,0]:i&&(h=[c,0,0,c]),(0,P.drawRoundRectWithInnerBorder)(t,o.qty.left,n,o.qty.width,d,l.backgroundColor,h),l.active.visible&&(0,P.drawRoundRectWithInnerBorder)(t,o.qty.left,n,o.qty.width,d,l.active.backgroundColor,h)}_drawQtyWithBackground(t,e,o,i,r){const l=(0,s.ensureDefined)(this._data.qty);this._drawQtyBackground(t,e,o,i,r);const a=(o.top+o.bottom)/2,n=o.qty.left+o.qty.width/2;this._drawText(t,e,l.text,l.textColor,n,a)}_drawTextWithBackground(t,e,o,i,r){const l=o.bottom-o.top,a=o.top+o.borderWidth,n=l-2*o.borderWidth,d=o.borderRadius-o.borderWidth;let c=0;r?c=i?d:[0,d,d,0]:i&&(c=[d,0,0,d]),(0,P.drawRoundRectWithInnerBorder)(t,o.text.left,a,o.text.width,n,this._data.text.backgroundColor,c),this._data.text.active.visible&&(0,P.drawRoundRectWithInnerBorder)(t,o.text.left,a,o.text.width,n,this._data.text.active.backgroundColor,c);const h=o.top+l/2,u=o.text.left+o.text.width/2,p=(this._data.qty||this._data.text).text,_=this._getTextYMidCorrection(t,p)*e;(0,x.drawText)(t,e,this._data.text.text,u,h,_,this._data.text.textColor,(0,s.ensureNotNull)(this._font))}_drawText(t,e,o,i,r,l,a){const n=o.split("@").join("").toUpperCase(),d=this._getTextYMidCorrection(t,n)*e;(0,x.drawText)(t,e,o,r,l,d,i,(0,s.ensureNotNull)(this._font),a)}_drawUnderlinedText(t,e,o,i,r,l){const a=this._getTextYMidCorrection(t,o)*e,n=this._getTextMetrics(t,o);(0,x.drawUnderlinedText)(t,e,o,r,l,a,i,(0,s.ensureNotNull)(this._font),n)}_getTextYMidCorrection(t,e){const o=t.font;t.font=(0,s.ensureNotNull)(this._font);const i=this._textWidthCache.yMidCorrection(t,e);return t.font=o,i}_getTextMetrics(t,e){const o=t.font;t.font=(0,s.ensureNotNull)(this._font);const i=this._textWidthCache.getMetrics(t,e);return t.font=o,i}_drawCloseButton(t,e,o,i,r,l,a){const n=(0,s.ensureDefined)(this._data.close);t.save(),t.lineWidth=a,t.strokeStyle=n.iconColor;const d=i+l,c=Math.max(1,Math.ceil(7*e)),h=Math.round((r-c)/2),u=Math.round((l-c)/2);(0,P.drawPoly)(t,[new T.Point(o+h,i+u),new T.Point(o+h+c,d-u)],!0),(0,P.drawPoly)(t,[new T.Point(o+h+c,i+u),new T.Point(o+h,d-u)],!0),t.restore()}_initCtx(){const t=document.createElement("canvas");t.width=0,t.height=0,this._ctxInternal=(0,s.ensureNotNull)(t.getContext("2d"))}}function I(t){return t.hasOwnProperty("tp")&&t.hasOwnProperty("sl")}class B extends D{constructor(){super(...arguments),this._wasTPMoved=!1,this._wasSLMoved=!1}hitTest(t,e){var o,i;const r=e.pixelRatio,l=this.rectWithOffsets(e),a=Math.round(t.x*r),n=Math.round(t.y*r),d=a>=l.left,c=a<=l.right,h=d&&c;if(!(n>=l.top&&n<=l.bottom)||!h)return null;const u={cursorType:S.PaneCursorType.Default,
hideCrosshairLinesOnHover:!0,activeItem:{id:this._data.id,part:8},contextMenuHandler:this._data.callbacks.onContextMenu,touchContextMenuHandler:this._data.callbacks.onContextMenu};if(this._data.disabled)return new C.HitTestResult(C.HitTestResult.CUSTOM,u);const p=Math.round(l.top/r),_=void 0!==this._data.callbacks.onMoveProjectionTP&&1===(null===(o=this._data.tp)||void 0===o?void 0:o.visibility);if(_&&a>=l.tp.left&&a<l.tp.left+l.tp.width){const t=Math.round(l.tp.left/r),e=Math.round(l.tp.width/r),o=t=>{this._data.callbacks.onMoveProjectionTP&&this._data.callbacks.onMoveProjectionTP(t),this._wasTPMoved=!0},i=()=>{this._wasTPMoved&&this._data.callbacks.onFinishMoveTP&&this._data.callbacks.onFinishMoveTP(),this._wasTPMoved=!1};return new C.HitTestResult(C.HitTestResult.CUSTOM,{...u,cursorType:S.PaneCursorType.Pointer,activeItem:{id:(0,s.ensureDefined)(this._data.tp).id,part:5},pressedMouseMoveHandler:o,touchMoveHandler:o,mouseUpHandler:i,touchEndHandler:i,tooltip:{extendMargin:!0,text:(0,s.ensureDefined)(this._data.tp).title,rect:{x:t,y:p,w:e,h:this._height}}})}const y=l.sl.left+l.sl.width,f=void 0!==this._data.callbacks.onMoveProjectionSL&&1===(null===(i=this._data.sl)||void 0===i?void 0:i.visibility);if(f&&a>=l.sl.left&&a<y){const t=Math.round(l.sl.width/r),e=Math.round(l.sl.left/r),o=Math.round(l.bottom/r),i=t=>{this._data.callbacks.onMoveProjectionSL&&this._data.callbacks.onMoveProjectionSL(t),this._wasSLMoved=!0},a=()=>{this._wasSLMoved&&this._data.callbacks.onFinishMoveSL&&this._data.callbacks.onFinishMoveSL(),this._wasSLMoved=!1};let n,d;const c=this._data.callbacks.onClickSL;if(void 0!==c){const i=i=>{const r=i.clientX-i.localX,s=i.clientY-i.localY,l=new T.Point(e+r,o+s);c((i=>i.x>e&&i.x<=e+t&&i.y>p&&i.y<=o),l)};n=i,d=t=>{t.preventDefault(),i(t)}}return new C.HitTestResult(C.HitTestResult.CUSTOM,{...u,cursorType:c?S.PaneCursorType.Default:S.PaneCursorType.Pointer,activeItem:{id:(0,s.ensureDefined)(this._data.sl).id,part:6},pressedMouseMoveHandler:i,touchMoveHandler:i,mouseUpHandler:a,touchEndHandler:a,clickHandler:n,tapHandler:d,tooltip:{extendMargin:!0,text:(0,s.ensureDefined)(this._data.sl).title,rect:{x:e,y:p,w:t,h:this._height}}})}const v=y-l.body.left<0?a>=y&&a<l.body.left:a>=l.body.right&&a<l.tp.left;if((_||f)&&v)return new C.HitTestResult(C.HitTestResult.CUSTOM,u);if(this._hasConfirmButton()&&(0,s.ensureDefined)(this._data.confirm)){const t=l.confirm.left+l.confirm.width;if(a>=l.confirm.left&&a<t){let t={};if(void 0!==this._data.callbacks.onMove){const e=t=>{this._data.callbacks.onMove&&this._data.callbacks.onMove(t),this._wasSourceMoved=!0},o=()=>{this._wasSourceMoved&&this._data.callbacks.onFinishMove&&this._data.callbacks.onFinishMove(),this._wasSourceMoved=!1};t={pressedMouseMoveHandler:e,touchMoveHandler:e,mouseUpHandler:o,touchEndHandler:o}}return new C.HitTestResult(C.HitTestResult.CUSTOM,{...u,...t,activeItem:{id:this._data.id,part:7},clickHandler:this._data.callbacks.onConfirm,tapHandler:this._data.callbacks.onConfirm})}const o=this._calcConfirmRect(e.pixelRatio,l.borderWidth).offset
;if(t-l.body.left<0?a>=t&&a<l.tp.left:a>=l.confirm.left-o&&a<l.confirm.left)return new C.HitTestResult(C.HitTestResult.CUSTOM,u)}return super.hitTest(t,e)}draw(t,e){if(super.draw(t,e),!this._isDataVisibleInViewport(e)||!this._data.visible)return;const o=this.rectWithOffsets(e),i=o.bottom-o.top,r=o.yMid;this._isTPSLVisible()&&(0!==o.tp.width&&1===(0,s.ensureDefined)(this._data.tp).visibility&&this._drawButton(t,e,i,o.borderRadius,r,o.tp,this._data.tp),0!==o.sl.width&&1===(0,s.ensureDefined)(this._data.sl).visibility&&this._drawButton(t,e,i,o.borderRadius,r,o.sl,this._data.sl)),this._hasConfirmButton()&&this._drawButton(t,e,i,o.borderRadius,r,o.confirm,this._data.confirm)}rect(t){return super.rect(t)}rectWithOffsets(t){return super.rectWithOffsets(t)}_calculateCacheRectWithOffsets(t){let e=super._calculateCacheRectWithOffsets(t);return e={...e,tp:{...e.tp,left:this._calcCoordinateWithOffset(e.tp.left,e.tp.left+e.tp.width).left},sl:{...e.sl,left:this._calcCoordinateWithOffset(e.sl.left,e.sl.left+e.sl.width).left}},void 0!==e.confirm&&(e.confirm={...e.confirm,left:this._calcCoordinateWithOffset(e.confirm.left,e.confirm.left+e.confirm.width).left}),e}_calculateCacheRect(t){const e=super._calculateCacheRect(t),o=this._calcTPSLRect(t.pixelRatio,e.borderWidth),i=this._calcConfirmRect(t.pixelRatio,e.borderWidth);let r=0,s=0;const l=this._data.bodyAlignment===g.TradedGroupHorizontalAlignment.Left;l?(s=e.body.right+o.offset,r=s+o.tp-(o.tp>0?e.borderWidth:0)):(r=e.body.left-o.offset-o.sl,s=r-(o.tp>0?o.tp-e.borderWidth:0));let a=0;i.confirm>0&&(a=l?r+o.sl+i.offset:s-i.confirm-i.offset-e.borderWidth);let n=a||s,d=e.right;return l&&(n=e.left,d=a>0?a+i.confirm:r+o.sl),{...e,left:n,right:d,tp:{width:o.tp,left:s},sl:{width:o.sl,left:r},confirm:{width:i.confirm,left:a}}}_drawLine(t,e){var o,i;if(!this._data.callbacks.onFinishMoveSL&&!this._data.callbacks.onFinishMoveTP)return void super._drawLine(t,e);const r=e.pixelRatio,s=this.rectWithOffsets(e),l=Math.round(e.physicalWidth);if(t.save(),t.strokeStyle=this._data.line.color,t.lineWidth=Math.max(1,Math.floor(this._data.line.thickness*r)),(0,P.setLineStyle)(t,this._data.line.style),(0,P.drawHorizontalLine)(t,s.yMid,s.body.right,l),this._data.line.extend)(0,P.drawHorizontalLine)(t,s.yMid,0,s.body.left);else{const e=1===(null===(o=this._data.tp)||void 0===o?void 0:o.visibility),r=1===(null===(i=this._data.sl)||void 0===i?void 0:i.visibility);if(e||r){const e=r?s.sl.left+s.sl.width:s.tp.left+s.tp.width;(0,P.drawHorizontalLine)(t,s.yMid,e,s.body.left)}if(this._hasConfirmButton()){const e=s.confirm.left+s.confirm.width;(0,P.drawHorizontalLine)(t,s.yMid,e,s.body.left)}}t.restore()}_calcAllWidth(t,e,o,i,r,s){const l=super._calcAllWidth(t,e,o,i,r,s);if(!this._data.tp&&!this._data.sl&&!this._hasConfirmButton())return l;const a=this._calcTPSLRect(t,s),n=this._calcConfirmRect(t,s);return l+a.tp+a.sl+a.offset+n.confirm+n.offset}_calcConfirmRect(t,e){if(!this._hasConfirmButton())return{confirm:0,offset:0};const o=2*e,i=Math.round(11*t),r=this._textWidth(this._ctxInternal,(0,
s.ensureDefined)(this._data.confirm).text);return{confirm:Math.round(r*t)+(r&&o)+(r&&i),offset:Math.round(10*t)}}_calcTPSLRect(t,e){const o=2*e,i=this._textWidth(this._ctxInternal,void 0!==this._data.tp?this._data.tp.text:""),r=Math.round(i*t)+(i&&o),s=this._textWidth(this._ctxInternal,void 0!==this._data.sl?this._data.sl.text:""),l=Math.round(s*t)+(s&&o);return{tp:r,sl:l,offset:l>0||r>0?Math.round(10*t):0}}_drawButton(t,e,o,i,r,s,l){if(void 0===l)return;const a=this.rectWithOffsets(e);(0,P.drawRoundRectWithInnerBorder)(t,s.left,a.top,s.width,o,l.backgroundColor,i),l.active.visible&&(0,P.drawRoundRectWithInnerBorder)(t,s.left,a.top,s.width,o,l.active.backgroundColor,i);const n=l.active.visible&&void 0!==l.active.borderColor?l.active.borderColor:l.borderColor;(0,P.drawRoundRectWithInnerBorder)(t,s.left,a.top,s.width,o,"transparent",i,a.borderWidth,n,l.borderStyle);const d=s.left+s.width/2;l.underlineText?this._drawUnderlinedText(t,e.pixelRatio,l.text,l.textColor,d,r):this._drawText(t,e.pixelRatio,l.text,l.textColor,d,r)}_isTPSLVisible(){return Boolean(this._data.tp)||Boolean(this._data.sl)}_hasConfirmButton(){return Boolean(this._data.callbacks.onConfirm&&this._data.confirm)}}class O extends D{constructor(){super(...arguments),this._left=0}hitTest(t,e){const o=e.pixelRatio,i=this.rectWithOffsets(e),r=Math.round(t.x*o),s=Math.round(t.y*o),l=r>=i.left,a=r<=i.right,n=l&&a;if(!(s>=i.top&&s<=i.bottom)||!n)return null;const d={cursorType:S.PaneCursorType.Default,hideCrosshairLinesOnHover:!0,activeItem:{id:this._data.id}};return this._data.disabled?new C.HitTestResult(C.HitTestResult.CUSTOM,d):new C.HitTestResult(C.HitTestResult.CUSTOM,{...d,activeItem:{id:this._data.id,part:8}})}applyOffset(t){const e=(0,s.ensureDefined)(this._data.drawWithTPOffset?t.projItemTpLeft:this._data.drawWithSLOffset?t.projItemSlLeft:0);this._left!==e&&(this._left=e,this.clearCache())}_drawQtyWithBackground(t,e,o,i,r){const l=(0,s.ensureDefined)(this._data.qty),a=o.top+(o.bottom-o.top)/2,n=o.qty.left+o.qty.width/2;this._drawText(t,e,l.text,l.textColor,n,a)}_drawTextWithBackground(t,e,o,i,r){const s=o.top+(o.bottom-o.top)/2,l=o.text.left+o.text.width/2;this._drawText(t,e,this._data.text.text,this._data.text.textColor,l,s)}_calculateCacheRect(t){const e=t.pixelRatio;let o=super._calculateCacheRect(t);const i=2*o.borderWidth,r=this._mainTextWidth(this._ctxInternal),s=this._quantityWidth(this._ctxInternal),l=Math.round(r*e+s*e)+(r&&i)+(s&&o.borderWidth),a=this._left+l;return o={...o,left:this._left,right:a,body:{...o.body,left:this._left,right:a},text:{left:this._left+o.qty.width+o.borderWidth,width:o.text.width,rightDividerWidth:0},qty:{left:this._left,width:o.qty.width,rightDividerWidth:o.qty.rightDividerWidth}},this._data.bodyAlignment!==g.TradedGroupHorizontalAlignment.Left?o:{...o,top:o.top,bottom:o.bottom,body:{left:o.body.left-o.text.width-Number(o.qty.rightDividerWidth)-o.borderWidth,right:o.qty.left+o.qty.width+o.borderWidth},text:{left:o.body.left-o.text.width-Number(o.qty.rightDividerWidth),width:o.text.width+Number(o.qty.rightDividerWidth),
rightDividerWidth:o.qty.rightDividerWidth},qty:{left:o.qty.left,width:o.qty.width-Number(o.qty.rightDividerWidth),rightDividerWidth:0}}}_calcAllWidth(t,e,o,i,r,s){const l=2*s;return Math.round(o*t)+(o&&l)}}class W extends B{constructor(){super(...arguments),this._bodyBorderRadius=4}hitTest(t,e){const o=e.pixelRatio,i=this.rectWithOffsets(e),r=Math.round(t.x*o),l=Math.round(t.y*o),a=r>=i.left,n=r<=i.right,d=a&&n,c=l>=i.top&&l<=i.bottom,h=Math.round(i.top/o);if(!c||!d)return null;const u={cursorType:S.PaneCursorType.Default,hideCrosshairLinesOnHover:!0,activeItem:{id:this._data.id,part:8}};if(this._data.disabled)return new C.HitTestResult(C.HitTestResult.CUSTOM,u);const p=this._hasReverseButton()&&(0,s.ensureDefined)(this._data.reverse);if(p&&1===p.visibility){const t=i.reverse.left+i.reverse.width;if(r>=i.reverse.left&&r<t){const t=Math.round(i.reverse.left/o),e=Math.round(i.reverse.width/o);return new C.HitTestResult(C.HitTestResult.CUSTOM,{activeItem:{id:this._data.id,part:4},cursorType:S.PaneCursorType.Default,hideCrosshairLinesOnHover:!0,contextMenuHandler:this._data.callbacks.onContextMenu,touchContextMenuHandler:this._data.callbacks.onContextMenu,clickHandler:this._data.callbacks.onReverse,tapHandler:this._data.callbacks.onReverse,tooltip:{text:p.title,rect:{x:t,y:h,w:e,h:this._height}}})}const s=this._calcReverseRect(e.pixelRatio).offset;if(t-i.body.left<0?r>=t&&r<i.tp.left:r>=i.reverse.left-s&&r<i.reverse.left)return new C.HitTestResult(C.HitTestResult.CUSTOM,u)}return super.hitTest(t,e)}draw(t,e){if(super.draw(t,e),!this._isReverseVisible()||!this._isDataVisibleInViewport(e)||!this._data.visible)return;const o=this.rectWithOffsets(e);this._drawReverseButton(t,e.pixelRatio,o.reverse.left,o.top,o.reverse.width,o.bottom-o.top,o.borderWidth,o.borderRadius)}rect(t){return super.rect(t)}rectWithOffsets(t){return super.rectWithOffsets(t)}_calculateCacheRectWithOffsets(t){const e=super._calculateCacheRectWithOffsets(t);return{...e,reverse:{...e.reverse,left:this._calcCoordinateWithOffset(e.reverse.left,e.reverse.left+e.reverse.width).left}}}_calculateCacheRect(t){var e;const o=super._calculateCacheRect(t);if(!(null===(e=this._data)||void 0===e?void 0:e.callbacks.onReverse)||!this._hasReverseButton())return{...o,reverse:{width:0,left:0}};const i=this._calcReverseRect(t.pixelRatio),r=this._data.bodyAlignment===g.TradedGroupHorizontalAlignment.Left,s=r?o.right+i.offset:o.left-i.width-i.offset,l=r?o.left:s,a=r?s+i.width:o.right;return{...o,left:l,right:a,reverse:{width:i.width,left:s}}}_calcAllWidth(t,e,o,i,r,s){var l;const a=super._calcAllWidth(t,e,o,i,r,s);if(!(null===(l=this._data)||void 0===l?void 0:l.callbacks.onReverse)||!this._hasReverseButton())return a;const n=this._calcReverseRect(t);return a+n.width+n.offset}_drawLine(t,e){var o;if(!(null===(o=this._data)||void 0===o?void 0:o.callbacks.onReverse))return void super._drawLine(t,e);const i=e.pixelRatio,r=this.rectWithOffsets(e),s=Math.round(e.physicalWidth),l=r.reverse.left+r.reverse.width;if(t.save(),t.strokeStyle=this._data.line.color,
t.lineWidth=Math.max(1,Math.floor(this._data.line.thickness*i)),(0,P.setLineStyle)(t,this._data.line.style),(0,P.drawHorizontalLine)(t,r.yMid,r.body.right,s),this._isReverseVisible()&&(0,P.drawHorizontalLine)(t,r.yMid,l,r.body.left),this._data.line.extend){const e=this._isReverseVisible()?r.reverse.left:r.body.left;(0,P.drawHorizontalLine)(t,r.yMid,0,e)}t.restore()}_calcReverseRect(t){return{width:Math.round(29*t),offset:Math.round(10*t)}}_drawReverseButton(t,e,o,i,r,l,a,n){const d=(0,s.ensureDefined)(this._data.reverse),c=d.active;t.save(),(0,P.drawRoundRectWithInnerBorder)(t,o,i,r,l,d.backgroundColor,n,a,this._data.borderColor),c.visible&&(0,P.drawRoundRectWithInnerBorder)(t,o,i,r,l,c.backgroundColor,n,a,"transparent");const h=Math.round(3*e),u=Math.round(3*e),p=Math.round(9*e),_=Math.round(o+(r-h)/2),y=Math.round(_+h),f=i+a+Math.round((l-p)/2-a),v=f+p,m=d.iconColor;t.lineWidth=a,(0,x.drawHalfArrow)(t,_,f,m,!1,p,u),(0,x.drawHalfArrow)(t,y,v,m,!0,p,u),t.restore()}_isReverseVisible(){return this._hasReverseButton()&&1===(0,s.ensureDefined)(this._data.reverse).visibility}_hasReverseButton(){return Boolean(this._data.callbacks.onReverse&&this._data.reverse)}}class R{constructor(t){this._prevCssWidth=null,this._prevPixelRatio=null,this._prevFontSize=null,this._font=null,this._itemsRectsInfo=null,this._textWidthCache=new k.TextWidthCache,this._minMainTextWidthCache=new Map,this._items=[],this._tradedGroupRenderersController=t}itemRenderers(){return this._items}clearCache(){this._itemsRectsInfo=null,this._tradedGroupRenderersController.invalidateCache()}setData(t){this._data=t}setFontSize(t){if(this._prevFontSize!==t){this._checkCacheValid({pixelRatio:this._prevPixelRatio,cssWidth:this._prevCssWidth},t),this._prevFontSize=t,this._font=null===t?null:(0,b.makeFont)(t,m.CHART_FONT_FAMILY,"","normal");for(const t of this._items)t.setFont(this._font)}}clearItems(){this._items=[]}addItem(t){const e=function(t,e,o,r){if(t.type===i.Position)return new W(t,e,o,r);if(t.type===i.WithBracketButtons)return new B(t,e,o,r);if(t.type===i.Projection)return new O(t,e,o,r);if(t.type===i.Default)return new D(t,e,o,r);throw new Error("Unknown traded item renderer's type")}(t,this._textWidthCache,(0,s.ensureNotNull)(this._font),this._minTextWidth.bind(this));this._items.push(e)}hitTest(t,e){var o;if(!this._paneHasVisibleItems())return null;this._checkCacheValid(e,this._prevFontSize),this._tradedGroupRenderersController.alignItems(e),this._calcItemsRectsInfo(e);for(let o=this._items.length-1;o>=0;o--){const i=this._items[o];i.applyOffset((0,s.ensureNotNull)(this._itemsRectsInfo));const r=i.hitTest(t,e);if(null!==r)return r}return(null===(o=this._data)||void 0===o?void 0:o.disableNoOverlap)?new C.HitTestResult(C.HitTestResult.MOVEPOINT_BACKGROUND,{clickHandler:this._data.disableNoOverlap,tapHandler:this._data.disableNoOverlap,contextMenuHandler:this._data.disableNoOverlap,touchContextMenuHandler:this._data.disableNoOverlap}):null}drawBackground(t,e){if(this._paneHasVisibleItems()){this._checkCacheValid(e,this._prevFontSize),
this._tradedGroupRenderersController.alignItems(e),this._calcItemsRectsInfo(e);for(const o of this._items)o.applyOffset((0,s.ensureNotNull)(this._itemsRectsInfo)),o.drawBackground(t,e)}}draw(t,e){var o,i,r,l;if(!this._paneHasVisibleItems())return;this._checkCacheValid(e,this._prevFontSize),this._tradedGroupRenderersController.alignItems(e),this._calcItemsRectsInfo(e);for(const o of this._items)o.applyOffset((0,s.ensureNotNull)(this._itemsRectsInfo)),o.drawLine(t,e);const a=null!==(i=null===(o=this._itemsRectsInfo)||void 0===o?void 0:o.rightmostBorder)&&void 0!==i?i:null,n=null!==(l=null===(r=this._itemsRectsInfo)||void 0===r?void 0:r.leftmostBorder)&&void 0!==l?l:null,d=Math.round(e.cssWidth*e.pixelRatio),c=Math.round(12*e.pixelRatio),h=this._data.horizontalAlignment===g.TradedGroupHorizontalAlignment.Left,u=h?n:a,p=h?-1:1;if(null!==u&&u+p*c<=d){const o=h?0:d,i=Math.round(this._data.rightPadding*e.pixelRatio),r=u+p*(Math.min(i,o-p*u)/2);this._drawVertLine(t,e,r);for(const o of this._items)o.drawPointOnLine(t,e,r)}for(const o of this._items)o.draw(t,e)}clearMinTextWidthByItemId(t){this._minMainTextWidthCache.has(t)&&this._minMainTextWidthCache.delete(t)}clearMinTextWidthCache(){this._minMainTextWidthCache.clear()}_minTextWidth(t,e){var o;if(!t.text.text)return 0;e.save(),e.font=(0,s.ensureNotNull)(this._font);const i=Math.ceil(this._textWidthCache.measureText(e,t.text.text)),r=this._minMainTextWidthCache.get(t.id);if(void 0===r||i>r){const o=Math.ceil(this._textWidthCache.measureText(e,"0"));this._minMainTextWidthCache.set(t.id,i+o)}return e.restore(),null!==(o=this._minMainTextWidthCache.get(t.id))&&void 0!==o?o:0}_checkCacheValid(t,e){const o=this._prevFontSize!==e||this._prevPixelRatio!==t.pixelRatio,i=this._prevCssWidth!==t.cssWidth;if(o||i){o&&this._textWidthCache.reset();for(const t of this._items)t.clearCache()}}_calcItemsRectsInfo(t){if(null!==this._itemsRectsInfo)return;const e=this._items.filter((t=>t.data().visible)).map((e=>e.rect(t))),o=this._tradedGroupRenderersController.getBorderPoint(this);let i,r,l,a,{rightmostBorder:n,leftmostBorder:d}=(0,s.ensureNotNull)(o),c=e[0].yMid,h=e[0].yMid;for(const t of e){t.yMid<c&&(c=t.yMid),t.yMid>h&&(h=t.yMid);I(t)&&(i=t.tp.left,r=t.sl.left)}const u=n-d;if(this._data.horizontalAlignment===g.TradedGroupHorizontalAlignment.Left)n>t.physicalWidth&&(a=Math.max(t.physicalWidth-u,Math.round(12*t.pixelRatio)));else if(d<0){const e=Math.round(12*t.pixelRatio);l=t.physicalWidth-u>e?u:t.physicalWidth-e}if(void 0!==i&&void 0!==r){if(void 0!==a){const t=d-a;i-=t,r-=t}if(void 0!==l){const t=l-n;i+=t,r+=t}}void 0!==a&&(d=a),void 0!==l&&(n=l),this._itemsRectsInfo={rightmostBorder:n,leftmostBorder:d,leftmostForItemOffset:a,rightmostForItemOffset:l,yMin:c,yMax:h,projItemTpLeft:i,projItemSlLeft:r}}_drawVertLine(t,e,o){const i=this._data.vertLine;if(null===i||null===this._itemsRectsInfo||this._itemsRectsInfo.yMax===this._itemsRectsInfo.yMin)return;const r=e.pixelRatio;t.strokeStyle=i.color,t.lineWidth=Math.max(1,Math.floor(i.thickness*r)),(0,P.setLineStyle)(t,i.style),(0,
P.drawVerticalLine)(t,o,this._itemsRectsInfo.yMin,this._itemsRectsInfo.yMax)}_paneHasVisibleItems(){return this._items.filter((t=>t.data().visible)).length>0}}var H=o(21218),A=o(150335),V=o(795161),j=o(602564),q=o(561626),N=o(604406),E=o(843388);const F=l.t(null,void 0,o(618156)),z=l.t(null,void 0,o(392553));class G{constructor(t,e,o,i,r,s){this._item=t,this._source=e,this._chartModel=o,this._mainItemStyle=i,this._isNoOverlapMode=r.isNoOverlapMode,this._displayMode=r.displayMode,this._rightPadding=r.rightPadding,this._groupLineColor=r.groupLineColor,this._y=r.y,this._externalCallbacks=s}_isProfitLossHidden(){return 0===this._displayMode}_isProfitLossShorten(){return 2!==this._displayMode}_isCloseVisible(){return 0!==this._displayMode}_minQtyWidth(){return 0===this._displayMode?30:0}_isHoveredItem(t){var e;return(null===(e=this._source.hoveredItem())||void 0===e?void 0:e.id)===t.id()}_isHoveredItemPart(t,e){var o;return this._isHoveredItem(t)&&(null===(o=this._source.hoveredItem())||void 0===o?void 0:o.part)===e}_isSelectedItem(t){var e;return(null===(e=this._source.selectedItem())||void 0===e?void 0:e.id)===t.id()}_isHoveredItemWithButtons(t){if(!t)return!1;const{takeProfit:e,stopLoss:o,trailingStop:i}=(0,E.bracketsByType)(this._source.items().projectionBrackets);return this._isHoveredItem(t)||Boolean(e&&this._isHoveredItem(e))||Boolean(o&&this._isHoveredItem(o))||Boolean(i&&this._isHoveredItem(i))}_isHoveredStopItemStopLimit(){const t=this._source.items().main,e=this._source.items().stopLimit;return!!(t&&e&&(0,_.isLimitPartStopLimitOrderItem)(e))&&this._isHoveredItem(t)}_isActiveSource(){return this._source.isHovered()||this._source.isSelected()}_itemWithButtons(){if(!this._isNoOverlapMode)return this._source.baseItem()}_projectionBracketsForItem(t){return t!==this._itemWithButtons()?[]:this._source.items().projectionBrackets}_renderDataForTPSLButtons(t){if(t!==this._itemWithButtons())return{};const e={borderStyle:this._source.isPlaced()?t.lineStyle():(0,s.ensureDefined)(this._source.mainItem()).lineStyle()},o={},{takeProfit:i,stopLoss:r,trailingStop:l}=(0,E.bracketsByType)(this._source.items().projectionBrackets);if(i){const t=null===i.price(),r=this._isHoveredItemPart(i,5),s=(0,f.getDefaultStyleForOrderItem)(i,this._source,(()=>this._chartModel.isDark()),e);o.tp={id:i.id(),visibility:t&&this._isMainButtonsVisible()?1:0,text:i.qtyText(),title:i.tooltip(),underlineText:!1,textColor:t?s.text.buttonTextColor:s.text.textColor,backgroundColor:s.text.backgroundColor,borderColor:s.borderColor,borderStyle:s.borderStyle,active:{visible:r,backgroundColor:s.text.backgroundColor}}}const a=r||l;if(a){const t=null===a.price(),i=this._isHoveredItemPart(a,6),r=(0,f.getDefaultStyleForOrderItem)(a,this._source,(()=>this._chartModel.isDark()),e),s=(0,j.generateColor)(r.borderColor,85);o.sl={id:a.id(),visibility:t&&this._isMainButtonsVisible()?1:0,text:a.qtyText(),title:a.tooltip(),underlineText:this._source.isTrailingStopSupported(),textColor:t?r.text.buttonTextColor:r.text.textColor,backgroundColor:r.text.backgroundColor,
borderColor:r.borderColor,borderStyle:r.borderStyle,active:{visible:i,backgroundColor:this._source.isTrailingStopSupported()?s:r.text.backgroundColor}}}return o}_renderDataForLine(t){return{drawOnTop:this._isActiveSource()&&!this._isNoOverlapMode,thickness:this._source.lineWidth(),style:t.lineStyle,color:t.lineColor,extend:this._source.isLineExtended()}}_renderDataForQty(t,e){return{text:(o=this._item.qtyText(),null===o?"0":((0,A.isNumber)(o)&&o<0&&(o=`− ${Math.abs(o)}`),(0,q.forceLTRStr)((0,N.splitThousands)(o," ")))),minTextWidth:this._minQtyWidth(),textColor:t.textColor,backgroundColor:t.backgroundColor,dividerColor:t.dividerColor,isDividerVisible:!0,active:{visible:this._isHoveredItemPart(this._item,1),backgroundColor:e}};var o}_renderDataForText(t,e){return{text:this._isProfitLossHidden()?"":this._item.profitLossText(this._isProfitLossShorten()),textColor:t.textColor,backgroundColor:t.backgroundColor,dividerColor:t.dividerColor,active:{visible:this._isHoveredItemPart(this._item,2),backgroundColor:e}}}_renderDataForPoint(){const{takeProfit:t,stopLoss:e,trailingStop:o}=(0,E.bracketsByType)(this._source.items().projectionBrackets),i=e||o,r=this._item===this._itemWithButtons(),s=r&&t&&null===t.price()&&this._isHoveredItem(t),l=r&&i&&null===i.price()&&this._isHoveredItem(i),a=this._isHoveredItem(this._item)||s||l?this._mainItemStyle.pointShadowColor:void 0;return{visible:this._isActiveSource(),backgroundColor:this._isSelectedItem(this._item)?this._groupLineColor:this._mainItemStyle.pointBackgroundColor,borderStyle:this._mainItemStyle.lineStyle,borderColor:this._groupLineColor,shadowColor:a}}_renderDataForClose(t,e){if(this._item.supportClose()&&this._isCloseVisible())return{backgroundColor:t.backgroundColor,iconColor:t.iconColor,active:{visible:this._isHoveredItemPart(this._item,3),backgroundColor:e}}}_renderDataForConfirm(){if(this._item!==this._itemWithConfirmButton()||!this._isMainButtonsVisible())return;(0,s.assert)((0,p.isOrderLikeItem)(this._item));const t=(0,f.getDefaultStyleForOrderItem)(this._item,this._source,(()=>this._chartModel.isDark())),e=(0,s.ensureDefined)(t.confirm),o=this._isHoveredItemPart(this._item,7);return{text:this._confirmButtonText(),textColor:e.textColor,backgroundColor:e.backgroundColor,borderColor:(0,s.ensureDefined)(e.borderColor),borderStyle:V.LineStyle.Solid,active:{visible:o,backgroundColor:e.activeColor,borderColor:e.activeColor}}}_renderDataGeneral(t){var e;return{y:this._y,visible:this._item.isVisible(),sortingIndex:null!==(e=this._item.price())&&void 0!==e?e:0,id:this._item.id(),disabled:this._source.disabled(),borderBackgroundColor:this._borderBackgroundColor(t),borderColor:t.borderColor,borderStyle:t.borderStyle,bodyAlignment:this._source.horizontalAlignment(),rightPadding:this._rightPadding}}_callbacks(t=[]){const e={},o={label:`[${this._modeGaLabel()}]`};this._item.hasContextMenu()&&(e.onContextMenu=t=>this._item.onContextMenu(t,o));const{takeProfit:i,stopLoss:r,trailingStop:s}=(0,E.bracketsByType)(t),l=r||s;return i&&(e.onMoveProjectionTP=t=>this._source.onMove(i.id(),t),
e.onFinishMoveTP=()=>this._source.onFinishMoveProjectionBracket(i.id(),{...o,event:"Add bracket from button"})),l&&(e.onMoveProjectionSL=t=>this._source.onMove(l.id(),t),e.onFinishMoveSL=()=>this._source.onFinishMoveProjectionBracket(l.id(),{...o,event:"Add bracket from button"}),this._source.isTrailingStopSupported()&&(e.onClickSL=(t,e)=>l.toggleType(t,e,o))),this._isNoOverlapMode&&(e.allInteractionsHandler=()=>this._externalCallbacks.setNoOverlapMode(!1)),this._isMainButtonsVisible()&&(e.onConfirm=()=>this._source.onConfirm(this._item.id(),o)),e}_isMainButtonsVisible(){return!this._source.isPlaced()&&this._source.isActiveSource()||this._isHoveredItemWithButtons(this._item)||this._isHoveredStopItemStopLimit()||this._source.isSelected()}_borderBackgroundColor(t){return t.borderStyle===V.LineStyle.Solid?"transparent":t.borderBackgroundColor}_modeGaLabel(){switch(this._displayMode){case 2:return"Standard view";case 1:return"Medium view";case 0:return"Minimal view"}}_confirmButtonText(){const t=1===this._item.data().side?F:z;return 2!==this._displayMode?t:`${t} ${this._item.qtyText()} @ ${this._item.priceText()}`}_itemWithConfirmButton(){if(!this._source.isPlaced()&&!this._source.isConfirmButtonOnDomWidget())return this._itemWithButtons()}}const Q=(0,H.appendEllipsis)(l.t(null,void 0,o(911810))),U=l.t(null,void 0,o(419780)),$=l.t(null,void 0,o(437431));class Y extends G{rendererData(){const t=(0,v.getDefaultStyleForPositionItem)(this._item.isBuyDirection(),this._source.isBlocked(),(()=>this._chartModel.isDark()),this._item.lineStyle());let e;const o=this._renderDataForClose(t.close,t.close.activeColor);return void 0!==o&&(e={...o,title:$}),{type:i.Position,...this._renderDataGeneral(t),...this._renderDataForTPSLButtons(this._item),callbacks:this._callbacks(this._projectionBracketsForItem(this._item)),line:this._renderDataForLine(t),qty:{...this._renderDataForQty(t.qty,t.qty.activeColor),title:Q},text:{...this._renderDataForText(t.text,t.qty.activeColor),title:"",textColor:this._item.profitLossTextColor(),active:{visible:!1,backgroundColor:t.qty.activeColor}},point:this._renderDataForPoint(),close:e,reverse:this._renderDataForReverse(t.reverse)}}_callbacks(t=[]){const e=super._callbacks(t),o={label:`[${this._modeGaLabel()}]`};return this._item.supportClose()&&this._isCloseVisible()&&(e.onClose=()=>this._item.onClose(o)),this._shouldReverseShown()&&(e.onReverse=()=>this._item.onReverse(o)),this._item.supportModify()&&(e.onModify=()=>this._item.onModify(o)),e}_renderDataForReverse(t){if(!this._shouldReverseShown())return;const e=this._isHoveredItemWithButtons(this._item)||this._source.isSelected();return{title:U,visibility:e?1:0,backgroundColor:t.backgroundColor,iconColor:t.iconColor,active:{visible:this._isHoveredItemPart(this._item,4),backgroundColor:t.activeColor}}}_shouldReverseShown(){return this._item.supportReverse()&&this._source.isReverseVisible()&&this._isReverseVisible()}_isReverseVisible(){return 2===this._displayMode&&!this._isNoOverlapMode}}const K=l.t(null,void 0,o(137172)),X=l.t(null,void 0,o(316075))
;class Z extends G{rendererData(){const t=this._item===this._itemWithButtons(),e=(0,f.getDefaultStyleForOrderItem)(this._item,this._source,(()=>this._chartModel.isDark())),o=(0,j.generateColor)(e.borderColor,85);let r;const s=this._renderDataForClose(e.close,o);return void 0!==s&&(r={...s,title:X}),{type:t?i.WithBracketButtons:i.Default,...this._renderDataGeneral(e),...this._renderDataForTPSLButtons(this._item),callbacks:this._callbacks(this._projectionBracketsForItem(this._item)),line:this._renderDataForLine(e),qty:{...this._renderDataForQty(e.qty,o),title:K},text:{...this._renderDataForText(e.text,o),title:this._item.profitLossTooltip()},point:this._renderDataForPoint(),close:r,confirm:this._renderDataForConfirm()}}_callbacks(t=[]){const e=this._source,o=super._callbacks(t),i={label:`[${this._modeGaLabel()}]`};return this._item.isMovingEnabled()&&!this._isNoOverlapMode&&(o.onMove=t=>e.onMove(this._item.id(),t),o.onFinishMove=()=>e.onFinishMove(this._item.id(),i)),this._item.supportModify()&&(o.onModify=()=>this._item.onModify(i)),this._item.supportClose()&&this._isCloseVisible()&&(o.onClose=()=>this._item.onClose(i)),this._item.canQtyCalcModify()&&(o.onQtyModify=(t,e)=>this._item.toggleQtyModify(t,e,i)),o}}class J extends Z{constructor(t,e,o,i,r,s){super(t,e,o,i,r,s),this._source=e}_callbacks(t=[]){const e=super._callbacks(t),o={label:`[${this._modeGaLabel()}]`};return this._item.supportClose()&&this._isCloseVisible()&&(e.onClose=async()=>this._source.onClose(o)),this._isNoOverlapMode||(this._item.isMovingEnabled()&&(e.onMove=t=>this._source.onMove(this._item.id(),t),e.onFinishMove=()=>this._source.onFinishMove(this._item.id(),o)),this._item.canSwitchType()&&(e.onText=(t,e)=>this._item.toggleType(t,e,o))),e}}class tt extends G{rendererData(){const t=(0,f.getDefaultStyleForOrderItem)(this._item,this._source,(()=>this._chartModel.isDark())),e=(0,j.generateColor)(t.borderColor,85);return{type:i.Projection,...this._renderDataGeneral(t),drawWithTPOffset:this._item.bracketType()===c.BracketType.TakeProfit,drawWithSLOffset:this._item.bracketType()===c.BracketType.StopLoss||this._item.bracketType()===c.BracketType.TrailingStop,callbacks:this._callbacks(),line:this._renderDataForLine(t),qty:this._renderDataForQty(t.qty,e),text:{...this._renderDataForText(t.text,e),title:this._item.profitLossText(),active:{visible:!1,backgroundColor:t.qty.activeColor}},point:this._renderDataForPoint(),close:this._renderDataForClose(t.close,t.close.activeColor)}}}function et(t,e,o,i,r,s){if((0,_.isPositionItem)(t))return new Y(t,e,o,i,r,s);if((0,_.isPreOrderItem)(t))return new J(t,e,o,i,r,s);if((0,_.isProjectionBracketItem)(t))return new tt(t,e,o,i,r,s);if((0,p.isOrderLikeItem)(t))return new Z(t,e,o,i,r,s);throw new Error("Unknown traded item type")}var ot;!function(t){t[t.Large=380]="Large",t[t.Small=280]="Small"}(ot||(ot={}));class it{constructor(t,e,o){this._prevItemTokens=new Map,this._displayMode=2,this._invalidated=!0,this._chartModel=t,this._source=e,this._tradedGroupRenderersController=o,this._showOrderProperty=e.showOrderProperty(),
this._showPositionProperty=e.showPositionProperty(),this._renderer=new R(this._tradedGroupRenderersController),this._tradedGroupRenderersController.registerRenderer(this._renderer),this._renderer.setFontSize(13),this._source.positionDisplayMode().subscribe(this._renderer,this._renderer.clearMinTextWidthCache),this._source.bracketsDisplayMode().subscribe(this._renderer,this._renderer.clearMinTextWidthCache)}destroy(){this._tradedGroupRenderersController.removeRenderer(this._renderer),this._source.positionDisplayMode().unsubscribe(this._renderer,this._renderer.clearMinTextWidthCache),this._source.bracketsDisplayMode().unsubscribe(this._renderer,this._renderer.clearMinTextWidthCache)}update(){this._invalidated=!0}renderer(t,e){if(this._invalidated){const t=this._displayMode;this._calculateMode(e),this._updateImpl(),t!==this._displayMode&&this._renderer.clearMinTextWidthCache(),this._renderer.clearCache(),this._invalidated=!1}return this._renderer}priceToCoordinate(t){if(null===t)return null;const e=this._chartModel.mainSeries(),o=e.firstValue();return null===o?null:e.priceScale().priceToCoordinate(t,o)}_calculateMode(t){if(!d.enabled("adaptive_trading_sources"))return;const e=t<ot.Large?t<ot.Small?0:1:2;this._displayMode=e}_mainItemStyle(){const t=this._source.mainItem();return void 0===t?(0,f.getStyleForOppositeDirection)(this._source.items().brackets[0],this._source,(()=>this._chartModel.isDark())):(0,p.isPositionLikeItem)(t)?(0,v.getDefaultStyleForPositionItem)(t.isBuyDirection(),this._source.isBlocked(),(()=>this._chartModel.isDark()),t.lineStyle()):((0,s.assert)((0,p.isOrderLikeItem)(t),"Unexpected traded item type"),(0,f.getDefaultStyleForOrderItem)(t,this._source,(()=>this._chartModel.isDark())))}_rightPadding(){return 2!==this._displayMode?40:64}_sortedItems(){var t,e,o;const i=[],r=this._source.items();let s=null,l=null,a=null;const n=r.brackets.slice();if(n.push(...r.projectionBrackets),void 0!==r.stopLimit&&n.push(r.stopLimit),void 0!==r.main&&n.push(r.main),this._tradedGroupRenderersController.isNoOverlapMode())return n;for(const r of n)(null===(t=this._source.movingItem())||void 0===t?void 0:t.id)===r.id()?a=r:(null===(e=this._source.hoveredItem())||void 0===e?void 0:e.id)===r.id()?l=r:(null===(o=this._source.selectedItem())||void 0===o?void 0:o.id)===r.id()?s=r:i.push(r);return null!==s&&i.push(s),null!==l&&i.push(l),null!==a&&i.push(a),i}_updateImpl(){if(this._renderer.clearItems(),!this._showOrderProperty.value()&&!this._showPositionProperty.value()||this._isNoData())return;const t=this._mainItemStyle(),e=this._source.isSelected(),o=e&&this._source.isHoveredOtherTradedGroup()?(0,s.ensureDefined)(t.disabledLineColor):t.lineColor,i=this._rightPadding(),r={vertLine:null,horizontalAlignment:this._source.horizontalAlignment(),rightPadding:i};(this._source.isHovered()||e)&&(r.vertLine={thickness:this._source.lineWidth(),style:t.lineStyle,color:o}),this._tradedGroupRenderersController.isNoOverlapMode()&&(r.disableNoOverlap=()=>this._tradedGroupRenderersController.setNoOverlapMode(!1)),this._renderer.setData(r)
;const l=new Map;for(const e of this._sortedItems()){const r=this.priceToCoordinate(e.price());if(null===r)continue;const s=et(e,this._source,this._chartModel,t,{isNoOverlapMode:this._tradedGroupRenderersController.isNoOverlapMode(),displayMode:this._displayMode,rightPadding:i,groupLineColor:o,y:r},{setNoOverlapMode:t=>this._tradedGroupRenderersController.setNoOverlapMode(t)}).rendererData();this._renderer.addItem(s),l.set(`${s.id} ${e.isBuyDirection()}`,s.id)}this._prevItemTokens.forEach(((t,e)=>{l.has(e)||this._renderer.clearMinTextWidthByItemId(t)})),this._prevItemTokens=l}_isNoData(){const t=this._source.items();return void 0===t.main&&void 0===t.stopLimit&&0===t.brackets.length}}var rt=o(672428);class st extends rt.PriceAxisView{constructor(t,e,o,i){super(),this._model=t,this._data=e,this._priceScaleFormatter=o,this._styleGetter=i}itemId(){return this._data.id()}_updateRendererData(t,e,o){if(t.visible=!1,!this._data.isVisible())return;const i=this._model.mainSeries(),r=i.priceScale(),s=i.firstValue();if(null===s)return;const l=this._data.price();if(null===l)return;const a=this._styleGetter();o.background=a.qty.backgroundColor,o.borderColor=a.labelBorderVisible?a.borderColor:void 0,o.borderStyle=a.labelBorderVisible?a.borderStyle:void 0,o.textColor=a.qty.textColor,o.coordinate=r.priceToCoordinate(l,s),t.borderVisible=a.labelBorderVisible,t.text=this._formatPrice(l),t.tickColor=a.labelTickColor,t.visible=!0}_formatPrice(t){return this._priceScaleFormatter().format(t,void 0,void 0,void 0,void 0,false)}}var lt=o(929654);class at extends lt.PriceLineAxisView{constructor(t,e,o,i,r,s,l){super(),this._chartModel=t,this._data=e,this._source=o,this._showProperty=s,this._height=i,this._verticalPadding=r,this._styleGetter=l}itemId(){return this._data.id()}_value(){const t=this._chartModel.mainSeries(),e=t.firstValue(),o=this._data.price();if(null===o||null===e)return{noData:!0};const i=t.priceScale().priceToCoordinate(o,e);return{noData:!1,floatCoordinate:i,coordinate:i,color:"",formattedPricePercentage:"",formattedPriceAbsolute:"",formattedPriceIndexedTo100:"",text:"",index:0}}_updateRendererData(t,e,o){const i=this._styleGetter();t.linestyle=i.lineStyle,o.additionalPaddingTop=this._verticalPadding,o.additionalPaddingBottom=this._verticalPadding,super._updateRendererData(t,e,o)}_priceLineColor(t){return this._styleGetter().lineColor}_lineWidth(){return this._source.lineWidth()}_lineStyle(){return this._styleGetter().lineStyle}_backgroundAreaHeight(){return this._height}_isVisible(){return this._showProperty.value()}}function nt(t,e,o){if((0,_.isPositionItem)(o)){const i=()=>(0,v.getDefaultStyleForPositionItem)(o.isBuyDirection(),e.isBlocked(),(()=>t.isDark()),o.lineStyle());return{priceAxisView:new st(t,o,(()=>e.priceScaleFormatter()),i),priceLineAxisView:new at(t,o,e,19,0,e.showPositionProperty(),i)}}(0,s.assert)((0,p.isOrderLikeItem)(o),"Unexpected traded item type");const i=()=>(0,f.getDefaultStyleForOrderItem)(o,e,(()=>t.isDark()));return{priceAxisView:new st(t,o,(()=>e.priceScaleFormatter()),i),
priceLineAxisView:new at(t,o,e,17,1,e.showOrderProperty(),i)}}class dt{constructor(t,e){this._model=t,this._source=e}updateAllViews(t){void 0!==this._views.main&&(this._views.main.priceAxisView.update(t),this._views.main.priceLineAxisView.update(t)),void 0!==this._views.stopLimit&&(this._views.stopLimit.priceAxisView.update(t),this._views.stopLimit.priceLineAxisView.update(t));for(const e of this._views.brackets)e.priceAxisView.update(t),e.priceLineAxisView.update(t);for(const e of this._views.project.brackets)e.priceAxisView.update(t),e.priceLineAxisView.update(t)}views(t,e){const o=this._source.movingItem()||null,i=this._source.hoveredItem()||null,r=this._source.selectedItem()||null,s=null!==o?o.id:null,l=null!==i?i.id:null,a=null!==r?r.id:null,n=[],d=[];let c=null,h=null,u=null,p=null,_=null,y=null;const f=this._views.brackets.slice();f.push(...this._views.project.brackets),this._views.main&&f.push(this._views.main),this._views.stopLimit&&f.push(this._views.stopLimit);for(const t of f)t.priceAxisView.itemId()===s?(c=t.priceAxisView,h=t.priceLineAxisView):t.priceAxisView.itemId()===l?(u=t.priceAxisView,p=t.priceLineAxisView):t.priceAxisView.itemId()===a?(_=t.priceAxisView,y=t.priceLineAxisView):(n.push(t.priceAxisView),d.push(t.priceLineAxisView));return null!==_&&null!==y&&(n.push(_),d.push(y)),null!==u&&null!==p&&(n.push(u),d.push(p)),null!==c&&null!==h&&(n.push(c),d.push(h)),[n,d]}recreateViews(){const t=this._source.items(),e=t.projectionBrackets.filter((t=>null!==t.price())).map((t=>nt(this._model,this._source,t)));this._views={brackets:t.brackets.map((t=>nt(this._model,this._source,t))),project:{brackets:e}},void 0!==t.main&&(this._views.main=nt(this._model,this._source,t.main)),void 0!==t.stopLimit&&(this._views.stopLimit=nt(this._model,this._source,t.stopLimit))}}function ct(t){return t instanceof _t}const ht=l.t(null,void 0,o(619397)),ut=l.t(null,void 0,o(360538));function pt(t){return void 0!==t&&((0,p.isOrderItemRawData)(t)||(0,p.isPreOrderItemRawData)(t))&&4===t.type}class _t extends a.CustomSourceBase{constructor(t,e,o,i,r,s,l,a,n){super(t,e),this._hadBeenModifiedAllItems=!1,this._isDestroyed=!1,this._bracketStopType=h.StopType.StopLoss,this._items={brackets:[],projectionBrackets:[]},this._blockedData=null,this._isBlocked=!1,this._mainSeries=e.mainSeries(),this._properties=o,this._globalVisibility=i,this._globalVisibility.subscribe(this.redraw.bind(this)),this._callbacks=s,this._symbolDataProvider=l,this._symbolDataProvider.onUpdate().subscribe(this,(()=>{this.items(!0).forEach((t=>{t.fireProfitLossChange()})),this.redraw()})),this._qtySuggester=a,this._paneView=new it(this._model,this,n),this._tradedGroupRenderersController=n,this._priceViewsGroup=new dt(this._model,this),this._rawDataSpawn=r.spawn(),this._rawDataSpawn.subscribe(this._setData.bind(this)),this._properties.positionPL.visibility.subscribe(this,this.redraw),this._properties.bracketsPL.visibility.subscribe(this,this.redraw),this._properties.positionPL.display.subscribe(this,(()=>{this.redraw()})),
this._properties.bracketsPL.display.subscribe(this,(()=>{this.redraw()})),this._properties.showPositions.subscribe(this,(()=>{this._tradedGroupRenderersController.setNoOverlapMode(!1)})),this._properties.showOrders.subscribe(this,(()=>{this._tradedGroupRenderersController.setNoOverlapMode(!1)})),this._tradedGroupRenderersController.isInvalidatedWV().subscribe((()=>{this._paneView.update(),this._isSourceShouldBeShown()&&this._model.updateSource(this)})),this._model.hoveredSourceChanged().subscribe(this,(()=>{if(!this._symbolDataProvider.isActualSymbol())return;const t=this._model.hoveredSource();(null===t||t!==this&&ct(t))&&this.redraw()}))}destroy(){var t,e;this._properties.showOrders.destroy(),this._properties.showPositions.destroy(),this._properties.positionPL.visibility.unsubscribeAll(this),this._properties.positionPL.display.unsubscribeAll(this),this._properties.bracketsPL.visibility.unsubscribeAll(this),this._properties.bracketsPL.display.unsubscribeAll(this),this._rawDataSpawn.destroy(),null===(t=this._items.main)||void 0===t||t.destroy(),null===(e=this._items.stopLimit)||void 0===e||e.destroy(),this._items.brackets.forEach((t=>t.destroy())),this._items.projectionBrackets.forEach((t=>t.destroy())),this._globalVisibility.unsubscribe(),this._paneView.destroy(),this._symbolDataProvider.onUpdate().unsubscribeAll(this),this._symbolDataProvider.destroy(),this._isDestroyed=!0}isSelectionEnabled(){return!0}priceScaleFormatter(){return this._mainSeries.formatter()}showPositionProperty(){return this._properties.showPositions}showOrderProperty(){return this._properties.showOrders}bracketStopType(){return this._bracketStopType}setBracketStopType(t){this._bracketStopType=t,this._updateProjectionBracketsItems(!0),this.redraw()}isTrailingStopSupported(){var t;return Boolean(null===(t=this.items().main)||void 0===t?void 0:t.data().supportTrailingStop)}isReverseVisible(){return this._properties.showReverse.value()}lineWidth(){return this._properties.lineProperties.width.value()}lineStyle(){return this._properties.lineProperties.style.value()}isLineExtended(){return this._properties.lineProperties.extend.value()}isPositionPLVisible(){return this._properties.positionPL.visibility}positionDisplayMode(){return this._properties.positionPL.display}isBracketsPLVisible(){return null}bracketsDisplayMode(){return this._properties.bracketsPL.display}horizontalAlignment(){return this._properties.horizontalAlignment.value()}isBlocked(){return this._isBlocked}disabled(){return this.isBlocked()}isConfirmButtonOnDomWidget(){return!1}setIsBlocked(t){this._isBlocked=t,this.redraw()}isHovered(){return this._model.hoveredSource()===this}isHoveredOtherTradedGroup(){return!this.isHovered()&&ct(this._model.hoveredSource())}isSelected(){return this._model.selection().isSelected(this)}items(t,e){if(t){const t=[];return this._items.stopLimit&&!(null==e?void 0:e.exceptStopLimit)&&t.push(this._items.stopLimit),this._items.main&&!(null==e?void 0:e.exceptMain)&&t.push(this._items.main),(null==e?void 0:e.exceptBrackets)||t.push(...this._items.brackets),
(null==e?void 0:e.exceptProjection)||t.push(...this._items.projectionBrackets),t}return this._items}baseItem(){var t;return null!==(t=this._items.stopLimit)&&void 0!==t?t:this._items.main}findItem(t){const e=this.items(!0).find((e=>e.id()===t));return(0,s.assert)(void 0!==e,`Traded item with id ${t} is not found`),e}findItemWithType(t,e){const o=e===u.TradedItemType.Position?_.isPositionItem:p.isOrderLikeItem;return this.items(!0,{exceptStopLimit:!0}).find((e=>o(e)&&e.data().id===t))}movingItem(){const t=this._model.customSourceBeingMoved()===this&&this._model.customSourceMovingHitTestData()||null;return null===t||void 0===t.activeItem?null:t.activeItem}hoveredItem(){const t=this._model.hoveredSource()===this&&this._model.lastHittestData()||null;return null===t||void 0===t.activeItem?null:t.activeItem}selectedItem(){const t=this._model.selection().isSelected(this)&&this._model.lastSelectedHittestData()||null;return null===t||void 0===t.activeItem?null:t.activeItem}priceScale(){return this._mainSeries.priceScale()}updateAllViews(){this._paneView.update(),this._priceViewsGroup.updateAllViews((0,n.sourceChangeEvent)(this.id()))}updateViewsForPane(t){this._isSourceShouldBeShownOnPane(t)&&this.updateAllViews()}paneViews(t){return this._isSourceShouldBeShownOnPane(t)?[this._paneView]:[]}priceAxisViews(t,e){if(!this._isSourceShouldBeShownOnPane(t))return[];const[o,i]=this._priceViewsGroup.views(t,e);return t.findTargetPriceAxisViews(this,e,o,i)}redraw(){this.updateAllViews(),this._isSourceShouldBeShown()&&this._model.updateSource(this)}syncData(){this._isDestroyed||(null!==this._blockedData?(this._setData(this._blockedData),this._blockedData=null):this._setData(this._rawDataSpawn.value()))}allItemsSupportMove(t){if(void 0===this._items.main)return!1;for(const t of this._items.projectionBrackets)if(null!==t.price())return!1;return!(t.length<2)&&t.every((t=>(0,p.isOrderLikeItem)(t)&&t.isMovingEnabled()))}onMove(t,e,o=!1){const i=this.findItem(t),r=i.price(),l=this.items(!0);if(o&&this.setIsBlocked(!0),e.shiftKey&&null!==i.price()&&this.allItemsSupportMove(l)){this._hadBeenModifiedAllItems=!0;const t=(0,s.ensureNotNull)(i.calcPriceDiff(e));l.forEach((e=>{(0,_.isProjectionBracketItem)(e)||e.applyPriceDiff(t)})),this._callbacks.hideChartHint()}else i.onMove(e),this._moveOtherProjectionBracketIfNeeded(i);null===r&&null!==i.price()&&this._priceViewsGroup.recreateViews(),this.redraw()}_updateStopLimit(t){const e=this._items.main,o=this._items.stopLimit;pt(t.main)&&void 0===o?this._items.stopLimit=this._createStopLimitItem(t,e):pt(t.main)&&void 0!==o?o.setData(this._dataForStopLimitOrder(t.main)):void 0!==o&&(this._convertStopLimitOrderToMainItem(t.main,o),this._deleteStopLimitItem())}_positionVisibilityGetter(){return this._isSourceShouldBeShown()&&this.showPositionProperty().value()}_orderVisibilityGetter(){return this._isSourceShouldBeShown()&&this.showOrderProperty().value()}_setData(t,e=!0){var o,i,l,a;if(this.isBlocked())this._blockedData=t,(0,_.isPositionItem)(this._items.main)&&void 0!==t.main&&((0,s.assert)((0,
p.isPositionItemRawData)(t.main)),this._items.main.setData(t.main));else{const s=null!==(a=null!==(i=null===(o=t.main)||void 0===o?void 0:o.symbol)&&void 0!==i?i:null===(l=t.brackets[0])||void 0===l?void 0:l.symbol)&&void 0!==a?a:null;t=(0,r.default)(t),e?this._updateItems(t):this._createItems(t),this._updateProjectionBracketsItems(),this._priceViewsGroup.recreateViews(),this._symbolDataProvider.start(s)}this.redraw()}_processedBracketData(t){return t}_createStopLimitItem(t,e){let o;if(void 0!==t.main&&((0,p.isOrderItemRawData)(t.main)||(0,p.isPreOrderItemRawData)(t.main))&&((0,_.isOrderItem)(e)||(0,_.isPreOrderItem)(e))&&4===e.type()){const e=this._dataForStopLimitOrder(t.main);o=(0,y.createItem)(y.TradedGroupItemType.LimitPartStopLimitOrder,e,this,this._model,{itemExternalServices:{symbolDataProvider:this._symbolDataProvider,qtySuggester:this._qtySuggester,tradedGroupRenderersController:this._tradedGroupRenderersController},visibilityGetters:{order:this._orderVisibilityGetter.bind(this),position:this._positionVisibilityGetter.bind(this)},sourceCallbacks:this._callbacks})}return o}_deleteStopLimitItem(){var t;null===(t=this._items.stopLimit)||void 0===t||t.destroy(),delete this._items.stopLimit}_isSourceShouldBeShown(){return!!this._globalVisibility.value()&&(!!this._symbolDataProvider.isActualSymbol()&&!(window.TradingView.printing&&!d.enabled("snapshot_trading_drawings")))}_getToggleStopTypeMenuHandler(){const t=[{title:ht,value:h.StopType.StopLoss}];return this.isTrailingStopSupported()&&t.push({title:ut,value:h.StopType.TrailingStop}),(e,o,i,r,s)=>{var l;const a=this.mainItem();if(e){const t=a&&(0,_.isPositionItem)(a)?"Chart Position":"Chart Order";this._callbacks.trackEvent(t,"Stop loss type menu opening",null!==(l=i.label)&&void 0!==l?l:"")}t.length>1&&updateDropdownMenu(e,o,t,this._bracketStopType,"Stop bracket type",(t=>this.setBracketStopType(t)),r,s)}}_moveOtherProjectionBracketIfNeeded(t){const e=this._items.main;if(!(0,_.isProjectionBracketItem)(t)||void 0===e||!e.supportOnlyPairBrackets()||this._items.projectionBrackets.length<2)return;const o=(0,s.ensureNotNull)(e.price()),i=(0,s.ensureNotNull)(t.price())-o,r=this._items.projectionBrackets.find((e=>e!==t));(0,s.ensureDefined)(r).setPrice(o-i)}_createItems(t){const e=this._createMainItem(t),o=this._createStopLimitItem(t,e);this._items={main:e,stopLimit:o,brackets:t.brackets.map((t=>this._createBracketItem(t))),projectionBrackets:[]}}_updateItems(t){void 0===this._items.main&&void 0!==t.main?this._items.main=this._createMainItem(t):void 0!==this._items.main&&void 0!==t.main?this._updateMainItem(t.main):void 0!==this._items.main&&void 0===t.main&&this._deleteMainItem(),this._updateStopLimit(t),this._updateBrackets(t.brackets)}_updateBrackets(t){const e=[];this._items.brackets.forEach((o=>{const i=t.findIndex((t=>t.id===o.data().id));-1!==i?(o.setData(this._processedBracketData(t[i])),t.splice(i,1)):e.push(o)})),e.forEach((t=>{const e=this._items.brackets.findIndex((e=>e.data().id===t.data().id));-1!==e&&(this._items.brackets[e].destroy(),
this._items.brackets.splice(e,1))})),t.forEach((t=>{const e=this._createBracketItem(t);this._items.brackets.push(e)}))}_updateProjectionBracketsItems(t=!1){const e=this._items.main;if(void 0===e||!e.supportBrackets())return;const{takeProfit:o,stopLoss:i,trailingStop:r}=(0,E.bracketsByType)(this._items.brackets),s=null!=i?i:r,{takeProfit:l,stopLoss:a,trailingStop:n}=(0,E.bracketsByType)(this._items.projectionBrackets),d=null!=a?a:n;[[o,l],[s,d]].forEach((([t,e])=>{if(t&&e){const t=this._items.projectionBrackets.indexOf(e);this._items.projectionBrackets[t].destroy(),this._items.projectionBrackets.splice(t,1)}}));const u=e.data();if(!o&&!l){const t=(0,E.buildProjectionBracketData)("ProjectionBracket",c.BracketType.TakeProfit,u),e=(0,y.createItem)(y.TradedGroupItemType.ProjectionBracket,t,this,this._model,{itemExternalServices:{symbolDataProvider:this._symbolDataProvider,qtySuggester:this._qtySuggester,tradedGroupRenderersController:this._tradedGroupRenderersController},visibilityGetters:{order:this._orderVisibilityGetter.bind(this),position:this._positionVisibilityGetter.bind(this)},sourceCallbacks:this._callbacks});this._items.projectionBrackets.push(e)}if(!s&&!d||t){const t=this._bracketStopType===h.StopType.StopLoss?c.BracketType.StopLoss:c.BracketType.TrailingStop,e=(0,E.buildProjectionBracketData)("ProjectionBracket",t,u);if(d)d.setData(e);else{const t=(0,y.createItem)(y.TradedGroupItemType.ProjectionBracket,e,this,this._model,{itemExternalServices:{symbolDataProvider:this._symbolDataProvider,qtySuggester:this._qtySuggester,tradedGroupRenderersController:this._tradedGroupRenderersController},visibilityGetters:{order:this._orderVisibilityGetter.bind(this),position:this._positionVisibilityGetter.bind(this)},sourceCallbacks:this._callbacks,menuCallbacks:{onToggleTypeMenuHandler:this._getToggleStopTypeMenuHandler(),closeDropdownMenuHandler:closeDropdownMenu}});this._items.projectionBrackets.push(t)}}}_deleteMainItem(){(0,s.ensureDefined)(this._items.main).destroy(),delete this._items.main,this._deleteStopLimitItem()}_isSourceShouldBeShownOnPane(t){return t.containsMainSeries()}}},186131:(t,e,o)=>{"use strict";o.d(e,{plSign:()=>f,BaseItem:()=>C});var i=o(650151),r=o(509806),s=o(604406),l=o(486028),a=o(922157),n=o.n(a),d=o(896778),c=o(927079),h=o(66568),u=o(561626),p=o(795161),_=o(122621),y=o(516703);function f(t,e){return`${t>0?"+":t<0?"−":""}${e?" ":""}`}const v={integerFormatter:new h.NumericFormatter(0),oneDecimalFormatter:new h.NumericFormatter(1),twoDecimalFormatter:new h.NumericFormatter(2)},m=r.t(null,void 0,o(618156)),b=r.t(null,void 0,o(392553));class C{constructor(t,e,o,i,r,s,l){this._contextMenu=null,this._profitLossChanged=new(n()),this._mainSeries=o,this._source=e,this._symbolDataProvider=i,this._gaOrigin=r,this._infoGetters=s,this._itemCommands=l,this.setData(t)}destroy(){var t,e,o;null===(t=this._formatPlWV)||void 0===t||t.destroy(),null===(e=this._plColorWV)||void 0===e||e.destroy(),this._profitLossChanged.destroy(),null===(o=this._contextMenu)||void 0===o||o.hide()}data(){return this._data}price(){
return this._data.price}setData(t){this._data=(0,l.clone)(t)}priceText(){return(0,i.ensureNotNull)(this._symbolDataProvider.symbolData()).priceFormatter.format((0,i.ensureNotNull)(this.price()))}supportBrackets(){return this._data.supportBrackets}supportOnlyPairBrackets(){return!1}plColorWV(){return void 0===this._plColorWV&&(this._plColorWV=(0,d.createWVFromGetterAndSubscription)((()=>this.profitLossTextColor()),this._profitLossChanged)),this._plColorWV}formatPlWV(){return void 0===this._formatPlWV&&(this._formatPlWV=(0,d.createWVFromGetterAndSubscription)((()=>this.profitLossText()),this._profitLossChanged)),this._formatPlWV}hasContextMenu(){return this.supportModify()||this.supportClose()}useMinTickFormatter(){return!0}isBuyDirection(){return 1===this._data.side}isVisible(){return this._infoGetters.visibility()}fireProfitLossChange(){this._profitLossChanged.fire()}profitLossText(t){if(!this._data)return"";const e=this._potentialProfitLoss();if(null===e)return"";let o;switch(this._infoGetters.displayMode.value()){case c.PlDisplay.Money:o=this.moneyText(e,!0);break;case c.PlDisplay.Pips:o=this.pipsText(e,!0);break;case c.PlDisplay.Percentage:o=this.percentageText(e,!0)}return(0,u.startWithLTR)(o)}percentageText(t,e){var o;const i=f(t,e),r=this._source.baseItem(),l=null!==(o=null==r?void 0:r.price())&&void 0!==o?o:null;if(null===l)return"";const a=100*t/l*this._data.side;return`${i}${(0,s.splitThousands)(v.twoDecimalFormatter.format(Math.abs(a))," ")}%`}moneyText(t,e){const o=this._symbolDataProvider.pipValue();if(null===o)return"";const r=f(t,e),s=(0,i.ensureNotNull)(this._symbolDataProvider.symbolData()),l=t/(s.pipSize||s.minTick)*this._data.side,a=this.isBuyDirection()?o.buyPipValue:o.sellPipValue,n=Math.abs((0,y.pipsToRiskInCurrency)(l,this._data.qty,a,s.priceMagnifier,s.lotSize));return`${r}${v.twoDecimalFormatter.format(n)} ${this.currency()}`}pipsText(t,e){const l=f(t,e),a=(0,i.ensureNotNull)(this._symbolDataProvider.symbolData()),n=isFinite(a.pipSize)&&a.pipSize!==a.minTick?v.oneDecimalFormatter:v.integerFormatter,d=parseFloat(n.format(t/(a.pipSize||a.minTick)))*this._data.side;switch(this._symbolDataProvider.pipValueType()){case _.PipValueType.Pips:return`${l}${r.t(null,{plural:"{pips} pips",count:Math.abs(d)},o(777772)).replace("{pips}",(0,s.splitThousands)(Math.abs(d).toFixed(1)," "))}`;case _.PipValueType.Ticks:return`${l}${r.t(null,{plural:"{ticks} ticks",count:Math.abs(d)},o(564225)).replace("{ticks}",(0,s.splitThousands)(Math.abs(d).toFixed(0)," "))}`}return""}tryBasePlOnLast(){return!1}lineStyle(){return p.LineStyle.Solid}confirmText(t){const e=1===this._data.side?m:b;return t?e:`${e} ${this.qtyText()} @ ${this.priceText()}`}_trackEventGA(t){const{origin:e=this._gaOrigin,event:o,label:r}=t;(0,i.assert)(!!o,"GA Event shouldn' be empty"),this._itemCommands.trackEvent(e,o,r)}_quantityText(t){return(0,i.ensureNotNull)(this._symbolDataProvider.symbolData()).quantityFormatter.format(t)}}},234018:(t,e,o)=>{"use strict";o.d(e,{OrderBaseItem:()=>M})
;var i=o(509806),r=o(21218),s=o(650151),l=o(150335),a=o(86441),n=o(486028),d=o(710567),c=o(795161),h=o(79581),u=o(927079),p=o(122621),_=o(971204),y=o(696546),f=o(163851),v=o(612377);var m=o(761139),b=o(18550),C=o(843388),P=o(186131);const g=(0,r.appendEllipsis)(i.t(null,void 0,o(305806))),k=i.t(null,void 0,o(709498)),T=i.t(null,void 0,o(555937)),S=i.t(null,void 0,o(937385));class M extends P.BaseItem{constructor(t,e,o,i,r,l,a,n="Chart Order"){super(t,e,o,i,n,r,l),this._inEdit=!1,this._isQtyModifyOpened=!1,this._handleQtyModifyClose=(t,e)=>{t(e)?this.applyQty(this.data().qty):this._handleQtyModifyDestroy()},this._handleQtyModifyDestroy=()=>{this.applyQty(this.data().qty),this._isQtyModifyOpened=!1,this._closeQtyCalc()},this._isBracket()&&this._source.bracketsDisplayMode().subscribe(this,this.fireProfitLossChange),a&&(this._qtyModifyCallbacks={onQtyApplyHandler:a.onQtyApplyHandler,onToggleQtyCalcHandler:a.onToggleQtyCalcHandler,qtyInfoGetter:a.qtyInfoGetter},this._qtyProvider=a.qtyProvider,this._suggestedQty=this._qtyProvider.suggestedQty().spawn(),this._suggestedQty.subscribe((0,s.ensureDefined)(this._qtyModifyCallbacks.onQtyApplyHandler)))}destroy(){var t,e;this._isQtyModifyOpened=!1,this._closeQtyCalc(),this._source.bracketsDisplayMode().unsubscribe(this,this.fireProfitLossChange),null===(t=this._contextMenu)||void 0===t||t.hide(),null===(e=this._suggestedQty)||void 0===e||e.destroy(),super.destroy()}canQtyCalcModify(){return Boolean(this._qtyProvider)}toggleQtyModify(t,e,o={}){this.canQtyCalcModify()&&(this._isQtyModifyOpened=!this._isQtyModifyOpened,this._toggleQtyCalc(t,e,o))}modifyQty(t){this.canQtyCalcModify()&&(0,s.ensureDefined)(this._qtyModifyCallbacks).onQtyApplyHandler(t)}applyQty(t){var e;this.modifyQty(t),null===(e=this._qtyProvider)||void 0===e||e.applySuggestedQty(this._data.qty)}currency(){var t;return null!==(t=this._symbolDataProvider.orderCurrency())&&void 0!==t?t:""}canSwitchType(){return!1}id(){return this._id}setData(t){this._inEdit||(super.setData(t),this.fireProfitLossChange(),this._id=this._calcId())}setInEdit(t){this._inEdit=t}type(){return this._data.type}bracketType(){return this._isBracket()?(0,C.getBracketType)(this._data):null}qty(){return this._data.qty}profitLossText(t){var e;return this._data&&this._isBracket()&&(null===(e=this._source.isBracketsPLVisible())||void 0===e?void 0:e.value())&&this.bracketType()!==p.BracketType.TrailingStop?super.profitLossText(t):this._bracketTypeText(t)}profitLossTextColor(){if(!this._data)return"";const t=this.style();if(!this._isBracket())return t.text.textColor;const e=this._potentialProfitLoss();return null===e?t.text.textColor:e>0?t.positivePlColor:e<0?t.negativePlColor:t.text.textColor}profitLossTooltip(){var t;const e=this._source.mainItem(),o=null==e?void 0:e.price();if(null==o||!this._isBracket())return"";const i=this._potentialProfitLoss();if(null===i)return`${this._bracketTypeText()}`;if(!(null===(t=this._source.isBracketsPLVisible())||void 0===t?void 0:t.value())||this.bracketType()===p.BracketType.TrailingStop)return""
;switch(this._infoGetters.displayMode.value()){case u.PlDisplay.Money:return`${this._bracketTypeText()} ${this.percentageText(i)} ${this.pipsText(i)}`;case u.PlDisplay.Percentage:return`${this._bracketTypeText()} ${this.moneyText(i)} ${this.pipsText(i)}`;case u.PlDisplay.Pips:return`${this._bracketTypeText()} ${this.moneyText(i)} ${this.percentageText(i)}`;default:return`${this._bracketTypeText()} ${this.pipsText(i)} ${this.percentageText(i)} ${this.moneyText(i)}`}}lineStyle(){return this.isWorking()?c.LineStyle.Solid:c.LineStyle.Dotted}calcPriceDiff(t){const e=new a.Point(t.localX,t.localY),o=this._mainSeries.priceScale(),i=this._mainSeries.firstValue();if(null===i)return null;const r=(0,s.ensureNotNull)(this.price());return o.coordinateToPrice(e.y,i)-r}applyPriceDiff(t){this._inEdit=!0,this._data.price=this._calcPriceByDiff(t)}onMove(t){const e=this.calcPriceDiff(t);null!==e&&(this.applyPriceDiff(e),t.isTouch&&(0,s.ensureDefined)(this._itemCommands.exitTrackingMode)())}async onFinishMove(t={},e={},o=!0,i,r=!0){var l,a,d;o&&this._source.setIsBlocked(!0);const c=(0,n.clone)(this._data),h=(0,s.ensureNotNull)(this.price());c.limitPrice=null!==(l=e.limitPrice)&&void 0!==l?l:c.limitPrice,c.takeProfit=null!==(a=e.takeProfit)&&void 0!==a?a:c.takeProfit,c.stopLoss=null!==(d=e.stopLoss)&&void 0!==d?d:c.stopLoss,c.stopPrice?c.stopPrice=h:c.limitPrice&&(c.limitPrice=h),this._addTrailingStopPipsData(c,e.trailingStop),this._trackEventGA(t);const u=await this._onFinishMoveOrder(c,i,r);return this._inEdit=!1,u}hasContextMenu(){return super.hasContextMenu()||this.isMovingEnabled()}async onContextMenu(t,e){this.fireProfitLossChange(),e=(0,b.mergeGaParams)(e,{origin:"Chart Order Context Menu"});const o=this._composeContextMenuActions(e),i={side:(0,y.sideToText)(this._data.side),qty:this.qtyText(),price:this.priceText(),orderType:(0,y.orderTypeToText)({orderType:this._data.type}),formatPlWV:this._isBracket()?this.formatPlWV():void 0},r=await async function(t,e){const o=[],i=await(0,v.createContextMenuTitle)(e);i&&o.push(i);for(const{actionId:e,label:i,onExecute:r}of t)o.push(new d.Action({actionId:e,label:i,onExecute:r}));return o}(o,i),s=this._infoGetters.noOverlapAction(e,(t=>this._trackEventGA(t)));s&&(r.push(new d.Separator),r.push(s)),this._contextMenu=await(0,v.showContextMenu)(r,t,(()=>{this._contextMenu=null}))}_composeContextMenuActions(t){const e=[];return this.supportModify()&&e.push({actionId:"Trading.EditOrder",label:this._source.isPlaced()?g:S,onExecute:()=>this.onModify(t)}),this.supportClose()&&e.push({actionId:"Trading.CancelOrder",label:this._source.isPlaced()?k:T,onExecute:()=>this.onClose(t)}),e}_calcPriceByDiff(t){const{minTick:e,variableMinTickData:o}=(0,s.ensureNotNull)(this._symbolDataProvider.symbolData()),i=t+(0,s.ensureNotNull)(this.price()),r=(0,h.getMinTick)({minTick:e,price:i,variableMinTickData:o});return(0,l.fixComputationError)(r*Math.round(i/r))}_addTrailingStopPipsData(t,e){const o=this._source.mainItem();if(o){const{side:i,stopPrice:r,limitPrice:l}=o.data(),{pipSize:a}=(0,
s.ensureNotNull)(this._symbolDataProvider.symbolData());if(void 0!==e){const o=(0,s.ensureDefined)(t.stopPrice||t.limitPrice);t.trailingStopPips=(0,f.calcPipsByPrice)(e,o,i,a)}else if((0,m.isBracketOrderRawData)(t)&&t.parentId&&t.stopType===_.StopType.TrailingStop){const{bid:e,ask:n}=(0,s.ensureNotNull)(this._symbolDataProvider.lastData());let d;if(isPositionLikeItem(o))d=1===i?e:n;else{d=3===o.data().type?r:l}t.trailingStopPips=(0,f.calcPipsByPrice)((0,s.ensureDefined)(t.stopPrice||t.limitPrice),(0,s.ensureDefined)(d),i,a)}}return t}_bracketTypeText(t){if(!this._data)return"";if(this._isBracket()){const e=(0,C.getBracketTypeToText)(this._data.type,this._data.stopType,t);if(null!==e)return e}return t?(0,y.orderTypeToText)({orderType:this._data.type,uppercase:!0,shorten:!0}):`${(0,y.sideToText)(this._data.side)} ${(0,y.orderTypeToText)({orderType:this._data.type,uppercase:!1})}`}_potentialProfitLoss(){const t=this._source.baseItem();if(!this._data||!t)return null;const e=this.price(),{ask:o,bid:i}=this._symbolDataProvider.lastData()||{},r=t.tryBasePlOnLast()&&3===this._data.type&&this._data.stopType===_.StopType.TrailingStop;if(!(0,n.isNumber)(e))return null;const s=r?this.isBuyDirection()?o:i:t.price();return(0,n.isNumber)(s)?(s-e)*this._data.side:null}_isBracket(){const t=this.data();if(!(0,m.isBracketOrderRawData)(t))return!1;const e=this._source.mainItem();return 1!==t.parentType||void 0!==e&&e.data().side!==this._data.side}_closeQtyCalc(){this._toggleQtyCalc((()=>!1),new a.Point(0,0))}_toggleQtyCalc(t,e=new a.Point(0,0),o={}){if(!this.canQtyCalcModify())return;const{onToggleQtyCalcHandler:i,qtyInfoGetter:r}=(0,s.ensureDefined)(this._qtyModifyCallbacks);i(this._isQtyModifyOpened,e,r,(()=>this.data().qty),(t=>this.modifyQty(t)),(e=>this._handleQtyModifyClose(t,e)),this._handleQtyModifyDestroy)}}},640120:(t,e,o)=>{"use strict";o.d(e,{OrderWithMenuItem:()=>l});var i=o(650151),r=o(86441),s=o(234018);class l extends s.OrderBaseItem{constructor(t,e,o,i,r,s,l,a){super(t,e,o,i,r,s,a),this._isTypeMenuOpened=!1,this._handleTypeMenuClose=(t,e)=>{t(e)||this._handleTypeMenuDestroy()},this._handleTypeMenuDestroy=()=>{this._isTypeMenuOpened=!1},this._typeMenuCallbacks=l}destroy(){var t;null===(t=this._typeMenuCallbacks)||void 0===t||t.closeDropdownMenuHandler(),super.destroy()}isMovingEnabled(){return!0}toggleType(t,e,o={}){this._typeMenuCallbacks&&(this._isTypeMenuOpened=!this._isTypeMenuOpened,this._toggleTypeMenu(t,e,o))}async onClose(t){}async onModify(t){return!1}async _onFinishMoveOrder(t,e,o=!0){return!0}_toggleTypeMenu(t,e=new r.Point(0,0),o={}){(0,i.ensureDefined)(this._typeMenuCallbacks).onToggleTypeMenuHandler(this._isTypeMenuOpened,e,o,(e=>this._handleTypeMenuClose(t,e)),this._handleTypeMenuDestroy)}}},744517:(t,e,o)=>{"use strict";function i(t){return"profitState"in t&&"onReverse"in t}function r(t){return function(t){return"isMovingEnabled"in t&&"onMove"in t&&"onFinishMove"in t}(t)&&"bracketType"in t&&"isWorking"in t}function s(t){return"Position"===t.dataType}function l(t){return"PreOrder"===t.dataType}
function a(t){return"Order"===t.dataType}o.d(e,{isPositionLikeItem:()=>i,isOrderLikeItem:()=>r,isPositionItemRawData:()=>s,isPreOrderItemRawData:()=>l,isOrderItemRawData:()=>a})},309142:(t,e,o)=>{"use strict";o.d(e,{TradedGroupItemType:()=>i,createItem:()=>m});var i,r=o(650151),s=o(822914),l=o(612377),a=o(744517),n=o(568490),d=o(247581),c=o(366416),h=o(622394),u=o(314937),p=o(22702),_=o(503654),y=o(210596),f=o.n(y);class v{constructor(t,e,o){this._onSuggestedQtyChange=t=>{this._lastSuggestedQty=t,this._suggestedQty.setValue(t)},this._symbol=t,this._suggestedQty=new(f())(e),this._lastSuggestedQty=e,this._qtySuggester=o}destroy(){var t;null===(t=this._qtySuggesterSubscription)||void 0===t||t.unsubscribe()}suggestedQty(){return this._suggestedQty}applySuggestedQty(t){void 0===this._qtySuggesterSubscription&&this._subscribeQtySuggester(),this._qtySuggester.setQty(this._symbol,t),this._lastSuggestedQty!==t&&this._suggestedQty.setValue(this._lastSuggestedQty,!0)}async _subscribeQtySuggester(){const t=await this._qtySuggester.getQty(this._symbol);this._suggestedQty.setValue(t),this._qtySuggesterSubscription=this._qtySuggester.suggestedQtyChanged(this._symbol).subscribe(this._onSuggestedQtyChange)}}function m(t,e,o,y,f){const m=y.mainSeries(),b=(t,e)=>(0,l.createNoOverlapMenuAction)(f.itemExternalServices.tradedGroupRenderersController,t,e);if(t===i.Order&&(0,a.isOrderItemRawData)(e)){const{dataType:t,...i}=e,r=t=>(0,u.getDefaultStyleForOrderItem)(t,o,(()=>y.isDark()));return new c.OrderItem(i,o,m,f.itemExternalServices.symbolDataProvider,{displayMode:o.bracketsDisplayMode(),style:r,visibility:f.visibilityGetters.order,noOverlapAction:b},{trackEvent:f.sourceCallbacks.trackEvent,exitTrackingMode:f.sourceCallbacks.exitTrackingMode},void 0,f.gaOrigin)}if(t===i.Position&&(0,a.isPositionItemRawData)(e)){const t=t=>(0,h.getDefaultStyleForPositionItem)(t.isBuyDirection(),o.isBlocked(),(()=>y.isDark()),t.lineStyle()),{dataType:i,...r}=e;return new p.PositionItem(r,o,m,f.itemExternalServices.symbolDataProvider,{displayMode:o.positionDisplayMode(),style:t,visibility:f.visibilityGetters.position,noOverlapAction:b},{trackEvent:f.sourceCallbacks.trackEvent})}if(t===i.LimitPartStopLimitOrder&&(0,a.isOrderItemRawData)(e)){const t=t=>(0,u.getDefaultStyleForOrderItem)(t,o,(()=>y.isDark())),i={...(0,s.default)(e),price:(0,r.ensureDefined)(e.limitPrice),considerFilledQty:!1},{dataType:l,...a}=i;let n;if(f.qtyModifyCallbacks){n={qtyProvider:new v(a.symbol,a.qty,f.itemExternalServices.qtySuggester),...(0,r.ensureDefined)(f.qtyModifyCallbacks)}}return new d.LimitPartStopLimitOrderItem(a,o,m,f.itemExternalServices.symbolDataProvider,{displayMode:o.bracketsDisplayMode(),style:t,visibility:f.visibilityGetters.order,noOverlapAction:b},{trackEvent:f.sourceCallbacks.trackEvent,exitTrackingMode:f.sourceCallbacks.exitTrackingMode},n)}if(t===i.ProjectionBracket&&(0,a.isOrderItemRawData)(e)){const{dataType:t,...i}=e,r=t=>(0,u.getDefaultStyleForOrderItem)(t,o,(()=>y.isDark()))
;return new n.ProjectionBracketItem(i,o,m,f.itemExternalServices.symbolDataProvider,{displayMode:o.bracketsDisplayMode(),style:r,visibility:f.visibilityGetters.order,noOverlapAction:b},{trackEvent:f.sourceCallbacks.trackEvent,exitTrackingMode:f.sourceCallbacks.exitTrackingMode},f.menuCallbacks)}if(t===i.PreOrder&&(0,a.isPreOrderItemRawData)(e)){const t=t=>(0,u.getDefaultStyleForOrderItem)(t,o,(()=>y.isDark())),{dataType:i,...s}=e,l=new v(s.symbol,s.qty,f.itemExternalServices.qtySuggester);return new _.PreOrderItem(s,o,m,f.itemExternalServices.symbolDataProvider,{displayMode:o.bracketsDisplayMode(),style:t,visibility:f.visibilityGetters.order,noOverlapAction:b},{trackEvent:f.sourceCallbacks.trackEvent,exitTrackingMode:f.sourceCallbacks.exitTrackingMode},f.menuCallbacks,{qtyProvider:l,...(0,r.ensureDefined)(f.qtyModifyCallbacks)})}throw new Error("Unknown traded item type")}!function(t){t[t.Position=0]="Position",t[t.Order=1]="Order",t[t.LimitPartStopLimitOrder=2]="LimitPartStopLimitOrder",t[t.ProjectionBracket=3]="ProjectionBracket",t[t.PreOrder=4]="PreOrder"}(i||(i={}))},837470:(t,e,o)=>{"use strict";o.d(e,{isPositionItem:()=>n,isOrderItem:()=>d,isPreOrderItem:()=>c,isLimitPartStopLimitOrderItem:()=>h,isProjectionBracketItem:()=>u});var i=o(568490),r=o(247581),s=o(366416),l=o(22702),a=o(503654);function n(t){return t instanceof l.PositionItem}function d(t){return t instanceof s.OrderItem}function c(t){return t instanceof a.PreOrderItem}function h(t){return t instanceof r.LimitPartStopLimitOrderItem}function u(t){return t instanceof i.ProjectionBracketItem}},247581:(t,e,o)=>{"use strict";o.d(e,{LimitPartStopLimitOrderItem:()=>a});var i=o(650151),r=o(486028),s=o(696546),l=o(366416);class a extends l.OrderItem{isWorking(){return!1}async onFinishMove(t,e={},o=!0,s){this._source.setIsBlocked(o);const l=(0,r.clone)(this.data()),a=(0,i.ensureNotNull)(l.price);l.limitPrice=a,l.takeProfit=e.takeProfit||l.takeProfit,l.stopLoss=e.stopLoss||l.stopLoss,await this._addTrailingStopPipsData(l),void 0===s&&(s=1),this._trackEventGA(t);const n=await(0,i.ensureDefined)(this._data.callbacks.moveOrder)(l.id,l,s);return this._inEdit=!1,this._source.setIsBlocked(!1),this._source.syncData(),n}profitLossText(t){return this._source.isPlaced()?this._bracketTypeText(t):(0,s.orderTypeToText)({orderType:this.data().type,uppercase:t,shorten:t})}supportClose(){return!1}_calcId(){return this.data().type}}},366416:(t,e,o)=>{"use strict";o.d(e,{OrderItem:()=>h});var i=o(650151),r=o(486028),s=o(484727),l=o(122621),a=o(18550),n=o(234018),d=o(843388);const c=s.enabled("chart_hide_close_order_button");class h extends n.OrderBaseItem{style(){return this._infoGetters.style(this)}isMovingEnabled(){return this._data.supportMove}supportClose(){return!c&&Boolean(this._data.callbacks.cancelOrder)}supportModify(){return Boolean(this._data.callbacks.modifyOrder)}isWorking(){return 6===this._data.status}qtyText(){return super._quantityText(this._data.considerFilledQty?this._data.qty-(this._data.filledQty||0):this._data.qty)}profitLossText(t){var e
;return this._data&&this._isBracket()&&(null===(e=this._source.isBracketsPLVisible())||void 0===e?void 0:e.value())&&this.bracketType()!==l.BracketType.TrailingStop?super.profitLossText(t):this._bracketTypeText(t)}async onModify(t={},e,o){this._source.setIsBlocked(!0);const s=(0,r.clone)(this._data);await this._addTrailingStopPipsData(s),this._trackEventGA((0,a.mergeGaParams)(t,{event:"Edit Order"}));const l=await(0,i.ensureDefined)(this._data.callbacks.modifyOrder)(s.id,s,e,o);return this._source.setIsBlocked(!1),this._source.syncData(),l}async onClose(t={}){this._source.isBlocked()||(this._source.setIsBlocked(!0),this._trackEventGA((0,a.mergeGaParams)(t,{event:"Cancel Order"})),await(0,i.ensureDefined)(this._data.callbacks.cancelOrder)(this._data.id),this._source.setIsBlocked(!1),this._source.syncData())}_onFinishMoveOrder(t,e,o=!0){return this._data.callbacks.moveOrder||this._data.supportModifyOrderPrice?(0,i.ensureDefined)(this._data.callbacks.moveOrder)(t.id,t,e):(0,i.ensureDefined)(this._data.callbacks.modifyOrder)(t.id,t,e,o)}_calcId(){return void 0!==this._data.parentId?(0,i.ensureNotNull)((0,d.getBracketType)(this._data)):this._data.id}}},344280:(t,e,o)=>{"use strict";o.d(e,{buyActiveColor:()=>l,sellActiveColor:()=>a,takeProfitActiveColor:()=>n,stopLossActiveColor:()=>d,buyPointShadowColor:()=>c,sellPointShadowColor:()=>h,overlayColor:()=>_,darkTheme:()=>b});var i=o(676507),r=o(602564),s=o(316167);const l=(0,r.generateColor)(i.colorsPalette["color-tv-blue-500"],85),a=((0,r.generateColor)(i.colorsPalette["color-tv-blue-500"],80),(0,r.generateColor)(i.colorsPalette["color-ripe-red-500"],85)),n=((0,r.generateColor)(i.colorsPalette["color-ripe-red-500"],80),(0,r.generateColor)(i.colorsPalette["color-minty-green-500"],85)),d=((0,r.generateColor)(i.colorsPalette["color-minty-green-500"],80),(0,r.generateColor)(i.colorsPalette["color-tan-orange-500"],85)),c=((0,r.generateColor)(i.colorsPalette["color-tan-orange-500"],80),(0,r.generateColor)(i.colorsPalette["color-tv-blue-500"],70)),h=(0,r.generateColor)(i.colorsPalette["color-ripe-red-500"],70),u=(0,r.generateColor)(i.colorsPalette["color-minty-green-500"],70),p=(0,r.generateColor)(i.colorsPalette["color-tan-orange-500"],70),_=(0,r.generateColor)(i.colorsPalette["color-cold-gray-900"],50),y={pointShadowColor:c,labelTickColor:i.colorsPalette["color-tv-blue-500"],lineColor:i.colorsPalette["color-tv-blue-500"],borderBackgroundColor:i.colorsPalette["color-cold-gray-900"],borderColor:i.colorsPalette["color-tv-blue-500"],pointBackgroundColor:i.colorsPalette["color-cold-gray-900"],disabledLineColor:i.colorsPalette["color-tv-blue-a700"],positivePlColor:i.colorsPalette["color-minty-green-500"],negativePlColor:i.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:i.colorsPalette["color-cold-gray-900"],textColor:i.colorsPalette["color-tv-blue-500"],dividerColor:i.colorsPalette["color-tv-blue-a800"],activeColor:l},text:{backgroundColor:i.colorsPalette["color-cold-gray-900"],textColor:i.colorsPalette["color-tv-blue-500"],dividerColor:i.colorsPalette["color-tv-blue-a800"],
buttonTextColor:i.colorsPalette["color-tv-blue-500"]},close:{backgroundColor:i.colorsPalette["color-cold-gray-900"],iconColor:i.colorsPalette["color-tv-blue-500"],activeColor:l},confirm:{backgroundColor:i.colorsPalette["color-tv-blue-500"],borderColor:i.colorsPalette["color-tv-blue-500"],textColor:i.colorsPalette["color-white"],activeColor:i.colorsPalette["color-tv-blue-600"]}},f={pointShadowColor:h,labelTickColor:i.colorsPalette["color-ripe-red-500"],lineColor:i.colorsPalette["color-ripe-red-500"],borderBackgroundColor:i.colorsPalette["color-cold-gray-900"],borderColor:i.colorsPalette["color-ripe-red-500"],pointBackgroundColor:i.colorsPalette["color-cold-gray-900"],disabledLineColor:i.colorsPalette["color-ripe-red-a800"],positivePlColor:i.colorsPalette["color-minty-green-500"],negativePlColor:i.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:i.colorsPalette["color-cold-gray-900"],textColor:i.colorsPalette["color-ripe-red-500"],dividerColor:i.colorsPalette["color-ripe-red-a800"],activeColor:a},text:{backgroundColor:i.colorsPalette["color-cold-gray-900"],textColor:i.colorsPalette["color-ripe-red-500"],dividerColor:i.colorsPalette["color-ripe-red-a800"],buttonTextColor:i.colorsPalette["color-ripe-red-500"]},close:{backgroundColor:i.colorsPalette["color-cold-gray-900"],iconColor:i.colorsPalette["color-ripe-red-500"],activeColor:a},confirm:{backgroundColor:i.colorsPalette["color-ripe-red-500"],borderColor:i.colorsPalette["color-ripe-red-500"],textColor:i.colorsPalette["color-white"],activeColor:i.colorsPalette["color-ripe-red-600"]}},v={pointShadowColor:u,labelTickColor:i.colorsPalette["color-minty-green-500"],lineColor:i.colorsPalette["color-minty-green-500"],borderBackgroundColor:i.colorsPalette["color-cold-gray-900"],borderColor:i.colorsPalette["color-minty-green-500"],pointBackgroundColor:i.colorsPalette["color-cold-gray-900"],positivePlColor:i.colorsPalette["color-minty-green-500"],negativePlColor:i.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:i.colorsPalette["color-cold-gray-900"],textColor:i.colorsPalette["color-minty-green-500"],dividerColor:"#0D3D41",activeColor:n},text:{backgroundColor:i.colorsPalette["color-cold-gray-900"],textColor:i.colorsPalette["color-minty-green-500"],dividerColor:"#0D3D41",buttonTextColor:i.colorsPalette["color-minty-green-500"]},close:{backgroundColor:i.colorsPalette["color-cold-gray-900"],iconColor:i.colorsPalette["color-minty-green-500"],activeColor:n}},m={pointShadowColor:p,labelTickColor:i.colorsPalette["color-tan-orange-500"],lineColor:i.colorsPalette["color-tan-orange-500"],borderBackgroundColor:i.colorsPalette["color-cold-gray-900"],borderColor:i.colorsPalette["color-tan-orange-500"],pointBackgroundColor:i.colorsPalette["color-cold-gray-900"],positivePlColor:i.colorsPalette["color-minty-green-500"],negativePlColor:i.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:i.colorsPalette["color-cold-gray-900"],textColor:i.colorsPalette["color-tan-orange-500"],dividerColor:"#453826",activeColor:d},text:{backgroundColor:i.colorsPalette["color-cold-gray-900"],
textColor:i.colorsPalette["color-tan-orange-500"],dividerColor:"#453826",buttonTextColor:i.colorsPalette["color-tan-orange-500"]},close:{backgroundColor:i.colorsPalette["color-cold-gray-900"],iconColor:i.colorsPalette["color-tan-orange-500"],activeColor:d}},b={buy:{normal:y,disabled:(0,s.generateBlendColors)(y,_)},sell:{normal:f,disabled:(0,s.generateBlendColors)(f,_)},takeProfit:{normal:v,disabled:(0,s.generateBlendColors)(v,_)},stopLoss:{normal:m,disabled:(0,s.generateBlendColors)(m,_)}}},190019:(t,e,o)=>{"use strict";o.d(e,{buyPointShadowColor:()=>a,sellPointShadowColor:()=>n,overlayColor:()=>h,lightTheme:()=>f});var i=o(676507),r=o(602564),s=o(316167),l=o(344280);const a=(0,r.generateColor)(i.colorsPalette["color-tv-blue-500"],80),n=(0,r.generateColor)(i.colorsPalette["color-ripe-red-500"],80),d=(0,r.generateColor)(i.colorsPalette["color-minty-green-500"],80),c=(0,r.generateColor)(i.colorsPalette["color-tan-orange-500"],80),h=(0,r.generateColor)(i.colorsPalette["color-white"],50),u={pointShadowColor:a,labelTickColor:i.colorsPalette["color-tv-blue-500"],lineColor:i.colorsPalette["color-tv-blue-500"],borderBackgroundColor:i.colorsPalette["color-white"],borderColor:i.colorsPalette["color-tv-blue-500"],pointBackgroundColor:i.colorsPalette["color-white"],disabledLineColor:i.colorsPalette["color-tv-blue-100"],positivePlColor:i.colorsPalette["color-minty-green-500"],negativePlColor:i.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:i.colorsPalette["color-white"],textColor:i.colorsPalette["color-tv-blue-500"],dividerColor:i.colorsPalette["color-tv-blue-50"],activeColor:l.buyActiveColor},text:{backgroundColor:i.colorsPalette["color-white"],textColor:i.colorsPalette["color-tv-blue-500"],dividerColor:i.colorsPalette["color-tv-blue-50"],buttonTextColor:i.colorsPalette["color-tv-blue-500"]},close:{backgroundColor:i.colorsPalette["color-white"],iconColor:i.colorsPalette["color-tv-blue-500"],activeColor:l.buyActiveColor},confirm:{backgroundColor:i.colorsPalette["color-tv-blue-500"],borderColor:i.colorsPalette["color-tv-blue-500"],textColor:i.colorsPalette["color-white"],activeColor:i.colorsPalette["color-tv-blue-600"]}},p={pointShadowColor:n,labelTickColor:i.colorsPalette["color-ripe-red-500"],lineColor:i.colorsPalette["color-ripe-red-500"],borderBackgroundColor:i.colorsPalette["color-white"],borderColor:i.colorsPalette["color-ripe-red-500"],pointBackgroundColor:i.colorsPalette["color-white"],disabledLineColor:i.colorsPalette["color-ripe-red-100"],positivePlColor:i.colorsPalette["color-minty-green-500"],negativePlColor:i.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:i.colorsPalette["color-white"],textColor:i.colorsPalette["color-ripe-red-500"],dividerColor:i.colorsPalette["color-ripe-red-50"],activeColor:l.sellActiveColor},text:{backgroundColor:i.colorsPalette["color-white"],textColor:i.colorsPalette["color-ripe-red-500"],dividerColor:i.colorsPalette["color-ripe-red-50"],buttonTextColor:i.colorsPalette["color-ripe-red-500"]},close:{backgroundColor:i.colorsPalette["color-white"],
iconColor:i.colorsPalette["color-ripe-red-500"],activeColor:l.sellActiveColor},confirm:{backgroundColor:i.colorsPalette["color-ripe-red-500"],borderColor:i.colorsPalette["color-ripe-red-500"],textColor:i.colorsPalette["color-white"],activeColor:i.colorsPalette["color-ripe-red-600"]}},_={pointShadowColor:d,labelTickColor:i.colorsPalette["color-minty-green-500"],lineColor:i.colorsPalette["color-minty-green-500"],borderBackgroundColor:i.colorsPalette["color-white"],borderColor:i.colorsPalette["color-minty-green-500"],pointBackgroundColor:i.colorsPalette["color-white"],positivePlColor:i.colorsPalette["color-minty-green-500"],negativePlColor:i.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:i.colorsPalette["color-white"],textColor:i.colorsPalette["color-minty-green-500"],dividerColor:i.colorsPalette["color-minty-green-50"],activeColor:l.takeProfitActiveColor},text:{backgroundColor:i.colorsPalette["color-white"],textColor:i.colorsPalette["color-minty-green-500"],dividerColor:i.colorsPalette["color-minty-green-50"],buttonTextColor:i.colorsPalette["color-minty-green-500"]},close:{backgroundColor:i.colorsPalette["color-white"],iconColor:i.colorsPalette["color-minty-green-500"],activeColor:l.takeProfitActiveColor}},y={pointShadowColor:c,labelTickColor:i.colorsPalette["color-tan-orange-500"],lineColor:i.colorsPalette["color-tan-orange-500"],borderBackgroundColor:i.colorsPalette["color-white"],borderColor:i.colorsPalette["color-tan-orange-500"],pointBackgroundColor:i.colorsPalette["color-white"],positivePlColor:i.colorsPalette["color-minty-green-500"],negativePlColor:i.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:i.colorsPalette["color-white"],textColor:i.colorsPalette["color-tan-orange-500"],dividerColor:i.colorsPalette["color-tan-orange-50"],activeColor:l.stopLossActiveColor},text:{backgroundColor:i.colorsPalette["color-white"],textColor:i.colorsPalette["color-tan-orange-500"],dividerColor:i.colorsPalette["color-tan-orange-50"],buttonTextColor:i.colorsPalette["color-tan-orange-500"]},close:{backgroundColor:i.colorsPalette["color-white"],iconColor:i.colorsPalette["color-tan-orange-500"],activeColor:l.stopLossActiveColor}},f={buy:{normal:u,disabled:(0,s.generateBlendColors)(u,h)},sell:{normal:p,disabled:(0,s.generateBlendColors)(p,h)},takeProfit:{normal:_,disabled:(0,s.generateBlendColors)(_,h)},stopLoss:{normal:y,disabled:(0,s.generateBlendColors)(y,h)}}},314937:(t,e,o)=>{"use strict";o.d(e,{getDefaultStyleForOrderItem:()=>a,getStyleForOppositeDirection:()=>n});var i=o(795161),r=o(122621),s=o(190019),l=o(344280);function a(t,e,o,a={}){const n=o()?l.darkTheme:s.lightTheme;let d;const c=t.bracketType();d=null!==c?c===r.BracketType.TakeProfit?n.takeProfit:n.stopLoss:t.isBuyDirection()?n.buy:n.sell;const h=e.disabled()?d.disabled:d.normal,u=e.isPlaced()?t.lineStyle():i.LineStyle.Dashed;return{...h,lineStyle:u,borderStyle:u,labelBorderVisible:!0,...a}}function n(t,e,o){const r=o()?l.darkTheme:s.lightTheme,a=t.isBuyDirection()?r.sell:r.buy;return{...e.disabled()?a.disabled:a.normal,
lineStyle:t.isWorking()?e.lineStyle():i.LineStyle.Dotted,borderStyle:t.isWorking()?i.LineStyle.Solid:i.LineStyle.Dotted,labelBorderVisible:!0}}},22702:(t,e,o)=>{"use strict";o.d(e,{PositionItem:()=>P});var i=o(650151),r=o(927079),s=o(710567),l=o(484727),a=o(486028),n=o(448064),d=o(817808),c=o(696546),h=o(612377),u=o(163851),p=o(18550),_=o(186131),y=o(509806);const f=(0,o(21218).appendEllipsis)(y.t(null,void 0,o(888310))),v=y.t(null,void 0,o(424356)),m=y.t(null,void 0,o(920848));const b=(0,d.getLogger)("Trading.Positions"),C=l.enabled("chart_hide_close_position_button");class P extends _.BaseItem{constructor(t,e,o,i,r,s){super(t,e,o,i,"Chart Position",r,s),this._source.positionDisplayMode().subscribe(this,this.fireProfitLossChange)}destroy(){this._source.positionDisplayMode().unsubscribe(this,this.fireProfitLossChange),super.destroy()}currency(){var t;return null!==(t=this._symbolDataProvider.positionCurrency())&&void 0!==t?t:""}profitLossTextColor(){if(!this._data)return"";const t=this._infoGetters.style(this);switch(this._data.profitState){case"negative":return t.negativePlColor;case"positive":return t.positivePlColor;default:return t.text.textColor}}id(){return this._data.id}setData(t){var e;const o=null===(e=this.data())||void 0===e?void 0:e.pl;super.setData(t),this.data().pl!==o&&this.fireProfitLossChange()}qtyText(){return super._quantityText(this._data.qtyBySide)}qty(){return this._data.qtyBySide}profitState(){return this._data.profitState}supportOnlyPairBrackets(){return this._data.supportOnlyPairBrackets}supportReverse(){return this._data.supportReverse}async onReverse(t={}){t=(0,p.mergeGaParams)(t,{event:"Reverse Position"}),await this._doActionWithBlock("reversePosition",!0,t)}supportClose(){return!C&&this._data.supportClose}async onClose(t={}){t=(0,p.mergeGaParams)(t,{event:"Close Position"}),await this._doActionWithBlock("closePosition",!0,t)}supportModify(){return this._data.supportBrackets}async onModify(t={}){return t=(0,p.mergeGaParams)(t,{event:"Edit Position"}),this._doActionWithBlock("modifyPosition",!0,t,void 0,void 0,!1)}useMinTickFormatter(){return!1}async onModifyWithBracket(t={},e={},o=!0,r,s=!0){var l,a;const n=this._symbolDataProvider.lastData(),d=null!==(l=null==n?void 0:n.bid)&&void 0!==l?l:null,c=null!==(a=null==n?void 0:n.ask)&&void 0!==a?a:null;if(void 0!==e.trailingStop&&d&&c){const t=1===this._data.side?d:c,{pipSize:o}=(0,i.ensureNotNull)(this._symbolDataProvider.symbolData());e.trailingStopPips=(0,u.calcPipsByPrice)(e.trailingStop,t,this._data.side,o),e.trailingStop=void 0}return this._doActionWithBlock("modifyPosition",o,t,e,r,s)}hasContextMenu(){return super.hasContextMenu()||this.supportReverse()}moneyText(t,e){return`${(0,_.plSign)(t,e)}${Math.abs(t).toFixed(2)} ${this.currency()}`}async onContextMenu(t,e){this.fireProfitLossChange();const o={};e=(0,p.mergeGaParams)(e,{origin:"Chart Position Context Menu"}),this.supportClose()&&(o.closePosition=this.onClose.bind(this,e)),this.supportReverse()&&(o.reversePosition=this.onReverse.bind(this,e)),
this.supportModify()&&(o.modifyPosition=this.onModify.bind(this,e));const i={side:(0,c.sideToText)(this._data.side),qty:this.qtyText(),price:this.priceText(),formatPlWV:this.formatPlWV(),plColorWV:this.plColorWV()},r=await async function(t,e){const o=[],i=await(0,h.createContextMenuTitle)(e);return i&&o.push(i),void 0!==t.modifyPosition&&o.push(new s.Action({actionId:"Trading.ModifyPosition",label:f,onExecute:t.modifyPosition})),void 0!==t.closePosition&&o.push(new s.Action({actionId:"Trading.ClosePosition",label:v,onExecute:t.closePosition})),void 0!==t.reversePosition&&o.push(new s.Action({actionId:"Trading.ReversePosition",label:m,onExecute:t.reversePosition})),o}(o,i),l=this._infoGetters.noOverlapAction(e,(t=>this._trackEventGA(t)));l&&(r.push(new s.Separator),r.push(l)),this._contextMenu=await(0,h.showContextMenu)(r,t,(()=>{this._contextMenu=null}))}tryBasePlOnLast(){return!0}_potentialProfitLoss(){var t;if(!this._source.isPositionPLVisible().value()||!this._data)return null;const{pl:e,side:o,price:i}=this._data;if(null===e)return null;if(this._infoGetters.displayMode.value()===r.PlDisplay.Money)return e;const{trade:s,ask:l,bid:n}=this._symbolDataProvider.lastData()||{},d=null!==(t=this._data.plBasedOnLast?s:this.isBuyDirection()?n:l)&&void 0!==t?t:i;return(0,a.isNumber)(d)?(d-i)*o:null}async _doActionWithBlock(t,e,o={},r={},s,l){if(void 0===this._data.callbacks[t])return!1;e&&this._source.setIsBlocked(!0),this._trackEventGA(o);let a=!1;try{a="modifyPosition"===t?await(0,i.ensureDefined)(this._data.callbacks.modifyPosition)(this._data.id,r,s,l):await(0,i.ensureDefined)(this._data.callbacks[t])(this._data.id)}catch(e){b.logWarn(`Try to ${t}, but got error: ${(0,n.errorToString)(e)}`)}finally{e&&(this._source.setIsBlocked(!1),this._source.syncData())}return a}}},622394:(t,e,o)=>{"use strict";o.d(e,{getDefaultStyleForPositionItem:()=>_});var i=o(795161),r=o(676507),s=o(344280),l=o(316167);const a={pointShadowColor:s.buyPointShadowColor,lineColor:r.colorsPalette["color-tv-blue-500"],borderBackgroundColor:r.colorsPalette["color-cold-gray-900"],borderColor:r.colorsPalette["color-tv-blue-500"],pointBackgroundColor:r.colorsPalette["color-cold-gray-900"],disabledLineColor:r.colorsPalette["color-tv-blue-a700"],positivePlColor:r.colorsPalette["color-minty-green-500"],negativePlColor:r.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:r.colorsPalette["color-tv-blue-500"],textColor:r.colorsPalette["color-white"],dividerColor:r.colorsPalette["color-tv-blue-500"],activeColor:r.colorsPalette["color-tv-blue-600"]},text:{backgroundColor:r.colorsPalette["color-cold-gray-900"],textColor:r.colorsPalette["color-cold-gray-600"],dividerColor:r.colorsPalette["color-tv-blue-a800"]},close:{backgroundColor:r.colorsPalette["color-cold-gray-900"],iconColor:r.colorsPalette["color-tv-blue-500"],activeColor:s.buyActiveColor},reverse:{backgroundColor:r.colorsPalette["color-cold-gray-900"],borderColor:r.colorsPalette["color-tv-blue-500"],iconColor:r.colorsPalette["color-tv-blue-500"],activeColor:s.buyActiveColor},confirm:{
backgroundColor:r.colorsPalette["color-tv-blue-500"],borderColor:r.colorsPalette["color-tv-blue-500"],textColor:r.colorsPalette["color-white"],activeColor:r.colorsPalette["color-tv-blue-600"]}},n={pointShadowColor:s.sellPointShadowColor,lineColor:r.colorsPalette["color-ripe-red-500"],borderBackgroundColor:r.colorsPalette["color-cold-gray-900"],borderColor:r.colorsPalette["color-ripe-red-500"],pointBackgroundColor:r.colorsPalette["color-cold-gray-900"],disabledLineColor:r.colorsPalette["color-ripe-red-a800"],positivePlColor:r.colorsPalette["color-minty-green-500"],negativePlColor:r.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:r.colorsPalette["color-ripe-red-500"],textColor:r.colorsPalette["color-white"],dividerColor:r.colorsPalette["color-ripe-red-500"],activeColor:r.colorsPalette["color-ripe-red-600"]},text:{backgroundColor:r.colorsPalette["color-cold-gray-900"],textColor:r.colorsPalette["color-cold-gray-600"],dividerColor:r.colorsPalette["color-ripe-red-a800"]},close:{backgroundColor:r.colorsPalette["color-cold-gray-900"],iconColor:r.colorsPalette["color-ripe-red-500"],activeColor:s.sellActiveColor},reverse:{backgroundColor:r.colorsPalette["color-cold-gray-900"],borderColor:r.colorsPalette["color-ripe-red-500"],iconColor:r.colorsPalette["color-ripe-red-500"],activeColor:s.sellActiveColor},confirm:{backgroundColor:r.colorsPalette["color-ripe-red-500"],borderColor:r.colorsPalette["color-ripe-red-500"],textColor:r.colorsPalette["color-white"],activeColor:r.colorsPalette["color-ripe-red-600"]}},d={buy:{normal:a,disabled:(0,l.generateBlendColors)(a,s.overlayColor)},sell:{normal:n,disabled:(0,l.generateBlendColors)(n,s.overlayColor)}};var c=o(190019);const h={pointShadowColor:c.buyPointShadowColor,lineColor:r.colorsPalette["color-tv-blue-500"],borderBackgroundColor:r.colorsPalette["color-white"],borderColor:r.colorsPalette["color-tv-blue-500"],pointBackgroundColor:r.colorsPalette["color-white"],disabledLineColor:r.colorsPalette["color-tv-blue-100"],positivePlColor:r.colorsPalette["color-minty-green-500"],negativePlColor:r.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:r.colorsPalette["color-tv-blue-500"],textColor:r.colorsPalette["color-white"],dividerColor:r.colorsPalette["color-tv-blue-500"],activeColor:r.colorsPalette["color-tv-blue-600"]},text:{backgroundColor:r.colorsPalette["color-white"],textColor:r.colorsPalette["color-cold-gray-300"],dividerColor:r.colorsPalette["color-tv-blue-50"]},close:{backgroundColor:r.colorsPalette["color-white"],iconColor:r.colorsPalette["color-tv-blue-500"],activeColor:s.buyActiveColor},reverse:{backgroundColor:r.colorsPalette["color-white"],borderColor:r.colorsPalette["color-tv-blue-500"],iconColor:r.colorsPalette["color-tv-blue-500"],activeColor:s.buyActiveColor},confirm:{backgroundColor:r.colorsPalette["color-tv-blue-500"],borderColor:r.colorsPalette["color-tv-blue-500"],textColor:r.colorsPalette["color-white"],activeColor:r.colorsPalette["color-tv-blue-600"]}},u={pointShadowColor:c.sellPointShadowColor,lineColor:r.colorsPalette["color-ripe-red-500"],
borderBackgroundColor:r.colorsPalette["color-white"],borderColor:r.colorsPalette["color-ripe-red-500"],pointBackgroundColor:r.colorsPalette["color-white"],disabledLineColor:r.colorsPalette["color-ripe-red-100"],positivePlColor:r.colorsPalette["color-minty-green-500"],negativePlColor:r.colorsPalette["color-ripe-red-500"],qty:{backgroundColor:r.colorsPalette["color-ripe-red-500"],textColor:r.colorsPalette["color-white"],dividerColor:r.colorsPalette["color-ripe-red-500"],activeColor:r.colorsPalette["color-ripe-red-600"]},text:{backgroundColor:r.colorsPalette["color-white"],textColor:r.colorsPalette["color-cold-gray-300"],dividerColor:r.colorsPalette["color-ripe-red-50"]},close:{backgroundColor:r.colorsPalette["color-white"],iconColor:r.colorsPalette["color-ripe-red-500"],activeColor:s.sellActiveColor},reverse:{backgroundColor:r.colorsPalette["color-white"],borderColor:r.colorsPalette["color-ripe-red-500"],iconColor:r.colorsPalette["color-ripe-red-500"],activeColor:s.sellActiveColor},confirm:{backgroundColor:r.colorsPalette["color-ripe-red-500"],borderColor:r.colorsPalette["color-ripe-red-500"],textColor:r.colorsPalette["color-white"],activeColor:r.colorsPalette["color-ripe-red-600"]}},p={buy:{normal:h,disabled:(0,l.generateBlendColors)(h,c.overlayColor)},sell:{normal:u,disabled:(0,l.generateBlendColors)(u,c.overlayColor)}};function _(t,e,o,r=i.LineStyle.Solid){const s=o()?d:p,l=t?s.buy:s.sell;return{...e?l.disabled:l.normal,lineStyle:r,borderStyle:r,labelBorderVisible:!1}}},503654:(t,e,o)=>{"use strict";o.d(e,{PreOrderItem:()=>n});var i=o(509806),r=o(795161),s=o(696546),l=o(640120);const a=i.t(null,void 0,o(502861));class n extends l.OrderWithMenuItem{constructor(){super(...arguments),this._supportedOrderTypes=[]}qtyText(){return super._quantityText(this._data.qty)}style(){return this._infoGetters.style(this)}setSupportOrderType(t){this._supportedOrderTypes=t}canSwitchType(){return this._supportedOrderTypes.length>1}orderTypesItems(){return this._supportedOrderTypes.map((t=>({type:t,typeText:(0,s.orderTypeToText)({orderType:t})})))}isWorking(){return!0}profitLossText(t){return(0,s.orderTypeToText)({orderType:this.data().type,uppercase:t,shorten:t})}profitLossTooltip(){return a}lineStyle(){return r.LineStyle.Dashed}supportClose(){return!0}supportModify(){return this._data.supportModify}async onClose(t){var e,o;null===(o=(e=this._source).onClose)||void 0===o||o.call(e,t)}async onModify(t){var e,o;return null===(o=(e=this._source).onModify)||void 0===o||o.call(e,t),!0}_calcId(){return"preOrder"}}},568490:(t,e,o)=>{"use strict";o.d(e,{ProjectionBracketItem:()=>m});var i=o(650151),r=o(150335),s=o(86441),l=o(509806),a=o(486028),n=o(795161),d=o(122621),c=o(971204),h=o(640120);const u=l.t(null,{context:"Stop loss"},o(653315)),p=l.t(null,{context:"Trailing stop"},o(668694)),_=l.t(null,{context:"Take profit"},o(645560)),y=l.t(null,void 0,o(223754)),f=l.t(null,void 0,o(870184)),v=l.t(null,void 0,o(416976));class m extends h.OrderWithMenuItem{style(){return this._infoGetters.style(this)}setPrice(t){const{minTick:e}=(0,
i.ensureNotNull)(this._symbolDataProvider.symbolData());null!==t&&(t=(0,r.fixComputationError)(e*Math.round(t/e))),this.setData({...(0,a.clone)(this.data()),price:t})}data(){return super.data()}qtyText(){return this._bracketTypeText(!0)}tooltip(){switch(this.bracketType()){case d.BracketType.TakeProfit:return y;case d.BracketType.StopLoss:return f;case d.BracketType.TrailingStop:return v;default:throw new Error("Unknown bracket type")}}isWorking(){return!0}supportClose(){return!1}supportModify(){return!0}profitLossText(t){var e;return(null===(e=this._source.isBracketsPLVisible())||void 0===e?void 0:e.value())&&this.bracketType()!==d.BracketType.TrailingStop?super.profitLossText(t):""}isMinifyMode(){return null===this.price()}bracketType(){return this.data().bracketType}async onMove(t){const e=new s.Point(t.localX,t.localY),o=this._mainSeries.priceScale(),r=this._mainSeries.firstValue();if(null===r)return;const l=o.coordinateToPrice(e.y,r);this.setPrice(l),t.isTouch&&(0,i.ensureDefined)(this._itemCommands.exitTrackingMode)()}lineStyle(){return n.LineStyle.Dashed}_isBracket(){return!0}_calcId(){return this._data.id}_bracketTypeText(t){return this._data?this.bracketType()===d.BracketType.TakeProfit?_:this._source.bracketStopType()===c.StopType.TrailingStop?p:u:""}}},163851:(t,e,o)=>{"use strict";o.d(e,{calcPipsByPrice:()=>r});var i=o(960521);function r(t,e,o,r){return(0,i.Big)(t).minus(e).div(r).mul(1===o?-1:1).toNumber()}},18550:(t,e,o)=>{"use strict";o.d(e,{mergeGaParams:()=>r});var i=o(650151);function r(t,e){(0,i.assert)(!(t.origin&&e.origin&&t.origin!==e.origin||t.event&&e.event&&t.event!==e.event),"origin and event should be only in one params object");const o={...t,...e};return t.label&&e.label&&(o.label=`${t.label} ${e.label}`),o}},843388:(t,e,o)=>{"use strict";o.d(e,{getBracketType:()=>_,getBracketTypeToText:()=>y,bracketsByType:()=>f,buildProjectionBracketData:()=>v,getOrderPriceByType:()=>m});var i=o(650151),r=o(509806),s=o(122621),l=o(971204),a=o(744517);const n=r.t(null,void 0,o(86430)),d=r.t(null,void 0,o(241648)),c=r.t(null,void 0,o(129266)),h=r.t(null,{context:"Trailing stop"},o(668694)),u=r.t(null,{context:"Stop loss"},o(653315)),p=r.t(null,{context:"Take profit"},o(645560));function _(t){return 3===t.type?t.stopType===l.StopType.TrailingStop?s.BracketType.TrailingStop:s.BracketType.StopLoss:1===t.type?s.BracketType.TakeProfit:null}function y(t,e,o){return 3===t?e===l.StopType.TrailingStop?o?h:n:o?u:d:1===t?o?p:c:null}function f(t){let e,o,i;return t.forEach((t=>{switch((0,a.isOrderLikeItem)(t)?t.bracketType():_(t)){case s.BracketType.TakeProfit:e=t;break;case s.BracketType.TrailingStop:i=t;break;case s.BracketType.StopLoss:o=t}})),{takeProfit:e,trailingStop:i,stopLoss:o}}function v(t,e,o){const i=e===s.BracketType.TrailingStop?l.StopType.TrailingStop:void 0,r=e===s.BracketType.TakeProfit?1:3,a=-1===o.side?1:-1;return{dataType:"Order",id:e===s.BracketType.TakeProfit?`${t}TakeProfit`:e===s.BracketType.StopLoss?`${t}StopLoss`:`${t}TrailingStop`,price:null,type:r,stopType:i,side:a,bracketType:e,qty:o.qty,
status:6,symbol:o.symbol,plBasedOnLast:"plBasedOnLast"in o&&o.plBasedOnLast,considerFilledQty:!1,supportModify:!1,supportModifyOrderPrice:!1,supportMove:!0,supportCancel:!1,supportBrackets:!1,callbacks:{}}}function m(t){return 1===t.type?(0,i.ensureDefined)(t.limitPrice,"limit price for order"):(0,i.ensureDefined)(t.stopPrice,"stop price for order")}},612377:(t,e,o)=>{"use strict";o.d(e,{createNoOverlapMenuAction:()=>s,showContextMenu:()=>l,createContextMenuTitle:()=>a});var i=o(509806),r=(o(710567),o(282926));o(18550);i.t(null,void 0,o(376303));function s(t,e,o){return null}async function l(t,e,o){return r.ContextMenuManager.createMenu(t,{},{menuName:"TradingOrderContextMenu"},o).then((t=>(t.show(e),t)))}async function a(t){return null}},25775:(t,e,o)=>{"use strict";o.d(e,{drawArrow:()=>l,drawOutlinedArrowHead:()=>a,drawHalfArrow:()=>n,drawText:()=>d,drawUnderlinedText:()=>c,drawOutlinedText:()=>h});var i=o(795161),r=o(664114),s=o(289763);function l(t,e,o,i,r,s,l,a,n){t.save();const d=t.lineWidth,c=t.lineWidth%2?.5:0;t.translate(e+c,o+c),s&&t.scale(1,-1);const h=Math.round(a/2),u=h,p=h;n&&(t.strokeStyle=r,t.lineWidth=2*t.lineWidth,t.lineCap="square",t.beginPath(),t.moveTo(0,h),t.lineTo(u,0),t.lineTo(a,h),t.stroke(),t.lineCap="butt",t.beginPath(),t.moveTo(p,l+(t.lineWidth-d)/2),t.lineTo(u,0),t.stroke()),t.lineWidth=d,t.strokeStyle=i,t.lineCap="square",t.beginPath(),t.moveTo(0,h),t.lineTo(u,0),t.lineTo(a,h),t.stroke(),t.lineCap="butt",t.beginPath(),t.moveTo(p,l),t.lineTo(u,0),t.stroke(),t.restore()}function a(t,e,o,i,r,s,l,a=90){t.save();const n=t.lineWidth,d=2*t.lineWidth,c=t.lineWidth%2?.5:0;t.translate(e+c+l/2-n,o+c),t.rotate(a*Math.PI/180);const h=Math.round(l/2);t.lineCap="square",t.lineWidth=d,t.strokeStyle=r,t.beginPath(),t.moveTo(0,h),t.lineTo(h,0),t.lineTo(l,h),t.stroke(),t.lineCap="square",t.lineWidth=n,t.strokeStyle=i,t.beginPath(),t.moveTo(0,h),t.lineTo(h,0),t.lineTo(l,h),t.stroke(),t.restore()}function n(t,e,o,i,r,s,l){t.save(),t.strokeStyle=i,t.lineJoin="miter";const a=t.lineWidth%2?.5:0,n=Math.round(s/3);t.translate(e+a,o+a),r&&t.scale(-1,-1),t.beginPath(),t.moveTo(0,s),t.lineTo(0,0),t.lineTo(-l,n),t.stroke(),t.restore()}function d(t,e,o,i,r,l,a,n,d="center"){t.save(),t.textAlign=d,t.textBaseline="middle",t.fillStyle=a,t.font=n,t.translate(i,r+l),(0,s.drawScaled)(t,e,(()=>{t.fillText(o,0,0)})),t.restore()}function c(t,e,o,l,a,n,d,c,h){t.save(),t.textAlign="center",t.textBaseline="middle",t.fillStyle=d,t.font=c;const u=1,p=1,_=(i.LineStyle.Dashed,Math.round(10*e)/2),y=Math.max(1,Math.floor(p*e)),f=h.width*e,v=Math.max(1,Math.floor(u*e)),m=Math.round(l-f/2),b=Math.round(a+_+v);t.strokeStyle=d,t.lineWidth=y;const C=Math.round(3*t.lineWidth),P=Math.round(3*t.lineWidth/2),g=Math.round(2*t.lineWidth);let k=Math.trunc(f/(C+g));const T=Math.trunc(f%(C+g)/2),S=[];for(S.push(P+T);k>1;)S.push(g,C),k--;S.push(g,P+T),t.setLineDash(S),(0,r.drawHorizontalLine)(t,b,m,m+Math.round(f)),t.translate(l,a+n),(0,s.drawScaled)(t,e,(()=>{t.fillText(o,0,0)})),t.restore()}function h(t,e,o,i,r,l,a,n,d){t.save(),
t.textAlign="center",t.textBaseline="middle",t.fillStyle=a,t.font=n,t.lineJoin="round",t.translate(i,r+l),(0,s.drawScaled)(t,e,(()=>{t.strokeStyle=d,t.strokeText(o,0,0),t.fillText(o,0,0)})),t.restore()}},653315:t=>{t.exports={ar:["إيقاف الخسارة"],ca_ES:"SL",cs:"SL",de:"SL",el:"SL",en:"SL",es:"SL",fa:"SL",fr:"SL",he_IL:"SL",hu_HU:"SL",id_ID:"SL",it:"SL",ja:"SL",ko:["스탑로스"],ms_MY:"SL",nl_NL:"SL",pl:"SL",pt:"SL",ro:"SL",ru:["СЛ"],sv:"SL",th:"SL",tr:"SL",vi:"SL",zh:"SL",zh_TW:"SL"}},645560:t=>{t.exports={ar:["جني الأرباح"],ca_ES:"TP",cs:"TP",de:"TP",el:"TP",en:"TP",es:"TP",fa:"TP",fr:"TP",he_IL:"TP",hu_HU:"TP",id_ID:"TP",it:"TP",ja:"TP",ko:["테이크프라핏"],ms_MY:"TP",nl_NL:"TP",pl:"TP",pt:"TP",ro:"TP",ru:["ТП"],sv:"TP",th:"TP",tr:["KA"],vi:"TP",zh:"TP",zh_TW:"TP"}},668694:t=>{t.exports={ar:"TS",ca_ES:"TS",cs:"TS",de:"TS",el:"TS",en:"TS",es:"TS",fa:"TS",fr:"TS",he_IL:"TS",hu_HU:"TS",id_ID:"TS",it:"TS",ja:"TS",ko:["트레일링 스탑"],ms_MY:"TS",nl_NL:"TS",pl:"TS",pt:"TS",ro:"TS",ru:["ТС"],sv:"TS",th:["เทรลลิ่งสต๊อป"],tr:"TS",vi:"TS",zh:["跟踪止损"],zh_TW:["跟踪止損"]}},316075:t=>{t.exports={ar:["إلغاء أمر"],ca_ES:["Cancel·lar ordre"],cs:"Cancel Order",de:["Auftrag abbrechen"],el:"Cancel Order",en:"Cancel Order",es:["Cancelar orden"],fa:"Cancel Order",fr:["Annuler Ordre"],he_IL:["בטל פקודה"],hu_HU:["Megbízás Törlése"],id_ID:["Batalkan Order"],it:["Annulla ordine"],ja:["注文をキャンセル"],ko:["주문 취소"],ms_MY:["Batalkan Pesanan"],nl_NL:"Cancel Order",pl:["Anuluj zlecenie"],pt:["Cancelar ordem"],ro:"Cancel Order",ru:["Отменить заявку"],sv:["Avbryt order"],th:["ยกเลิกคำสั่ง"],tr:["Emir İptal"],vi:["Hủy Lệnh"],zh:["取消订单"],zh_TW:["取消報單"]}},555937:t=>{t.exports={ar:["إلغاء أمر المشروع"],ca_ES:"Cancel project order",cs:"Cancel project order",de:["Projekt-Order stornieren"],el:"Cancel project order",en:"Cancel project order",es:"Cancel project order",fa:"Cancel project order",fr:["Annuler le projet d'ordre"],he_IL:["בטל פקודת פרויקט"],hu_HU:"Cancel project order",id_ID:["Batalkan order proyek"],it:["Annulla ordine del progetto"],ja:["プロジェクトオーダーのキャンセル"],ko:["프로젝트 주문 취소"],ms_MY:["Batal pesanan projek"],nl_NL:"Cancel project order",pl:"Cancel project order",pt:"Cancel project order",ro:"Cancel project order",ru:["Отменить проектную заявку"],sv:["Avbryt projektorder"],th:"Cancel project order",tr:["Proje emrini iptal et"],vi:["Huỷ lệnh dự án"],zh:"Cancel project order",zh_TW:"Cancel project order"}},502861:t=>{t.exports={ar:["تغيير نوع الأمر"],ca_ES:"Change order type",cs:"Change order type",de:["Order-Typ ändern"],el:"Change order type",en:"Change order type",es:["Cambiar tipo de orden"],fa:"Change order type",fr:["Changer le type d'ordre"],he_IL:["שנה סוג הוראה"],hu_HU:"Change order type",id_ID:["Ubah tipe order"],it:["Cambia tipo di ordine"],ja:["注文タイプの変更"],ko:["주문 유형 변경"],ms_MY:["Tukar jenis pesanan"],nl_NL:"Change order type",pl:["Zmień typ zlecenia"],pt:["Alterar tipo da ordem"],ro:"Change order type",ru:["Изменить тип заявки"],sv:["Ändra ordertyp"],th:["เปลี่ยนประเภทของ Stop Order"],tr:["Değişiklik emri türü"],vi:["Thay đổi loại lệnh"],zh:["更改订单类型"],
zh_TW:["更改訂單類型"]}},437431:t=>{t.exports={ar:["إغلاق صفقة"],ca_ES:"Close Position",cs:"Close Position",de:["Position Schließen"],el:"Close Position",en:"Close Position",es:["Cerrar posición"],fa:"Close Position",fr:["Fermer la Position"],he_IL:["סגור פוזיציה"],hu_HU:["Záró Pozíció"],id_ID:["Tutup Posisi"],it:["Chiudi posizione"],ja:["ポジション決済"],ko:["포지션 닫기"],ms_MY:["Kedudukan Penutup"],nl_NL:"Close Position",pl:["Zamknij pozycję"],pt:["Fechar Posição"],ro:"Close Position",ru:["Закрыть позицию"],sv:["Stäng position"],th:["ปิดสถานะ"],tr:["Pozisyonu Kapat"],vi:["Đóng Trạng thái"],zh:["平仓"],zh_TW:["平倉"]}},870184:t=>{t.exports={ar:["إضافة أمر إيقاف الخسارة"],ca_ES:"Add Stop Loss",cs:"Add Stop Loss",de:["Stop Loss hinzufügen"],el:"Add Stop Loss",en:"Add Stop Loss",es:["Añadir Stop Loss"],fa:"Add Stop Loss",fr:["Ajouter Stop Loss"],he_IL:["הוסף סטופ לוס"],hu_HU:"Add Stop Loss",id_ID:["Dan Stop Loss"],it:["Aggiungi stop loss"],ja:["損切りを追加"],ko:["스탑 로스 추가"],ms_MY:["Tambah Renti Rugi"],nl_NL:"Add Stop Loss",pl:["Dodaj Stop Loss"],pt:["Adcionar Stop Loss"],ro:"Add Stop Loss",ru:["Добавить Стоп-лосс"],sv:["Lägg till en stoppförlust"],th:["เพิ่ม Stop Loss"],tr:["Zarar Durdur'u Ekle"],vi:["Thêm Cắt Lỗ"],zh:["添加止损"],zh_TW:["加停損單"]}},223754:t=>{t.exports={ar:["إضافة أمر جني الأرباح"],ca_ES:"Add Take Profit",cs:"Add Take Profit",de:["Take Profit hinzufügen"],el:"Add Take Profit",en:"Add Take Profit",es:["Añadir Take Profit"],fa:"Add Take Profit",fr:["Ajouter Take Profit"],he_IL:["הוסף Take Profit"],hu_HU:"Add Take Profit",id_ID:["Dan Take Profit"],it:["Aggiungi take profit"],ja:["利益確定を追加"],ko:["이익 실현 추가"],ms_MY:["Tambah Ambil Untung"],nl_NL:"Add Take Profit",pl:["Dodaj Take Profit"],pt:["Adicionar Take Profit"],ro:"Add Take Profit",ru:["Добавить Тейк-профит"],sv:["Lägg till vinstuttag"],th:["เพิ่ม Take Profit"],tr:["Kar Al'ı Ekle"],vi:["Thêm Chốt Lời"],zh:["添加止盈"],zh_TW:["增加停利單"]}},416976:t=>{t.exports={ar:["أضف أمر الوقف المتحرك"],ca_ES:"Add Trailing Stop",cs:"Add Trailing Stop",de:["Trailing Stop hinzufügen"],el:"Add Trailing Stop",en:"Add Trailing Stop",es:["Añadir tope de pérdida dinámico (Trailing Stop)"],fa:"Add Trailing Stop",fr:["Ajouter un Trailing stop"],he_IL:["הוסף סטופ נגרר"],hu_HU:"Add Trailing Stop",id_ID:["Tambahkan Trailing Stop"],it:["Aggiungi trailing stop"],ja:["トレーリングストップの追加"],ko:["트레이링 스탑 넣기"],ms_MY:["Tambah Hentian Jejak"],nl_NL:"Add Trailing Stop",pl:["Dodaj Trailing Stop"],pt:["Adicionar Trailing Stop"],ro:"Add Trailing Stop",ru:["Добавить Трейлинг-стоп"],sv:["Lägg till Trailing Stop"],th:["เพิ่มเทลลิ่งสต็อป"],tr:["Takipli Durdurma Ekle"],vi:["Thêm điểm dừng"],zh:["添加追踪止损"],zh_TW:["增加追蹤停損"]}},618156:t=>{t.exports={ar:["شراء"],ca_ES:"Buy",cs:"Buy",de:["Kauf"],el:"Buy",en:"Buy",es:["Comprar"],fa:"Buy",fr:"Buy",he_IL:["קניה"],hu_HU:["Vétel"],id_ID:["Pembelian"],it:["Compra"],ja:["買い"],ko:["바이"],ms_MY:["Beli"],nl_NL:"Buy",pl:["Kup"],pt:["Compra"],ro:"Buy",ru:["Покупать"],sv:["Köp"],th:["ซื้อ"],tr:["Al"],vi:["Mua"],zh:["买入"],zh_TW:["買入"]}},937385:t=>{t.exports={ar:"Edit project order",ca_ES:"Edit project order",
cs:"Edit project order",de:["Projekt-Order bearbeiten"],el:"Edit project order",en:"Edit project order",es:"Edit project order",fa:"Edit project order",fr:["Modifier le projet d'ordre"],he_IL:["ערוך פקודת פרויקט"],hu_HU:"Edit project order",id_ID:["Edit order proyek"],it:["Modifica ordine del progetto"],ja:["プロジェクトオーダーの作成"],ko:["프로젝트 주문 수정"],ms_MY:["Edit pesanan projek"],nl_NL:"Edit project order",pl:"Edit project order",pt:"Edit project order",ro:"Edit project order",ru:["Редактировать проектную заявку"],sv:["Redigera projektorder"],th:"Edit project order",tr:["Proje emrini değiştir"],vi:["Chỉnh sửa lệnh dự án"],zh:"Edit project order",zh_TW:"Edit project order"}},137172:t=>{t.exports={ar:["تعديل الأمر..."],ca_ES:"Modify Order...",cs:"Modify Order...",de:["Order modifizieren..."],el:"Modify Order...",en:"Modify Order...",es:["Modificar orden..."],fa:"Modify Order...",fr:["Modifier l'ordre..."],he_IL:["שנה הוראה..."],hu_HU:"Modify Order...",id_ID:["Memodifikasi Order..."],it:["Modifica ordine..."],ja:["注文の変更..."],ko:["오더 고치기..."],ms_MY:["Ubah Suai Pesanan..."],nl_NL:"Modify Order...",pl:["Modyfikuj zlecenie..."],pt:["Modificar ordem..."],ro:"Modify Order...",ru:["Изменить заявку..."],sv:["Ändra order..."],th:["แก้ไขออเดอร์..."],tr:["Emir Değiştir..."],vi:["Chỉnh Lệnh..."],zh:["调整订单..."],zh_TW:["修改訂單..."]}},305806:t=>{t.exports={ar:["تعديل الأمر"],ca_ES:"Modify order",cs:"Modify order",de:["Order bearbeiten"],el:"Modify order",en:"Modify order",es:["Modificar orden"],fa:"Modify order",fr:["Modifier l'ordre"],he_IL:["שנה פקודה"],hu_HU:"Modify order",id_ID:["Ubah order"],it:["Modifica ordine"],ja:["注文を変更する"],ko:["모디파이 오더"],ms_MY:["Ubah suai pesanan"],nl_NL:"Modify order",pl:["Modyfikuj zlecenie"],pt:["Modificar ordem"],ro:"Modify order",ru:["Изменить заявку"],sv:["Ändra order"],th:["เปลี่ยนแปลงออร์เดอร์"],tr:["Emri değiştir"],vi:["Điều chỉnh lệnh"],zh:["修改订单"],zh_TW:["修改訂單"]}},376303:t=>{t.exports={ar:["لا توجد أوامر ومراكز متداخلة"],ca_ES:"No overlap orders and positions",cs:"No overlap orders and positions",de:["Keine Überschneidungen von Aufträgen und Positionen"],el:"No overlap orders and positions",en:"No overlap orders and positions",es:["No hay solapamiento de órdenes y posiciones"],fa:"No overlap orders and positions",fr:["Pas de chevauchement des ordres et des positions"],he_IL:["אין פקודות ותפקידים חופפים"],hu_HU:"No overlap orders and positions",id_ID:["Tidak ada order dan posisi yang tumpang tindih"],it:["No ordini sovrapposti"],ja:["注文やポジションを重ねない"],ko:["겹치는 주문 및 포지션이 없습니다."],ms_MY:["Tiada pesanan dan posisi bertindan"],nl_NL:"No overlap orders and positions",pl:["Brak nakładających się zleceń i pozycji"],pt:["Sem sobreposição de ordens e posições"],ro:"No overlap orders and positions",ru:["Не перекрывать заявки и позиции"],sv:["Inga överlappande ordrar eller positioner"],th:["ไม่มีออร์เดอร์และโพสิชั่นที่ทับซ้อนกัน"],tr:["Çakışan emir ve pozisyon yok"],vi:["Không có lệnh và vị thế trùng lặp"],zh:["无重叠订单和仓位"],zh_TW:["無重疊訂單和部位"]}},392553:t=>{t.exports={ar:["بيع"],ca_ES:"Sell",cs:"Sell",de:["Verkauf"],
el:"Sell",en:"Sell",es:["Vender"],fa:"Sell",fr:["Vendre"],he_IL:["מכירה"],hu_HU:["Eladás"],id_ID:["Penjualan"],it:["Vendi"],ja:["売り"],ko:["셀"],ms_MY:["Jual"],nl_NL:"Sell",pl:["Sprzedaj"],pt:["Venda"],ro:"Sell",ru:["Продавать"],sv:["Sälj"],th:["ขาย"],tr:["Sat"],vi:["Bán"],zh:["卖出"],zh_TW:["賣出"]}},619397:t=>{t.exports={ar:["وقف الخسارة"],ca_ES:"Stop loss",cs:"Stop loss",de:["Stop-Loss"],el:"Stop loss",en:"Stop loss",es:["Stop Loss"],fa:"Stop loss",fr:["Stop Loss"],he_IL:["סטופ לוס"],hu_HU:"Stop loss",id_ID:["Stop Loss"],it:"Stop loss",ja:["損切り"],ko:["스탑로스"],ms_MY:["Renti Rugi"],nl_NL:["Stop-loss"],pl:["Stop Loss"],pt:["Stop Loss"],ro:["Stop Loss"],ru:["Стоп-лосс"],sv:["Stop Loss"],th:["ตัดขาดทุน"],tr:["Zarar Durdur"],vi:["Cắt lỗ"],zh:["止损"],zh_TW:["停損"]}},911810:t=>{t.exports={ar:["حماية المركز"],ca_ES:"Protect Position",cs:"Protect Position",de:["Position absichern"],el:"Protect Position",en:"Protect Position",es:["Proteger posición"],fa:"Protect Position",fr:["Protéger la position"],he_IL:["הגן על הפוזיציה."],hu_HU:"Protect Position",id_ID:["Lindungi Posisi"],it:["Proteggi posizione"],ja:["ポジション保護"],ko:["프로텍트 포지션"],ms_MY:["Melindungi Kedudukan"],nl_NL:"Protect Position",pl:["Zabezpiecz pozycję"],pt:["Proteger a posição"],ro:"Protect Position",ru:["Защитить позицию"],sv:["Skydda position"],th:["ป้องกันโพซิชั่น"],tr:["Pozisyonu Koru"],vi:["Bảo vệ Vị thế"],zh:["保护持仓"],zh_TW:["保護倉位"]}},888310:t=>{t.exports={ar:["حماية المركز"],ca_ES:"Protect position",cs:"Protect position",de:["Position absichern"],el:"Protect position",en:"Protect position",es:"Protect position",fa:"Protect position",fr:["Protéger la position"],he_IL:["הגן על הפוזיציה."],hu_HU:"Protect position",id_ID:["Lindungi posisi"],it:["Proteggi posizione"],ja:["ポジション保護"],ko:["포지션 보호"],ms_MY:["Lindungi kedudukan"],nl_NL:"Protect position",pl:["Zabezpiecz pozycję"],pt:"Protect position",ro:"Protect position",ru:["Защитить позицию"],sv:"Protect position",th:"Protect position",tr:["Pozisyonu koru"],vi:["Bảo vị vị thế"],zh:"Protect position",zh_TW:"Protect position"}},419780:t=>{t.exports={ar:["عكس الصفقة"],ca_ES:"Reverse Position",cs:"Reverse Position",de:["Position Umkehren"],el:"Reverse Position",en:"Reverse Position",es:["Revertir posición"],fa:"Reverse Position",fr:["Inverser la Position"],he_IL:["הפוך פוזיציה"],hu_HU:["Fordított Pozíció"],id_ID:["Membalik Posisi"],it:["Inverti posizione"],ja:["ポジションを反転"],ko:["리버스 포지션"],ms_MY:["Kedudukan Terbalik"],nl_NL:"Reverse Position",pl:["Odwróć pozycje"],pt:["Reverter Posição"],ro:"Reverse Position",ru:["Перевернуть позицию"],sv:["Omvänd position"],th:["ตำแหน่งการย้อนกลับ"],tr:["Karşıt Pozisyon"],vi:["Vị thế Đảo ngược"],zh:["平仓反手"],zh_TW:["平倉反手"]}},360538:t=>{t.exports={ar:["وقف الخسارة المتحرك"],ca_ES:"Trailing stop",cs:["Trailing Stop"],de:["Trailing Stop"],el:["Trailing Stop"],en:"Trailing stop",es:["Tope de pérdida dinámico"],fa:["Trailing Stop"],fr:["Trailing Stop"],he_IL:["טריילינג-סטופ"],hu_HU:["Trailing Stop"],id_ID:["Trailing Stop"],it:["Trailing Stop"],ja:["トレーリングストップ"],ko:["트레일링 스탑"],ms_MY:["Jejakan Renti"],
nl_NL:["Trailing Stop"],pl:["Zlecenie Trailing Stop"],pt:["Trailing Stop"],ro:["Trailing Stop"],ru:["Трейлинг-стоп"],sv:["Efterföljande stopp"],th:["การเลื่อนจุดตัดขาดทุน"],tr:["İz süren Stop"],vi:["Lệnh cắt lỗ dưới"],zh:["跟踪止损"],zh_TW:["移動停損"]}},777772:t=>{t.exports={ar:["‎{pips}‎ نقطة","‎{pips}‎ نقطة","‎{pips}‎ نقطة","‎{pips}‎ نقاط","‎{pips}‎ نقطة","‎{pips}‎ نقطة"],ca_ES:"{pips} pip",cs:"{pips} pip",de:["{pips} Pip","{pips} Pips"],el:"{pips} pip",en:"{pips} pip",es:"{pips} pip",fa:["{pips} pips"],fr:"{pips} pip",he_IL:["פיפ {pips}","פיפס {pips}","פיפס {pips}","פיפס {pips}"],hu_HU:["{pips} pips"],id_ID:"{pips} pip",it:"{pips} pip",ja:["{pips}pips"],ko:["{pips} 핍"],ms_MY:"{pips} pip",nl_NL:"{pips} pip",pl:"{pips} pip",pt:"{pips} pip",ro:"{pips} pip",ru:["{pips} пипс","{pips} пипса","{pips} пипсов","{pips} пипсов"],sv:"{pips} pip",th:"{pips} pip",tr:"{pips} pip",vi:"{pips} pip",zh:["{pips}点"],zh_TW:["{pips}點"]}},564225:t=>{t.exports={ar:["‎{ticks}‎ تيك","‎{ticks}‎ تيك","‎{ticks}‎ تيك","‎{ticks}‎ تيك","‎{ticks}‎ تيك‏","‎{ticks}‎ تيك"],ca_ES:"{ticks} tick",cs:"{ticks} tick",de:["{ticks} Tick","{ticks} Ticks"],el:"{ticks} tick",en:"{ticks} tick",es:"{ticks} tick",fa:["{ticks} ticks"],fr:"{ticks} tick",he_IL:["טיק‎{ticks}‎","טיקים ‎{ticks}‎","טיקים ‎{ticks}‎","טיקים ‎{ticks}‎"],hu_HU:["{ticks} ticks"],id_ID:"{ticks} tick",it:"{ticks} tick",ja:["{ticks}ティック"],ko:["{ticks} 틱"],ms_MY:"{ticks} tick",nl_NL:"{ticks} tick",pl:"{ticks} tick",pt:"{ticks} tick",ro:"{ticks} tick",ru:["{ticks} тик","{ticks} тика","{ticks} тиков","{ticks} тиков"],sv:"{ticks} tick",th:"{ticks} tick",tr:["{ticks} çubuk","{ticks} çubuk"],vi:"{ticks} tick",zh:["{ticks}ticks"],zh_TW:["{ticks}ticks"]}}}]);