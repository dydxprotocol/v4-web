(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[6780],{50105:e=>{e.exports={innerLabel:"innerLabel-21h1g6jU"}},76535:e=>{e.exports={controlWrapper:"controlWrapper-7ApHzdB4",hidden:"hidden-7ApHzdB4",control:"control-7ApHzdB4",controlIncrease:"controlIncrease-7ApHzdB4",controlDecrease:"controlDecrease-7ApHzdB4",controlIcon:"controlIcon-7ApHzdB4",title:"title-7ApHzdB4"}},18368:e=>{e.exports={scrollable:"scrollable-2w4-r8AL"}},75604:(e,t,i)=>{"use strict";i.d(t,{InputWithError:()=>p});var o=i(67294),n=i(94184),s=i(72913),r=i(54056),a=i(37467),l=i(17138),c=i(42436),d=i(50105);const u={large:s.InputClasses.FontSizeLarge,medium:s.InputClasses.FontSizeMedium},h={attachment:c.anchors.top.attachment,targetAttachment:c.anchors.top.targetAttachment,attachmentOffsetY:-4};function p(e){const{className:t,inputClassName:i,stretch:s=!0,errorMessage:c,fontSizeStyle:p="large",endSlot:m,button:_,error:g,warning:b,innerLabel:C,inputReference:v,children:S,...f}=e,y=g&&void 0!==c?[c]:void 0,P=b&&void 0!==c?[c]:void 0,I=n(d.inputContainer,u[p],t),E=C?o.createElement(r.StartSlot,{className:d.innerLabel,interactive:!1},C):void 0,A=m||_||S?o.createElement(r.EndSlot,null,m,_,S):void 0;return o.createElement(a.FormInput,{...f,className:I,inputClassName:i,errors:y,warnings:P,hasErrors:g,hasWarnings:b,messagesPosition:l.MessagesPosition.Attached,customErrorsAttachment:h,messagesRoot:"document",inheritMessagesWidthFromTarget:!0,disableMessagesRtlStyles:!0,iconHidden:!0,stretch:s,reference:v,startSlot:E,endSlot:A})}},66361:(e,t,i)=>{"use strict";i.d(t,{NumberInputView:()=>C});var o=i(67294),n=i(89505),s=i(75604),r=i(94184),a=i(74245),l=i(21659),c=i(14897),d=i(76535);function u(e){const t=r(d.control,d.controlIncrease),i=r(d.control,d.controlDecrease);return o.createElement(o.Fragment,null,void 0!==e.title&&o.createElement("div",{className:d.title},e.title),o.createElement("div",{className:d.controlWrapper},(e.defaultButtonsVisible||e.title)&&o.createElement(o.Fragment,null,o.createElement("button",{type:"button",tabIndex:-1,"aria-label":(0,a.t)("Increase"),className:t,onClick:e.increaseValue},o.createElement(l.Icon,{icon:c,className:d.controlIcon})),o.createElement("button",{type:"button",tabIndex:-1,"aria-label":(0,a.t)("Decrease"),className:i,onClick:e.decreaseValue},o.createElement(l.Icon,{icon:c,className:d.controlIcon})))))}var h=i(51720),p=i(65262),m=i(88812),_=i(69397);const g=[38],b=[40];function C(e){const[t,i]=(0,h.useHover)(),[r,a]=(0,p.useFocus)(),l=(0,m.createSafeMulticastEventHandler)(a.onFocus,e.onFocus),c=(0,m.createSafeMulticastEventHandler)(a.onBlur,e.onBlur),d=(0,o.useCallback)(t=>{!e.disabled&&r&&(t.preventDefault(),t.deltaY<0?e.onValueByStepChange(1):e.onValueByStepChange(-1))},[r,e.disabled,e.onValueByStepChange]);return o.createElement(s.InputWithError,{...i,id:e.id,name:e.name,pattern:e.pattern,borderStyle:e.borderStyle,fontSizeStyle:e.fontSizeStyle,value:e.value,className:e.className,inputClassName:e.inputClassName,button:function(){
const{button:i,forceShowControls:s,disabled:a,title:l}=e,c=!a&&!n.mobiletouch&&(s||r||t);return a?void 0:o.createElement(o.Fragment,null,null!=i?i:o.createElement(u,{increaseValue:C,decreaseValue:v,defaultButtonsVisible:c,title:l}))}(),disabled:e.disabled,placeholder:e.placeholder,innerLabel:e.innerLabel,endSlot:e.endSlot,containerReference:e.containerReference,inputReference:e.inputReference,inputMode:e.inputMode,type:e.type,error:e.error,errorMessage:e.errorMessage,onClick:e.onClick,onFocus:l,onBlur:c,onChange:e.onValueChange,onKeyDown:function(t){if(e.disabled||0!==(0,_.modifiersFromEvent)(t.nativeEvent))return;let i=g,o=b;e.controlDecKeyCodes&&(o=o.concat(e.controlDecKeyCodes));e.controlIncKeyCodes&&(i=i.concat(e.controlIncKeyCodes));(o.includes(t.keyCode)||i.includes(t.keyCode))&&(t.preventDefault(),e.onValueByStepChange(o.includes(t.keyCode)?-1:1));e.onKeyDown&&e.onKeyDown(t)},onWheelNoPassive:d,stretch:e.stretch,intent:e.intent,highlight:e.highlight,highlightRemoveRoundBorder:e.highlightRemoveRoundBorder,autoSelectOnFocus:e.autoSelectOnFocus,"data-property-id":e["data-name"]});function C(){e.disabled||e.onValueByStepChange(1)}function v(){e.disabled||e.onValueByStepChange(-1)}}},25568:(e,t,i)=>{"use strict";i.r(t),i.d(t,{SourcePropertiesEditorRenderer:()=>A});i(74245);var o=i(67294),n=i(73935),s=i(41695),r=i(16282),a=i(85452),l=i(69671),c=i.n(l),d=i(44956),u=i(32011),h=i(14711),p=i(25882),m=i(15300),_=i(32420),g=i(16676),b=i(2491),C=i(27652),v=i(13662),S=i(7511),f=i(46403),y=i(35688),P=i(18368);class I extends o.PureComponent{constructor(e){super(e),this._activePageRef=o.createRef(),this._getActionPageById=e=>{if(!e)return;const{pages:t}=this.props;return t.find(t=>t.id.toLowerCase()===e.toLowerCase())},this._onChangeActivePageDefinitions=()=>{this.setState({tableKey:Date.now()},()=>{this._requestResize&&this._requestResize()})},this._renderFooterLeft=()=>{const{source:e,model:t}=this.props;return(0,_.isLineTool)(e)?o.createElement(p.FooterMenu,{source:e,model:t}):o.createElement(f.MatchMedia,{rule:"screen and (max-width: 428px)"},i=>(0,b.isStudy)(e)&&o.createElement(g.StudyDefaultsManager,{model:t,source:e,mode:i?"compact":"normal"}))},this._subscribe=e=>{e&&e.definitions.subscribe(this._onChangeActivePageDefinitions)},this._unsubscribe=e=>{e&&e.definitions.unsubscribe(this._onChangeActivePageDefinitions)},this._getActiveTabSettingsName=()=>{const{source:e}=this.props;return e instanceof C.Series?"properties_dialog.active_tab.chart":e instanceof v.LineDataSource?"properties_dialog.active_tab.drawing":e instanceof S.Study?"properties_dialog.active_tab.study":""},this._handleSelectPage=e=>{const{activePageId:t}=this.state,i=this._getActionPageById(t),o=this._getActionPageById(e),n=this._getActiveTabSettingsName();t!==e&&(this._unsubscribe(i),n&&c().setValue(n,e),this._subscribe(o),this.setState({activePageId:e,tableKey:Date.now()},()=>{this._requestResize&&this._requestResize(),this._focusActivePageFirstTextInput()}))},this._handleScroll=()=>{u.globalCloseDelegate.fire()},this._handleSubmit=()=>{
this.props.onSubmit(),this._closePopupDialog()},this._closePopupDialog=()=>{window.lineToolPropertiesToolbar&&window.lineToolPropertiesToolbar.refresh(),this.props.onClose()};const{pages:t}=this.props;let i;if(this._getActionPageById(this.props.activePageId))i=(0,r.ensureDefined)(this.props.activePageId);else{const e=c().getValue(this._getActiveTabSettingsName(),""),o=this._getActionPageById(e);i=o?o.id:t[0].id}this.state={activePageId:i,tableKey:Date.now()},window.lineToolPropertiesToolbar&&window.lineToolPropertiesToolbar.hide()}componentDidMount(){const{activePageId:e}=this.state,t=this._getActionPageById(e);this._focusActivePageFirstTextInput(),this._subscribe(t)}componentWillUnmount(){const{activePageId:e}=this.props,t=this._getActionPageById(e);clearTimeout(this._timeout),this._unsubscribe(t)}render(){var e;const{source:t,onCancel:i}=this.props,{activePageId:n}=this.state,s=(null===(e=t.properties().title)||void 0===e?void 0:e.value())||t.title();return o.createElement(d.AdaptiveConfirmDialog,{dataName:"source-properties-editor",title:s,isOpened:!0,onSubmit:this._handleSubmit,onCancel:i,onClickOutside:this._handleSubmit,onClose:this._closePopupDialog,footerLeftRenderer:this._renderFooterLeft,render:this._renderChildren(n),submitOnEnterKey:!1})}_renderChildren(e){return({requestResize:t})=>{this._requestResize=t;const{pages:i}=this.props,n={allIds:i.map(e=>e.id),byId:i.reduce((e,t)=>({...e,[t.id]:{title:t.title}}),{})},s=i.find(t=>t.id===e);return o.createElement(o.Fragment,null,o.createElement(h.DialogTabs,{activeTabId:e,onSelect:this._handleSelectPage,tabs:n}),o.createElement(m.TouchScrollContainer,{className:P.scrollable,onScroll:this._handleScroll},o.createElement(y.PropertiesEditorTab,{page:s,pageRef:this._activePageRef,tableKey:this.state.tableKey})))}}_focusActivePageFirstTextInput(){if(!a.CheckMobile.any()&&this._activePageRef.current){const e=this._activePageRef.current.querySelector("input[type=text],textarea");e&&(this._timeout=setTimeout(()=>{e.focus()},0))}}}var E=i(8361);class A extends E.DialogRenderer{constructor(e){super(),this._timeout=null,this._handleClose=()=>{n.unmountComponentAtNode(this._container),this._setVisibility(!1),this._onClose&&this._onClose(),this._subscription.unsubscribe(this,this._handleCollectionChanged)},this._handleSubmit=()=>{const e=this._source;(0,_.isLineTool)(e)&&e.hasAlert.value()&&setTimeout(()=>{e.areLocalAndServerAlertsMismatch()&&e.synchronizeAlert(!0)})},this._handleCancel=()=>{this._model.undoToCheckpoint(this._checkpoint)},this._propertyPages=e.propertyPages,this._model=e.model,this._activePageId=e.activePageId,this._onClose=e.onClose,this._source=e.source,this._checkpoint=this._ensureCheckpoint(e.undoCheckPoint),this._subscription=this._model.model().dataSourceCollectionChanged(),this._subscription.subscribe(this,this._handleCollectionChanged)}hide(e){e?this._handleCancel():this._handleSubmit(),this._handleClose()}isVisible(){return this.visible().value()}show(){n.render(o.createElement(I,{source:this._source,onSubmit:this._handleSubmit,
onClose:this._handleClose,onCancel:this._handleCancel,pages:this._propertyPages,model:this._model,activePageId:this._activePageId}),this._container),this._setVisibility(!0),s.emit("drawings_settings_dialog",{objectType:"drawing",scriptTitle:this._source.title()})}_handleCollectionChanged(){null===this._timeout&&(this._timeout=setTimeout(()=>{this._closeDialogIfSourceIsDeleted(),this._timeout=null}))}_closeDialogIfSourceIsDeleted(){null===this._model.model().dataSourceForId(this._source.id())&&this._handleClose()}_ensureCheckpoint(e){return void 0===e&&(e=this._model.createUndoCheckpoint()),e}}},15379:(e,t,i)=>{"use strict";i.r(t),i.d(t,{SourcesPropertiesEditorRenderer:()=>f});var o=i(67294),n=i(73935),s=i(74245),r=i(49972),a=i(8361);const l=function(){};var c=i(14711),d=i(15300),u=i(44956),h=i(49297),p=i(50585),m=i(35688);const _=(0,s.t)("Apply Defaults"),g=(0,s.t)("Selected Drawings"),b={allIds:["visibility"],byId:{visibility:{title:(0,s.t)("Visibility")}}};function C(e){return o.createElement(o.Fragment,null,o.createElement(c.DialogTabs,{activeTabId:"visibility",tabs:b,onSelect:l}),o.createElement(d.TouchScrollContainer,null,o.createElement(m.PropertiesEditorTab,{page:e.page,tableKey:"visibility"})))}function v(e){const{propertyPage:t,onSubmit:i,onCancel:n,onClose:s,onApplyDefaults:r}=e;return o.createElement(u.AdaptiveConfirmDialog,{dataName:"sources-properties-editor",title:g,isOpened:!0,onSubmit:i,onCancel:n,onClickOutside:s,onClose:s,footerLeftRenderer:function(){return o.createElement(h.FooterMenu,null,o.createElement(p.TemplateMenuItem,{onClick:r,name:_}))},render:function(){return o.createElement(C,{page:t})},submitOnEnterKey:!1})}const S=new r.TranslatedString("apply factory defaults to selected sources",(0,s.t)("apply factory defaults to selected sources"));class f extends a.DialogRenderer{constructor(e){super(),this._dataSourceChangedPromise=null,this._submitHandler=()=>{Promise.resolve().then(()=>{this._sources.map(e=>{e.areLocalAndServerAlertsMismatch()&&e.synchronizeAlert(!0)})}),this._close()},this._cancelHandler=()=>{this._undoModel.undoToCheckpoint(this._undoCheckpoint)},this._closeHandler=()=>{this._close()},this._applyDefaultsHandler=()=>{this._undoModel.beginUndoMacro(S),this._sources.forEach(e=>{this._undoModel.restorePropertiesForSource(e)}),this._undoModel.endUndoMacro()},this._dataSourceCollectionChangedHandler=()=>{null===this._dataSourceChangedPromise&&(this._dataSourceChangedPromise=Promise.resolve().then(()=>{const e=this._undoModel.model();this._sources.find(t=>null===e.dataSourceForId(t.id()))&&this._close(),this._dataSourceChangedPromise=null}))},this._sources=e.sources,this._propertyPage=e.propertyPage,this._undoModel=e.undoModel,this._undoCheckpoint=this._undoModel.createUndoCheckpoint(),this._undoModel.model().dataSourceCollectionChanged().subscribe(this,this._dataSourceCollectionChangedHandler)}destroy(){this._close()}show(){this._isVisible()||(this._mount(),this._setVisibility(!0))}hide(){this._isVisible()&&(this._unmount(),this._setVisibility(!1))}_mount(){
n.render(o.createElement(v,{propertyPage:this._propertyPage,onSubmit:this._submitHandler,onCancel:this._cancelHandler,onClose:this._closeHandler,onApplyDefaults:this._applyDefaultsHandler}),this._container)}_unmount(){n.unmountComponentAtNode(this._container)}_isVisible(){return this.visible().value()}_close(){this.hide(),this._undoModel.model().dataSourceCollectionChanged().unsubscribe(this,this._dataSourceCollectionChangedHandler)}}}}]);