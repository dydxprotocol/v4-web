(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[4627],{747553:e=>{e.exports={label:"label-oHMFhnC8"}},124685:e=>{e.exports={contextActions:"contextActions-D_fUDt4_",hideIfNoHover:"hideIfNoHover-D_fUDt4_",someContextActionFocused:"someContextActionFocused-D_fUDt4_"}},930170:e=>{e.exports={customPopoverItem:"customPopoverItem-eQTOre3a",clickable:"clickable-eQTOre3a"}},618822:e=>{e.exports={titleLine:"titleLine-LXzo3rzz",title:"title-LXzo3rzz",nestedPopovers:"nestedPopovers-LXzo3rzz",space:"space-LXzo3rzz",icon:"icon-LXzo3rzz"}},394922:e=>{e.exports={container:"container-l6FVmx3S"}},109251:e=>{e.exports={wrapper:"wrapper-j3GOYMat",button:"button-j3GOYMat",buy:"buy-j3GOYMat",sell:"sell-j3GOYMat",profit:"profit-j3GOYMat",loss:"loss-j3GOYMat"}},223717:e=>{e.exports={cancelOrders:"cancelOrders-m2XMeKi6",reversed:"reversed-m2XMeKi6",countedVolume:"countedVolume-m2XMeKi6",cancelButton:"cancelButton-m2XMeKi6"}},445300:e=>{e.exports={hintPlaceholder:"hintPlaceholder-r_FUchCa"}},210293:e=>{e.exports={centeringContainer:"centeringContainer-AQZPvIZ5",volume:"volume-AQZPvIZ5",bid:"bid-AQZPvIZ5",ask:"ask-AQZPvIZ5"}},422808:e=>{e.exports={domControls:"domControls-YIrj9QFH"}},343618:e=>{e.exports={switchModeButton:"switchModeButton-XDRLiDDn",timer:"timer-XDRLiDDn"}},212497:e=>{e.exports={timer:"timer-xnZGqIWx"}},143541:e=>{e.exports={headerWrapper:"headerWrapper-tEyqHGm0",header:"header-tEyqHGm0",details:"details-tEyqHGm0",duration:"duration-tEyqHGm0",arrow:"arrow-tEyqHGm0",upperCase:"upperCase-tEyqHGm0",textBlock:"textBlock-tEyqHGm0",tifValue:"tifValue-tEyqHGm0",summaryLine:"summaryLine-tEyqHGm0"}},902593:e=>{e.exports={widgetcolumnwidthbuysell:"58px",widgetcolumnwidthmiddle:"78px",widgetcolumnwidthorders:"56px",widgetborderwidth:"1px","tv-dom-panel":"tv-dom-panel-WJ5VG8Pz","tv-dom-panel__header":"tv-dom-panel__header-WJ5VG8Pz","tv-dom-panel__header-title":"tv-dom-panel__header-title-WJ5VG8Pz","tv-dom-panel__header-symbol":"tv-dom-panel__header-symbol-WJ5VG8Pz","tv-dom-panel__header-exchange":"tv-dom-panel__header-exchange-WJ5VG8Pz","tv-dom-panel__header-close":"tv-dom-panel__header-close-WJ5VG8Pz","tv-dom-panel__header-warning":"tv-dom-panel__header-warning-WJ5VG8Pz","tv-dom-panel__header-warning--active":"tv-dom-panel__header-warning--active-WJ5VG8Pz","tv-dom-panel__content":"tv-dom-panel__content-WJ5VG8Pz","tv-dom-panel__warning":"tv-dom-panel__warning-WJ5VG8Pz","tv-dom-panel__disabled":"tv-dom-panel__disabled-WJ5VG8Pz","tv-dom-panel__disabled-warning":"tv-dom-panel__disabled-warning-WJ5VG8Pz",mainblock:"mainblock-WJ5VG8Pz",emptyStateImage:"emptyStateImage-WJ5VG8Pz",header:"header-WJ5VG8Pz"}},453429:e=>{e.exports={wrapper:"wrapper-BpNh_MLZ",qty:"qty-BpNh_MLZ",errorsContainer:"errorsContainer-BpNh_MLZ"}},627601:e=>{e.exports={upperBlock:"upperBlock-pOOE9kBn",bottomBlock:"bottomBlock-pOOE9kBn"}},620268:e=>{e.exports={widgetcolumnwidthbuysell:"58px",widgetcolumnwidthmiddle:"78px",widgetcolumnwidthorders:"56px",widgetordertypeheight:"10px",widgetborderwidth:"1px",widgetrowheight:"20px",
"tv-dom-widget-main":"tv-dom-widget-main-S1ZrBpKB","tv-dom-widget-main__anchor":"tv-dom-widget-main__anchor-S1ZrBpKB","tv-dom-widget-main__row":"tv-dom-widget-main__row-S1ZrBpKB","tv-dom-widget-main__value":"tv-dom-widget-main__value-S1ZrBpKB","tv-dom-widget-main__value--price":"tv-dom-widget-main__value--price-S1ZrBpKB","tv-dom-widget-main__value--highlighted":"tv-dom-widget-main__value--highlighted-S1ZrBpKB","tv-dom-widget-main__value--long-position":"tv-dom-widget-main__value--long-position-S1ZrBpKB","tv-dom-widget-main__value--short-position":"tv-dom-widget-main__value--short-position-S1ZrBpKB","tv-dom-widget-main__value--buy":"tv-dom-widget-main__value--buy-S1ZrBpKB","tv-dom-widget-main__value--sell":"tv-dom-widget-main__value--sell-S1ZrBpKB","tv-dom-widget-main__value--orders-buy":"tv-dom-widget-main__value--orders-buy-S1ZrBpKB","tv-dom-widget-main__value--orders-sell":"tv-dom-widget-main__value--orders-sell-S1ZrBpKB","tv-dom-widget-main__value--color-bid":"tv-dom-widget-main__value--color-bid-S1ZrBpKB","tv-dom-widget-main__value--color-ask":"tv-dom-widget-main__value--color-ask-S1ZrBpKB","tv-dom-widget-main__label":"tv-dom-widget-main__label-S1ZrBpKB","tv-dom-widget-main__label--active":"tv-dom-widget-main__label--active-S1ZrBpKB","tv-dom-widget-main__meter":"tv-dom-widget-main__meter-S1ZrBpKB","tv-dom-widget-main__meter--buy":"tv-dom-widget-main__meter--buy-S1ZrBpKB","tv-dom-widget-main__meter--buy-active":"tv-dom-widget-main__meter--buy-active-S1ZrBpKB","tv-dom-widget-main__meter--sell":"tv-dom-widget-main__meter--sell-S1ZrBpKB","tv-dom-widget-main__meter--sell-active":"tv-dom-widget-main__meter--sell-active-S1ZrBpKB","tv-dom-widget-main__value-readout":"tv-dom-widget-main__value-readout-S1ZrBpKB","tv-dom-widget-main__offscreen-arrow":"tv-dom-widget-main__offscreen-arrow-S1ZrBpKB","tv-dom-widget-main__offscreen-arrow--higher":"tv-dom-widget-main__offscreen-arrow--higher-S1ZrBpKB","tv-dom-widget-main__offscreen-arrow--lower":"tv-dom-widget-main__offscreen-arrow--lower-S1ZrBpKB","tv-dom-widget-main__order":"tv-dom-widget-main__order-S1ZrBpKB","tv-dom-widget-main__order--collapsed":"tv-dom-widget-main__order--collapsed-S1ZrBpKB","tv-dom-widget-main__drag-shield":"tv-dom-widget-main__drag-shield-S1ZrBpKB","tv-dom-widget-main__drag-shield--order":"tv-dom-widget-main__drag-shield--order-S1ZrBpKB","tv-dom-widget-main__hidden":"tv-dom-widget-main__hidden-S1ZrBpKB"}},36327:e=>{e.exports={widgetordertypeheight:"10px",widgetrowheight:"20px",widgetborderwidth:"1px",widgetyellow:"#ffc84a","tv-dom-widget-order":"tv-dom-widget-order-YzgGdJzq","tv-dom-widget-order--ghost":"tv-dom-widget-order--ghost-YzgGdJzq","tv-dom-widget-order--inactive":"tv-dom-widget-order--inactive-YzgGdJzq","tv-dom-widget-order--type-stop":"tv-dom-widget-order--type-stop-YzgGdJzq","tv-dom-widget-order__close":"tv-dom-widget-order__close-YzgGdJzq","tv-dom-widget-order--type-stoplimit":"tv-dom-widget-order--type-stoplimit-YzgGdJzq","tv-dom-widget-order--highlighted":"tv-dom-widget-order--highlighted-YzgGdJzq",
"tv-dom-widget-order--buy":"tv-dom-widget-order--buy-YzgGdJzq","tv-dom-widget-order--notcanceled":"tv-dom-widget-order--notcanceled-YzgGdJzq","tv-dom-widget-order__qty":"tv-dom-widget-order__qty-YzgGdJzq","tv-dom-widget-order--immovable":"tv-dom-widget-order--immovable-YzgGdJzq","tv-dom-widget-order--unmodified":"tv-dom-widget-order--unmodified-YzgGdJzq","tv-dom-widget-order__type":"tv-dom-widget-order__type-YzgGdJzq"}},801023:e=>{e.exports={hotKeyTitle:"hotKeyTitle-C608a1Xd"}},342724:e=>{e.exports={wrapper:"wrapper-btWtGFgr",marketBlock:"marketBlock-btWtGFgr",tradingActionBlock:"tradingActionBlock-btWtGFgr",container:"container-btWtGFgr",row:"row-btWtGFgr",button:"button-btWtGFgr"}},927186:e=>{e.exports={wrapper:"wrapper-RoaZjf69",title:"title-RoaZjf69"}},25596:e=>{e.exports={dateTimeWrapper:"dateTimeWrapper-Dg2Jb5Mv",containerDatePicker:"containerDatePicker-Dg2Jb5Mv",dateInputContainer:"dateInputContainer-Dg2Jb5Mv",dateInput:"dateInput-Dg2Jb5Mv",dateInputIcon:"dateInputIcon-Dg2Jb5Mv"}},583221:e=>{e.exports={hiddenLabel:"hiddenLabel-XFowpoet"}},421978:e=>{e.exports={informer:"informer-iBPUmjfh"}},375390:e=>{e.exports={wrapper:"wrapper-eYAfVbpw"}},698110:e=>{e.exports={container:"container-yrIMi47q",title:"title-yrIMi47q",title_normal:"title_normal-yrIMi47q",icon:"icon-yrIMi47q",text:"text-yrIMi47q",text_large:"text_large-yrIMi47q",action:"action-yrIMi47q"}},463039:(e,t,i)=>{"use strict";i.d(t,{Label:()=>l});var s=i(50959),r=i(497754),n=i.n(r),o=i(102691),a=i(747553);function l(e){const{htmlFor:t,children:i,className:r,id:l,...d}=e;return s.createElement(o.BeforeSlot,{...d,className:n()(a.label,r)},s.createElement("label",{id:l,htmlFor:t},i))}},646538:(e,t,i)=>{"use strict";i.d(t,{useHorizontalMenuKeyboardNavigation:()=>_});var s=i(241032),r=i(393728),n=i(923058),o=i(865081),a=i(930202),l=i(745845),d=i(32556),c=i(314485);function u(e,t={}){const{focusNext:i,focusPrev:s,focusFirst:r,focusLast:n}=(0,o.getSelectorKeyboardNavigation)(e,t.allowNestedFocusable),u={...t.horizontal?{39:i,37:s}:{40:i,38:s},...t.handleHomeEnd?{36:r,35:n}:{}};return{onFocus:function(i){const s=i.currentTarget;i.target===s&&function(i){const s=(0,l.getSelectorTreeWalker)(i,e).nextNode();s&&(0,d.isHTMLOrSVGElement)(s)&&s!==i&&s.focus(t.focusOptions)}(s)},onKeyDown:function(e){const i=(0,c.flipArrowsOnRtl)((0,a.hashFromEvent)(e),t.isRtl),s=e.currentTarget,r=e.target;if(!(r instanceof Node))return;if(!s.contains(r))return;const n=u[i];if(n){e.preventDefault();const i=n?.(s,t.focusOptions);i&&e.stopPropagation()}}}}const h=`[${s.DATA_IS_CONTEXT_ACTION}]`,m=n.CONTEXT_ACTION_FOCUSABLE_TAGS.map((e=>`${h} ${e}`)).join(","),_=()=>{const{isRtl:e}=(0,r.usePopoverContext)();return u(m+`,[${s.DATA_IS_POPOVER_ITEM_BUTTON}]`,{horizontal:!0,isRtl:e,allowNestedFocusable:!0})}},923058:(e,t,i)=>{"use strict";i.d(t,{CONTEXT_ACTION_FOCUSABLE_TAGS:()=>c,ContextAction:()=>h});var s=i(50959),r=i(497754),n=i.n(r),o=i(344346),a=i(241032),l=i(124685);const d={[a.DATA_IS_CONTEXT_ACTION]:!0},c=["a","button","input",'[aria-role="button"]'],u=c.join(",");function h(e){
const{children:t}=e,{id:i,hideContextActionsIfNoHover:r,focusedContextActionsCounter:a,setFocusedContextActionsCounter:c}=(0,o.useContextAction)(),h=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=h.current;if(!e)return;const t=e.querySelector(u);return t?function(e,t){const i=()=>{t((e=>e+1))},s=()=>{t((e=>e-1))};return e.addEventListener("focus",i),e.addEventListener("blur",s),()=>{e.removeEventListener("focus",i),e.removeEventListener("blur",s)}}(t,c):void 0}),[t,c]),s.createElement("span",{...d,id:i,ref:h,onClick:e=>{e.stopPropagation()},className:n()(l.contextActions,r&&l.hideIfNoHover,a>0&&l.someContextActionFocused)},t)}},344346:(e,t,i)=>{"use strict";i.d(t,{useContextAction:()=>o,useWrappedIntoContextActionsContext:()=>n});var s=i(50959);const r=(0,s.createContext)({setIds:()=>{},hideContextActionsIfNoHover:!1,focusedContextActionsCounter:0,setFocusedContextActionsCounter:()=>{}});function n(e,t,i){const[n,o]=(0,s.useState)(0),a=(0,s.useMemo)((()=>({focusedContextActionsCounter:n,setFocusedContextActionsCounter:o,setIds:t,hideContextActionsIfNoHover:!!i})),[n,o,t,i]);return(0,s.useMemo)((()=>e?s.createElement(r.Provider,{value:a},e):void 0),[e,a])}function o(){const{setIds:e,hideContextActionsIfNoHover:t,focusedContextActionsCounter:i,setFocusedContextActionsCounter:n}=(0,s.useContext)(r),o=(0,s.useId)();return(0,s.useEffect)((()=>(e((e=>[...e,o])),()=>{e((e=>e.filter((e=>e!==o))))})),[e,o]),{id:o,hideContextActionsIfNoHover:t,focusedContextActionsCounter:i,setFocusedContextActionsCounter:n}}},126338:(e,t,i)=>{"use strict";i.d(t,{ContextActionsSlot:()=>r});var s=i(50959);function r(e){const{id:t,ariaLabelledby:i,ariaOwns:r}=e;return s.createElement("div",{id:t,role:"menu","aria-labelledby":i,"aria-orientation":"horizontal","aria-owns":r.join(" "),"aria-hidden":0===r.length})}},810410:(e,t,i)=>{"use strict";i.d(t,{CustomPopoverItem:()=>l});var s=i(50959),r=i(497754),n=i.n(r),o=i(241032),a=i(930170);const l=(0,s.forwardRef)(((e,t)=>{const{id:i,children:r,onClick:l,disabled:d,focusable:c,role:u,ariaLabel:h,...m}=e,_=m,p=l?"button":"div",g=c||l,v=d?void 0:l;return s.createElement(p,{id:i,className:n()(a.customPopoverItem,v&&a.clickable),onClick:v,"aria-disabled":d,"aria-label":h,role:u,tabIndex:g?0:void 0,ref:t,..._,[o.DATA_IS_POPOVER_ITEM_BUTTON]:!!g||void 0},s.createElement("div",{inert:d?"true":void 0},r))}))},167554:(e,t,i)=>{"use strict";i.d(t,{SectionPopoverItem:()=>u});var s=i(50959),r=i(497754),n=i.n(r),o=i(878112),a=i(902129),l=i(347531),d=i(368182),c=i(618822);function u(e){const{id:t,title:i,children:r,itemRole:u,wrappable:h,defaultWrapped:m,ariaLabel:_,rightSlot:p,rightSlotAriaLabelledby:g,...v}=e,b=v,[y,w]=(0,s.useState)(m??!1),f=(0,s.useId)(),S=(0,s.useId)();return s.createElement(s.Fragment,null,s.createElement(a.TitleSectionPopoverItem,{...b,id:t,role:u,onClick:h?()=>w((e=>!e)):void 0,rightSlot:p,rightSlotAriaLabelledby:g,focusable:h,ariaExpanded:h?!y:void 0,ariaControls:h?S:void 0,ariaLabel:_,className:c.titleLine},s.createElement("div",{className:c.title,id:f
},i),h&&s.createElement(s.Fragment,null,s.createElement("div",{className:c.space}),s.createElement(o.Icon,{className:c.icon,icon:y?l:d}))),s.createElement("div",{role:"group","aria-labelledby":f,id:S,className:n()(y&&c.wrapped)},!y&&r))}},902129:(e,t,i)=>{"use strict";i.d(t,{TitleSectionPopoverItem:()=>l});var s=i(50959),r=i(646538),n=i(344346),o=i(810410),a=i(126338);function l(e){const{id:t,role:i,onClick:l,rightSlot:d,rightSlotAriaLabelledby:c,focusable:u,ariaExpanded:h,ariaControls:m,ariaHaspopup:_,ariaLabel:p,children:g,className:v,...b}=e,y=b,{onKeyDown:w}=(0,r.useHorizontalMenuKeyboardNavigation)(),[f,S]=(0,s.useState)([]),x=(0,n.useWrappedIntoContextActionsContext)(d,S),I=(0,s.useId)();return s.createElement("div",{onKeyDown:w},s.createElement(o.CustomPopoverItem,{id:t,role:i,onClick:l,focusable:u||!!d,"aria-expanded":h??(!!d||void 0),"aria-controls":m??(d?I:void 0),"aria-haspopup":d?"menu":void 0,"aria-label":p,...y},s.createElement("div",{className:v},g,x)),s.createElement(a.ContextActionsSlot,{id:I,ariaLabelledby:c,ariaOwns:f}))}},314485:(e,t,i)=>{"use strict";function s(e,t){if(!t)return e;const i=255&e,s=-256&e;return 37===i?39+s:39===i?37+s:e}i.d(t,{flipArrowsOnRtl:()=>s})},928141:(e,t,i)=>{"use strict";function s(e,t){const i={};for(const r of Object.entries(t))i["camelCase"===e?"aria"+(s=r[0],""===s?"":s[0].toUpperCase()+s.substring(1)):"aria-"+r[0]]=r[1];var s;return i}i.d(t,{createAriaAttributesProps:()=>s})},937901:(e,t,i)=>{"use strict";function s(e,t){return{[e]:t}}i.d(t,{createRefProp:()=>s})},179050:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DOMPanel:()=>at});var s,r,n=i(609838),o=i(632227),a=i(50959),l=i(662941),d=i(240534),c=i(650151),u=i(870122),h=i(180185),m=i(960521),_=i.n(m),p=i(947488),g=i(997345),v=i(391431),b=i(181436),y=i(822960),w=i(148296),f=i(172912),S=i(459895),x=i(416637),I=i(621327),k=i(529596),P=i(14654);!function(e){e[e.Inside=0]="Inside",e[e.Lower=1]="Lower",e[e.Higher=2]="Higher"}(s||(s={})),function(e){e[e.Up=1]="Up",e[e.Down=2]="Down"}(r||(r={}));var T=i(737538),O=i(563223),C=i(799573),E=i(36327),M=i(620268);const D={limitOrder:n.t(null,void 0,i(790258)),stopOrder:n.t(null,void 0,i(898251))};class B{constructor(e){this._pool=[],this._handlers=e||{},this._ordersPool=new V(this._handlers),this._useCssTransform="transform"in document.createElement("span").style}allocate(){return this._pool.pop()||new L(this._ordersPool,this._handlers,this._useCssTransform)}free(e){e.destroy(),this._pool.push(e)}}class L{constructor(e,t,i){this._isStopOrderModeEnabled=!1,this._price=0,this._useCssTransform=i,this._ordersPool=e,this._handlers=t,this._allocatedOrderViews=[];const s=document.createElement("div");s.setAttribute("class",M["tv-dom-widget-main__row"]);const r=document.createElement("span");r.setAttribute("class",`${M["tv-dom-widget-main__value"]} ${M["tv-dom-widget-main__value--price"]}`);const n=document.createElement("span");n.setAttribute("class",`${M["tv-dom-widget-main__value"]} ${M["tv-dom-widget-main__value--sell"]}`);const o=document.createElement("span")
;o.setAttribute("class",`${M["tv-dom-widget-main__value"]} ${M["tv-dom-widget-main__value--buy"]}`);const a=document.createElement("span");a.setAttribute("class",`${M["tv-dom-widget-main__meter"]} ${M["tv-dom-widget-main__meter--sell"]}`);const l=document.createElement("span");l.setAttribute("class",`${M["tv-dom-widget-main__meter"]} ${M["tv-dom-widget-main__meter--buy"]}`);const d=document.createElement("span");d.setAttribute("class",M["tv-dom-widget-main__value-readout"]);const c=document.createElement("span");c.setAttribute("class",M["tv-dom-widget-main__value-readout"]);const u=document.createTextNode(""),h=document.createTextNode(""),m=document.createTextNode("");this._useCssTransform&&(a.style.width=l.style.width="100%",a.style.transform=l.style.transform="scale(0, 1)");const _=document.createElement("span");_.setAttribute("class",`${M["tv-dom-widget-main__value"]} ${M["tv-dom-widget-main__value--orders-buy"]}`);const p=document.createElement("span");p.textContent=D.limitOrder,p.setAttribute("class",M["tv-dom-widget-main__label"]),_.appendChild(p);const g=document.createElement("span");g.setAttribute("class",`${M["tv-dom-widget-main__value"]} ${M["tv-dom-widget-main__value--orders-sell"]}`);const v=document.createElement("span");v.textContent=D.limitOrder,v.setAttribute("class",M["tv-dom-widget-main__label"]),g.appendChild(v),s.appendChild(n),s.appendChild(o),s.appendChild(r),s.appendChild(_),s.appendChild(g),r.appendChild(m),n.appendChild(a),o.appendChild(l),n.appendChild(d),o.appendChild(c),d.appendChild(u),c.appendChild(h),this._priceCell=r,this._priceText=m,this._askText=u,this._bidText=h,this._askMeter=a,this._bidMeter=l,this._ordersBuy=_,this._ordersSell=g,this._orderBuyLabel=p,this._orderSellLabel=v,this._isHigherThanBestBid=!1,this._isLowerThanBestAsk=!1,this._orderType=1,t&&t.bidAskClick&&(n.addEventListener("click",(e=>this._handlerCellClick(-1,e)),!1),o.addEventListener("click",(e=>this._handlerCellClick(1,e)),!1)),t&&t.bidAskContextMenu&&(n.addEventListener("contextmenu",(e=>{t.bidAskContextMenu.call(null,e,{price:this._price,side:-1})}),!1),o.addEventListener("contextmenu",(e=>{t.bidAskContextMenu.call(null,e,{price:this._price,side:1})}),!1)),n.addEventListener(C.mobiletouch?"touchstart":"mouseover",(e=>{v.textContent=this._isStopOrderModeEnabled?D.stopOrder:D.limitOrder,v.style.visibility="visible"}),!1),n.addEventListener(C.mobiletouch?"touchend":"mouseout",(()=>{v.style.visibility="hidden"}),!1),o.addEventListener(C.mobiletouch?"touchstart":"mouseover",(e=>{p.textContent=this._isStopOrderModeEnabled?D.stopOrder:D.limitOrder,p.style.visibility="visible"}),!1),o.addEventListener(C.mobiletouch?"touchend":"mouseout",(()=>{p.style.visibility="hidden"}),!1),this.element=s}updatePriceText(e){this._priceText.nodeValue=e}updateBidVolume(e){this._bidText.nodeValue!==e&&(this._bidText.nodeValue=e)}updateAskVolume(e){this._askText.nodeValue!==e&&(this._askText.nodeValue=e)}updateBidMeter(e){const t=Math.min(Math.max(e,0),1)||0
;this._useCssTransform?this._bidMeter.style.transform=`scale(${t}, 1)`:this._bidMeter.style.width=100*t+"%"}updateAskMeter(e){const t=Math.min(Math.max(e,0),1)||0;this._useCssTransform?this._askMeter.style.transform=`scale(${t}, 1)`:this._askMeter.style.width=100*t+"%"}updatePriceHighlight(e,t){const i=this._priceCell.classList;if(i)i.toggle(M["tv-dom-widget-main__value--highlighted"],e),i.toggle(M["tv-dom-widget-main__value--long-position"],t>0),i.toggle(M["tv-dom-widget-main__value--short-position"],t<0);else{let i=`${M["tv-dom-widget-main__value"]} ${M["tv-dom-widget-main__value--price"]}`;e&&(i+=` ${M["tv-dom-widget-main__value--highlighted"]}`),t>0?i+=` ${M["tv-dom-widget-main__value--long-position"]}`:t<0&&(i+=` ${M["tv-dom-widget-main__value--short-position"]}`),this._priceCell.setAttribute("class",i)}}setHigherThanBid(e){this._isHigherThanBestBid=e,this._updateLabelColor(this._orderBuyLabel,this._isActive(e))}updateAskLabels(e){this._isLowerThanBestAsk=e,this._updateLabelColor(this._orderSellLabel,this._isActive(e))}setStopOrderMode(e){this._isStopOrderModeEnabled=e,this._orderType=e?3:1,this._orderSellLabel.textContent=e?D.stopOrder:D.limitOrder,this._orderBuyLabel.textContent=e?D.stopOrder:D.limitOrder,this._updateLabelColor(this._orderBuyLabel,this._isActive(this._isHigherThanBestBid)),this._updateLabelColor(this._orderSellLabel,this._isActive(this._isLowerThanBestAsk))}updatePrice(e){this._price=e}updateOrders(e){for(;this._allocatedOrderViews.length>e.length;){const e=this._allocatedOrderViews.pop();e&&this._ordersPool.free(e)}for(;this._allocatedOrderViews.length<e.length;)this._allocatedOrderViews.push(this._ordersPool.allocate());const t={};for(let i=0;i<e.length;i++){const s=e[i],r=this._allocatedOrderViews[i],n=Boolean(s.buy),o=n?1:-1;t[o]?.collapse(),t[o]=s.noCollapse?void 0:r,s.order!==r.order()&&(r.updateOrderData(s.order,s.pricePropertyName),r.updateQty(s.qty),r.updateTypeText(s.typeText),n?this._ordersBuy.prepend(r.element):this._ordersSell.append(r.element)),r.updateClassName({isBuy:n,type:s.type,inactive:s.inactive,ghost:s.ghost,highlighted:s.highlighted,isModifiable:s.isModifiable,isMovable:s.isMovable,isCancellable:s.isCancellable})}}destroy(){const e=this._allocatedOrderViews.length;if(e>0){for(let t=0;t<e;t++)this._ordersPool.free(this._allocatedOrderViews[t]);this._allocatedOrderViews.length=0}}paintPrice(e){const t=this.element.classList;t.toggle(M["tv-dom-widget-main__value--color-ask"],"ask"===e),t.toggle(M["tv-dom-widget-main__value--color-bid"],"bid"===e)}_handlerCellClick(e,t){const i=(0,h.modifiersFromEvent)(t);if(![h.Modifiers.None,h.Modifiers.Mod].includes(i))return;const s=1===e?this._bidMeter:this._askMeter,r=1===e?"buy":"sell";clearTimeout(this._activeStateTimerId),s.classList.add(`${M[`tv-dom-widget-main__meter--${r}-active`]}`),this._activeStateTimerId=setTimeout((()=>{s.classList.remove(`${M[`tv-dom-widget-main__meter--${r}-active`]}`)}),500),this._handlers.bidAskClick.call(null,t,{price:this._price,side:e,type:i===h.Modifiers.Mod?3:1})}_updateLabelColor(e,t){
const i=e.classList;if(i)i.toggle(M["tv-dom-widget-main__label--active"],t);else{let i=M["tv-dom-widget-main__label"];t&&(i+=` ${M["tv-dom-widget-main__label--active"]}`),e.setAttribute("class",i)}}_isActive(e){const t=3===this._orderType;return t&&!e||!t&&e}}class V{constructor(e){this._pool=[],this._handlers=e}allocate(){return this._pool.pop()||new N(this._handlers)}free(e){e.destroy(),this._pool.push(e)}}class N{constructor(e){this._order=null,this._pricePropertyName=null;const t=document.createElement("div");t.setAttribute("class",`${M["tv-dom-widget-main__order"]} ${E["tv-dom-widget-order"]}`);const s=document.createElement("div");s.innerHTML=i(548927),s.setAttribute("class",E["tv-dom-widget-order__close"]);const r=document.createElement("span");r.setAttribute("class",E["tv-dom-widget-order__qty"]);const n=document.createTextNode(""),o=document.createElement("span");o.setAttribute("class",E["tv-dom-widget-order__type"]);const a=document.createTextNode("");t.appendChild(s),t.appendChild(r),r.appendChild(n),t.appendChild(o),o.appendChild(a),e&&e.closeButtonClick&&s.addEventListener("click",(t=>{e.closeButtonClick.call(null,t,this._order)}),!1),e&&e.qtyClick&&r.addEventListener("click",(t=>{e.qtyClick.call(null,t,this._order)}),!1),e&&e.orderMousedown&&r.addEventListener("mousedown",(t=>{null!==this._order&&null!==this._pricePropertyName&&e.orderMousedown.call(null,t,{order:this._order,pricePropertyName:this._pricePropertyName})}),!1),this.element=t,this._qtyText=n,this._typeText=a}order(){return this._order}updateQty(e){this._qtyText.nodeValue=e||""}updateTypeText(e){this._typeText.nodeValue=e||""}updateClassName(e){const{isBuy:t,type:i,inactive:s,ghost:r,highlighted:n,isModifiable:o,isMovable:a,isCancellable:l}=e,d=this.element;d.className=`${M["tv-dom-widget-main__order"]} ${E["tv-dom-widget-order"]}`,d.classList.toggle(E["tv-dom-widget-order--buy"],!!t),d.classList.toggle(E[`tv-dom-widget-order--type-${i}`],!!i),d.classList.toggle(E["tv-dom-widget-order--inactive"],!!s),d.classList.toggle(E["tv-dom-widget-order--ghost"],!!r),d.classList.toggle(E["tv-dom-widget-order--highlighted"],!!n),d.classList.toggle(E["tv-dom-widget-order--unmodified"],!1===o),d.classList.toggle(E["tv-dom-widget-order--immovable"],!1===a),d.classList.toggle(E["tv-dom-widget-order--notcanceled"],!1===l)}collapse(){this.element.classList.add(M["tv-dom-widget-main__order--collapsed"])}updateOrderData(e,t){this._order=e,this._pricePropertyName=t}destroy(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this._order=null}}function A(e,t){const i=[];if(0===e.length||0===t.length)return[...e,...t];let s=0,r=0;for(;s<=e.length&&r<=t.length;){const n=e[s],o=t[r];n>=o?(s++,i.push(n)):(r++,i.push(o))}return s===e.length&&i.push(...t.slice(r+1)),r===t.length&&i.push(...e.slice(s+1)),i}function F(e,t){let i=0;for(const s of e){const e=s.filter(isFinite);if(0===e.length)continue;const r=e[0]-(t-i);if(r<0)return t-i;if(r<e.length)return e[r];const n=e.length-1;i+=e[0]-e[n]-n}return t-i}function q(e,t){return t-e}
function H(e,t,i,s){return t===s[i-1]||e.push(Number(t)),e}class ${constructor(e,t,i){this._container=null,this._listContainer=null,this._dragShield=null,this._viewsList=[],this._bids={},this._asks={},this._indexes=[],this._repaintScheduled=!1,this._currentVolumeMax=0,this._orders={},this._positionIndex=NaN,this._positionQty=0,this._orderGhost=null,this._totalVolumeBid=0,this._totalVolumeAsk=0,this._buyOrdersValue=0,this._sellOrdersValue=0,this._buyOrdersValueInactive=0,this._sellOrdersValueInactive=0,this._buyOrdersQuantity=0,this._sellOrdersQuantity=0,this._offscreenIndexLocation$=new T.Subject,this._cellIndexesInAskZone=[],this._cellIndexesInBidZone=[],this._bestAskIndex=Number.POSITIVE_INFINITY,this._bestBidIndex=Number.NEGATIVE_INFINITY,this._worstBidIndex=Number.POSITIVE_INFINITY,this._worstAskIndex=Number.NEGATIVE_INFINITY,this._isPositionAlreadyUpdated=!1,this._handlers=e||{},this._realtimeProvider=i,this._showPricesWith=t,this.autoCenterRequired=new d.WatchedValue(!1),this.height=0,this.topIndex=NaN,this._symbolData=null,this.indexToPrice=()=>NaN,this.priceToIndex=()=>NaN,this._lastPriceIndex=NaN,this._viewAllocated=new Map,this._viewPool=null,this._invalidatedAsk={},this._invalidatedBid={},this._invalidatedPriceHighlight={},this._invalidatedOrders={},this._dynamicModeState=!1,this._numericFormatter=new O.NumericFormatter,this._showPricesWith.zeroVolume.subscribe(this.centerOnLast.bind(this)),this._showPricesWith.spread.subscribe(this.centerOnLast.bind(this)),this.reset()}reset(){this.topIndex=NaN,this._symbolData=null,this.indexToPrice=()=>NaN,this.priceToIndex=()=>NaN,this._lastPriceIndex=NaN,this.resetData(),this.resetView(),this.resetOrders(),this.resetOrderGhost(),this.resetPosition(),this.autoCenterRequired.setValue(!1)}resetData(){if(this._bids={},this._asks={},this._totalVolumeBid=0,this._totalVolumeAsk=0,this._recalcMaxVolume(),this._recalcBestWorstBid(),this._recalcBestWorstAsk(),this._viewAllocated)for(const[e]of this._viewAllocated)this._invalidatedAsk[e]=!0,this._invalidatedBid[e]=!0;this._offscreenIndexLocation$.next(s.Inside),this.scheduleRepaint()}resetOrders(){if(this._orders)for(const e in this._orders)this._orders.hasOwnProperty(e)&&(this._invalidatedOrders[e]=!0);this._orders={},this._buyOrdersValue=0,this._sellOrdersValue=0,this._buyOrdersValueInactive=0,this._sellOrdersValueInactive=0,this._buyOrdersQuantity=0,this._sellOrdersQuantity=0,this.scheduleRepaint()}resetPosition(){this._invalidatedPriceHighlight[this._positionIndex]=!0,this._positionIndex=NaN,this._positionQty=0,this.scheduleRepaint()}resetView(){if(this._viewAllocated&&this._viewPool)for(const[e]of this._viewAllocated){const t=this._viewAllocated.get(e);t&&(t.element.remove(),this._viewPool.free(t),this._viewAllocated.delete(e))}this._listContainer&&(this._viewsList.length=0,this._listContainer.innerHTML=""),this.setDragShield(!1,!1),this.scheduleRepaint()}setSymbolInfo(e){this._symbolData={...e},this.indexToPrice=(0,P.makePriceIndexToPriceConverter)(e.minTick,e.variableMinTickData),this.priceToIndex=(0,
P.makePriceToPriceIndexConverter)(e.minTick,e.variableMinTickData),this._isPositionAlreadyUpdated=!1}setContainer(e){if(this._container===e)return;this._container&&(this.resetView(),this._container.innerHTML=""),this._container=e,this._viewPool=new B(this._handlers),this._viewAllocated=new Map;const t=this._listContainer=document.createElement("div");t.className=M["tv-dom-widget-main__anchor"],e.append(t);const i=this._dragShield=document.createElement("div");i.className=`${M["tv-dom-widget-main__drag-shield"]} js-hidden`,e.append(i),this._repaintScheduled=!1,this.scheduleRepaint()}setHeight(e){e!==this.height&&(this.height=e,0!==e&&(this.centerOnLast(),this._isPositionAlreadyUpdated=!1),this.checkAutoCenter(),this.scheduleRepaint())}shiftTopIndexRelativeToIndex(e,t){this._setTopIndex(e+t)}setStopOrderMode(e){let t=this.topIndex;this._canIndexBeDisplayed(t)||(t=this.correctIndex(t,-1));const i=this.correctIndex(t,1-this.height);if(!isFinite(i))return;const s=this._viewAllocated;for(const[,t]of s)t&&t.setStopOrderMode(e)}correctIndex(e,t=0){const i=e+t;if(!this._hasQuotes())return i;const s=this._showPricesWith.zeroVolume.value(),r=this._showPricesWith.spread.value();return s&&r?i:s&&!r?F([[this._bestAskIndex,this._bestBidIndex]],i):!s&&r?F([this._cellIndexesInAskZone,this._cellIndexesInBidZone],i):s||r?i:F([(new Array).concat(this._cellIndexesInAskZone,this._cellIndexesInBidZone)],i)}centerOnLast(){this.autoCenterRequired.setValue(!1);const e=this._autoCenterTargetTopIndex();isFinite(e)&&this._setTopIndex(e)}guessOrderType(e,t){const i=this.priceToIndex(e);if(!isFinite(e))return null;if(1!==t&&-1!==t)return null;let s=this._bestAskIndex,r=this._bestBidIndex;return isFinite(s)||(s=r+1),isFinite(r)||(r=s-1),isFinite(s)||isFinite(r)||(s=r=this._lastPriceIndex),1===t?i&&i<s?1:3:i&&i>r?1:3}updateData(e){this._indexes.forEach((e=>{isFinite(this._asks[e])||delete this._asks[e],isFinite(this._bids[e])||delete this._bids[e]}));let t=!1;e.snapshot&&(t=this._hasStaticDOMRequiredData()&&!this._isPositionAlreadyUpdated,this.resetData());let i=!1;if(e.bids)for(let t=0;t<e.bids.length;t++){const s=(0,c.ensureDefined)(e.bids[t]),r=this.priceToIndex(s.price),n=s.volume,o=this._bids[r]||null;o!==n&&(i=!0,n>0?(this._totalVolumeBid+=n-Number(o),this._bids[r]=n):(this._totalVolumeBid-=Number(o),delete this._bids[r]),this._invalidatedBid[r]=!0)}if(e.asks)for(let t=0;t<e.asks.length;t++){const s=(0,c.ensureDefined)(e.asks[t]),r=this.priceToIndex(s.price),n=s.volume,o=this._asks[r]||null;o!==n&&(i=!0,n>0?(this._totalVolumeAsk+=n-Number(o),this._asks[r]=n):(this._totalVolumeAsk-=Number(o),delete this._asks[r]),this._invalidatedAsk[r]=!0)}if(this._collectIndexes(),!this._hasDataInDOM()){if(i=!0,0!==e.bids.length){const t=this.priceToIndex(e.bids[0].price);this._bids[t]=Number.POSITIVE_INFINITY}if(0!==e.asks.length){const t=this.priceToIndex(e.asks[0].price);this._asks[t]=Number.POSITIVE_INFINITY}this._collectIndexes()}i&&this._recalcDepthInfo(),this._recalcMaxVolume(),t?(this.centerOnLast(),
this._isPositionAlreadyUpdated=!0):this.checkAutoCenter(),this._dynamicModeState&&this.centerOnLast(),this.scheduleRepaint()}totalVolumeBid(){return this._totalVolumeBid}totalVolumeAsk(){return this._totalVolumeAsk}buyOrdersValue(){return this._buyOrdersValue}sellOrdersValue(){return this._sellOrdersValue}buyInactiveOrdersValue(){return this._buyOrdersValueInactive}sellInactiveOrdersValue(){return this._sellOrdersValueInactive}buyOrdersQuantity(){return this._numericFormatter.format(this._buyOrdersQuantity)}sellOrdersQuantity(){return this._numericFormatter.format(this._sellOrdersQuantity)}updateOrders(e){this.resetOrders();for(let t=0;t<e.length;t++){const i=e[t],s=6===i.status;if(1===i.side?(this._buyOrdersValue+=Number(s),this._buyOrdersValueInactive+=Number(!s),this._buyOrdersQuantity=s?new(_())(this._buyOrdersQuantity).plus(i.qty).toNumber():0):(this._sellOrdersValue+=Number(s),this._sellOrdersValueInactive+=Number(!s),this._sellOrdersQuantity=s?new(_())(this._sellOrdersQuantity).plus(i.qty).toNumber():0),i.stopPrice){const e=this.priceToIndex(i.stopPrice);this._orders[e]||(this._orders[e]=[]),this._orders[e].push({order:i,pricePropertyName:"stopPrice"}),this._invalidatedOrders[e]=!0}if(void 0!==i.limitPrice){const e=this.priceToIndex(i.limitPrice);this._orders[e]||(this._orders[e]=[]),this._orders[e].push({order:i,pricePropertyName:"limitPrice"}),this._invalidatedOrders[e]=!0}}this._recalcDepthInfo(),this.scheduleRepaint()}updateLast(e){const t=this.priceToIndex(e);t!==this._lastPriceIndex&&(this._invalidatedPriceHighlight[this._lastPriceIndex]=!0,this._invalidatedPriceHighlight[t]=!0,this._lastPriceIndex=t,this.checkAutoCenter(),this.scheduleRepaint())}updatePosition(e){if(void 0===e||0===e.qty)return void this.resetPosition();const t=this.priceToIndex(e.avgPrice),i=Math.abs(e.qty)*(1===e.side?1:-1);this._positionIndex===t&&this._positionQty===i||(this._invalidatedPriceHighlight[this._positionIndex]=!0,this._invalidatedPriceHighlight[t]=!0,this._positionIndex=t,this._positionQty=i,this.scheduleRepaint())}resetOrderGhost(){this._orderGhost&&(this._invalidatedOrders[this._orderGhost.index]=!0,this._invalidatedOrders[this._orderGhost.originIndex]=!0,this._orderGhost=null,this.scheduleRepaint())}setOrderGhost(e){const{order:t,pricePropertyName:i,price:s}=e;this.resetOrderGhost();const r=this.priceToIndex(s);isFinite(r)&&(this._orderGhost={ghost:!0,order:t,pricePropertyName:i,price:s,index:r,originIndex:this.priceToIndex(t[i])},this._invalidatedOrders[r]=!0,this.scheduleRepaint())}setDragShield(e,t){this._dragShield&&(this._dragShield.classList.toggle("js-hidden",!e),this._dragShield.classList.toggle(M["tv-dom-widget-main__drag-shield--order"],t))}scheduleRepaint(){this._repaintScheduled||this._symbolData&&(requestAnimationFrame((()=>this.repaint())),this._repaintScheduled=!0)}formatVolume(e){return null===this._symbolData?String(e):this._symbolData.volumeFormatter.format(e)}repaint(){if(this._repaintScheduled=!1,!this._listContainer)return;if(null===this._viewPool)return
;const e=this.topIndex,t=this.correctIndex(e,1-this.height);if(isFinite(t)){for(;this._viewsList.length<this.height;){const e=this._viewPool.allocate();this._listContainer.append(e.element),this._viewsList.push(e)}for(;this._viewsList.length>this.height;){const e=(0,c.ensureDefined)(this._viewsList.pop());e.element.remove(),this._viewPool.free(e)}this._oldViewAllocated=this._viewAllocated,this._viewAllocated=new Map;for(let t=0;t<this._viewsList.length;t++){const i=this.correctIndex(e,-t),s=this._viewsList[t];this._viewAllocated.set(i,s),this._updateRow(i)}this._updateOffscreenIndexLocation(this._lastPriceIndex,e,t);for(const e in this._invalidatedBid)this._invalidatedBid.hasOwnProperty(e)&&delete this._invalidatedBid[e];for(const e in this._invalidatedAsk)this._invalidatedAsk.hasOwnProperty(e)&&delete this._invalidatedAsk[e];for(const e in this._invalidatedPriceHighlight)this._invalidatedPriceHighlight.hasOwnProperty(e)&&delete this._invalidatedPriceHighlight[e];for(const e in this._invalidatedOrders)this._invalidatedOrders.hasOwnProperty(e)&&delete this._invalidatedOrders[e]}}typePrice(e){return e>=this._bestAskIndex?"ask":e<=this._bestBidIndex?"bid":void 0}toggleDynamicModeState(){return this._dynamicModeState=!this._dynamicModeState,this._dynamicModeState}getDynamicModeState(){return this._dynamicModeState}checkAutoCenter(){isFinite(this.topIndex)||this.centerOnLast();const e=this.topIndex,t=this.correctIndex(this.topIndex,1-this.height);let i;i=isFinite(this._bestBidIndex)?this._bestBidIndex:isFinite(this._bestAskIndex)?this._bestAskIndex:isFinite(this._lastPriceIndex)?this._lastPriceIndex:NaN;let s=NaN;isFinite(this._bestAskIndex)?s=this._bestAskIndex:isFinite(this._bestBidIndex)?s=this._bestBidIndex:isFinite(this._lastPriceIndex)&&(i=this._lastPriceIndex);let r=!1;(s+3>e||i-3<t)&&(this.topIndex,this._autoCenterTargetTopIndex()),this.autoCenterRequired.setValue(r)}isSpread(e){return this._bestAskIndex>e&&e>this._bestBidIndex}getOffscreenIndexLocationObservable(){return this._offscreenIndexLocation$.asObservable()}_hasDataInDOM(){return 0!==this._indexes.length}_updateOffscreenIndexLocation(e,t,i){isFinite(this._lastPriceIndex)&&(e>t?this._offscreenIndexLocation$.next(s.Higher):e<i?this._offscreenIndexLocation$.next(s.Lower):this._offscreenIndexLocation$.next(s.Inside))}_hasStaticDOMRequiredData(){return 0!==this.height&&isFinite(this.topIndex)&&null!==this._symbolData&&isFinite(this._lastPriceIndex)}_hasQuotes(){return this._indexes.length>1}_collectIndexes(){this._indexes=Object.keys(Object.assign({},this._asks,this._bids))}_recalcDepthInfo(){const e=Object.keys(this._asks).reduce(H,[]).sort(q),t=Object.keys(this._bids).reduce(H,[]).sort(q),i=Object.keys(this._orders).reduce(H,[]).sort(q);this._worstAskIndex=e[0],this._bestAskIndex=e[e.length-1],this._bestBidIndex=t[0],this._worstBidIndex=t[t.length-1];const s=[],r=[];for(const e of i)e<=this._worstAskIndex&&e>=this._bestAskIndex&&void 0===this._asks[e]&&s.push(e),e<=this._bestBidIndex&&e>=this._worstBidIndex&&void 0===this._bids[e]&&r.push(e)
;this._cellIndexesInAskZone=A(e,s),this._cellIndexesInBidZone=A(t,r)}_updateRow(e){if(!this._symbolData)return;const t=this._oldViewAllocated,s=this._viewAllocated;let r=s.get(e);this._viewPool&&!r&&(r=this._viewPool.allocate(),s.set(e,r));const o=this._orderGhost;if(t&&t.get(e)!==s.get(e)){const t=this.indexToPrice(e);r.updatePrice(t),r.updatePriceText(this._symbolData.priceFormatter.format(t))}r.paintPrice(this.typePrice(e)),this._asks[e]&&this._asks[e]!==Number.POSITIVE_INFINITY?r.updateAskVolume(this.formatVolume(this._asks[e])):r.updateAskVolume(""),r.updateAskLabels(e<this._bestAskIndex),this._bids[e]&&this._bids[e]!==Number.POSITIVE_INFINITY?r.updateBidVolume(this.formatVolume(this._bids[e])):r.updateBidVolume(""),r.setHigherThanBid(e>this._bestBidIndex),r.updateAskMeter(this._asks[e]===Number.POSITIVE_INFINITY?100:this._asks[e]/this._currentVolumeMax||0),r.updateBidMeter(this._bids[e]===Number.POSITIVE_INFINITY?100:this._bids[e]/this._currentVolumeMax||0);const a=e===this._lastPriceIndex,l=e===this._positionIndex?this._positionQty:0;r.updatePriceHighlight(a,l);let d,c,u=this._orders[e]||[];null!==o&&(o.index===e&&(o.originIndex!==e?u=u.concat(o):c=o.order.id),o.index!==e&&o.originIndex!==e||(d=o.order.side));const h=this._realtimeProvider.activeBroker()?.metainfo().configFlags;for(let e=0;e<u.length;e++){const t=u[e],s=t.order,r=s.filledQty||0;switch(t.inactive=6!==s.status||4===s.type&&"limitPrice"===t.pricePropertyName,t.isModifiable=void 0!==h&&(0,v.isModifyOrderSupported)(s,h),t.isMovable=void 0!==h&&(0,v.isMoveOrderSupported)(s,h),t.isCancellable=!0,s.type){case 2:t.typeText=n.t(null,void 0,i(490138)),t.type="market";break;case 1:t.typeText=s.parentId?n.t(null,void 0,i(486933)):n.t(null,void 0,i(790258)),t.type="limit";break;case 3:t.typeText=s.parentId?n.t(null,void 0,i(426497)):n.t(null,{context:"order"},i(679953)),t.type="stop";break;case 4:t.typeText=n.t(null,void 0,i(264073)),t.type="stoplimit";break;default:t.typeText=""}t.qty=this._symbolData.quantityFormatter.format(s.qty-r),t.buy=1===s.side,t.noCollapse=s.side===d,t.highlighted=null!==o&&void 0!==c&&s.id===c&&o.pricePropertyName===t.pricePropertyName}r.updateOrders(u)}_setTopIndex(e){e!==this.topIndex&&(this.topIndex=e,this.checkAutoCenter()),this.scheduleRepaint()}_canIndexBeDisplayed(e){const t=this._showPricesWith.zeroVolume.value(),i=this._showPricesWith.spread.value();if(t&&!this.isSpread(e))return!0;if(i&&this.isSpread(e))return!0;const s=e===this._lastPriceIndex,r=e===this._positionIndex,n=this._bids.hasOwnProperty(e)||this._asks.hasOwnProperty(e),o=e<=this._worstBidIndex||this._worstAskIndex<=e,a=this._orders[e]||[],l=this._orderGhost&&this._orderGhost.index===e;return r||s||l||o||n||0!==a.length}_getGapMiddleIndex(){let e=this._bestAskIndex,t=this._bestBidIndex;return isFinite(e)||(e=t),isFinite(t)||(t=e),Math.floor((t+e)/2)}_autoCenterTargetTopIndex(){const e=Math.floor(this.height/2);return this._showPricesWith.zeroVolume.value()&&this._showPricesWith.spread.value()?this._getCenterIndex()+e:this._getCorrectCenterIndex()+e}
_getCorrectCenterIndex(){const e=this._getCenterIndex(),t=this._bestAskIndex??e,i=this._worstAskIndex??e;let s=e;if(!this._showPricesWith.zeroVolume.value()){s=e+i-t-1-(this._cellIndexesInAskZone.length-1>=0?this._cellIndexesInAskZone.length-1:0)+1}return this._showPricesWith.spread.value()||(s+=t-e),s}_getCenterIndex(){const e=this._getGapMiddleIndex();return isFinite(e)?e:isFinite(this._bestBidIndex)?this._bestBidIndex:isFinite(this._bestAskIndex)?this._bestAskIndex:isFinite(this._lastPriceIndex)?this._lastPriceIndex:NaN}_recalcMaxVolume(){let e=0;for(const t in this._asks)this._asks.hasOwnProperty(t)&&(e=Math.max(this._asks[t],e));for(const t in this._bids)this._bids.hasOwnProperty(t)&&(e=Math.max(this._bids[t],e));e!==this._currentVolumeMax&&(this._currentVolumeMax=e)}_recalcBestWorstBid(){let e=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY;for(const i in this._bids)this._bids.hasOwnProperty(i)&&(+i>e&&(e=+i),+i<t&&(t=+i));this._bestBidIndex=e,this._worstBidIndex=t}_recalcBestWorstAsk(){let e=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY;for(const i in this._asks)this._asks.hasOwnProperty(i)&&(+i<e&&(e=+i),+i>t&&(t=+i));this._bestAskIndex=e,this._worstAskIndex=t}}var z,R=i(218286),W=i(599016);!function(e){e[e.Percentage=0]="Percentage",e[e.Pips=1]="Pips",e[e.Currency=2]="Currency"}(z||(z={}));class U{constructor(e,t){this._symbolData=null,this._calculatePLUsingLast=!1,this._hasLotSize=new d.WatchedValue(!1),this._plState$=new T.Subject,this._positionState$=new T.Subject,this._pipValueType=null,this.changePLViewType=()=>{switch(this._displayProfitState){case 2:this._displayProfitState=1;break;case 0:this._displayProfitState=2;break;case 1:this._displayProfitState=0}u.setValue(w.settingsKeys.PROFIT_VIEW_TYPE,this._displayProfitState),this.updatePL()},this.compareQty=()=>{const e=Math.abs(Number(this._position?.qty));e>0&&isFinite(e)&&this.qty.setValue(e)},this._updatePipValueType=e=>{this._pipValueType=e},this.defaultPLState={plText:null,tradeDirection:null,plTooltipText:n.t(null,void 0,i(74966))},this.defaultPositionState={positionText:null,side:null},this.plState$=this._plState$.pipe((0,R.distinctUntilChanged)(((e,t)=>e.plText===t.plText&&e.tradeDirection===t.tradeDirection&&e.plTooltipText===t.plTooltipText))),this.positionState$=this._positionState$.pipe((0,R.distinctUntilChanged)(((e,t)=>e.positionText===t.positionText&&e.side===t.side))),this._handlers=e||{},t.subscribe(this._updatePipValueType),this._displayProfitState=u.getJSON(w.settingsKeys.PROFIT_VIEW_TYPE,2),this.reset(),this._integerFormatter=new O.NumericFormatter({precision:0}),this._oneDecimalFormatter=new O.NumericFormatter({precision:1}),this._twoDecimalFormatter=new O.NumericFormatter({precision:2}),this.qty=new d.WatchedValue(1),this.qty.subscribe((e=>this._handlers.qtyChange.call(null,e))),this._qtyProperties=new d.WatchedValue({min:1,step:1,max:1})}reset(){this._position=void 0,this._pl=void 0,this._lastPrice=void 0,this._bid=void 0,this._ask=void 0,this._symbolData=null,this._updatePositionState(this.defaultPositionState),
this._updatePLState(this.defaultPLState)}setBrokerConfigFlags(e){this._calculatePLUsingLast=e.calculatePLUsingLast}setSymbolInfo(e){const{qtyProperties:t,units:i}=e;this._symbolData=e,this._qtyProperties.setValue({...t,units:i})}getQtyProperties(){return this._qtyProperties}updatePosition(e){if(this._position=e,void 0===this._position||0===this._position.qty||null===this._symbolData)return void this._updatePositionState(this.defaultPositionState);const{qty:t,avgPrice:i,side:s}=this._position,r=this._symbolData.priceFormatter.format(i),n=Math.abs(t),o=this._symbolData.volumeFormatter.format(n);this._updatePositionState({positionText:`${o} @ ${r}`,side:s})}updatePL(e){if(void 0!==e&&(this._pl=e),void 0===this._position)return void this._updatePLState(this.defaultPLState);const{side:t,avgPrice:i}=this._position,s=-1===t,r=this._calculatePLUsingLast?this._lastPrice:s?this._ask:this._bid;if(void 0===r){if(void 0===this._pl||2!==this._displayProfitState)this._updatePLState(this.defaultPLState);else{const e=this._pl>=0?1:2;this._updatePLState({plText:this._makePlText(),tradeDirection:e,plTooltipText:this._makePlTooltipText()})}return}const n=(r-i)*(s?-1:1),o=n>0?1:2;switch(this._displayProfitState){case 0:{const e=this._calculatePLPercentage(i,n);this._updatePLState({plText:e,tradeDirection:o,plTooltipText:this._makePlTooltipText()});break}case 1:{const e=this._makePipsText(n);this._updatePLState({plText:e,tradeDirection:o,plTooltipText:this._makePlTooltipText()});break}case 2:this._updatePLState({plText:this._makePlText(),tradeDirection:o,plTooltipText:this._makePlTooltipText()})}}updateLast(e,t,i){this._lastPrice=e,this._bid=t,this._ask=i,this.updatePL()}bid(){return this._bid}ask(){return this._ask}setHasLotSize(e){this._hasLotSize.setValue(e)}hasLotSize(){return this._hasLotSize.readonly()}_calculatePLPercentage(e,t){const i=t/e;return isFinite(i)?this._twoDecimalFormatter.format(100*i)+"%":null}_makePipsText(e){if(null===this._symbolData)return null;const{pipSize:t,minTick:s}=this._symbolData,r=isFinite(t)&&t!==s?this._oneDecimalFormatter:this._integerFormatter,o=parseFloat(r.format(e/(t||s)));if(!isFinite(o))return null;switch(this._pipValueType){case W.PipValueType.Pips:return n.t(null,{plural:"{pips} pips",count:Math.abs(o),replace:{pips:String(o)}},i(161156));case W.PipValueType.Ticks:return n.t(null,{plural:"{ticks} ticks",count:Math.abs(o),replace:{ticks:String(o)}},i(800338));default:return null}}_makePlText(){if(void 0===this._pl)return null;const e=this._twoDecimalFormatter.format(this._pl);return void 0!==this._symbolData?.positionCurrency?`${e} ${this._symbolData.positionCurrency}`:e}_makePlTooltipText(){switch(this._displayProfitState){case 2:return this._pipValueType===W.PipValueType.Pips?n.t(null,void 0,i(370639)):n.t(null,void 0,i(679308));case 0:return this._symbolData?.positionCurrency?n.t(null,{replace:{currency:this._symbolData.positionCurrency}},i(357428)):this.defaultPLState.plTooltipText;case 1:return n.t(null,void 0,i(496469));default:return this.defaultPLState.plTooltipText}}
_updatePositionState(e){this._positionState$.next(e)}_updatePLState(e){this._plState$.next(e)}}class G{constructor(e,t,i){this._expiresAt=0,this._delay=e,this._doneCb=t,this._progressCb=i}run(){if(this._timeoutId)return;const e=Date.now?Date.now():+new Date;this._expiresAt=e+this._delay,this._timeoutId=window.setTimeout((()=>{this.abort(),this._doneCb()}),this._delay),this._trackProgressScheduled||this._trackProgress()}revert(){this._timeoutId&&(window.clearTimeout(this._timeoutId),this._timeoutId=void 0,this.run())}abort(){this._timeoutId&&(window.clearTimeout(this._timeoutId),this._timeoutId=void 0,this._expiresAt=0,this._progressCb&&this._progressCb(0))}setWindow(e){this._wnd=e}_trackProgress(){if(this._trackProgressScheduled=!1,!this._progressCb||!this._timeoutId)return;const e=Date.now?Date.now():+new Date;let t=1-(this._expiresAt-e)/this._delay;t=Math.max(Math.min(t,1),0),this._progressCb(t),this._wnd&&this._wnd.requestAnimationFrame?this._wnd.requestAnimationFrame((()=>{this._trackProgress()})):window.setTimeout((()=>{this._trackProgress()}),40),this._trackProgressScheduled=!0}}var K=i(586639),Z=i(329452),Q=i(466479);class Y{constructor(){this._currentValuesSummaryLine$=new p.BehaviorSubject(""),this._isVisible$=new p.BehaviorSubject(!1),this._isOpen$=new p.BehaviorSubject(!1),this._onCustomFieldsUpdate=new Z.Delegate,this._customFieldsViewModelSubscription=void 0,this._rewriteDisplayedSelectedItems=()=>{const e=this.customFieldsViewModel?.getCustomFieldsModels().flatMap((e=>{switch(e.type){case"Checkbox":return e.getChecked()?e.title:[];case"ComboBox":return e.getSelectedItem()??[];default:return[]}}))??[],t=this._getCurrentDurationName();void 0!==t&&e.push(t);const i=e.join(", ");this._currentValuesSummaryLine$.next(i)},this._updateVisibility=()=>{this._isVisible$.next(this._hasDuration()||this._hasCustomFields())},this.currentValuesSummaryLine$=this._currentValuesSummaryLine$.asObservable(),this.isOpen$=this._isOpen$.asObservable(),this._updateVisibility()}setCustomFields(e){this._createCustomFieldsViewModel(e),this._rewriteDisplayedSelectedItems(),this._updateVisibility(),this._onCustomFieldsUpdate.fire()}setDurationsInfo(e,t){void 0!==t&&(this._durationsMetaInfo=t),this._currentDuration=e,this._rewriteDisplayedSelectedItems(),this._updateVisibility()}isVisible(){return this._isVisible$.getValue()}setIsOpen(e){this._isOpen$.next(e)}_getCurrentDurationName(){const e=this._currentDuration?.type,t=this._durationsMetaInfo?.find((t=>t.value===e));return t?.name}_hasDuration(){return void 0!==this._currentDuration}_hasCustomFields(){return void 0!==this.customFieldsViewModel&&0!==Object.keys(this.customFieldsViewModel.getCustomFieldsInputValues()).length}_createCustomFieldsViewModel(e){void 0!==this.customFieldsViewModel&&(this.customFieldsViewModel.unsubscribe(),this._customFieldsViewModelSubscription?.unsubscribe()),this.customFieldsViewModel=new Q.CustomFieldsViewModel({existingOrder:!1,customFields:e,initialInputState:void 0,orderType$:(0,K.of)(null)}),this.customFieldsViewModel.subscribe(),
this._customFieldsViewModelSubscription=this.customFieldsViewModel.customFieldsInputValues$.subscribe((()=>{this._rewriteDisplayedSelectedItems(),this._updateVisibility()}))}}var j=i(661851),J=i(853177),X=i(878112),ee=i(930202),te=i(497754),ie=i.n(te),se=i(297265),re=i(423994),ne=i(314266);function oe(e){const{currentDuration:t,durationMetaInfoList:i,onDurationChanged:s,showErrorMessages:r,revertInvalidData:n}=e;return a.createElement(ne.DurationControl,{currentDuration:t,durationMetaInfoList:i,onDurationChanged:s,showErrorMessages:r,revertInvalidData:n})}var ae=i(143541),le=i(488263),de=i(611902);function ce(e){const{domDetails:t,onDurationChanged:s}=e,r=t.customFieldsViewModel?.getCustomFieldsModels()||[],o=(0,j.useObservable)(t.isOpen$),l=(0,se.useWatchedValueReadonly)({watchedValue:e.currentDuration}),d=(0,se.useWatchedValueReadonly)({watchedValue:e.durationMetaInfoList}),c=(0,j.useObservable)(t.currentValuesSummaryLine$);return a.createElement(a.Fragment,null,a.createElement("div",{className:ae.headerWrapper},a.createElement("div",{className:ae.header,tabIndex:0,onKeyDown:e=>{const i=(0,ee.hashFromEvent)(e);13!==i&&32!==i||t.setIsOpen(!o)},onClick:()=>t.setIsOpen(!o)},a.createElement("div",{className:te(ae.textBlock,ae.summaryLine)},a.createElement("span",null,n.t(null,void 0,i(278892)))," ",a.createElement("span",{className:te(ae.tifValue)},c)),a.createElement("div",{className:ae.arrow},a.createElement(X.Icon,{icon:o?le:de})))),o&&a.createElement("div",{className:ae.details},a.createElement(re.CustomFields,{customFieldModels:r,isWait:!1,forceUserToSelectValue:!1}),a.createElement("div",{className:ae.duration},void 0!==l&&void 0!==d&&a.createElement(oe,{currentDuration:l,durationMetaInfoList:d,onDurationChanged:s,showErrorMessages:!0,revertInvalidData:!0}))))}var ue=i(224567),he=i(228837),me=i(431520),_e=i(901317),pe=i(729354),ge=i(453429);function ve(e){const{calcData:t}=e,i=(0,a.useRef)(null),[s,r]=(0,_e.useWatchedValue)(t.qty),n=(0,se.useWatchedValueReadonly)({watchedValue:t.getQtyProperties()}),o=(0,se.useWatchedValueReadonly)({watchedValue:t.hasLotSize()});return a.createElement(a.Fragment,null,a.createElement("div",{ref:i,className:ge.errorsContainer}),a.createElement("div",{className:ge.wrapper},a.createElement(pe.QuantityInput,{id:"dom-quantity-input",qty:s,quantityMetainfo:n,onValueChange:r,hideLabel:!0,hasLotSize:o,button:a.createElement(a.Fragment,null),className:ge.qty,customErrorsAttachment:{target:i.current}})))}var be=i(801023);const ye=e=>a.createElement(a.Fragment,null,a.createElement("span",{className:be.hotKeyTitle},e.title),a.createElement("span",null,e.keyboardKeys.map((e=>a.createElement(ue.HotkeyBox,{key:e,keyboardKey:e})))));var we=i(342724);const fe=n.t(null,void 0,i(231234)),Se=n.t(null,void 0,i(442687));function xe(e){const{uiPlaceOrder:t,calcData:s}=e,r=a.createElement(ye,{title:n.t(null,void 0,i(248463)),keyboardKeys:["Shift","B"]}),o=a.createElement(ye,{title:n.t(null,void 0,i(554663)),keyboardKeys:["Shift","S"]});return a.createElement("div",{
className:te(we.row,we.wrapper,we.marketBlock)},a.createElement(ue.Tooltip,{content:r,isRtl:(0,me.isRtl)(),trigger:[ue.Trigger.Hover,ue.Trigger.Focus]},a.createElement(he.SquareButton,{size:"xsmall",color:"blue",variant:"primary",className:te(we.button),onClick:e=>{e.preventDefault(),t({type:2,side:1})}},fe)),a.createElement(ve,{calcData:s}),a.createElement(ue.Tooltip,{content:o,isRtl:(0,me.isRtl)(),trigger:[ue.Trigger.Hover,ue.Trigger.Focus]},a.createElement(he.SquareButton,{size:"xsmall",color:"red",variant:"primary",className:te(we.button),onClick:e=>{e.preventDefault(),t({type:2,side:-1})}},Se)))}var Ie=i(109251);const ke=n.t(null,void 0,i(267539));function Pe(e){const{plState$:t,positionState$:i,defaultPLState:s,defaultPositionState:r,changePLViewType:n,compareQty:o}=e,{plText:l,plTooltipText:d,tradeDirection:c}=(0,j.useObservable)(t,s),{positionText:u,side:h}=(0,j.useObservable)(i,r),m=null===u,_=te(Ie.button,!m&&1===c&&Ie.profit,!m&&2===c&&Ie.loss),p=te(Ie.button,!m&&1===h&&Ie.buy,!m&&-1===h&&Ie.sell);return a.createElement("div",{className:Ie.wrapper},a.createElement(ue.Tooltip,{isRtl:(0,me.isRtl)(),content:ke,trigger:[ue.Trigger.Hover,ue.Trigger.Focus]},a.createElement(he.SquareButton,{className:p,disabled:m,onClick:o,size:"xsmall",color:"gray",variant:"secondary"},u??"—")),a.createElement(ue.Tooltip,{isRtl:(0,me.isRtl)(),content:d,trigger:[ue.Trigger.Hover,ue.Trigger.Focus]},a.createElement(he.SquareButton,{className:_,disabled:m,onClick:n,size:"xsmall",color:"gray",variant:"secondary"},l??"—")))}const Te=n.t(null,void 0,i(795379)),Oe=n.t(null,void 0,i(745769)),Ce=n.t(null,void 0,i(364489)),Ee=n.t(null,void 0,i(714747)),Me=n.t(null,void 0,i(410844)),De=n.t(null,void 0,i(244948));function Be(e){const t=e.isPositionBlocked||!e.isTradable||!e.hasPosition||!e.hasFlatten,i=!e.isTradable||!(e.hasBuyOrders||e.hasSellOrders),s=e.isPositionBlocked||!e.isTradable||!e.hasPosition||!e.hasReverse,r=(0,a.useCallback)((i=>{t||(i.preventDefault(),e.uiClosePosition())}),[t,e.uiClosePosition]),n=(0,a.useCallback)((t=>{i||(t.preventDefault(),e.uiCancelAllOrders())}),[i,e.uiCancelAllOrders]),o=(0,a.useCallback)((t=>{s||(t.preventDefault(),e.uiReversePosition())}),[s,e.uiReversePosition]);return a.createElement("div",{className:te(we.row,we.wrapper,we.tradingActionBlock)},a.createElement(ue.Tooltip,{content:Me,isRtl:(0,me.isRtl)(),trigger:[ue.Trigger.Hover,ue.Trigger.Focus]},a.createElement(he.SquareButton,{"aria-disabled":t,size:"xsmall",color:"gray",variant:"secondary",className:we.button,onClick:r,tabIndex:t?-1:0},Oe)),a.createElement(ue.Tooltip,{content:Ee,isRtl:(0,me.isRtl)(),trigger:[ue.Trigger.Hover,ue.Trigger.Focus]},a.createElement(he.SquareButton,{"aria-disabled":i,size:"xsmall",color:"gray",variant:"secondary",className:we.button,onClick:n,tabIndex:i?-1:0},Te)),a.createElement(ue.Tooltip,{content:De,isRtl:(0,me.isRtl)(),trigger:[ue.Trigger.Hover,ue.Trigger.Focus]},a.createElement(he.SquareButton,{"aria-disabled":s,size:"xsmall",color:"gray",variant:"secondary",className:we.button,onClick:o,tabIndex:s?-1:0},Ce)))}
var Le=i(394922);function Ve(e){const{uiState$:t,warningMessage$:i,domDetailsDropdownProps:s,domMarketActionBlockProps:r,tradingActionBlockControllers:n,domCalcBlockProps:o}=e,l=(0,j.useObservable)(t,{isTradable:!1,isPositionBlocked:!1,hasPosition:!1,hasBuyOrders:!1,hasSellOrders:!1,qty:1,gtcOrder:!1,hasFlatten:!1,hasReverse:!1}),d=[];return l.isTradable&&d.push({id:"symbol-specific-warning",warningMessageSource:l.symbolSpecificWarningMessage}),a.createElement("div",{className:Le.container},a.createElement(Pe,{...o}),a.createElement(Be,{...n,...l}),a.createElement(xe,{...r}),l.isTradable&&s.domDetails.isVisible()&&a.createElement(ce,{...s}),a.createElement(J.TradingPanelWarningInformersContainer,{warningInformersItems:d}))}var Ne=i(898237),Ae=i(223717),Fe=i(11728);function qe(e){const{isLoading:t,onClick:i,buttonTitle:s,volume:r,countedVolumeTitle:n,side:o,disabled:l}=e;return a.createElement("div",{className:ie()(Ae.cancelOrders,-1===o&&Ae.reversed)},a.createElement(ue.Tooltip,{trigger:[ue.Trigger.Focus,ue.Trigger.Hover],content:s,isRtl:(0,me.isRtl)()},a.createElement(Ne.LightButton,{iconOnly:!0,startSlot:a.createElement(X.Icon,{icon:Fe}),variant:"quiet-primary",size:"xsmall",className:Ae.cancelButton,onClick:i,disabled:t||l,tabIndex:0})),""!==r&&void 0!==r&&a.createElement("span",{className:ie()(Ae.countedVolume,Boolean(n)&&"apply-common-tooltip"),title:n},r))}i(445300);var He=i(102464);const $e=a.createElement(ye,{title:n.t(null,void 0,i(678046)),keyboardKeys:[(0,ee.humanReadableModifiers)(ee.Modifiers.Shift,!1),(0,ee.humanReadableModifiers)(ee.Modifiers.Alt,!1),"C"]});function ze(e){const{isLoading:t,onClick:i,trackEvent:s}=e;return a.createElement("div",{style:{position:"relative"}},a.createElement(ue.Tooltip,{content:$e,isRtl:(0,me.isRtl)(),trigger:[ue.Trigger.Focus,ue.Trigger.Hover]},a.createElement(Ne.LightButton,{iconOnly:!0,startSlot:a.createElement(X.Icon,{icon:He}),variant:"quiet-primary",size:"xsmall",onClick:()=>{i(),s("Center DOM data")}})),!1)}const Re=e=>{let t="M 0 0";return e>0&&(e>=1?t="M 0 -1":t+="L 0 -1",e>.5&&(t+="A 1 1 0 0 1 0 1"),t+="A 1 1 0 0 1 "+Math.sin(2*e*Math.PI)+" "+-Math.cos(2*e*Math.PI)+"Z"),t};var We=i(212497);function Ue(e){const{className:t,timer:i}=e,[s,r]=(0,a.useState)({d:"M 0,0"});return(0,a.useLayoutEffect)((()=>{i((e=>{r({d:Re(e||0)})}))}),[]),a.createElement("svg",{className:ie()(We.timer,t),viewBox:"-1 -1 2 2",width:"2",height:"2"},a.createElement("path",{...s}))}var Ge=i(343618);const Ke={on:i(781957),off:i(943145)};function Ze(e){const{onClick:t,toggleDynamicModeState:s,trackEvent:r,timer:o}=e,[l,d]=(0,a.useState)({icon:Ke.off,title:n.t(null,void 0,i(167785))});return a.createElement("div",{className:Ge.switchModeButton},a.createElement(Ue,{timer:o,className:Ge.timer}),a.createElement(ue.Tooltip,{isRtl:(0,me.isRtl)(),content:l.title,trigger:[ue.Trigger.Hover,ue.Trigger.Focus]},a.createElement(Ne.LightButton,{iconOnly:!0,startSlot:a.createElement(X.Icon,{icon:l.icon}),variant:"quiet-primary",size:"xsmall",onClick:()=>{const e=s();d((e=>e?{icon:Ke.on,
title:n.t(null,void 0,i(413264))}:{icon:Ke.off,title:n.t(null,void 0,i(167785))})(e)),t(),r(e?"Enable dynamic mode":"Disable dynamic mode")}})))}var Qe=i(210293);function Ye(e){const{isLoading:t,onClick:s,isStaticDOMEnabled:r,toggleDynamicModeState:o,trackEvent:l,timer:d,totalVolumeAsk:c,totalVolumeBid:u}=e;return a.createElement("div",{className:Qe.centeringContainer},a.createElement("div",{className:ie()(Qe.volume,Qe.bid)},a.createElement("span",{title:n.t(null,void 0,i(662627)),className:"apply-common-tooltip"},u)),r?a.createElement(ze,{isLoading:t,onClick:s,trackEvent:l}):a.createElement(Ze,{toggleDynamicModeState:o,isLoading:t,onClick:s,trackEvent:l,timer:d}),a.createElement("div",{className:ie()(Qe.volume,Qe.ask)},a.createElement("span",{title:n.t(null,void 0,i(867713)),className:"apply-common-tooltip"},c)))}var je=i(422808);function Je(e){const{isLoading:t,uiState$:s,onCenteringButtonClick:r,isStaticDOMEnabled:o,toggleDynamicModeState:l,trackEvent:d,timer:c,cancelOrders:u,cancelOrdersState$:h}=e,m=(0,se.useWatchedValueReadonly)({watchedValue:t}),_=(0,j.useObservable)(s),p=(0,j.useObservable)(h,{cancelBuyOrdersDisabled:!0,cancelSellOrdersDisabled:!0});return a.createElement("div",{className:je.domControls},a.createElement(qe,{isLoading:m,buttonTitle:n.t(null,void 0,i(195133)),onClick:()=>u(1),side:1,countedVolumeTitle:p?.countedVolumeBuyTitle,volume:p?.countedVolumeBuy,disabled:p.cancelBuyOrdersDisabled}),a.createElement(Ye,{isStaticDOMEnabled:o,isLoading:m,onClick:r,totalVolumeAsk:_?.totalVolumeAsk,totalVolumeBid:_?.totalVolumeBid,toggleDynamicModeState:l,trackEvent:d,timer:c}),a.createElement(qe,{isLoading:m,buttonTitle:n.t(null,void 0,i(193212)),onClick:()=>u(-1),side:-1,countedVolumeTitle:p?.countedVolumeSellTitle,volume:p?.countedVolumeSell,disabled:p.cancelSellOrdersDisabled}))}var Xe=i(902593),et=i(627601);const tt=!0;function it(e,t){return`${w.settingsKeys.DOM_DURATION}${e}.${t}`}const st={1:"LIMIT",2:"MARKET",3:"STOP",4:"STOPLIMIT"};function rt(e){return e instanceof MouseEvent?e.pageY:e.touches[0]?.pageY??0}class nt{constructor(e){this.delayedData=new d.WatchedValue(!1),this.isBats=new d.WatchedValue(!1),this._container=null,this._warning=null,this._mainBlock=null,this._subscription=null,this._noDataTimeout=null,this._actionMarketButtons=null,this._actionPositionButtons=null,this._cancelOrdersState$=null,this._currentDuration=new d.WatchedValue,this._durationMetaInfoList=new d.WatchedValue,this._viewTotalVolumeScheduled=!1,this._csxAllTitle=n.t(null,void 0,i(714747)),this._flattenTitle=n.t(null,void 0,i(410844)),this._reverseTitle=n.t(null,void 0,i(244948)),this._handleModKeyStateChange=e=>{const t=(0,h.modifiersFromEvent)(e)===h.Modifiers.Mod;this._content.setStopOrderMode(t)},this._createTimer=e=>(this._timer=new G(2e3,(()=>{this._content.centerOnLast()}),e),this._timer),this._onDurationChanged=e=>{this._currentDuration.setValue(e),this._domDetails.setDurationsInfo(e);const t=this._realtimeProvider.activeBroker();if(null===t)return;const i=it(t.metainfo().id,this._tradingLinking.value().symbol)
;u.setValue(i,e.type)},this._onSuggestedQtyChange=e=>{this._calcData.qty.setValue(e),this._mergeUiState({qty:e})};const{body:t,visible:s,trading:r,qtySuggester:o,tradingLinking:a,headerState:l,isLoading:c}=e;this._headerState=l,this._visible=s,this._symbolData=null,this._isLoading=c,this._supportedOrderTypes=[2],this._domDetails=new Y,this._trading=r,this._qtySuggester=o,this._tradingLinking=a,this._realtimeProvider=this._trading.realtimeProvider();const m=this._handlers(),_={zeroVolume:this._trading.showPricesWith().zeroVolume.readonly(),spread:this._trading.showPricesWith().spread.readonly()};this._content=new $(m,_,this._realtimeProvider),this._calcData=new U(m,r.pipValueType()),this._uiState={isTradable:!1,isPositionBlocked:!1,hasPosition:!1,hasBuyOrders:!1,hasSellOrders:!1,qty:1,gtcOrder:!1,hasFlatten:!1,hasReverse:!1},this._upperBlockResizeObserver=new ResizeObserver((e=>{for(const t of e){const e=Math.ceil(t.target.clientHeight/20);this._content.setHeight(e)}})),this._uiState$=new p.BehaviorSubject(this._uiState),this.isTradable$=this._uiState$.pipe((0,g.map)((({isTradable:e})=>e))),this._timerLockState={},t.subscribe((e=>this._recreateLayout(e)),{callWithLast:!0}),this._tradingLinking.valueObservable().subscribe((({warning:e})=>{this._onStateChange(),this._updateDetails(),this._warningMessage$?.next(e)})),this._realtimeProvider.onStatusChanged.subscribe(null,(()=>{this._onStateChange(),this._updateDetails()})),s.subscribe((()=>{this._onStateChange(),this._warningMessage$?.next(this._warningMessage$.getValue())})),this._onStateChange(),this._updateDetails()}uiScroll(e){this._content.getDynamicModeState()||(this._content.shiftTopIndexRelativeToIndex(this._content.topIndex,0|e),this._timer?.revert())}uiCenter(){this._content.centerOnLast(),this._trackEvent("Center")}uiCancelOrder(e){this._uiState.isTradable&&null!==e&&((0,c.ensureNotNull)(this._trading.brokerCommandsUI()||null).cancelOrder(e),this._trackEvent("Cancel Order"))}uiModifyOrder(e,t=null){if(!e||!this._uiState.isTradable||void 0===this._configFlags||!(0,v.isModifyOrderSupported)(e,this._configFlags))return Promise.resolve();let i=!0;null===t&&(t={},i=!1);const s=(0,c.ensureNotNull)(this._trading.brokerCommandsUI()||null).modifyOrder({...e,...t},i,void 0,!0);return this._lockTimerUntilSettled(s),this._trackEvent("Modify Order"),Promise.resolve()}uiPlaceOrder({side:e,type:t,price:i=NaN,altPrice:s=NaN}){if(!this._realtimeProvider.activeBroker())return void this._trading.toggleTradingWidget().then((()=>{this._trading.onNeedSelectBroker.fire()}));if(!this._subscription?.broker)return void this._trading.toggleTradingWidget();if(2!==t&&!isFinite(i))return;null===t&&(t=this._content.guessOrderType(i,e));let r=!0;if(null===t&&(r=!1,t=1),!this._isOrderTypeSupported(t))return;const n=this._calcData.ask(),o=this._calcData.bid(),a=1===e?n:o,l={symbol:this._tradingLinking.value().symbol,qty:this._calcData.qty.value(),side:e,type:t,seenPrice:a??null,duration:this._currentDuration.value(),
customFields:this._domDetails.customFieldsViewModel?.getCustomFieldsInputValues()};void 0!==n&&void 0!==o&&(l.currentQuotes={ask:n,bid:o}),3===l.type&&(l.stopPrice=i),1===l.type&&(l.limitPrice=i),4===l.type&&(l.stopPrice=i,isFinite(s)?l.limitPrice=s:r=!1),this._lockTimerUntilSettled((0,c.ensureNotNull)(this._trading.brokerCommandsUI()||null).placeOrder(l,r,!0));const d=this._content.getDynamicModeState()?"enabled":"disabled";this._trackEvent("Place Order",st[t]),this._trackEvent(`Place Order (dynamic mode ${d})`,st[t])}uiCancelAllOrders(e){const t=this._uiState;if(!t.isTradable||!t.hasBuyOrders&&!t.hasSellOrders||1===e&&!t.hasBuyOrders||-1===e&&!t.hasSellOrders)return Promise.resolve();const i=(0,c.ensureNotNull)(this._trading.brokerCommandsUI()||null).cancelOrders(this._tradingLinking.value().symbol,e);return this._lockTimerUntilSettled(i),e?this._trackEvent("Cancel All "+(1===e?"Buy":"Sell")+" Orders"):this._trackEvent("Cancel All Orders"),Promise.resolve()}async uiClosePosition(){if(this._uiState.isPositionBlocked||!this._uiState.isTradable||!this._uiState.hasPosition||!this._uiState.hasFlatten)return;const e=this._realtimeProvider.activeBroker();if(!e)return;this._mergeUiState({isPositionBlocked:!0});const t=e.positions(this._tradingLinking.value().symbol).then((e=>{for(const t of e)if(0!==t.qty)return(0,c.ensureNotNull)(this._trading.brokerCommandsUI()).closePosition(t.id);return Promise.resolve(!1)})).finally((()=>this._mergeUiState({isPositionBlocked:!1})));this._lockTimerUntilSettled(t),this._trackEvent("Close Position")}async uiReversePosition(){if(this._uiState.isPositionBlocked||!this._uiState.isTradable||!this._uiState.hasPosition||!this._uiState.hasReverse)return;const e=this._realtimeProvider.activeBroker();if(!e)return;this._mergeUiState({isPositionBlocked:!0});const t=e.positions(this._tradingLinking.value().symbol).then((e=>{for(const t of e)if(0!==t.qty)return(0,c.ensureNotNull)(this._trading.brokerCommandsUI()).reversePosition(t.id);return Promise.resolve(!1)})).finally((()=>this._mergeUiState({isPositionBlocked:!1})));this._lockTimerUntilSettled(t),this._trackEvent("Reverse")}uiOrderMousedown(e,t,i){if(1!==e.buttons||null===t||null===this._mainBlock||null===this._subscription)return;this.uiStopOrderDrag();const s=t[i],r=this._subscription;let n=NaN;r.orderMouseRoot=document.documentElement,r.orderMousemoveHandler=e=>{if(e.preventDefault(),1!==(e.buttons||e.which)||void 0===this._configFlags||!(0,v.isMoveOrderSupported)(t,this._configFlags))return void this.uiStopOrderDrag();const s=(0,c.ensureNotNull)(this._mainBlock).getBoundingClientRect().y,r=rt(e)-s,o=-Math.floor(r/20),a=this._content.correctIndex(this._content.topIndex,o);n=this._content.indexToPrice(a),this._content.setDragShield(!0,!0),this._mergeTimerLockState({drag:!0}),this._content.setOrderGhost({order:t,pricePropertyName:i,price:n})},r.orderMouseupHandler=()=>{this.uiStopOrderDrag();this._realtimeProvider.activeBroker()&&isFinite(n)&&n!==s&&(this._content.setOrderGhost({order:t,pricePropertyName:i,price:n}),
this._content.setDragShield(!0,!0),this._trackEvent("Move Order"),this.uiModifyOrder(t,{[i]:n}).then((()=>this.uiStopOrderDrag())).catch((()=>this.uiStopOrderDrag())))},r.orderMousedownHandler=()=>{this.uiStopOrderDrag()},r.orderMouseRoot.addEventListener("mousemove",r.orderMousemoveHandler),r.orderMouseRoot.addEventListener("mouseup",r.orderMouseupHandler),setTimeout((()=>{const{orderMouseRoot:e,orderMousedownHandler:t}=r;e&&t&&e.addEventListener("mousedown",t)}),0)}uiStopOrderDrag(){if(this._content.setDragShield(!1,!1),this._content.resetOrderGhost(),this._mergeTimerLockState({drag:!1}),!this._subscription)return;const{orderMousemoveHandler:e,orderMouseupHandler:t,orderMousedownHandler:i,orderMouseRoot:s}=this._subscription;delete this._subscription.orderMousemoveHandler,delete this._subscription.orderMouseupHandler,delete this._subscription.orderMousedownHandler,delete this._subscription.orderMouseRoot,s&&e&&s.removeEventListener("mousemove",e),s&&t&&s.removeEventListener("mouseup",t),s&&i&&s.removeEventListener("mousedown",i)}uiContextMenu(e,t,s){if(!this._uiState.isTradable)return;if(1!==t&&-1!==t)return;const r=this._uiState.qty||NaN,o=(0,v.safeSplitSymbol)(this._tradingLinking.value().symbol)[1],a=(0,x.abbreviatedNumber)(r),l=[],d=this._symbolData?.priceFormatter||new f.PriceFormatter;if(this._trackEvent("Context Menu"),isFinite(s)){const e=d.format(s);if(this._isOrderTypeSupported(3)){const r={stopPrice:e,qty:a,symbol:o};let d="";d=1===t?n.t(null,{replace:r},i(175275)):n.t(null,{replace:r},i(87480));const c=new I.Action({actionId:"Trading.DOMPlaceStopOrder",options:{label:d,onExecute:()=>{this.uiPlaceOrder({side:t,price:s,type:3})}}});l.push(c)}if(this._isOrderTypeSupported(1)){const r={limitPrice:e,qty:a,symbol:o};let d="";d=1===t?n.t(null,{replace:r},i(52606)):n.t(null,{replace:r},i(998267));const c=new I.Action({actionId:"Trading.DOMPlaceLimitOrder",options:{label:d,onExecute:()=>{this.uiPlaceOrder({side:t,price:s,type:1})}}});l.push(c)}if(this._symbolData&&this._isOrderTypeSupported(4)){const r=(0,P.getMinTick)({minTick:this._symbolData.minTick,price:s,variableMinTickData:this._symbolData.variableMinTickData}),c=new(_())(r).mul(1===t?1:-1).plus(s).toNumber(),u={stopPrice:e,limitPrice:d.format(c),qty:a,symbol:o};let h="";h=1===t?n.t(null,{replace:u},i(374717)):n.t(null,{replace:u},i(628431));const m=new I.Action({actionId:"Trading.DOMPlaceStopLimitOrder",options:{label:h,onExecute:()=>{this.uiPlaceOrder({side:t,price:s,altPrice:c,type:4})}}});l.push(m)}}if(this._isOrderTypeSupported(2)){const e={qty:a,symbol:o};let s="";s=1===t?n.t(null,{replace:e},i(548866)):n.t(null,{replace:e},i(193012));const r=new I.Action({actionId:"Trading.DOMPlaceMarketOrder",options:{label:s,onExecute:()=>{this.uiPlaceOrder({side:t,type:2})}}});l.push(r)}l.length&&k.ContextMenuManager.showMenu(l,e,void 0,{menuName:"DOMWidgetContextMenu"})}_recreateLayout(e){null!==this._container&&(this._container.innerHTML="");const t=document.createElement("div"),r=document.createElement("div");this._upperBlockResizeObserver.disconnect(),
this._upperBlockResizeObserver.observe(t),t.classList.add(et.upperBlock),r.classList.add(et.bottomBlock),this._container=e;const n=function(e){const t=document.createElement("span"),r=document.createElement("span");return t.className=`${M["tv-dom-widget-main__offscreen-arrow"]} ${M["tv-dom-widget-main__offscreen-arrow--higher"]} js-hidden`,r.className=`${M["tv-dom-widget-main__offscreen-arrow"]} ${M["tv-dom-widget-main__offscreen-arrow--lower"]} js-hidden`,t.innerHTML=i(355482),r.innerHTML=i(482075),e.append(t),e.append(r),e=>{t.classList.toggle("js-hidden",e!==s.Higher),r.classList.toggle("js-hidden",e!==s.Lower)}}(t);this._content.getOffscreenIndexLocationObservable().subscribe(n),this._createMainBlock(t),this._createControlsBlock(r),this._createDOMBottomWidget(r),this._container.append(t),this._container.append(r),this._calcData.reset()}_createMainBlock(e){const t=document.createElement("div");t.className=M["tv-dom-widget-main"],e.append(t);const s=this._warning=document.createElement("div");s.className=`${Xe["tv-dom-panel__warning"]} i-hidden`,s.textContent=n.t(null,void 0,i(212938)),t.append(s),this._content.setContainer(t);let r=0;t.addEventListener("wheel",(e=>{if(!this._content.getDynamicModeState()&&(e.deltaMode!==e.DOM_DELTA_PAGE?r-=(0,b.getPixelsFromEvent)(e).y/100:r-=(0,y.clamp)(e.deltaY,-1,1),Math.abs(r)>=1)){const e=r%1;this.uiScroll(r-e),r=e}}));let o=!1;const a=e=>{if(o)return;const t="touches"in e;if(!t&&1!==(e.buttons||e.which))return;const i=this._content.topIndex;if(!isFinite(i))return;if(t&&1!==e.touches.length)return;if(!(e.target instanceof Element))return;if(!e.target.closest(`.${M["tv-dom-widget-main__value--price"]}`))return;o=!0;const s=rt(e),r=document.documentElement,n=()=>{["mouseup","mousedown","touchend","touchstart","touchcancel"].forEach((e=>r.removeEventListener(e,n))),r.removeEventListener("mousemove",a),r.removeEventListener("touchmove",a),o=!1,this._content.setDragShield(!1,!1),this._mergeTimerLockState({scroll:!1})},a=e=>{if(!this._content.getDynamicModeState()){if(!t&&1!==(e.buttons||e.which))return void n();const r=rt(e)-s,o=Math.round(r/20);o&&(this._content.setDragShield(!0,!1),this._mergeTimerLockState({scroll:!0})),this._content.shiftTopIndexRelativeToIndex(i,o)}};r.addEventListener(t?"touchmove":"mousemove",a),r.addEventListener(t?"touchend":"mouseup",n),t&&r.addEventListener("touchcancel",n),setTimeout((()=>{o&&r.addEventListener(t?"touchstart":"mousedown",n)}),0)};t.addEventListener("mousedown",a),t.addEventListener("touchstart",a),t.addEventListener("dblclick",(e=>{if(!(e.target instanceof Element))return;e.target.closest(`.${M["tv-dom-widget-main__value--price"]}`)&&this.uiCenter()})),this._mainBlock=t}_createDOMBottomWidget(e){const t=document.createElement("div");e.append(t);const i={domDetails:this._domDetails,currentDuration:this._currentDuration,durationMetaInfoList:this._durationMetaInfoList,onDurationChanged:this._onDurationChanged},s={uiPlaceOrder:e=>this.uiPlaceOrder(e),calcData:this._calcData},r={uiClosePosition:()=>this.uiClosePosition(),
uiCancelAllOrders:()=>this.uiCancelAllOrders(),uiReversePosition:()=>this.uiReversePosition()},n={plState$:this._calcData.plState$,positionState$:this._calcData.positionState$,defaultPLState:this._calcData.defaultPLState,defaultPositionState:this._calcData.defaultPositionState,changePLViewType:this._calcData.changePLViewType,compareQty:this._calcData.compareQty};!function(e,t){o.render(a.createElement(Ve,{...t}),e)}(t,{uiState$:this._uiState$.asObservable(),warningMessage$:this._warningMessage$?.asObservable(),tradingActionBlockControllers:r,domDetailsDropdownProps:i,domMarketActionBlockProps:s,domCalcBlockProps:n})}_createControlsBlock(e){const t=document.createElement("div"),{isTradable:i,hasBuyOrders:s,hasSellOrders:r}=this._uiState;this._cancelOrdersState$=new p.BehaviorSubject({cancelBuyOrdersDisabled:!i||!s,cancelSellOrdersDisabled:!i||!r}),this._updateValueBuySellOrders(),function(e){const{container:t,props:i}=e;o.render(a.createElement(Je,{...i}),t)}({container:t,props:{isLoading:this._isLoading,cancelOrdersState$:this._cancelOrdersState$.asObservable(),uiState$:this._uiState$.asObservable(),cancelOrders:e=>this.uiCancelAllOrders(e),onCenteringButtonClick:()=>this.uiCenter(),trackEvent:e=>this._trackEvent(e),toggleDynamicModeState:()=>this._content.toggleDynamicModeState(),isStaticDOMEnabled:tt,timer:this._createTimer}}),e.append(t)}_showNoDataNotice(){}_hideNoDataNotice(){}_syncActionButtons(){const{isPositionBlocked:e,isTradable:t,hasPosition:i,hasBuyOrders:s,hasSellOrders:r,hasFlatten:n,hasReverse:o}=this._uiState;if(this._actionPositionButtons&&this._actionMarketButtons){const a={...this._actionPositionButtons,...this._actionMarketButtons},l="i-disabled";a.flatten.disabled=e||!t||!i||!n,a.reverse.disabled=e||!t||!i||!o,a.clear.disabled=!t||!(s||r),a.flatten.title=this._flattenTitle,a.reverse.title=this._reverseTitle,a.clear.title=this._csxAllTitle;const d=this._isOrderTypeSupported(2);a.buyMarket.classList.toggle(l,!d),a.sellMarket.classList.toggle(l,!d)}this._cancelOrdersState$&&this._mergeCancelOrdersState({cancelBuyOrdersDisabled:!t||!s,cancelSellOrdersDisabled:!t||!r})}_mergeUiState(e){const t=this._uiState;let i,s=!1;for(i in e)t[i]!==e[i]&&(t[i]=e[i],s=!0);s&&(this._uiState$.next({...t}),this._headerState.setIsTradable(t.isTradable),this._syncActionButtons())}_handlers(){return{closeButtonClick:(e,t)=>{e.preventDefault(),this.uiCancelOrder(t&&t.id)},qtyClick:(e,t)=>{e.preventDefault(),this.uiModifyOrder(t)},bidAskClick:(e,{side:t,price:i,type:s})=>{e.preventDefault(),this.uiPlaceOrder({side:t,price:i,type:s||null})},bidAskContextMenu:(e,{side:t,price:i})=>{e.preventDefault(),this.uiContextMenu(e,t,i)},qtyChange:e=>{!isFinite(e)||e<0||(this._qtySuggester.setQty(this._tradingLinking.value().symbol,e),this._mergeUiState({qty:e}))},qtyInput:e=>{!isFinite(e)||e<0||this._mergeUiState({qty:e})},orderMousedown:(e,{order:t,pricePropertyName:i})=>{this.uiOrderMousedown(e,t,i)}}}_mergeTimerLockState(e){if(void 0===this._timer)return;const t=this._timerLockState;let i,s=!1;for(i in e)t[i]!==e[i]&&(t[i]=e[i],
s=!0);s&&(!t.autoCenterRequired||t.scroll||t.drag||t.dialog?this._timer.abort():this._timer.run())}_lockTimerUntilSettled(e){if(!e)return;this._mergeTimerLockState({dialog:e});const t=()=>{this._timerLockState?.dialog===e&&this._mergeTimerLockState({dialog:null})};e.then(t,t)}async _getSymbolData(e){const t=this._realtimeProvider.activeBroker(),[i,s,[r,n],o]=await Promise.all([this._realtimeProvider.symbolInfo(e),this._realtimeProvider.quantityFormatter(e),this._realtimeProvider.isTradable(e).then((async({tradable:i})=>[i,i?await(t?.getPositionCurrency(e)):void 0])),t?.formatter(e,!0)]),a=o??await this._realtimeProvider.formatter(e),l=Math.max(0,Math.ceil(-Math.log10(i.qty.step))),d=new S.VolumeFormatter({precision:l});return{brokerSymbol:i.brokerSymbol?(0,v.getSymbolNameOverFullname)(i.brokerSymbol):(0,v.getSymbolNameOverFullname)(e),minTick:i.minTick,pipSize:i.pipSize,priceFormatter:a,volumeFormatter:d,quantityFormatter:s,qtyProperties:i.qty,lotSize:i.lotSize,isTradable:r,positionCurrency:n,variableMinTickData:i.variableMinTick?(0,P.makeVariableMinTickData)(i.minTick,i.variableMinTick):void 0,units:i.units}}_unsubscribeData(){if(!this._subscription)return;const{broker:e,symbol:t,domHandler:i,realtimeHandler:s,orderHandler:r,positionHandler:n,plHandler:o,plPositionId:a,fullUpdateOrders:l,fullUpdatePosition:d}=this._subscription;this._subscription=null,t&&s&&this._realtimeProvider.unsubscribeRealtime(t,s),t&&i&&this._realtimeProvider.unsubscribeDOM(t,i),e&&r&&e.orderUpdate.unsubscribe(null,r),e&&n&&e.positionUpdate.unsubscribe(null,n),e&&o&&a&&e.unsubscribePL(a,o),e&&l&&e.currentAccountUpdate.unsubscribe(null,l),e&&d&&e.currentAccountUpdate.unsubscribe(null,d),this._suggestedQtySubscription?.unsubscribe()}_trackEvent(e,t){this._trading.trackEvent("DOM",e,t)}_processOrders(e){const t=[];let i=!1,s=!1;for(let r=0;r<e.length;r++){const n=e[r];if(4===n.status||3===n.status||6===n.status)switch(t.push(n),n.side){case 1:i=!0;break;case-1:s=!0}}this._content.updateOrders(t),this._updateValueBuySellOrders(),this._mergeUiState({hasBuyOrders:i,hasSellOrders:s})}_processPositions(e,t,i){const s=i.find((e=>0!==e.qty));this._mergeUiState({hasPosition:!!s}),void 0!==s&&s.id===t.plPositionId||t.plPositionId&&t.plHandler&&e.unsubscribePL&&(e.unsubscribePL(t.plPositionId,t.plHandler),delete t.plPositionId,t.plHandler=null),void 0===s||t.plPositionId===s.id&&t.plHandler||(t.plHandler=(e,i)=>{this._subscription===t&&this._calcData.updatePL(i)},t.plPositionId=s.id,e.subscribePL(t.plPositionId,t.plHandler)),this._content.updatePosition(s),this._calcData.updatePosition(s),this._calcData.updatePL()}_updateDurationMetainfo(e,t,i){const s=e?.metainfo().durations;if(this._durationMetaInfoList.setValue(void 0!==s?(0,v.filterDurationsBySymbolDurations)(s,i):void 0),null===e||void 0===this._durationMetaInfoList.value())return;const r=it(e.metainfo().id,t),n=u.getValue(r),o=void 0!==n?this._makeOrderDuration(n):this._makeDefaultOrderDuration();this._currentDuration.setValue(o),
void 0!==o&&this._domDetails.setDurationsInfo(o,this._durationMetaInfoList.value())}_makeDefaultOrderDuration(){const e=this._durationMetaInfoList.value();if(void 0===e||0===e.length)return;const t=e.find((e=>!0===e.default))||e[0];return(0,v.makeOrderDuration)(t)}_makeOrderDuration(e){const t=this._durationMetaInfoList.value()?.find((t=>t.value===e));return void 0!==t?(0,v.makeOrderDuration)(t):void 0}async _onStateChange(){const{symbol:e}=this._tradingLinking.value(),t=this._realtimeProvider.activeBroker(),i=t?.metainfo().configFlags.calculatePLUsingLast;if(!this._visible.value())return void this._unsubscribeData();this._noDataTimeout&&clearTimeout(this._noDataTimeout),this._noDataTimeout=setTimeout((()=>{this._warning?.classList.remove("i-hidden")}),3e3),this._headerState.setTitle(e),this._headerState.setDescription(t?.metainfo().title),this._headerState.setSymbol(e),this._headerState.setBrokerId(t?.metainfo().id),this._symbolData=null,this._unsubscribeData(),this._content.reset(),this._calcData.setBrokerConfigFlags({calculatePLUsingLast:!0===i}),this._calcData.reset();const s=null===t||t?.metainfo().configFlags.supportDOM;this._configFlags=t?.metainfo().configFlags,this._mergeUiState({isTradable:!1,hasPosition:!1,hasBuyOrders:!1,hasSellOrders:!1,qty:void 0,hasFlatten:null!==t&&!t.metainfo().configFlags.supportMultiposition}),this._mergeTimerLockState({scroll:!1,drag:!1,dialog:null}),this.uiStopOrderDrag();let r=[],n=[];if(!e||!s)return;const o={broker:t,symbol:e,domHandler:null,realtimeHandler:null,orderHandler:null,positionHandler:null,plHandler:null,plPositionId:void 0,fullUpdateOrders:null,fullUpdatePosition:null};this._subscription=o;const a=await this._qtySuggester.getQty(e);this._onSuggestedQtyChange(a),this._suggestedQtySubscription=this._qtySuggester.suggestedQtyChanged(e).subscribe(this._onSuggestedQtyChange);const l=await this._getSymbolData(e),d=l.isTradable;if(this._calcData.setHasLotSize(void 0!==l.lotSize),!l)return;if(this._subscription!==o)return;this._symbolData=l,this._content.setSymbolInfo(l),this._calcData.setSymbolInfo(l),this._headerState.setTitle(l.brokerSymbol||e),this._headerState.setDescription(t?.metainfo().title),this.isBats.setValue(!1),o.realtimeHandler=(e,t)=>{const i=t.trade||t.bid||t.ask;i&&this._noDataTimeout&&(this._warning?.classList.add("i-hidden"),clearTimeout(this._noDataTimeout),this._noDataTimeout=null),this._content.updateLast(i||NaN),this._calcData.updateLast(t.trade||NaN,t.bid||NaN,t.ask||NaN),this.delayedData.setValue(Boolean(t.isDelayed)),this._headerState.setHasDelayedQuotes(Boolean(t.isDelayed)),this._headerState.setHasBatsQuotes((0,v.isBatsQuotes)(t)),!this.isBats.value()&&(0,v.isBatsQuotes)(t)&&this.isBats.setValue(!0)},o.domHandler=(e,t)=>{this._content.updateData(t),this._scheduleUpdateViewTotalVolume()};const c=d?await(t?.getSymbolSpecificTradingOptions(e)):void 0;this._updateDurationMetainfo(t,e,c?.allowedDurations),this._mergeUiState({isTradable:d,symbolSpecificWarningMessage:c?.warningMessage,hasReverse:c?.supportReversePosition}),
this._realtimeProvider.subscribeRealtime(e,o.realtimeHandler),this._realtimeProvider.subscribeDOM(e,o.domHandler),this._supportedOrderTypes=this._getSupportedOrderTypes(t,c?.allowedOrderTypes),this._isOrderTypeSupported(3)?(document.addEventListener("keydown",this._handleModKeyStateChange,!1),document.addEventListener("keyup",this._handleModKeyStateChange,!1)):(document.removeEventListener("keydown",this._handleModKeyStateChange),document.removeEventListener("keyup",this._handleModKeyStateChange)),t&&d&&(o.orderHandler=e=>{if(e.symbol!==o.symbol)return;const t=r.findIndex((t=>t.id===e.id));-1!==t?r[t]=e:r.push(e),this._processOrders(r)},o.positionHandler=e=>{if(e.symbol!==o.symbol)return;const i=n.findIndex((t=>t.id===e.id));-1!==i?n[i]=e:n.push(e),this._processPositions(t,o,n)},o.fullUpdateOrders=()=>{const i=t.orders(e);o.orderPromise=i,i.then((e=>{this._subscription===o&&o.orderPromise===i&&(r=e,this._processOrders(e))}))},o.fullUpdatePosition=()=>{const i=t.positions(e);o.positionPromise=i,i.then((e=>{this._subscription===o&&o.positionPromise===i&&(n=e,this._processPositions(t,o,e))}))},t.orderUpdate.subscribe(null,o.orderHandler),t.positionUpdate.subscribe(null,o.positionHandler),t.currentAccountUpdate.subscribe(null,o.fullUpdateOrders),t.currentAccountUpdate.subscribe(null,o.fullUpdatePosition),o.fullUpdateOrders(),o.fullUpdatePosition()),this._updateViewTotalVolume(),this._updateValueBuySellOrders()}async _updateDetails(){const e=await(this._realtimeProvider.activeBroker()?.getOrderDialogOptions(this._tradingLinking.value().symbol)),t=e?.customFields??[];this._domDetails.setCustomFields(t)}_getSupportedOrderTypes(e,t){const i=[];return null===e||1!==e.connectionStatus()?[2]:(e.metainfo().configFlags.supportMarketOrders&&(0,v.isOrderTypeAllowed)(2,t)&&i.push(2),e.metainfo().configFlags.supportLimitOrders&&(0,v.isOrderTypeAllowed)(1,t)&&i.push(1),e.metainfo().configFlags.supportStopOrders&&(0,v.isOrderTypeAllowed)(3,t)&&i.push(3),e.metainfo().configFlags.supportStopLimitOrders&&(0,v.isOrderTypeAllowed)(4,t)&&i.push(4),i)}_isOrderTypeSupported(e){return-1!==this._supportedOrderTypes.indexOf(e)}_scheduleUpdateViewTotalVolume(){this._viewTotalVolumeScheduled||(this._viewTotalVolumeScheduled=!0,window.requestAnimationFrame((()=>this._updateViewTotalVolume())))}_updateViewTotalVolume(){if(this._viewTotalVolumeScheduled=!1,this._symbolData){const e=this._content.totalVolumeBid(),t=this._content.totalVolumeAsk();this._mergeUiState({totalVolumeAsk:isFinite(t)?this._content.formatVolume(t):"-",totalVolumeBid:isFinite(e)?this._content.formatVolume(e):"-"})}}_mergeCancelOrdersState(e){this._cancelOrdersState$?.next({...this._cancelOrdersState$.value,...e})}_updateValueBuySellOrders(){const e=this._content.buyOrdersValue(),t=this._content.sellOrdersValue(),i=this._content.buyInactiveOrdersValue(),s=this._content.sellInactiveOrdersValue(),r=this._content.buyOrdersQuantity(),n=this._content.sellOrdersQuantity();this._mergeCancelOrdersState({countedVolumeBuy:String(i>0?e:e||""),countedVolumeSell:String(s>0?t:t||""),
countedVolumeBuyTitle:0!==e||0!==i?this._setFormattingTextForCountVolume(e,i,+r):"",countedVolumeSellTitle:0!==t||0!==s?this._setFormattingTextForCountVolume(t,s,+n):""})}_setFormattingTextForCountVolume(e,t,s){const r=n.t(null,{plural:"{countOrders} active orders x {countQuantity}",count:e},i(24994)).format({countOrders:String(e),countQuantity:String(s)}),o=n.t(null,{plural:"{countInactiveOrders} inactive orders",count:t},i(304994)).format({countInactiveOrders:String(t)});return r+(t>0?`, ${o}`:"")}}var ot=i(227915);class at{constructor(e,t,s,r,c,u){var h;this._container=document.createElement("div"),this.centerDOM=()=>{this._centerDOM?.()},this._syncEnabled=()=>{const e=this._trading.activeBroker();return 1===e?.connectionStatus()&&!e.metainfo().configFlags.supportDOM?this._showEmptyState():this._hideEmptyState()},this._hideEmptyState=()=>{void 0!==this._emptyStateContainer&&(o.unmountComponentAtNode(this._emptyStateContainer),this._emptyStateContainer.remove(),this._emptyStateContainer=void 0,this._content?.classList.remove("js-hidden"))},this._showEmptyState=()=>{void 0===this._emptyStateContainer&&(this._content?.classList.add("js-hidden"),this._emptyStateContainer=document.createElement("div"),this._emptyStateContainer.classList.add(Xe["tv-dom-panel__disabled"]),o.render(a.createElement(l.EmptyStateBlock,{iconClass:Xe.emptyStateImage,title:n.t(null,void 0,i(904666)),titleSize:"normal",text:n.t(null,void 0,i(984892))}),this._emptyStateContainer),this._container.appendChild(this._emptyStateContainer))},this._syncVisibility=e=>{e?this._body.append(this._container):this._container.remove()},this._resizerBridge=t,this._widgetBody=new d.WatchedValue,this._visible=new d.WatchedValue(!1),this._trading=e,this._qtySuggester=s,this._tradingLinking=r,this._headerState=c,this._headerState.setSettings((h=e.showPricesWith(),[{settingType:0,label:n.t(null,void 0,i(140229)),value$:(0,ot.makeObservableFromWatchedValue)(h.zeroVolume),onClick:()=>h.zeroVolume.setValue(!h.zeroVolume.value())},{settingType:0,label:n.t(null,void 0,i(843379)),value$:(0,ot.makeObservableFromWatchedValue)(h.spread),onClick:()=>h.spread.setValue(!h.spread.value())}])),this._body=this._resizerBridge.container.value().querySelector(".trading-panel-content"),this._container=document.createElement("div"),this._trading.onConnectionStatusChange.subscribe(null,this._syncEnabled),this._syncEnabled(),this._visible.when((()=>{this._resizerBridge.container.subscribe((e=>{this._body=e.querySelector(".trading-panel-content"),this._createLayout(),this._syncEnabled()}),{callWithLast:!0});const e=new nt({body:this._widgetBody,visible:this._visible,trading:this._trading,qtySuggester:this._qtySuggester,tradingLinking:this._tradingLinking,headerState:this._headerState,isLoading:u});this._centerDOM=()=>e.uiCenter(),this._visible.subscribe(this._syncVisibility)}))}setCloseHandler(e){this._headerState.setCloseFunction(e)}setVisibility(e){this._visible.setValue(e)}_createLayout(){this._container.classList.add(Xe["tv-dom-panel"])
;const e=this._content=document.createElement("div");e.classList.add(Xe["tv-dom-panel__content"],Xe.mainblock),this._container.append(e),this._container.addEventListener("contextmenu",(e=>{e.target instanceof HTMLElement&&e.target.matches("input, textarea")||e.preventDefault()})),this._body.append(this._container),this._widgetBody.setValue(e)}}},314266:(e,t,i)=>{"use strict";i.d(t,{DurationControl:()=>B});var s=i(609838),r=i(50959),n=i(319937),o=i(679864),a=i(723991),l=i(354648),d=i(911794);function c(e){return e.flatMap((e=>"items"in e?e.items:e))}var u=i(167554);function h(e){const{isOpen:t,onClose:i,anchorId:s,anchorButtonRef:n,contentId:a,items:l,value:h,onChange:_,placementRules:p,width:g,height:v,closeOnClickAway:b,...y}=e,w=(0,r.useCallback)((e=>{i(!0,"currentLevel"),_(e)}),[i,_]),f=(0,r.useId)(),S=(0,r.useMemo)((()=>c(l)),[l]),x=(0,r.useMemo)((()=>S.findIndex((e=>e.value===h))),[S,h]);(0,r.useEffect)((()=>{if(!t)return;if(-1===x)return;const e=`item_${f}_${x}`,i=document.getElementById(e);var s;i&&(s=()=>{i.focus({preventScroll:!0}),(0,d.scrollPopoverItemIntoView)(i,!1)},window.requestIdleCallback?window.requestIdleCallback(s):setTimeout(s))}),[f,x,t]);const I=(0,r.useCallback)((()=>{let e=0;function t(t){return r.createElement(m,{id:`item_${f}_${e++}`,key:`${t.title}:${t.description}`,value:h,item:t,onSelectItem:w})}return r.createElement(r.Fragment,null,l.map(((e,i)=>"items"in e?r.createElement(u.SectionPopoverItem,{key:`group_${f}_${i}`,title:e.title},e.items.map(t)):t(e))))}),[l,w,f,h]),k=(0,r.useMemo)(I,[I]),P=y;return r.createElement(o.PopoverKeyboardNavigator,{role:"listbox",ariaLabelledby:s,isOpen:t,onClose:i,anchored:{type:"element",at:n},idOfContentWrapperElement:a,placementRules:p,width:g,height:v,focusFirstItemOnOpen:!1,closeOnClickAway:b,...P},k)}function m(e){const{id:t,value:i,item:s,onSelectItem:n}=e,o=(0,r.useCallback)((()=>n(s.value)),[n,s.value]),d=i===s.value;return r.createElement(a.PopoverItem,{role:"option",selected:d,ariaChecked:d,title:s.title,leftSlot:(0,l.iconPart)(s),key:s.title,popoverItemButtonId:t,onClick:o,disabled:s.disabled})}var _=i(928141),p=i(937901);function g(e){return function(e){const{isOpen:t,onClose:i,contentId:s,anchorButtonRef:r,anchorId:o,handleAnchorClick:a,handleAnchorKeyDown:l}=(0,n.useDefaultButtonAnchorProps)({anchorId:e.anchorId,openOnEnter:e.openOnEnter});return{isOpen:t,anchorProps:{id:o,role:"combobox",onClick:a,onKeyDown:l,...(0,p.createRefProp)(e.refStyle,r),...(0,_.createAriaAttributesProps)(e.ariaStyle,{expanded:t,controls:s,haspopup:"listbox"})},popoverProps:{isOpen:t,anchorId:o,anchorButtonRef:r,contentId:s,onClose:i,items:e.items,value:e.value,onChange:e.onChange}}}({items:e.items,value:e.value,onChange:e.onChange,refStyle:e?.refStyle??"reference",ariaStyle:e?.ariaStyle??"kebab-case",openOnEnter:e.openOnEnter,anchorId:e?.anchorId})}function v(e){
const{title:t,items:i,onChange:s,value:o,noneSelectedTitle:a,popoverPlacementRules:l,popoverWidth:d,popoverHeight:u,stretch:m,anchorButtonId:_,disabled:p,anchorButtonSize:v,anchorButtonSizeClassname:b,openOnEnter:y}=e,w=(0,r.useMemo)((()=>c(i).find((e=>e.value===o))),[i,o]),{isOpen:f,anchorProps:S,popoverProps:x}=g({items:i,value:o,onChange:s,openOnEnter:y,ariaStyle:"camelCase",anchorId:_}),I=t??w?.title??a;return r.createElement(r.Fragment,null,r.createElement(n.ButtonAnchor,{...S,children:I,isOpen:f,stretch:m,anchorButtonClassname:b,disabled:p,size:v}),r.createElement(h,{...x,placementRules:l,width:d,height:u}))}var b=i(391431),y=i(930202),w=i(350324),f=i(493173),S=i(44807),x=i(508550),I=i(614793),k=i(25596);const P=new Date((new Date).setHours(0,0,0,0));const T=(0,f.mergeThemes)(w.DEFAULT_INPUT_DATE_THEME,{container:k.dateInputContainer,date:k.dateInput,icon:k.dateInputIcon});function O(e){return r.createElement(w.DateInput,{...e,theme:T})}function C(e){const{initDateTime:t,onDateSelect:i,onTimeSelect:s,onControlFocused:n,hasDatePicker:o,hasTimePicker:a,showErrorMessages:l,onError:d,revertInvalidData:c,keepFocusOnKeyBoardTimeNavigation:u}=e;if((0,r.useEffect)((()=>()=>d?.(!1)),[]),!o&&!a)return r.createElement(r.Fragment,null);const h=()=>{n?.()};return r.createElement("div",{className:k.dateTimeWrapper,onKeyDown:e=>{13===(0,y.hashFromEvent)(e)&&e.stopPropagation()}},o&&r.createElement(I.DatePicker,{name:"duration-date-input",containerClassName:k.containerDatePicker,minDate:P,initial:t,onPick:e=>{if(null===e)return d?.(!0);i(e),d?.(!1)},onFocus:h,InputComponent:O,showErrorMessages:l,revertInvalidData:c,showOnFocus:!1}),a&&r.createElement(S.TimeInput,{name:"duration-time-input",value:(m=t,(0,x.twoDigitsFormat)(m.getHours())+":"+(0,x.twoDigitsFormat)(m.getMinutes())),onChange:e=>{s(function(e){const[t,i]=e.split(":"),s=new Date;return s.setHours(Number(t),Number(i)),s}(e))},onFocus:h,keepFocusOnKeyBoardNavigation:u}));var m}var E=i(927186);function M(e,t){return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),t.getUTCHours(),t.getUTCMinutes())}const D="duration-select-input";function B(e){const{currentDuration:t,durationMetaInfoList:n,onDurationChanged:o,onControlFocused:a,showErrorMessages:l,revertInvalidData:d,onError:c}=e,u=(0,b.findDurationMetaInfo)(n,t.type);(0,r.useEffect)((()=>{if(void 0===a)return;const e=document.getElementById(D);return e?.addEventListener("focus",a),()=>e?.removeEventListener("focus",a)}),[a]);const h=(0,r.useMemo)((()=>void 0!==t.datetime?new Date(t.datetime):["GTT","GTD"].includes(t.type)?(0,b.makeDatePlus24UTCHours)():new Date),[t.datetime,t.type]),m=(0,r.useMemo)((()=>n.map((e=>({title:e.name,value:e.value})))),[n]);if(void 0===u)return r.createElement(r.Fragment,null);const _=m.length<2;return r.createElement("div",{className:E.wrapper},r.createElement("span",{className:E.title},s.t(null,void 0,i(296344))),r.createElement(v,{anchorButtonId:D,value:u?.value,items:m,disabled:_,onChange:function(i){const s={type:i},r=(0,b.findDurationMetaInfo)(n,i)
;void 0!==r&&(r.hasDatePicker||r.hasTimePicker)&&(s.datetime=t.datetime||(0,b.getTimestamp)((0,b.makeDatePlus24UTCHours)()));o(s),void 0!==e.onClose&&e.onClose()},stretch:!0}),r.createElement(C,{initDateTime:h,hasDatePicker:u.hasDatePicker,hasTimePicker:u.hasTimePicker,onControlFocused:a,onDateSelect:function(t){const i=M(t,h);e.onDurationChanged({type:e.currentDuration.type,datetime:i})},onTimeSelect:function(t){const i=M(h,t);e.onDurationChanged({type:e.currentDuration.type,datetime:i})},revertInvalidData:d,showErrorMessages:l,onError:c,keepFocusOnKeyBoardTimeNavigation:!0}))}},729354:(e,t,i)=>{"use strict";i.d(t,{QuantityInput:()=>_});var s=i(50959),r=i(609838),n=i(463039),o=i(499665);var a=i(587125),l=i(341086),d=i(50771),c=i(848062),u=i(863582),h=i(391431),m=i(583221);function _(e){const{id:t,qty:_,quantityMetainfo:p,onValueChange:g,className:v,customTitle:b,hasLotSize:y,onClick:w,inputReference:f,hideLabel:S,button:x,customErrorsAttachment:I}=e,{error:k,errorMessage:P,setError:T,setErrorMessage:O,handleInputError:C}=function(e,t){const[i,r]=(0,s.useState)(!1),[n,a]=(0,s.useState)(void 0),[l,d]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{const{res:i,msg:s}=(0,o.checkQtyError)(t,e,!0),n=l?void 0:s;r(l||i),a(n)}),[e,t,l]),{error:i,errorMessage:n,setError:r,setErrorMessage:a,handleInputError:e=>{d(e)}}}(_,p),E=(0,s.useMemo)((()=>(0,l.numberFormattersParsersChain)({chain:[(0,d.prohibitNanOnParseStep)(),(0,c.decimalNumberMagnitudeStep)({standardNotationOnly:!0}),(0,u.signumStep)({negativeSign:u.longMinusSign})]},{ignoreLocaleNumberFormat:!0})),[p]),M=b??(y?r.t(null,void 0,i(833526)):r.t(null,void 0,i(715432)));return s.createElement(s.Fragment,null,s.createElement(n.Label,{className:S&&m.hiddenLabel,htmlFor:t},M),s.createElement(a.NumberInput,{...p,button:x,id:t,className:v,value:(0,h.applyRounding)(_,E),onValueChange:e=>{const{res:t,msg:i}=(0,o.checkQtyError)(p,e,!0);t||g(e),T(t),O(i)},error:k,errorMessage:P,errorHandler:C,onBlur:()=>{T(!1),O(void 0)},onClick:w,inputReference:f,useFormatter:!1,mode:"float",customErrorsAttachment:I}))}},853177:(e,t,i)=>{"use strict";i.d(t,{TradingPanelWarningInformersContainer:()=>_});var s=i(50959),r=i(815544),n=i(38323);var o=i(586639),a=i(609838),l=i(918460);const d=e=>{const[t,i]=(0,s.useState)(e);return[t,(0,s.useCallback)((()=>i(!1)),[]),(0,s.useCallback)((()=>i(!0)),[])]};var c=i(661851),u=i(421978);function h(e){const{warningMessageSource:t,isCloseButtonShown:h=!0}=e,[m,_]=(0,s.useState)(),[p,g,v]=d(!0),b=(0,s.useCallback)((e=>{_(e),v()}),[]),y=(0,s.useMemo)((()=>{return(e=t)&&(e instanceof r.Observable||(0,n.isFunction)(e.lift)&&(0,n.isFunction)(e.subscribe))?t:(0,o.of)(t);var e}),[t]);return(0,c.useObservableSubscription)(y,b),p&&void 0!==m&&""!==m?s.createElement(l.Informer,{content:m,header:a.t(null,void 0,i(392298)),informerIntent:"warning",isCloseButtonShown:h,className:u.informer,onCloseClick:g}):s.createElement(s.Fragment,null)}var m=i(375390);function _(e){const{warningInformersItems:t}=e;return 0===t.length?s.createElement(s.Fragment,null):s.createElement("div",{
className:m.wrapper},t.map((e=>s.createElement(h,{key:e.id,...e}))))}},904925:(e,t,i)=>{"use strict";i.d(t,{PopupMenuDisclosureView:()=>c});var s=i(50959),r=i(624216),n=i(650151);const o={x:0,y:0};function a(e,t,i){return(0,s.useCallback)((()=>function(e,t,{x:i=o.x,y:s=o.y}=o){const r=(0,n.ensureNotNull)(e).getBoundingClientRect(),a={x:r.left+i,y:r.top+r.height+s,indentFromWindow:{top:4,bottom:4,left:4,right:4}};return t&&(a.overrideWidth=r.width),a}(e.current,t,i)),[e,t])}var l=i(586240);const d=parseInt(l["size-header-height"]);function c(e){const{button:t,popupChildren:i,buttonRef:n,listboxId:o,listboxClassName:l,listboxTabIndex:c,matchButtonAndListboxWidths:u,isOpened:h,scrollWrapReference:m,listboxReference:_,onClose:p,onOpen:g,onListboxFocus:v,onListboxBlur:b,onListboxKeyDown:y,listboxAria:w,repositionOnScroll:f=!0,closeOnHeaderOverlap:S=!1,popupPositionCorrection:x={x:0,y:0},popupPosition:I}=e,k=a(n,u,x),P=S?d:0;return s.createElement(s.Fragment,null,t,s.createElement(r.PopupMenu,{...w,id:o,className:l,tabIndex:c,isOpened:h,position:I||k,repositionOnScroll:f,onClose:p,onOpen:g,doNotCloseOn:n.current,reference:_,scrollWrapReference:m,onFocus:v,onBlur:b,onKeyDown:y,closeOnScrollOutsideOffset:P},i))}},662941:(e,t,i)=>{"use strict";i.d(t,{EmptyStateBlock:()=>l});var s=i(50959),r=i(497754),n=i.n(r),o=i(698110);function a(e){const{title:t,tagName:i,titleSize:r}=e,a=i||"strong";return s.createElement(a,{className:n()(o.title,o[`title_${r}`])},t)}const l=(0,s.forwardRef)((function(e,t){return s.createElement("div",{className:r(o.container,e.className),ref:t},s.createElement("div",{className:r(o.icon,e.iconClass)}),e.title&&s.createElement(a,{title:e.title,titleSize:e.titleSize,tagName:e.titleTagName}),e.text&&s.createElement("div",{className:r(o.text,"large"===e.textSize&&o.text_large)},e.text),e.action&&s.createElement("div",{className:o.action},e.action))}))},297265:(e,t,i)=>{"use strict";i.d(t,{useWatchedValueReadonly:()=>r});var s=i(50959);const r=(e,t=!1,i=[])=>{const r="watchedValue"in e?e.watchedValue:void 0,n="defaultValue"in e?e.defaultValue:e.watchedValue.value(),[o,a]=(0,s.useState)(r?r.value():n);return(t?s.useLayoutEffect:s.useEffect)((()=>{if(r){a(r.value());const e=e=>a(e);return r.subscribe(e),()=>r.unsubscribe(e)}return()=>{}}),[r,...i]),o}},901317:(e,t,i)=>{"use strict";i.d(t,{useWatchedValue:()=>r});var s=i(50959);const r=(e,t=[])=>{const[i,r]=(0,s.useState)(e.value());return(0,s.useEffect)((()=>{const t=e=>r(e);return e.subscribe(t),()=>e.unsubscribe(t)}),[e,...t]),[i,t=>e.setValue(t)]}},493173:(e,t,i)=>{"use strict";function s(e,t,i={}){return Object.assign({},e,function(e,t,i={}){const s=Object.assign({},t);for(const r of Object.keys(t)){const n=i[r]||r;n in e&&(s[r]=[e[n],t[r]].join(" "))}return s}(e,t,i))}i.d(t,{mergeThemes:()=>s})},181436:(e,t,i)=>{"use strict";i.d(t,{getPixelsFromEvent:()=>r});const s=[()=>navigator.userAgent.includes("Win")&&navigator.userAgent.includes("Chrome")?1/window.devicePixelRatio:1,()=>16,(e=()=>0)=>.8*(e()??0)];function r(e,t=()=>({})){return{
x:e.deltaX*s[e.deltaMode]((()=>t().width)),y:e.deltaY*s[e.deltaMode]((()=>t().height))}}},834073:(e,t,i)=>{"use strict";i.d(t,{TradingInformer:()=>n});var s=i(50959);i(632227),i(661851);const r=s.lazy((async()=>({default:(await Promise.all([i.e(9642),i.e(4582),i.e(4010)]).then(i.bind(i,37624))).TradingInformerImpl})));function n(e){const{informerMessage:t,className:i}=e;return s.createElement(s.Suspense,{fallback:null},s.createElement(r,{className:i,informerMessage:t}))}},102464:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.578 9.5A5.446 5.446 0 008.5 14.422V16h1v-1.578A5.446 5.446 0 0014.422 9.5H16v-1h-1.578A5.446 5.446 0 009.5 3.578V2h-1v1.578A5.446 5.446 0 003.578 8.5H2v1h1.578zM8.5 6V4.583A4.446 4.446 0 004.583 8.5H6v1H4.583A4.446 4.446 0 008.5 13.417V12h1v1.417A4.446 4.446 0 0013.417 9.5H12v-1h1.417A4.446 4.446 0 009.5 4.583V6h-1z"/></svg>'},347531:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="m4.67 7.38.66-.76L9 9.84l3.67-3.22.66.76L9 11.16 4.67 7.38Z"/></svg>'},368182:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="m4.67 10.62.66.76L9 8.16l3.67 3.22.66-.76L9 6.84l-4.33 3.78Z"/></svg>'},499084:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16Zm4-9.97L11.9 6 8.3 9.82 6.1 7.46 4.99 8.5 8.32 12 13 7.03Z"/></svg>'},530162:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"/></svg>'},527941:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16Zm1-12a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM8.5 9.5H7V8h3v6H8.5V9.5Z"/></svg>'},611902:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><path stroke="currentcolor" stroke-linecap="round" d="M4 7l5 4 5-4"/></svg>'},488263:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><path stroke="currentcolor" stroke-linecap="round" d="M4 11l5-4 5 4"/></svg>'},11728:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 9" width="9" height="9"><path stroke="currentcolor" stroke-width="1.2" d="M1 1l7 7m0-7L1 8"/></svg>'},781957:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 17" width="16" height="17" fill="none"><rect width="15" height="9" stroke="currentcolor" rx="2.5" x=".5" y="7.5"/><circle stroke="currentcolor" cx="8" cy="12" r=".5"/><path stroke="currentcolor" d="M3.5 7c0 .28.22.5.5.5h8a.5.5 0 0 0 .5-.5V5a4.5 4.5 0 1 0-9 0v2z"/></svg>'},943145:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 17" width="16" height="17" fill="none"><path fill="currentcolor" fill-rule="evenodd" clip-rule="evenodd" d="M4 5v2h9a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V5a5 5 0 0 1 8.66-3.4l-.74.66A3.99 3.99 0 0 0 4 5z"/><rect width="15" height="9" stroke="currentcolor" rx="2.5" x=".5" y="7.5"/><circle stroke="currentcolor" cx="8" cy="12" r=".5"/></svg>'},482075:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 7" width="12" height="7"><path d="M1 0a1 1 0 0 0-1 1c0 .276.1.538.28.72l5 5c.182.18.444.28.72.28.276 0 .538-.1.72-.28l5-5c.18-.182.28-.444.28-.72a1 1 0 0 0-1-1c-.276 0-.538.1-.72.28L6 4.563 1.72.282C1.537.1 1.275 0 1 0z"/></svg>'},355482:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 7" width="12" height="7"><path d="M1 7a1 1 0 0 1-1-1c0-.276.1-.538.28-.72l5-5C5.463.1 5.725 0 6 0c.276 0 .538.1.72.28l5 5c.18.182.28.444.28.72a1 1 0 0 1-1 1c-.276 0-.538-.1-.72-.28L6 2.437l-4.28 4.28C1.537 6.9 1.275 7 1 7z"/></svg>'},548927:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 9" width="9px" height="9px"><path d="M2 1L1 2l2.5 2.5L1 7l1 1 2.5-2.5L7 8l1-1-2.5-2.5L8 2 7 1 4.5 3.5z"/></svg>'}}]);